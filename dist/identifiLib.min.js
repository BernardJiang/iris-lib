!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.identifiLib=e()}(this,function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t,e){return t(e={exports:{}},e.exports),e.exports}var n=i(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),r=i(function(t){var e=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),s=(r.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),o=function(t,e,i){if(s(t),void 0===e)return t;switch(i){case 1:return function(i){return t.call(e,i)};case 2:return function(i,n){return t.call(e,i,n)};case 3:return function(i,n,r){return t.call(e,i,n,r)}}return function(){return t.apply(e,arguments)}},a=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t},h=function(t){try{return!!t()}catch(t){return!0}},c=!h(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=n.document,l=a(f)&&a(f.createElement),d=function(t){return l?f.createElement(t):{}},p=!c&&!h(function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a}),g=function(t,e){if(!a(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!a(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!a(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!a(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")},v=Object.defineProperty,y={f:c?Object.defineProperty:function(t,e,i){if(u(t),e=g(e,!0),u(i),p)try{return v(t,e,i)}catch(t){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[e]=i.value),t}},m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=c?function(t,e,i){return y.f(t,e,m(1,i))}:function(t,e,i){return t[e]=i,t},S={}.hasOwnProperty,w=function(t,e){return S.call(t,e)},x=function(t,e,i){var s,a,u,h=t&x.F,c=t&x.G,f=t&x.S,l=t&x.P,d=t&x.B,p=t&x.W,g=c?r:r[e]||(r[e]={}),v=g.prototype,y=c?n:f?n[e]:(n[e]||{}).prototype;for(s in c&&(i=e),i)(a=!h&&y&&void 0!==y[s])&&w(g,s)||(u=a?y[s]:i[s],g[s]=c&&"function"!=typeof y[s]?i[s]:d&&a?o(u,n):p&&y[s]==u?function(t){var e=function(e,i,n){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,i)}return new t(e,i,n)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(u):l&&"function"==typeof u?o(Function.call,u):u,l&&((g.virtual||(g.virtual={}))[s]=u,t&x.R&&v&&!v[s]&&b(v,s,u)))};x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128;var F,E=x,A={}.toString,D=function(t){return A.call(t).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==D(t)?t.split(""):Object(t)},I=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},T=function(t){return C(I(t))},P=Math.ceil,j=Math.floor,H=function(t){return isNaN(t=+t)?0:(t>0?j:P)(t)},_=Math.min,R=function(t){return t>0?_(H(t),9007199254740991):0},k=Math.max,B=Math.min,N=i(function(t){var e=n["__core-js_shared__"]||(n["__core-js_shared__"]={});(t.exports=function(t,i){return e[t]||(e[t]=void 0!==i?i:{})})("versions",[]).push({version:r.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),O=0,V=Math.random(),L=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++O+V).toString(36))},M=N("keys"),K=function(t){return M[t]||(M[t]=L(t))},U=(F=!1,function(t,e,i){var n,r=T(t),s=R(r.length),o=function(t,e){return(t=H(t))<0?k(t+e,0):B(t,e)}(i,s);if(F&&e!=e){for(;s>o;)if((n=r[o++])!=n)return!0}else for(;s>o;o++)if((F||o in r)&&r[o]===e)return F||o||0;return!F&&-1}),q=K("IE_PROTO"),$=function(t,e){var i,n=T(t),r=0,s=[];for(i in n)i!=q&&w(n,i)&&s.push(i);for(;e.length>r;)w(n,i=e[r++])&&(~U(s,i)||s.push(i));return s},z="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),G=Object.keys||function(t){return $(t,z)},J={f:Object.getOwnPropertySymbols},W={f:{}.propertyIsEnumerable},Y=function(t){return Object(I(t))},X=Object.assign,Z=!X||h(function(){var t={},e={},i=Symbol(),n="abcdefghijklmnopqrst";return t[i]=7,n.split("").forEach(function(t){e[t]=t}),7!=X({},t)[i]||Object.keys(X({},e)).join("")!=n})?function(t,e){for(var i=Y(t),n=arguments.length,r=1,s=J.f,o=W.f;n>r;)for(var a,u=C(arguments[r++]),h=s?G(u).concat(s(u)):G(u),c=h.length,f=0;c>f;)o.call(u,a=h[f++])&&(i[a]=u[a]);return i}:X;E(E.S+E.F,"Object",{assign:Z});var Q=r.Object.assign,tt=e(i(function(t){t.exports={default:Q,__esModule:!0}})),et=i(function(t,e){t.exports=e=self.fetch,e.default=self.fetch.bind(self),e.Headers=self.Headers,e.Request=self.Request,e.Response=self.Response}),it=(et.Headers,et.Request,et.Response,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),nt=[],rt=[],st="undefined"!=typeof Uint8Array?Uint8Array:Array,ot=!1;function at(){ot=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,i=t.length;e<i;++e)nt[e]=t[e],rt[t.charCodeAt(e)]=e;rt["-".charCodeAt(0)]=62,rt["_".charCodeAt(0)]=63}function ut(t,e,i){for(var n,r,s=[],o=e;o<i;o+=3)n=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(nt[(r=n)>>18&63]+nt[r>>12&63]+nt[r>>6&63]+nt[63&r]);return s.join("")}function ht(t){var e;ot||at();for(var i=t.length,n=i%3,r="",s=[],o=0,a=i-n;o<a;o+=16383)s.push(ut(t,o,o+16383>a?a:o+16383));return 1===n?(e=t[i-1],r+=nt[e>>2],r+=nt[e<<4&63],r+="=="):2===n&&(e=(t[i-2]<<8)+t[i-1],r+=nt[e>>10],r+=nt[e>>4&63],r+=nt[e<<2&63],r+="="),s.push(r),s.join("")}function ct(t,e,i,n,r){var s,o,a=8*r-n-1,u=(1<<a)-1,h=u>>1,c=-7,f=i?r-1:0,l=i?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=n;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-h;else{if(s===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,n),s-=h}return(d?-1:1)*o*Math.pow(2,s-n)}function ft(t,e,i,n,r,s){var o,a,u,h=8*s-r-1,c=(1<<h)-1,f=c>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:s-1,p=n?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+f>=1?l/u:l*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*u-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[i+d]=255&a,d+=p,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[i+d]=255&o,d+=p,o/=256,h-=8);t[i+d-p]|=128*g}var lt={}.toString,dt=Array.isArray||function(t){return"[object Array]"==lt.call(t)};function pt(){return vt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function gt(t,e){if(pt()<e)throw new RangeError("Invalid typed array length");return vt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=vt.prototype:(null===t&&(t=new vt(e)),t.length=e),t}function vt(t,e,i){if(!(vt.TYPED_ARRAY_SUPPORT||this instanceof vt))return new vt(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return bt(this,t)}return yt(this,t,e,i)}function yt(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n);vt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=vt.prototype:t=St(t,e);return t}(t,e,i,n):"string"==typeof e?function(t,e,i){"string"==typeof i&&""!==i||(i="utf8");if(!vt.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|Ft(e,i),r=(t=gt(t,n)).write(e,i);r!==n&&(t=t.slice(0,r));return t}(t,e,i):function(t,e){if(xt(e)){var i=0|wt(e.length);return 0===(t=gt(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(n=e.length)!=n?gt(t,0):St(t,e);if("Buffer"===e.type&&dt(e.data))return St(t,e.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function mt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function bt(t,e){if(mt(e),t=gt(t,e<0?0:0|wt(e)),!vt.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function St(t,e){var i=e.length<0?0:0|wt(e.length);t=gt(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function wt(t){if(t>=pt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+pt().toString(16)+" bytes");return 0|t}function xt(t){return!(null==t||!t._isBuffer)}function Ft(t,e){if(xt(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return Wt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return Yt(t).length;default:if(n)return Wt(t).length;e=(""+e).toLowerCase(),n=!0}}function Et(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function At(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=vt.from(e,n)),xt(e))return 0===e.length?-1:Dt(t,e,i,n,r);if("number"==typeof e)return e&=255,vt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):Dt(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function Dt(t,e,i,n,r){var s,o=1,a=t.length,u=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,i/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=i;s<a;s++)if(h(t,s)===h(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(i+u>a&&(i=a-u),s=i;s>=0;s--){for(var f=!0,l=0;l<u;l++)if(h(t,s+l)!==h(e,l)){f=!1;break}if(f)return s}return-1}function Ct(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var o=0;o<n;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[i+o]=a}return o}function It(t,e,i,n){return Xt(Wt(e,t.length-i),t,i,n)}function Tt(t,e,i,n){return Xt(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function Pt(t,e,i,n){return Tt(t,e,i,n)}function jt(t,e,i,n){return Xt(Yt(e),t,i,n)}function Ht(t,e,i,n){return Xt(function(t,e){for(var i,n,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)i=t.charCodeAt(o),n=i>>8,r=i%256,s.push(r),s.push(n);return s}(e,t.length-i),t,i,n)}function _t(t,e,i){return 0===e&&i===t.length?ht(t):ht(t.slice(e,i))}function Rt(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var s,o,a,u,h=t[r],c=null,f=h>239?4:h>223?3:h>191?2:1;if(r+f<=i)switch(f){case 1:h<128&&(c=h);break;case 2:128==(192&(s=t[r+1]))&&(u=(31&h)<<6|63&s)>127&&(c=u);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(u=(15&h)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(u=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,f=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),r+=f}return function(t){var e=t.length;if(e<=kt)return String.fromCharCode.apply(String,t);var i="",n=0;for(;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=kt));return i}(n)}vt.TYPED_ARRAY_SUPPORT=void 0===it.TYPED_ARRAY_SUPPORT||it.TYPED_ARRAY_SUPPORT,vt.poolSize=8192,vt._augment=function(t){return t.__proto__=vt.prototype,t},vt.from=function(t,e,i){return yt(null,t,e,i)},vt.TYPED_ARRAY_SUPPORT&&(vt.prototype.__proto__=Uint8Array.prototype,vt.__proto__=Uint8Array),vt.alloc=function(t,e,i){return function(t,e,i,n){return mt(e),e<=0?gt(t,e):void 0!==i?"string"==typeof n?gt(t,e).fill(i,n):gt(t,e).fill(i):gt(t,e)}(null,t,e,i)},vt.allocUnsafe=function(t){return bt(null,t)},vt.allocUnsafeSlow=function(t){return bt(null,t)},vt.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Zt(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Zt(t.slice(0,0))}(t))},vt.compare=function(t,e){if(!xt(t)||!xt(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,s=Math.min(i,n);r<s;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},vt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},vt.concat=function(t,e){if(!dt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return vt.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=vt.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var s=t[i];if(!xt(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,r),r+=s.length}return n},vt.byteLength=Ft,vt.prototype._isBuffer=!0,vt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Et(this,e,e+1);return this},vt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Et(this,e,e+3),Et(this,e+1,e+2);return this},vt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Et(this,e,e+7),Et(this,e+1,e+6),Et(this,e+2,e+5),Et(this,e+3,e+4);return this},vt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Rt(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Ot(this,e,i);case"utf8":case"utf-8":return Rt(this,e,i);case"ascii":return Bt(this,e,i);case"latin1":case"binary":return Nt(this,e,i);case"base64":return _t(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},vt.prototype.equals=function(t){if(!xt(t))throw new TypeError("Argument must be a Buffer");return this===t||0===vt.compare(this,t)},vt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},vt.prototype.compare=function(t,e,i,n,r){if(!xt(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(n>>>=0),o=(i>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(n,r),h=t.slice(e,i),c=0;c<a;++c)if(u[c]!==h[c]){s=u[c],o=h[c];break}return s<o?-1:o<s?1:0},vt.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},vt.prototype.indexOf=function(t,e,i){return At(this,t,e,i,!0)},vt.prototype.lastIndexOf=function(t,e,i){return At(this,t,e,i,!1)},vt.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return Ct(this,t,e,i);case"utf8":case"utf-8":return It(this,t,e,i);case"ascii":return Tt(this,t,e,i);case"latin1":case"binary":return Pt(this,t,e,i);case"base64":return jt(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ht(this,t,e,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},vt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var kt=4096;function Bt(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function Nt(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function Ot(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",s=e;s<i;++s)r+=Jt(t[s]);return r}function Vt(t,e,i){for(var n=t.slice(e,i),r="",s=0;s<n.length;s+=2)r+=String.fromCharCode(n[s]+256*n[s+1]);return r}function Lt(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function Mt(t,e,i,n,r,s){if(!xt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function Kt(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-i,2);r<s;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function Ut(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-i,4);r<s;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function qt(t,e,i,n,r,s){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function $t(t,e,i,n,r){return r||qt(t,0,i,4),ft(t,e,i,n,23,4),i+4}function zt(t,e,i,n,r){return r||qt(t,0,i,8),ft(t,e,i,n,52,8),i+8}vt.prototype.slice=function(t,e){var i,n=this.length;if((t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),vt.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=vt.prototype;else{var r=e-t;i=new vt(r,void 0);for(var s=0;s<r;++s)i[s]=this[s+t]}return i},vt.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||Lt(t,e,this.length);for(var n=this[t],r=1,s=0;++s<e&&(r*=256);)n+=this[t+s]*r;return n},vt.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||Lt(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},vt.prototype.readUInt8=function(t,e){return e||Lt(t,1,this.length),this[t]},vt.prototype.readUInt16LE=function(t,e){return e||Lt(t,2,this.length),this[t]|this[t+1]<<8},vt.prototype.readUInt16BE=function(t,e){return e||Lt(t,2,this.length),this[t]<<8|this[t+1]},vt.prototype.readUInt32LE=function(t,e){return e||Lt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},vt.prototype.readUInt32BE=function(t,e){return e||Lt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},vt.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||Lt(t,e,this.length);for(var n=this[t],r=1,s=0;++s<e&&(r*=256);)n+=this[t+s]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},vt.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||Lt(t,e,this.length);for(var n=e,r=1,s=this[t+--n];n>0&&(r*=256);)s+=this[t+--n]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},vt.prototype.readInt8=function(t,e){return e||Lt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},vt.prototype.readInt16LE=function(t,e){e||Lt(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},vt.prototype.readInt16BE=function(t,e){e||Lt(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},vt.prototype.readInt32LE=function(t,e){return e||Lt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},vt.prototype.readInt32BE=function(t,e){return e||Lt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},vt.prototype.readFloatLE=function(t,e){return e||Lt(t,4,this.length),ct(this,t,!0,23,4)},vt.prototype.readFloatBE=function(t,e){return e||Lt(t,4,this.length),ct(this,t,!1,23,4)},vt.prototype.readDoubleLE=function(t,e){return e||Lt(t,8,this.length),ct(this,t,!0,52,8)},vt.prototype.readDoubleBE=function(t,e){return e||Lt(t,8,this.length),ct(this,t,!1,52,8)},vt.prototype.writeUIntLE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||Mt(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,s=0;for(this[e]=255&t;++s<i&&(r*=256);)this[e+s]=t/r&255;return e+i},vt.prototype.writeUIntBE=function(t,e,i,n){(t=+t,e|=0,i|=0,n)||Mt(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+i},vt.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,1,255,0),vt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},vt.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,2,65535,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Kt(this,t,e,!0),e+2},vt.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,2,65535,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Kt(this,t,e,!1),e+2},vt.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,4,4294967295,0),vt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ut(this,t,e,!0),e+4},vt.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,4,4294967295,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ut(this,t,e,!1),e+4},vt.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);Mt(this,t,e,i,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<i&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+i},vt.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);Mt(this,t,e,i,r-1,-r)}var s=i-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+i},vt.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,1,127,-128),vt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},vt.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,2,32767,-32768),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Kt(this,t,e,!0),e+2},vt.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,2,32767,-32768),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Kt(this,t,e,!1),e+2},vt.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,4,2147483647,-2147483648),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ut(this,t,e,!0),e+4},vt.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||Mt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ut(this,t,e,!1),e+4},vt.prototype.writeFloatLE=function(t,e,i){return $t(this,t,e,!0,i)},vt.prototype.writeFloatBE=function(t,e,i){return $t(this,t,e,!1,i)},vt.prototype.writeDoubleLE=function(t,e,i){return zt(this,t,e,!0,i)},vt.prototype.writeDoubleBE=function(t,e,i){return zt(this,t,e,!1,i)},vt.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,s=n-i;if(this===t&&i<e&&e<n)for(r=s-1;r>=0;--r)t[r+e]=this[r+i];else if(s<1e3||!vt.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+s),e);return s},vt.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!vt.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var s;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(s=e;s<i;++s)this[s]=t;else{var o=xt(t)?t:Wt(new vt(t,n).toString()),a=o.length;for(s=0;s<i-e;++s)this[s+e]=o[s%a]}return this};var Gt=/[^+\/0-9A-Za-z-_]/g;function Jt(t){return t<16?"0"+t.toString(16):t.toString(16)}function Wt(t,e){var i;e=e||1/0;for(var n=t.length,r=null,s=[],o=0;o<n;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&s.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&s.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;s.push(i)}else if(i<2048){if((e-=2)<0)break;s.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;s.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return s}function Yt(t){return function(t){var e,i,n,r,s,o;ot||at();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new st(3*a/4-s),n=s>0?a-4:a;var u=0;for(e=0,i=0;e<n;e+=4,i+=3)r=rt[t.charCodeAt(e)]<<18|rt[t.charCodeAt(e+1)]<<12|rt[t.charCodeAt(e+2)]<<6|rt[t.charCodeAt(e+3)],o[u++]=r>>16&255,o[u++]=r>>8&255,o[u++]=255&r;return 2===s?(r=rt[t.charCodeAt(e)]<<2|rt[t.charCodeAt(e+1)]>>4,o[u++]=255&r):1===s&&(r=rt[t.charCodeAt(e)]<<10|rt[t.charCodeAt(e+1)]<<4|rt[t.charCodeAt(e+2)]>>2,o[u++]=r>>8&255,o[u++]=255&r),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Gt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Xt(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}function Zt(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Qt={userAgent:!1},te={};if(void 0===ee)var ee={};ee.lang={extend:function(t,e,i){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var n=function(){};if(n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),i){var r;for(r in i)t.prototype[r]=i[r];var s=function(){},o=["toString","valueOf"];try{/MSIE/.test(Qt.userAgent)&&(s=function(t,e){for(r=0;r<o.length;r+=1){var i=o[r],n=e[i];"function"==typeof n&&n!=Object.prototype[i]&&(t[i]=n)}})}catch(t){}s(t.prototype,i)}}};var ie,ne,re,se,oe=oe||function(t,e){var i={},n=i.lib={},r=n.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var i=new t;return e&&i.mixIn(e),i.hasOwnProperty("init")||(i.init=function(){i.$super.init.apply(this,arguments)}),i.init.prototype=i,i.$super=this,i},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=n.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,i=t.words,n=this.sigBytes,r=t.sigBytes;if(this.clamp(),n%4)for(var s=0;s<r;s++){var o=i[s>>>2]>>>24-s%4*8&255;e[n+s>>>2]|=o<<24-(n+s)%4*8}else for(s=0;s<r;s+=4)e[n+s>>>2]=i[s>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,i=this.sigBytes;e[i>>>2]&=4294967295<<32-i%4*8,e.length=t.ceil(i/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var i=[],n=0;n<e;n+=4)i.push(4294967296*t.random()|0);return new s.init(i,e)}}),o=i.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var s=e[r>>>2]>>>24-r%4*8&255;n.push((s>>>4).toString(16)),n.push((15&s).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n+=2)i[n>>>3]|=parseInt(t.substr(n,2),16)<<24-n%8*4;return new s.init(i,e/2)}},u=o.Latin1={stringify:function(t){for(var e=t.words,i=t.sigBytes,n=[],r=0;r<i;r++){var s=e[r>>>2]>>>24-r%4*8&255;n.push(String.fromCharCode(s))}return n.join("")},parse:function(t){for(var e=t.length,i=[],n=0;n<e;n++)i[n>>>2]|=(255&t.charCodeAt(n))<<24-n%4*8;return new s.init(i,e)}},h=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},c=n.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var i=this._data,n=i.words,r=i.sigBytes,o=this.blockSize,a=r/(4*o),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,h=t.min(4*u,r);if(u){for(var c=0;c<u;c+=o)this._doProcessBlock(n,c);var f=n.splice(0,u);i.sigBytes-=h}return new s.init(f,h)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(n.Hasher=c.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,i){return new t.init(i).finalize(e)}},_createHmacHelper:function(t){return function(e,i){return new f.HMAC.init(t,i).finalize(e)}}}),i.algo={});return i}(Math);!function(t){var e,i=(e=oe).lib,n=i.Base,r=i.WordArray;(e=e.x64={}).Word=n.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=n.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,i=[],n=0;n<e;n++){var s=t[n];i.push(s.high),i.push(s.low)}return r.create(i,this.sigBytes)},clone:function(){for(var t=n.clone.call(this),e=t.words=this.words.slice(0),i=e.length,r=0;r<i;r++)e[r]=e[r].clone();return t}})}(),oe.lib.Cipher||function(t){var e=(d=oe).lib,i=e.Base,n=e.WordArray,r=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=r.extend({cfg:i.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,i){this.cfg=this.cfg.extend(i),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,i,n){return("string"==typeof i?p:l).encrypt(t,e,i,n)},decrypt:function(e,i,n){return("string"==typeof i?p:l).decrypt(t,e,i,n)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=d.mode={},h=function(t,e,i){var n=this._iv;n?this._iv=void 0:n=this._prevBlock;for(var r=0;r<i;r++)t[e+r]^=n[r]},c=(e.BlockCipherMode=i.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();c.Encryptor=c.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize;h.call(this,t,e,n),i.encryptBlock(t,e),this._prevBlock=t.slice(e,e+n)}}),c.Decryptor=c.extend({processBlock:function(t,e){var i=this._cipher,n=i.blockSize,r=t.slice(e,e+n);i.decryptBlock(t,e),h.call(this,t,e,n),this._prevBlock=r}}),u=u.CBC=c,c=(d.pad={}).Pkcs7={pad:function(t,e){for(var i,r=(i=(i=4*e)-t.sigBytes%i)<<24|i<<16|i<<8|i,s=[],o=0;o<i;o+=4)s.push(r);i=n.create(s,i),t.concat(i)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:c}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var i=e.createEncryptor;else i=e.createDecryptor,this._minBufferSize=1;this._mode=i.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=e.CipherParams=i.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(u=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?n.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var i=n.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:i})}},e.SerializableCipher=i.extend({cfg:i.extend({format:u}),encrypt:function(t,e,i,n){n=this.cfg.extend(n);var r=t.createEncryptor(i,n);return e=r.finalize(e),r=r.cfg,f.create({ciphertext:e,key:i,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:n.format})},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),t.createDecryptor(i,n).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,i,r){return r||(r=n.random(8)),t=o.create({keySize:e+i}).compute(t,r),i=n.create(t.words.slice(e),4*i),t.sigBytes=4*e,f.create({key:t,iv:i,salt:r})}},p=e.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:d}),encrypt:function(t,e,i,n){return i=(n=this.cfg.extend(n)).kdf.execute(i,t.keySize,t.ivSize),n.iv=i.iv,(t=l.encrypt.call(this,t,e,i.key,n)).mixIn(i),t},decrypt:function(t,e,i,n){return n=this.cfg.extend(n),e=this._parse(e,n.format),i=n.kdf.execute(i,t.keySize,t.ivSize,e.salt),n.iv=i.iv,l.decrypt.call(this,t,e,i.key,n)}})}(),function(){for(var t=oe,e=t.lib.BlockCipher,i=t.algo,n=[],r=[],s=[],o=[],a=[],u=[],h=[],c=[],f=[],l=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;var g=0,v=0;for(p=0;256>p;p++){var y=(y=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&y^99;n[g]=y,r[y]=g;var m=d[g],b=d[m],S=d[b],w=257*d[y]^16843008*y;s[g]=w<<24|w>>>8,o[g]=w<<16|w>>>16,a[g]=w<<8|w>>>24,u[g]=w,w=16843009*S^65537*b^257*m^16843008*g,h[y]=w<<24|w>>>8,c[y]=w<<16|w>>>16,f[y]=w<<8|w>>>24,l[y]=w,g?(g=m^d[d[d[S^m]]],v^=d[d[v]]):g=v=1}var x=[0,1,2,4,8,16,32,64,128,27,54];i=i.AES=e.extend({_doReset:function(){for(var t=(i=this._key).words,e=i.sigBytes/4,i=4*((this._nRounds=e+6)+1),r=this._keySchedule=[],s=0;s<i;s++)if(s<e)r[s]=t[s];else{var o=r[s-1];s%e?6<e&&4==s%e&&(o=n[o>>>24]<<24|n[o>>>16&255]<<16|n[o>>>8&255]<<8|n[255&o]):(o=n[(o=o<<8|o>>>24)>>>24]<<24|n[o>>>16&255]<<16|n[o>>>8&255]<<8|n[255&o],o^=x[s/e|0]<<24),r[s]=r[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<i;e++)s=i-e,o=e%4?r[s]:r[s-4],t[e]=4>e||4>=s?o:h[n[o>>>24]]^c[n[o>>>16&255]]^f[n[o>>>8&255]]^l[n[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,u,n)},decryptBlock:function(t,e){var i=t[e+1];t[e+1]=t[e+3],t[e+3]=i,this._doCryptBlock(t,e,this._invKeySchedule,h,c,f,l,r),i=t[e+1],t[e+1]=t[e+3],t[e+3]=i},_doCryptBlock:function(t,e,i,n,r,s,o,a){for(var u=this._nRounds,h=t[e]^i[0],c=t[e+1]^i[1],f=t[e+2]^i[2],l=t[e+3]^i[3],d=4,p=1;p<u;p++){var g=n[h>>>24]^r[c>>>16&255]^s[f>>>8&255]^o[255&l]^i[d++],v=n[c>>>24]^r[f>>>16&255]^s[l>>>8&255]^o[255&h]^i[d++],y=n[f>>>24]^r[l>>>16&255]^s[h>>>8&255]^o[255&c]^i[d++];l=n[l>>>24]^r[h>>>16&255]^s[c>>>8&255]^o[255&f]^i[d++],h=g,c=v,f=y}g=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^i[d++],v=(a[c>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^i[d++],y=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^i[d++],l=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&f])^i[d++],t[e]=g,t[e+1]=v,t[e+2]=y,t[e+3]=l},keySize:8});t.AES=e._createHelper(i)}(),function(){function t(t,e){var i=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=i,this._lBlock^=i<<t}function e(t,e){var i=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=i,this._rBlock^=i<<t}var i=oe,n=(r=i.lib).WordArray,r=r.BlockCipher,s=i.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=r.extend({_doReset:function(){for(var t=this._key.words,e=[],i=0;56>i;i++){var n=o[i]-1;e[i]=t[n>>>5]>>>31-n%32&1}for(t=this._subKeys=[],n=0;16>n;n++){var r=t[n]=[],s=u[n];for(i=0;24>i;i++)r[i/6|0]|=e[(a[i]-1+s)%28]<<31-i%6,r[4+(i/6|0)]|=e[28+(a[i+24]-1+s)%28]<<31-i%6;for(r[0]=r[0]<<1|r[0]>>>31,i=1;7>i;i++)r[i]>>>=4*(i-1)+3;r[7]=r[7]<<5|r[7]>>>27}for(e=this._invSubKeys=[],i=0;16>i;i++)e[i]=t[15-i]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(i,n,r){this._lBlock=i[n],this._rBlock=i[n+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;16>s;s++){for(var o=r[s],a=this._lBlock,u=this._rBlock,f=0,l=0;8>l;l++)f|=h[l][((u^o[l])&c[l])>>>0];this._lBlock=u,this._rBlock=a^f}r=this._lBlock,this._lBlock=this._rBlock,this._rBlock=r,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),i[n]=this._lBlock,i[n+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});i.DES=r._createHelper(f),s=s.TripleDES=r.extend({_doReset:function(){var t=this._key.words;this._des1=f.createEncryptor(n.create(t.slice(0,2))),this._des2=f.createEncryptor(n.create(t.slice(2,4))),this._des3=f.createEncryptor(n.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),i.TripleDES=r._createHelper(s)}(),function(){var t=oe,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,i=t.sigBytes,n=this._map;t.clamp(),t=[];for(var r=0;r<i;r+=3)for(var s=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<i;o++)t.push(n.charAt(s>>>6*(3-o)&63));if(e=n.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var i=t.length,n=this._map;(r=n.charAt(64))&&(-1!=(r=t.indexOf(r))&&(i=r));for(var r=[],s=0,o=0;o<i;o++)if(o%4){var a=n.indexOf(t.charAt(o-1))<<o%4*2,u=n.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|u)<<24-s%4*8,s++}return e.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,i,n,r,s,o){return((t=t+(e&i|~e&n)+r+o)<<s|t>>>32-s)+e}function i(t,e,i,n,r,s,o){return((t=t+(e&n|i&~n)+r+o)<<s|t>>>32-s)+e}function n(t,e,i,n,r,s,o){return((t=t+(e^i^n)+r+o)<<s|t>>>32-s)+e}function r(t,e,i,n,r,s,o){return((t=t+(i^(e|~n))+r+o)<<s|t>>>32-s)+e}for(var s=oe,o=(u=s.lib).WordArray,a=u.Hasher,u=s.algo,h=[],c=0;64>c;c++)h[c]=4294967296*t.abs(t.sin(c+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[u=s+o];t[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var u=t[s+0],c=(a=t[s+1],t[s+2]),f=t[s+3],l=t[s+4],d=t[s+5],p=t[s+6],g=t[s+7],v=t[s+8],y=t[s+9],m=t[s+10],b=t[s+11],S=t[s+12],w=t[s+13],x=t[s+14],F=t[s+15],E=e(E=o[0],C=o[1],D=o[2],A=o[3],u,7,h[0]),A=e(A,E,C,D,a,12,h[1]),D=e(D,A,E,C,c,17,h[2]),C=e(C,D,A,E,f,22,h[3]);E=e(E,C,D,A,l,7,h[4]),A=e(A,E,C,D,d,12,h[5]),D=e(D,A,E,C,p,17,h[6]),C=e(C,D,A,E,g,22,h[7]),E=e(E,C,D,A,v,7,h[8]),A=e(A,E,C,D,y,12,h[9]),D=e(D,A,E,C,m,17,h[10]),C=e(C,D,A,E,b,22,h[11]),E=e(E,C,D,A,S,7,h[12]),A=e(A,E,C,D,w,12,h[13]),D=e(D,A,E,C,x,17,h[14]),E=i(E,C=e(C,D,A,E,F,22,h[15]),D,A,a,5,h[16]),A=i(A,E,C,D,p,9,h[17]),D=i(D,A,E,C,b,14,h[18]),C=i(C,D,A,E,u,20,h[19]),E=i(E,C,D,A,d,5,h[20]),A=i(A,E,C,D,m,9,h[21]),D=i(D,A,E,C,F,14,h[22]),C=i(C,D,A,E,l,20,h[23]),E=i(E,C,D,A,y,5,h[24]),A=i(A,E,C,D,x,9,h[25]),D=i(D,A,E,C,f,14,h[26]),C=i(C,D,A,E,v,20,h[27]),E=i(E,C,D,A,w,5,h[28]),A=i(A,E,C,D,c,9,h[29]),D=i(D,A,E,C,g,14,h[30]),E=n(E,C=i(C,D,A,E,S,20,h[31]),D,A,d,4,h[32]),A=n(A,E,C,D,v,11,h[33]),D=n(D,A,E,C,b,16,h[34]),C=n(C,D,A,E,x,23,h[35]),E=n(E,C,D,A,a,4,h[36]),A=n(A,E,C,D,l,11,h[37]),D=n(D,A,E,C,g,16,h[38]),C=n(C,D,A,E,m,23,h[39]),E=n(E,C,D,A,w,4,h[40]),A=n(A,E,C,D,u,11,h[41]),D=n(D,A,E,C,f,16,h[42]),C=n(C,D,A,E,p,23,h[43]),E=n(E,C,D,A,y,4,h[44]),A=n(A,E,C,D,S,11,h[45]),D=n(D,A,E,C,F,16,h[46]),E=r(E,C=n(C,D,A,E,c,23,h[47]),D,A,u,6,h[48]),A=r(A,E,C,D,g,10,h[49]),D=r(D,A,E,C,x,15,h[50]),C=r(C,D,A,E,d,21,h[51]),E=r(E,C,D,A,S,6,h[52]),A=r(A,E,C,D,f,10,h[53]),D=r(D,A,E,C,m,15,h[54]),C=r(C,D,A,E,a,21,h[55]),E=r(E,C,D,A,v,6,h[56]),A=r(A,E,C,D,F,10,h[57]),D=r(D,A,E,C,p,15,h[58]),C=r(C,D,A,E,w,21,h[59]),E=r(E,C,D,A,l,6,h[60]),A=r(A,E,C,D,b,10,h[61]),D=r(D,A,E,C,c,15,h[62]),C=r(C,D,A,E,y,21,h[63]);o[0]=o[0]+E|0,o[1]=o[1]+C|0,o[2]=o[2]+D|0,o[3]=o[3]+A|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;i[r>>>5]|=128<<24-r%32;var s=t.floor(n/4294967296);for(i[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),i[14+(r+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(i.length+1),this._process(),i=(e=this._hash).words,n=0;4>n;n++)r=i[n],i[n]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(u),s.HmacMD5=a._createHmacHelper(u)}(Math),function(){var t=oe,e=(r=t.lib).WordArray,i=r.Hasher,n=[],r=t.algo.SHA1=i.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=this._hash.words,r=i[0],s=i[1],o=i[2],a=i[3],u=i[4],h=0;80>h;h++){if(16>h)n[h]=0|t[e+h];else{var c=n[h-3]^n[h-8]^n[h-14]^n[h-16];n[h]=c<<1|c>>>31}c=(r<<5|r>>>27)+u+n[h],c=20>h?c+(1518500249+(s&o|~s&a)):40>h?c+(1859775393+(s^o^a)):60>h?c+((s&o|s&a|o&a)-1894007588):c+((s^o^a)-899497514),u=a,a=o,o=s<<30|s>>>2,s=r,r=c}i[0]=i[0]+r|0,i[1]=i[1]+s|0,i[2]=i[2]+o|0,i[3]=i[3]+a|0,i[4]=i[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=Math.floor(i/4294967296),e[15+(n+64>>>9<<4)]=i,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=i._createHelper(r),t.HmacSHA1=i._createHmacHelper(r)}(),function(t){for(var e=oe,i=(r=e.lib).WordArray,n=r.Hasher,r=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},u=2,h=0;64>h;){var c;t:{c=u;for(var f=t.sqrt(c),l=2;l<=f;l++)if(!(c%l)){c=!1;break t}c=!0}c&&(8>h&&(s[h]=a(t.pow(u,.5))),o[h]=a(t.pow(u,1/3)),h++),u++}var d=[];r=r.SHA256=n.extend({_doReset:function(){this._hash=new i.init(s.slice(0))},_doProcessBlock:function(t,e){for(var i=this._hash.words,n=i[0],r=i[1],s=i[2],a=i[3],u=i[4],h=i[5],c=i[6],f=i[7],l=0;64>l;l++){if(16>l)d[l]=0|t[e+l];else{var p=d[l-15],g=d[l-2];d[l]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[l-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[l-16]}p=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&h^~u&c)+o[l]+d[l],g=((n<<30|n>>>2)^(n<<19|n>>>13)^(n<<10|n>>>22))+(n&r^n&s^r&s),f=c,c=h,h=u,u=a+p|0,a=s,s=r,r=n,n=p+g|0}i[0]=i[0]+n|0,i[1]=i[1]+r|0,i[2]=i[2]+s|0,i[3]=i[3]+a|0,i[4]=i[4]+u|0,i[5]=i[5]+h|0,i[6]=i[6]+c|0,i[7]=i[7]+f|0},_doFinalize:function(){var e=this._data,i=e.words,n=8*this._nDataBytes,r=8*e.sigBytes;return i[r>>>5]|=128<<24-r%32,i[14+(r+64>>>9<<4)]=t.floor(n/4294967296),i[15+(r+64>>>9<<4)]=n,e.sigBytes=4*i.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=n._createHelper(r),e.HmacSHA256=n._createHmacHelper(r)}(Math),ne=(ie=oe).lib.WordArray,re=(se=ie.algo).SHA256,se=se.SHA224=re.extend({_doReset:function(){this._hash=new ne.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=re._doFinalize.call(this);return t.sigBytes-=4,t}}),ie.SHA224=re._createHelper(se),ie.HmacSHA224=re._createHmacHelper(se),function(){function t(){return n.create.apply(n,arguments)}for(var e=oe,i=e.lib.Hasher,n=(s=e.x64).Word,r=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=t();s=s.SHA512=i.extend({_doReset:function(){this._hash=new r.init([new n.init(1779033703,4089235720),new n.init(3144134277,2227873595),new n.init(1013904242,4271175723),new n.init(2773480762,1595750129),new n.init(1359893119,2917565137),new n.init(2600822924,725511199),new n.init(528734635,4215389547),new n.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var i=(f=this._hash.words)[0],n=f[1],r=f[2],s=f[3],u=f[4],h=f[5],c=f[6],f=f[7],l=i.high,d=i.low,p=n.high,g=n.low,v=r.high,y=r.low,m=s.high,b=s.low,S=u.high,w=u.low,x=h.high,F=h.low,E=c.high,A=c.low,D=f.high,C=f.low,I=l,T=d,P=p,j=g,H=v,_=y,R=m,k=b,B=S,N=w,O=x,V=F,L=E,M=A,K=D,U=C,q=0;80>q;q++){var $=a[q];if(16>q)var z=$.high=0|t[e+2*q],G=$.low=0|t[e+2*q+1];else{z=((G=(z=a[q-15]).high)>>>1|(J=z.low)<<31)^(G>>>8|J<<24)^G>>>7;var J=(J>>>1|G<<31)^(J>>>8|G<<24)^(J>>>7|G<<25),W=((G=(W=a[q-2]).high)>>>19|(Y=W.low)<<13)^(G<<3|Y>>>29)^G>>>6,Y=(Y>>>19|G<<13)^(Y<<3|G>>>29)^(Y>>>6|G<<26),X=(G=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low;z=(z=(z=z+X+((G=J+G.low)>>>0<J>>>0?1:0))+W+((G=G+Y)>>>0<Y>>>0?1:0))+Z+((G=G+Q)>>>0<Q>>>0?1:0);$.high=z,$.low=G}X=B&O^~B&L,Q=N&V^~N&M,$=I&P^I&H^P&H;var tt=T&j^T&_^j&_,et=(J=(I>>>28|T<<4)^(I<<30|T>>>2)^(I<<25|T>>>7),W=(T>>>28|I<<4)^(T<<30|I>>>2)^(T<<25|I>>>7),(Y=o[q]).high),it=Y.low;Z=K+((B>>>14|N<<18)^(B>>>18|N<<14)^(B<<23|N>>>9))+((Y=U+((N>>>14|B<<18)^(N>>>18|B<<14)^(N<<23|B>>>9)))>>>0<U>>>0?1:0),K=L,U=M,L=O,M=V,O=B,V=N,B=R+(Z=(Z=(Z=Z+X+((Y=Y+Q)>>>0<Q>>>0?1:0))+et+((Y=Y+it)>>>0<it>>>0?1:0))+z+((Y=Y+G)>>>0<G>>>0?1:0))+((N=k+Y|0)>>>0<k>>>0?1:0)|0,R=H,k=_,H=P,_=j,P=I,j=T,I=Z+($=J+$+((G=W+tt)>>>0<W>>>0?1:0))+((T=Y+G|0)>>>0<Y>>>0?1:0)|0}d=i.low=d+T,i.high=l+I+(d>>>0<T>>>0?1:0),g=n.low=g+j,n.high=p+P+(g>>>0<j>>>0?1:0),y=r.low=y+_,r.high=v+H+(y>>>0<_>>>0?1:0),b=s.low=b+k,s.high=m+R+(b>>>0<k>>>0?1:0),w=u.low=w+N,u.high=S+B+(w>>>0<N>>>0?1:0),F=h.low=F+V,h.high=x+O+(F>>>0<V>>>0?1:0),A=c.low=A+M,c.high=E+L+(A>>>0<M>>>0?1:0),C=f.low=C+U,f.high=D+K+(C>>>0<U>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;return e[n>>>5]|=128<<24-n%32,e[30+(n+128>>>10<<5)]=Math.floor(i/4294967296),e[31+(n+128>>>10<<5)]=i,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=i._createHelper(s),e.HmacSHA512=i._createHmacHelper(s)}(),function(){var t=oe,e=(r=t.x64).Word,i=r.WordArray,n=(r=t.algo).SHA512,r=r.SHA384=n.extend({_doReset:function(){this._hash=new i.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=n._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=n._createHelper(r),t.HmacSHA384=n._createHmacHelper(r)}(),function(){var t=oe,e=(n=t.lib).WordArray,i=n.Hasher,n=t.algo,r=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=e.create([0,1518500249,1859775393,2400959708,2840853838]),h=e.create([1352829926,1548603684,1836072691,2053994217,0]);n=n.RIPEMD160=i.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var i=0;16>i;i++){var n=t[S=e+i];t[S]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8)}var c,f,l,d,p,g,v,y,m,b,S=this._hash.words,w=(n=u.words,h.words),x=r.words,F=s.words,E=o.words,A=a.words;g=c=S[0],v=f=S[1],y=l=S[2],m=d=S[3],b=p=S[4];var D;for(i=0;80>i;i+=1)D=c+t[e+x[i]]|0,D=16>i?D+((f^l^d)+n[0]):32>i?D+((f&l|~f&d)+n[1]):48>i?D+(((f|~l)^d)+n[2]):64>i?D+((f&d|l&~d)+n[3]):D+((f^(l|~d))+n[4]),D=(D=(D|=0)<<E[i]|D>>>32-E[i])+p|0,c=p,p=d,d=l<<10|l>>>22,l=f,f=D,D=g+t[e+F[i]]|0,D=16>i?D+((v^(y|~m))+w[0]):32>i?D+((v&m|y&~m)+w[1]):48>i?D+(((v|~y)^m)+w[2]):64>i?D+((v&y|~v&m)+w[3]):D+((v^y^m)+w[4]),D=(D=(D|=0)<<A[i]|D>>>32-A[i])+b|0,g=b,b=m,m=y<<10|y>>>22,y=v,v=D;D=S[1]+l+m|0,S[1]=S[2]+d+b|0,S[2]=S[3]+p+g|0,S[3]=S[4]+c+v|0,S[4]=S[0]+f+y|0,S[0]=D},_doFinalize:function(){var t=this._data,e=t.words,i=8*this._nDataBytes,n=8*t.sigBytes;for(e[n>>>5]|=128<<24-n%32,e[14+(n+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,i=0;5>i;i++)n=e[i],e[i]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8);return t},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});t.RIPEMD160=i._createHelper(n),t.HmacRIPEMD160=i._createHmacHelper(n)}(Math),function(){var t=oe,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,i){t=this._hasher=new t.init,"string"==typeof i&&(i=e.parse(i));var n=t.blockSize,r=4*n;i.sigBytes>r&&(i=t.finalize(i)),i.clamp();for(var s=this._oKey=i.clone(),o=this._iKey=i.clone(),a=s.words,u=o.words,h=0;h<n;h++)a[h]^=1549556828,u[h]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t,e=oe,i=(t=e.lib).Base,n=t.WordArray,r=(t=e.algo).HMAC,s=t.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){var i=this.cfg,s=r.create(i.hasher,t),o=n.create(),a=n.create([1]),u=o.words,h=a.words,c=i.keySize;for(i=i.iterations;u.length<c;){var f=s.update(e).finalize(a);s.reset();for(var l=f.words,d=l.length,p=f,g=1;g<i;g++){p=s.finalize(p),s.reset();for(var v=p.words,y=0;y<d;y++)l[y]^=v[y]}o.concat(f),h[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(t,e,i){return s.create(i).compute(t,e)}}();var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ue="=";function he(t){var e,i,n="";for(e=0;e+3<=t.length;e+=3)i=parseInt(t.substring(e,e+3),16),n+=ae.charAt(i>>6)+ae.charAt(63&i);for(e+1==t.length?(i=parseInt(t.substring(e,e+1),16),n+=ae.charAt(i<<2)):e+2==t.length&&(i=parseInt(t.substring(e,e+2),16),n+=ae.charAt(i>>2)+ae.charAt((3&i)<<4));(3&n.length)>0;)n+=ue;return n}function ce(t){var e,i,n,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=ue;++e)(n=ae.indexOf(t.charAt(e)))<0||(0==s?(r+=ye(n>>2),i=3&n,s=1):1==s?(r+=ye(i<<2|n>>4),i=15&n,s=2):2==s?(r+=ye(i),r+=ye(n>>2),i=3&n,s=3):(r+=ye(i<<2|n>>4),r+=ye(15&n),s=0));return 1==s&&(r+=ye(i<<2)),r}function fe(t,e,i){null!=t&&("number"==typeof t?this.fromNumber(t,e,i):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function le(){return new fe(null)}fe.prototype.am=function(t,e,i,n,r,s){for(;--s>=0;){var o=e*this[t++]+i[n]+r;r=Math.floor(o/67108864),i[n++]=67108863&o}return r},fe.prototype.DB=26,fe.prototype.DM=67108863,fe.prototype.DV=1<<26;fe.prototype.FV=Math.pow(2,52),fe.prototype.F1=26,fe.prototype.F2=0;var de,pe,ge="0123456789abcdefghijklmnopqrstuvwxyz",ve=new Array;for(de="0".charCodeAt(0),pe=0;pe<=9;++pe)ve[de++]=pe;for(de="a".charCodeAt(0),pe=10;pe<36;++pe)ve[de++]=pe;for(de="A".charCodeAt(0),pe=10;pe<36;++pe)ve[de++]=pe;function ye(t){return ge.charAt(t)}function me(t,e){var i=ve[t.charCodeAt(e)];return null==i?-1:i}function be(t){var e=le();return e.fromInt(t),e}function Se(t){var e,i=1;return 0!=(e=t>>>16)&&(t=e,i+=16),0!=(e=t>>8)&&(t=e,i+=8),0!=(e=t>>4)&&(t=e,i+=4),0!=(e=t>>2)&&(t=e,i+=2),0!=(e=t>>1)&&(t=e,i+=1),i}function we(t){this.m=t}function xe(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Fe(t,e){return t&e}function Ee(t,e){return t|e}function Ae(t,e){return t^e}function De(t,e){return t&~e}function Ce(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Ie(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Te(){}function Pe(t){return t}function je(t){this.r2=le(),this.q3=le(),fe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}we.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},we.prototype.revert=function(t){return t},we.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},we.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},we.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},xe.prototype.convert=function(t){var e=le();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(fe.ZERO)>0&&this.m.subTo(e,e),e},xe.prototype.revert=function(t){var e=le();return t.copyTo(e),this.reduce(e),e},xe.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var i=32767&t[e],n=i*this.mpl+((i*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[i=e+this.m.t]+=this.m.am(0,n,t,e,0,this.m.t);t[i]>=t.DV;)t[i]-=t.DV,t[++i]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},xe.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},xe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},fe.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},fe.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},fe.prototype.fromString=function(t,e){var i;if(16==e)i=4;else if(8==e)i=3;else if(256==e)i=8;else if(2==e)i=1;else if(32==e)i=5;else{if(4!=e)return void this.fromRadix(t,e);i=2}this.t=0,this.s=0;for(var n=t.length,r=!1,s=0;--n>=0;){var o=8==i?255&t[n]:me(t,n);o<0?"-"==t.charAt(n)&&(r=!0):(r=!1,0==s?this[this.t++]=o:s+i>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&fe.ZERO.subTo(this,this)},fe.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},fe.prototype.dlShiftTo=function(t,e){var i;for(i=this.t-1;i>=0;--i)e[i+t]=this[i];for(i=t-1;i>=0;--i)e[i]=0;e.t=this.t+t,e.s=this.s},fe.prototype.drShiftTo=function(t,e){for(var i=t;i<this.t;++i)e[i-t]=this[i];e.t=Math.max(this.t-t,0),e.s=this.s},fe.prototype.lShiftTo=function(t,e){var i,n=t%this.DB,r=this.DB-n,s=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<n&this.DM;for(i=this.t-1;i>=0;--i)e[i+o+1]=this[i]>>r|a,a=(this[i]&s)<<n;for(i=o-1;i>=0;--i)e[i]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},fe.prototype.rShiftTo=function(t,e){e.s=this.s;var i=Math.floor(t/this.DB);if(i>=this.t)e.t=0;else{var n=t%this.DB,r=this.DB-n,s=(1<<n)-1;e[0]=this[i]>>n;for(var o=i+1;o<this.t;++o)e[o-i-1]|=(this[o]&s)<<r,e[o-i]=this[o]>>n;n>0&&(e[this.t-i-1]|=(this.s&s)<<r),e.t=this.t-i,e.clamp()}},fe.prototype.subTo=function(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]-t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n-=t[i],e[i++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e[i++]=this.DV+n:n>0&&(e[i++]=n),e.t=i,e.clamp()},fe.prototype.multiplyTo=function(t,e){var i=this.abs(),n=t.abs(),r=i.t;for(e.t=r+n.t;--r>=0;)e[r]=0;for(r=0;r<n.t;++r)e[r+i.t]=i.am(0,n[r],e,r,0,i.t);e.s=0,e.clamp(),this.s!=t.s&&fe.ZERO.subTo(e,e)},fe.prototype.squareTo=function(t){for(var e=this.abs(),i=t.t=2*e.t;--i>=0;)t[i]=0;for(i=0;i<e.t-1;++i){var n=e.am(i,e[i],t,2*i,0,1);(t[i+e.t]+=e.am(i+1,2*e[i],t,2*i+1,n,e.t-i-1))>=e.DV&&(t[i+e.t]-=e.DV,t[i+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(i,e[i],t,2*i,0,1)),t.s=0,t.clamp()},fe.prototype.divRemTo=function(t,e,i){var n=t.abs();if(!(n.t<=0)){var r=this.abs();if(r.t<n.t)return null!=e&&e.fromInt(0),void(null!=i&&this.copyTo(i));null==i&&(i=le());var s=le(),o=this.s,a=t.s,u=this.DB-Se(n[n.t-1]);u>0?(n.lShiftTo(u,s),r.lShiftTo(u,i)):(n.copyTo(s),r.copyTo(i));var h=s.t,c=s[h-1];if(0!=c){var f=c*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),l=this.FV/f,d=(1<<this.F1)/f,p=1<<this.F2,g=i.t,v=g-h,y=null==e?le():e;for(s.dlShiftTo(v,y),i.compareTo(y)>=0&&(i[i.t++]=1,i.subTo(y,i)),fe.ONE.dlShiftTo(h,y),y.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--v>=0;){var m=i[--g]==c?this.DM:Math.floor(i[g]*l+(i[g-1]+p)*d);if((i[g]+=s.am(0,m,i,v,0,h))<m)for(s.dlShiftTo(v,y),i.subTo(y,i);i[g]<--m;)i.subTo(y,i)}null!=e&&(i.drShiftTo(h,e),o!=a&&fe.ZERO.subTo(e,e)),i.t=h,i.clamp(),u>0&&i.rShiftTo(u,i),o<0&&fe.ZERO.subTo(i,i)}}},fe.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},fe.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},fe.prototype.exp=function(t,e){if(t>4294967295||t<1)return fe.ONE;var i=le(),n=le(),r=e.convert(this),s=Se(t)-1;for(r.copyTo(i);--s>=0;)if(e.sqrTo(i,n),(t&1<<s)>0)e.mulTo(n,r,i);else{var o=i;i=n,n=o}return e.revert(i)},fe.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var i,n=(1<<e)-1,r=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(i=this[o]>>a)>0&&(r=!0,s=ye(i));o>=0;)a<e?(i=(this[o]&(1<<a)-1)<<e-a,i|=this[--o]>>(a+=this.DB-e)):(i=this[o]>>(a-=e)&n,a<=0&&(a+=this.DB,--o)),i>0&&(r=!0),r&&(s+=ye(i));return r?s:"0"},fe.prototype.negate=function(){var t=le();return fe.ZERO.subTo(this,t),t},fe.prototype.abs=function(){return this.s<0?this.negate():this},fe.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var i=this.t;if(0!=(e=i-t.t))return this.s<0?-e:e;for(;--i>=0;)if(0!=(e=this[i]-t[i]))return e;return 0},fe.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Se(this[this.t-1]^this.s&this.DM)},fe.prototype.mod=function(t){var e=le();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(fe.ZERO)>0&&t.subTo(e,e),e},fe.prototype.modPowInt=function(t,e){var i;return i=t<256||e.isEven()?new we(e):new xe(e),this.exp(t,i)},fe.ZERO=be(0),fe.ONE=be(1),Te.prototype.convert=Pe,Te.prototype.revert=Pe,Te.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i)},Te.prototype.sqrTo=function(t,e){t.squareTo(e)},je.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=le();return t.copyTo(e),this.reduce(e),e},je.prototype.revert=function(t){return t},je.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},je.prototype.mulTo=function(t,e,i){t.multiplyTo(e,i),this.reduce(i)},je.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var He=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],_e=(1<<26)/He[He.length-1];function Re(){this.i=0,this.j=0,this.S=new Array}fe.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},fe.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),i=Math.pow(t,e),n=be(i),r=le(),s=le(),o="";for(this.divRemTo(n,r,s);r.signum()>0;)o=(i+s.intValue()).toString(t).substr(1)+o,r.divRemTo(n,r,s);return s.intValue().toString(t)+o},fe.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var i=this.chunkSize(e),n=Math.pow(e,i),r=!1,s=0,o=0,a=0;a<t.length;++a){var u=me(t,a);u<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+u,++s>=i&&(this.dMultiply(n),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&fe.ZERO.subTo(this,this)},fe.prototype.fromNumber=function(t,e,i){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,i),this.testBit(t-1)||this.bitwiseTo(fe.ONE.shiftLeft(t-1),Ee,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(fe.ONE.shiftLeft(t-1),this);else{var n=new Array,r=7&t;n.length=1+(t>>3),e.nextBytes(n),r>0?n[0]&=(1<<r)-1:n[0]=0,this.fromString(n,256)}},fe.prototype.bitwiseTo=function(t,e,i){var n,r,s=Math.min(t.t,this.t);for(n=0;n<s;++n)i[n]=e(this[n],t[n]);if(t.t<this.t){for(r=t.s&this.DM,n=s;n<this.t;++n)i[n]=e(this[n],r);i.t=this.t}else{for(r=this.s&this.DM,n=s;n<t.t;++n)i[n]=e(r,t[n]);i.t=t.t}i.s=e(this.s,t.s),i.clamp()},fe.prototype.changeBit=function(t,e){var i=fe.ONE.shiftLeft(t);return this.bitwiseTo(i,e,i),i},fe.prototype.addTo=function(t,e){for(var i=0,n=0,r=Math.min(t.t,this.t);i<r;)n+=this[i]+t[i],e[i++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;i<this.t;)n+=this[i],e[i++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;i<t.t;)n+=t[i],e[i++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e[i++]=n:n<-1&&(e[i++]=this.DV+n),e.t=i,e.clamp()},fe.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},fe.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},fe.prototype.multiplyLowerTo=function(t,e,i){var n,r=Math.min(this.t+t.t,e);for(i.s=0,i.t=r;r>0;)i[--r]=0;for(n=i.t-this.t;r<n;++r)i[r+this.t]=this.am(0,t[r],i,r,0,this.t);for(n=Math.min(t.t,e);r<n;++r)this.am(0,t[r],i,r,0,e-r);i.clamp()},fe.prototype.multiplyUpperTo=function(t,e,i){--e;var n=i.t=this.t+t.t-e;for(i.s=0;--n>=0;)i[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)i[this.t+n-e]=this.am(e-n,t[n],i,0,0,this.t+n-e);i.clamp(),i.drShiftTo(1,i)},fe.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,i=this.s<0?t-1:0;if(this.t>0)if(0==e)i=this[0]%t;else for(var n=this.t-1;n>=0;--n)i=(e*i+this[n])%t;return i},fe.prototype.millerRabin=function(t){var e=this.subtract(fe.ONE),i=e.getLowestSetBit();if(i<=0)return!1;var n=e.shiftRight(i);(t=t+1>>1)>He.length&&(t=He.length);for(var r=le(),s=0;s<t;++s){r.fromInt(He[Math.floor(Math.random()*He.length)]);var o=r.modPow(n,this);if(0!=o.compareTo(fe.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<i&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(fe.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},fe.prototype.clone=function(){var t=le();return this.copyTo(t),t},fe.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},fe.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},fe.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},fe.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},fe.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var i,n=this.DB-t*this.DB%8,r=0;if(t-- >0)for(n<this.DB&&(i=this[t]>>n)!=(this.s&this.DM)>>n&&(e[r++]=i|this.s<<this.DB-n);t>=0;)n<8?(i=(this[t]&(1<<n)-1)<<8-n,i|=this[--t]>>(n+=this.DB-8)):(i=this[t]>>(n-=8)&255,n<=0&&(n+=this.DB,--t)),0!=(128&i)&&(i|=-256),0==r&&(128&this.s)!=(128&i)&&++r,(r>0||i!=this.s)&&(e[r++]=i);return e},fe.prototype.equals=function(t){return 0==this.compareTo(t)},fe.prototype.min=function(t){return this.compareTo(t)<0?this:t},fe.prototype.max=function(t){return this.compareTo(t)>0?this:t},fe.prototype.and=function(t){var e=le();return this.bitwiseTo(t,Fe,e),e},fe.prototype.or=function(t){var e=le();return this.bitwiseTo(t,Ee,e),e},fe.prototype.xor=function(t){var e=le();return this.bitwiseTo(t,Ae,e),e},fe.prototype.andNot=function(t){var e=le();return this.bitwiseTo(t,De,e),e},fe.prototype.not=function(){for(var t=le(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},fe.prototype.shiftLeft=function(t){var e=le();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},fe.prototype.shiftRight=function(t){var e=le();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},fe.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+Ce(this[t]);return this.s<0?this.t*this.DB:-1},fe.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,i=0;i<this.t;++i)t+=Ie(this[i]^e);return t},fe.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},fe.prototype.setBit=function(t){return this.changeBit(t,Ee)},fe.prototype.clearBit=function(t){return this.changeBit(t,De)},fe.prototype.flipBit=function(t){return this.changeBit(t,Ae)},fe.prototype.add=function(t){var e=le();return this.addTo(t,e),e},fe.prototype.subtract=function(t){var e=le();return this.subTo(t,e),e},fe.prototype.multiply=function(t){var e=le();return this.multiplyTo(t,e),e},fe.prototype.divide=function(t){var e=le();return this.divRemTo(t,e,null),e},fe.prototype.remainder=function(t){var e=le();return this.divRemTo(t,null,e),e},fe.prototype.divideAndRemainder=function(t){var e=le(),i=le();return this.divRemTo(t,e,i),new Array(e,i)},fe.prototype.modPow=function(t,e){var i,n,r=t.bitLength(),s=be(1);if(r<=0)return s;i=r<18?1:r<48?3:r<144?4:r<768?5:6,n=r<8?new we(e):e.isEven()?new je(e):new xe(e);var o=new Array,a=3,u=i-1,h=(1<<i)-1;if(o[1]=n.convert(this),i>1){var c=le();for(n.sqrTo(o[1],c);a<=h;)o[a]=le(),n.mulTo(c,o[a-2],o[a]),a+=2}var f,l,d=t.t-1,p=!0,g=le();for(r=Se(t[d])-1;d>=0;){for(r>=u?f=t[d]>>r-u&h:(f=(t[d]&(1<<r+1)-1)<<u-r,d>0&&(f|=t[d-1]>>this.DB+r-u)),a=i;0==(1&f);)f>>=1,--a;if((r-=a)<0&&(r+=this.DB,--d),p)o[f].copyTo(s),p=!1;else{for(;a>1;)n.sqrTo(s,g),n.sqrTo(g,s),a-=2;a>0?n.sqrTo(s,g):(l=s,s=g,g=l),n.mulTo(g,o[f],s)}for(;d>=0&&0==(t[d]&1<<r);)n.sqrTo(s,g),l=s,s=g,g=l,--r<0&&(r=this.DB-1,--d)}return n.revert(s)},fe.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return fe.ZERO;for(var i=t.clone(),n=this.clone(),r=be(1),s=be(0),o=be(0),a=be(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),e?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);i.compareTo(n)>=0?(i.subTo(n,i),e&&r.subTo(o,r),s.subTo(a,s)):(n.subTo(i,n),e&&o.subTo(r,o),a.subTo(s,a))}return 0!=n.compareTo(fe.ONE)?fe.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},fe.prototype.pow=function(t){return this.exp(t,new Te)},fe.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),i=t.s<0?t.negate():t.clone();if(e.compareTo(i)<0){var n=e;e=i,i=n}var r=e.getLowestSetBit(),s=i.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),i.rShiftTo(s,i));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=i.getLowestSetBit())>0&&i.rShiftTo(r,i),e.compareTo(i)>=0?(e.subTo(i,e),e.rShiftTo(1,e)):(i.subTo(e,i),i.rShiftTo(1,i));return s>0&&i.lShiftTo(s,i),i},fe.prototype.isProbablePrime=function(t){var e,i=this.abs();if(1==i.t&&i[0]<=He[He.length-1]){for(e=0;e<He.length;++e)if(i[0]==He[e])return!0;return!1}if(i.isEven())return!1;for(e=1;e<He.length;){for(var n=He[e],r=e+1;r<He.length&&n<_e;)n*=He[r++];for(n=i.modInt(n);e<r;)if(n%He[e++]==0)return!1}return i.millerRabin(t)},fe.prototype.square=function(){var t=le();return this.squareTo(t),t},Re.prototype.init=function(t){var e,i,n;for(e=0;e<256;++e)this.S[e]=e;for(i=0,e=0;e<256;++e)i=i+this.S[e]+t[e%t.length]&255,n=this.S[e],this.S[e]=this.S[i],this.S[i]=n;this.i=0,this.j=0},Re.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var ke,Be,Ne,Oe=256;function Ve(){var t;t=(new Date).getTime(),Be[Ne++]^=255&t,Be[Ne++]^=t>>8&255,Be[Ne++]^=t>>16&255,Be[Ne++]^=t>>24&255,Ne>=Oe&&(Ne-=Oe)}if(null==Be){var Le;if(Be=new Array,Ne=0,void 0!==te&&void 0!==te.msCrypto){var Me=te.msCrypto;if(Me.getRandomValues){var Ke=new Uint8Array(32);for(Me.getRandomValues(Ke),Le=0;Le<32;++Le)Be[Ne++]=Ke[Le]}}for(;Ne<Oe;)Le=Math.floor(65536*Math.random()),Be[Ne++]=Le>>>8,Be[Ne++]=255&Le;Ne=0,Ve()}function Ue(){if(null==ke){for(Ve(),(ke=new Re).init(Be),Ne=0;Ne<Be.length;++Ne)Be[Ne]=0;Ne=0}return ke.next()}function qe(){}function $e(t,e){return new fe(t,e)}function ze(t,e,i){for(var n="",r=0;n.length<e;)n+=i(String.fromCharCode.apply(String,t.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]))),r+=1;return n}function Ge(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Je(t,e,i){for(var n="",r=0;n.length<e;)n+=i(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])),r+=1;return n}function We(t,e){this.x=e,this.q=t}function Ye(t,e,i,n){this.curve=t,this.x=e,this.y=i,this.z=null==n?fe.ONE:n,this.zinv=null}function Xe(t,e,i){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(i),this.infinity=new Ye(this,null,null)}qe.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=Ue()},Ge.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},Ge.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=$e(t,16),this.e=parseInt(e,16)}},Ge.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var i=new Array,n=t.length-1;n>=0&&e>0;){var r=t.charCodeAt(n--);r<128?i[--e]=r:r>127&&r<2048?(i[--e]=63&r|128,i[--e]=r>>6|192):(i[--e]=63&r|128,i[--e]=r>>6&63|128,i[--e]=r>>12|224)}i[--e]=0;for(var s=new qe,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);i[--e]=o[0]}return i[--e]=2,i[--e]=0,new fe(i)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var i=this.doPublic(e);if(null==i)return null;var n=i.toString(16);return 0==(1&n.length)?n:"0"+n},Ge.prototype.encryptOAEP=function(t,e,i){var n=function(t,e,i,n){var r=Qe.crypto.MessageDigest,s=Qe.crypto.Util,o=null;if(i||(i="sha1"),"string"==typeof i&&(o=r.getCanonicalAlgName(i),n=r.getHashLength(o),i=function(t){return fi(s.hashHex(li(t),o))}),t.length+2*n+2>e)throw"Message too long for RSA";var a,u="";for(a=0;a<e-t.length-2*n-2;a+=1)u+="\0";var h=i("")+u+""+t,c=new Array(n);(new qe).nextBytes(c);var f=ze(c,h.length,i),l=[];for(a=0;a<h.length;a+=1)l[a]=h.charCodeAt(a)^f.charCodeAt(a);var d=ze(l,c.length,i),p=[0];for(a=0;a<c.length;a+=1)p[a+1]=c[a]^d.charCodeAt(a);return new fe(p.concat(l))}(t,this.n.bitLength()+7>>3,e,i);if(null==n)return null;var r=this.doPublic(n);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},Ge.prototype.type="RSA",Ge.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),i=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(i)<0;)e=e.add(this.p);return e.subtract(i).multiply(this.coeff).mod(this.p).multiply(this.q).add(i)},Ge.prototype.setPrivate=function(t,e,i){if(this.isPrivate=!0,"string"!=typeof t)this.n=t,this.e=e,this.d=i;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=$e(t,16),this.e=parseInt(e,16),this.d=$e(i,16)}},Ge.prototype.setPrivateEx=function(t,e,i,n,r,s,o,a){if(this.isPrivate=!0,this.isPublic=!1,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=$e(t,16),this.e=parseInt(e,16),this.d=$e(i,16),this.p=$e(n,16),this.q=$e(r,16),this.dmp1=$e(s,16),this.dmq1=$e(o,16),this.coeff=$e(a,16)},Ge.prototype.generate=function(t,e){var i=new qe,n=t>>1;this.e=parseInt(e,16);for(var r=new fe(e,16);;){for(;this.p=new fe(t-n,1,i),0!=this.p.subtract(fe.ONE).gcd(r).compareTo(fe.ONE)||!this.p.isProbablePrime(10););for(;this.q=new fe(n,1,i),0!=this.q.subtract(fe.ONE).gcd(r).compareTo(fe.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(fe.ONE),a=this.q.subtract(fe.ONE),u=o.multiply(a);if(0==u.gcd(r).compareTo(fe.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(u),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},Ge.prototype.decrypt=function(t){var e=$e(t,16),i=this.doPrivate(e);return null==i?null:function(t,e){for(var i=t.toByteArray(),n=0;n<i.length&&0==i[n];)++n;if(i.length-n!=e-1||2!=i[n])return null;for(++n;0!=i[n];)if(++n>=i.length)return null;for(var r="";++n<i.length;){var s=255&i[n];s<128?r+=String.fromCharCode(s):s>191&&s<224?(r+=String.fromCharCode((31&s)<<6|63&i[n+1]),++n):(r+=String.fromCharCode((15&s)<<12|(63&i[n+1])<<6|63&i[n+2]),n+=2)}return r}(i,this.n.bitLength()+7>>3)},Ge.prototype.decryptOAEP=function(t,e,i){var n=$e(t,16),r=this.doPrivate(n);return null==r?null:function(t,e,i,n){var r=Qe.crypto.MessageDigest,s=Qe.crypto.Util,o=null;for(i||(i="sha1"),"string"==typeof i&&(o=r.getCanonicalAlgName(i),n=r.getHashLength(o),i=function(t){return fi(s.hashHex(li(t),o))}),t=t.toByteArray(),a=0;a<t.length;a+=1)t[a]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*n+2)throw"Cipher too short";var a,u=t.substr(1,n),h=t.substr(n+1),c=Je(h,n,i),f=[];for(a=0;a<u.length;a+=1)f[a]=u.charCodeAt(a)^c.charCodeAt(a);var l=Je(String.fromCharCode.apply(String,f),t.length-n,i),d=[];for(a=0;a<h.length;a+=1)d[a]=h.charCodeAt(a)^l.charCodeAt(a);if((d=String.fromCharCode.apply(String,d)).substr(0,n)!==i(""))throw"Hash mismatch";var p=(d=d.substr(n)).indexOf("");if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}(r,this.n.bitLength()+7>>3,e,i)},We.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},We.prototype.toBigInteger=function(){return this.x},We.prototype.negate=function(){return new We(this.q,this.x.negate().mod(this.q))},We.prototype.add=function(t){return new We(this.q,this.x.add(t.toBigInteger()).mod(this.q))},We.prototype.subtract=function(t){return new We(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},We.prototype.multiply=function(t){return new We(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},We.prototype.square=function(){return new We(this.q,this.x.square().mod(this.q))},We.prototype.divide=function(t){return new We(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},Ye.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ye.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ye.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(fe.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(fe.ZERO))},Ye.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(fe.ZERO)&&!this.y.toBigInteger().equals(fe.ZERO)},Ye.prototype.negate=function(){return new Ye(this.curve,this.x,this.y.negate(),this.z)},Ye.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),i=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(fe.ZERO.equals(i))return fe.ZERO.equals(e)?this.twice():this.curve.getInfinity();var n=new fe("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),i.square()),a=o.multiply(i),u=r.multiply(o),h=e.square().multiply(this.z),c=h.subtract(u.shiftLeft(1)).multiply(t.z).subtract(a).multiply(i).mod(this.curve.q),f=u.multiply(n).multiply(e).subtract(s.multiply(a)).subtract(h.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),l=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new Ye(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(f),l)},Ye.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new fe("3"),e=this.x.toBigInteger(),i=this.y.toBigInteger(),n=i.multiply(this.z),r=n.multiply(i).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);fe.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(n).mod(this.curve.q),u=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),h=n.square().multiply(n).shiftLeft(3).mod(this.curve.q);return new Ye(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),h)},Ye.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,n=i.multiply(new fe("3")),r=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var o=n.testBit(e);o!=i.testBit(e)&&(s=s.add(o?this:r))}return s},Ye.prototype.multiplyTwo=function(t,e,i){var n;n=t.bitLength()>i.bitLength()?t.bitLength()-1:i.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);n>=0;)r=r.twice(),t.testBit(n)?r=i.testBit(n)?r.add(s):r.add(this):i.testBit(n)&&(r=r.add(e)),--n;return r},Xe.prototype.getQ=function(){return this.q},Xe.prototype.getA=function(){return this.a},Xe.prototype.getB=function(){return this.b},Xe.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},Xe.prototype.getInfinity=function(){return this.infinity},Xe.prototype.fromBigInteger=function(t){return new We(this.q,t)},Xe.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,i=t.substr(2,e),n=t.substr(e+2,e);return new Ye(this,this.fromBigInteger(new fe(i,16)),this.fromBigInteger(new fe(n,16)));default:return null}},We.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},Ye.prototype.getEncoded=function(t){var e=function(t,e){var i=t.toByteArrayUnsigned();if(e<i.length)i=i.slice(i.length-e);else for(;e>i.length;)i.unshift(0);return i},i=this.getX().toBigInteger(),n=this.getY().toBigInteger(),r=e(i,32);return t?n.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(n,32))),r},Ye.decodeFrom=function(t,e){e[0];var i=e.length-1,n=e.slice(1,1+i/2),r=e.slice(1+i/2,1+i);n.unshift(0),r.unshift(0);var s=new fe(n),o=new fe(r);return new Ye(t,t.fromBigInteger(s),t.fromBigInteger(o))},Ye.decodeFromHex=function(t,e){e.substr(0,2);var i=e.length-2,n=e.substr(2,i/2),r=e.substr(2+i/2,i/2),s=new fe(n,16),o=new fe(r,16);return new Ye(t,t.fromBigInteger(s),t.fromBigInteger(o))},Ye.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),i=t.y.subtract(this.y).divide(e),n=i.square().subtract(this.x).subtract(t.x),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new Ye(this.curve,n,r)},Ye.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(fe.valueOf(2)),e=this.curve.fromBigInteger(fe.valueOf(3)),i=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),n=i.square().subtract(this.x.multiply(t)),r=i.multiply(this.x.subtract(n)).subtract(this.y);return new Ye(this.curve,n,r)},Ye.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,i=t,n=i.multiply(new fe("3")),r=this.negate(),s=this;for(e=n.bitLength()-2;e>0;--e){s=s.twice();var o=n.testBit(e);o!=i.testBit(e)&&(s=s.add2D(o?this:r))}return s},Ye.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),i=this.curve.getA().toBigInteger(),n=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(i.multiply(t)).add(n).mod(r);return s.equals(o)},Ye.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},Ye.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),i=this.getY().toBigInteger();if(e.compareTo(fe.ONE)<0||e.compareTo(t.subtract(fe.ONE))>0)throw new Error("x coordinate out of bounds");if(i.compareTo(fe.ONE)<0||i.compareTo(t.subtract(fe.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Ze=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),i={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function n(t,e,n){return e?i[e]:String.fromCharCode(parseInt(n,16))}var r=new String(""),s=Object.hasOwnProperty;return function(i,o){var a,u,h=i.match(t),c=h[0],f=!1;"{"===c?a={}:"["===c?a=[]:(a=[],f=!0);for(var l=[a],d=1-f,p=h.length;d<p;++d){var g;switch((c=h[d]).charCodeAt(0)){default:(g=l[0])[u||g.length]=+c,u=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(e,n)),g=l[0],!u){if(!(g instanceof Array)){u=c||r;break}u=g.length}g[u]=c,u=void 0;break;case 91:g=l[0],l.unshift(g[u||g.length]=[]),u=void 0;break;case 93:l.shift();break;case 102:(g=l[0])[u||g.length]=!1,u=void 0;break;case 110:(g=l[0])[u||g.length]=null,u=void 0;break;case 116:(g=l[0])[u||g.length]=!0,u=void 0;break;case 123:g=l[0],l.unshift(g[u||g.length]={}),u=void 0;break;case 125:l.shift()}}if(f){if(1!==l.length)throw new Error;a=a[0]}else if(l.length)throw new Error;if(o){var v=function(t,e){var i=t[e];if(i&&"object"==typeof i){var n=null;for(var r in i)if(s.call(i,r)&&i!==t){var a=v(i,r);void 0!==a?i[r]=a:(n||(n=[]),n.push(r))}if(n)for(var u=n.length;--u>=0;)delete i[n[u]]}return o.call(t,e,i)};a=v({"":a},"")}return a}}();void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),Qe.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var i=e.substr(1).length;i%2==1?i+=1:e.match(/^[0-7]/)||(i+=2);for(var n="",r=0;r<i;r++)n+="f";e=new fe(n,16).xor(t).add(fe.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return pi(t,e)},this.newObject=function(t){var e=Qe.asn1,i=e.DERBoolean,n=e.DERInteger,r=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,u=e.DEREnumerated,h=e.DERUTF8String,c=e.DERNumericString,f=e.DERPrintableString,l=e.DERTeletexString,d=e.DERIA5String,p=e.DERUTCTime,g=e.DERGeneralizedTime,v=e.DERSequence,y=e.DERSet,m=e.DERTaggedObject,b=e.ASN1Util.newObject,S=Object.keys(t);if(1!=S.length)throw"key of param shall be only one.";var w=S[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new i(t[w]);if("int"==w)return new n(t[w]);if("bitstr"==w)return new r(t[w]);if("octstr"==w)return new s(t[w]);if("null"==w)return new o(t[w]);if("oid"==w)return new a(t[w]);if("enum"==w)return new u(t[w]);if("utf8str"==w)return new h(t[w]);if("numstr"==w)return new c(t[w]);if("prnstr"==w)return new f(t[w]);if("telstr"==w)return new l(t[w]);if("ia5str"==w)return new d(t[w]);if("utctime"==w)return new p(t[w]);if("gentime"==w)return new g(t[w]);if("seq"==w){for(var x=t[w],F=[],E=0;E<x.length;E++){var A=b(x[E]);F.push(A)}return new v({array:F})}if("set"==w){for(x=t[w],F=[],E=0;E<x.length;E++){A=b(x[E]);F.push(A)}return new y({array:F})}if("tag"==w){var D=t[w];if("[object Array]"===Object.prototype.toString.call(D)&&3==D.length){var C=b(D[2]);return new m({tag:D[0],explicit:D[1],obj:C})}var I={};if(void 0!==D.explicit&&(I.explicit=D.explicit),void 0!==D.tag&&(I.tag=D.tag),void 0===D.obj)throw"obj shall be specified for 'tag'.";return I.obj=b(D.obj),new m(I)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},Qe.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",i=parseInt(t.substr(0,2),16),n=(e=Math.floor(i/40)+"."+i%40,""),r=2;r<t.length;r+=2){var s=("00000000"+parseInt(t.substr(r,2),16).toString(2)).slice(-8);if(n+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new fe(n,2).toString(10),n=""}return e},Qe.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",n=new fe(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";n=s+n;for(o=0;o<n.length-1;o+=7){var a=n.substr(o,7);o!=n.length-7&&(a="1"+a),i+=e(parseInt(a,2))}return i};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)n+=i(r[o]);return n},Qe.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var i=e.length/2;if(i>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+i).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},Qe.asn1.DERAbstractString=function(t){Qe.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=hi(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},ee.lang.extend(Qe.asn1.DERAbstractString,Qe.asn1.ASN1Object),Qe.asn1.DERAbstractTime=function(t){Qe.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,i){var n=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+n(String(r.getMonth()+1),2)+n(String(r.getDate()),2)+n(String(r.getHours()),2)+n(String(r.getMinutes()),2)+n(String(r.getSeconds()),2);if(!0===i){var a=r.getMilliseconds();if(0!=a){var u=n(String(a),3);o=o+"."+(u=u.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=ri(t)},this.setByDateValue=function(t,e,i,n,r,s){var o=new Date(Date.UTC(t,e-1,i,n,r,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ee.lang.extend(Qe.asn1.DERAbstractTime,Qe.asn1.ASN1Object),Qe.asn1.DERAbstractStructured=function(t){Qe.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},ee.lang.extend(Qe.asn1.DERAbstractStructured,Qe.asn1.ASN1Object),Qe.asn1.DERBoolean=function(){Qe.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ee.lang.extend(Qe.asn1.DERBoolean,Qe.asn1.ASN1Object),Qe.asn1.DERInteger=function(t){Qe.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=Qe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new fe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ee.lang.extend(Qe.asn1.DERInteger,Qe.asn1.ASN1Object),Qe.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=Qe.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}Qe.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var i="0"+t;this.hTLV=null,this.isModified=!0,this.hV=i+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var i=0;i<=e;i++)t+="0";var n="";for(i=0;i<t.length-1;i+=8){var r=t.substr(i,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),n+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+n},this.setByBooleanArray=function(t){for(var e="",i=0;i<t.length;i++)1==t[i]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},ee.lang.extend(Qe.asn1.DERBitString,Qe.asn1.ASN1Object),Qe.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=Qe.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}Qe.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ee.lang.extend(Qe.asn1.DEROctetString,Qe.asn1.DERAbstractString),Qe.asn1.DERNull=function(){Qe.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ee.lang.extend(Qe.asn1.DERNull,Qe.asn1.ASN1Object),Qe.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},i=function(t){var i="",n=new fe(t,10).toString(2),r=7-n.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";n=s+n;for(o=0;o<n.length-1;o+=7){var a=n.substr(o,7);o!=n.length-7&&(a="1"+a),i+=e(parseInt(a,2))}return i};Qe.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var n="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);n+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)n+=i(r[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=n},this.setValueName=function(t){var e=Qe.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},ee.lang.extend(Qe.asn1.DERObjectIdentifier,Qe.asn1.ASN1Object),Qe.asn1.DEREnumerated=function(t){Qe.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=Qe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new fe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ee.lang.extend(Qe.asn1.DEREnumerated,Qe.asn1.ASN1Object),Qe.asn1.DERUTF8String=function(t){Qe.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ee.lang.extend(Qe.asn1.DERUTF8String,Qe.asn1.DERAbstractString),Qe.asn1.DERNumericString=function(t){Qe.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ee.lang.extend(Qe.asn1.DERNumericString,Qe.asn1.DERAbstractString),Qe.asn1.DERPrintableString=function(t){Qe.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ee.lang.extend(Qe.asn1.DERPrintableString,Qe.asn1.DERAbstractString),Qe.asn1.DERTeletexString=function(t){Qe.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ee.lang.extend(Qe.asn1.DERTeletexString,Qe.asn1.DERAbstractString),Qe.asn1.DERIA5String=function(t){Qe.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ee.lang.extend(Qe.asn1.DERIA5String,Qe.asn1.DERAbstractString),Qe.asn1.DERUTCTime=function(t){Qe.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=ri(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=ri(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},ee.lang.extend(Qe.asn1.DERUTCTime,Qe.asn1.DERAbstractTime),Qe.asn1.DERGeneralizedTime=function(t){Qe.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=ri(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=ri(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},ee.lang.extend(Qe.asn1.DERGeneralizedTime,Qe.asn1.DERAbstractTime),Qe.asn1.DERSequence=function(t){Qe.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},ee.lang.extend(Qe.asn1.DERSequence,Qe.asn1.DERAbstractStructured),Qe.asn1.DERSet=function(t){Qe.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var i=this.asn1Array[e];t.push(i.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ee.lang.extend(Qe.asn1.DERSet,Qe.asn1.DERAbstractStructured),Qe.asn1.DERTaggedObject=function(t){Qe.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,i){this.hT=e,this.isExplicit=t,this.asn1Object=i,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=i.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ee.lang.extend(Qe.asn1.DERTaggedObject,Qe.asn1.ASN1Object);var Qe,ti,ei,ii=new function(){};function ni(t){for(var e="",i=0;i<t.length;i++){var n=t[i].toString(16);1==n.length&&(n="0"+n),e+=n}return e}function ri(t){return ni(function(t){for(var e=new Array,i=0;i<t.length;i++)e[i]=t.charCodeAt(i);return e}(t))}function si(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function oi(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function ai(t){return t.length%2==1&&(t="0"+t),si(he(t))}function ui(t){return ce(oi(t))}function hi(t){return yi(Si(t))}function ci(t){return decodeURIComponent(mi(t))}function fi(t){for(var e="",i=0;i<t.length-1;i+=2)e+=String.fromCharCode(parseInt(t.substr(i,2),16));return e}function li(t){for(var e="",i=0;i<t.length;i++)e+=("0"+t.charCodeAt(i).toString(16)).slice(-2);return e}function di(t){var e=function(t){return he(t)}(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function pi(t,e){return"-----BEGIN "+e+"-----\r\n"+di(t)+"\r\n-----END "+e+"-----\r\n"}function gi(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return function(t){return ce(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}(t=void 0!==e?(t=t.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):(t=t.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function vi(t){return~~(function(t){var e,i,n,r,s,o,a,u,h,c,f;if(f=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=f[1],e=parseInt(u),2===u.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),i=parseInt(f[2])-1,n=parseInt(f[3]),r=parseInt(f[4]),s=parseInt(f[5]),o=parseInt(f[6]),a=0,""!==(h=f[7])&&(c=(h.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(e,i,n,r,s,o,a);throw"unsupported zulu format: "+t}(t)/1e3)}function yi(t){return t.replace(/%/g,"")}function mi(t){return t.replace(/(..)/g,"%$1")}function bi(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?function(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),i=0;i<8;i++)e[i]=e[i].replace(/^0+/,""),""==e[i]&&(e[i]="0");var n=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===n)return t.slice(1,-1);var r="";for(i=0;i<n.length;i++)n[i].length>r.length&&(r=n[i]);return(t=t.replace(r,"::")).slice(1,-1)}(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function Si(t){for(var e=encodeURIComponent(t),i="",n=0;n<e.length;n++)"%"==e[n]?(i+=e.substr(n,3),n+=2):i=i+"%"+ri(e[n]);return i}function wi(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}ii.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var i=parseInt(t.substr(e+3,1));return 0==i?-1:0<i&&i<10?i+1:-2},ii.getL=function(t,e){var i=ii.getLblen(t,e);return i<1?"":t.substr(e+2,2*i)},ii.getVblen=function(t,e){var i;return""==(i=ii.getL(t,e))?-1:("8"===i.substr(0,1)?new fe(i.substr(2),16):new fe(i,16)).intValue()},ii.getVidx=function(t,e){var i=ii.getLblen(t,e);return i<0?i:e+2*(i+1)},ii.getV=function(t,e){var i=ii.getVidx(t,e),n=ii.getVblen(t,e);return t.substr(i,2*n)},ii.getTLV=function(t,e){return t.substr(e,2)+ii.getL(t,e)+ii.getV(t,e)},ii.getNextSiblingIdx=function(t,e){return ii.getVidx(t,e)+2*ii.getVblen(t,e)},ii.getChildIdx=function(t,e){var i=ii,n=new Array,r=i.getVidx(t,e);"03"==t.substr(e,2)?n.push(r+2):n.push(r);for(var s=i.getVblen(t,e),o=r,a=0;;){var u=i.getNextSiblingIdx(t,o);if(null==u||u-r>=2*s)break;if(a>=200)break;n.push(u),o=u,a++}return n},ii.getNthChildIdx=function(t,e,i){return ii.getChildIdx(t,e)[i]},ii.getIdxbyList=function(t,e,i,n){var r,s,o=ii;if(0==i.length){if(void 0!==n&&t.substr(e,2)!==n)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+n;return e}return r=i.shift(),s=o.getChildIdx(t,e),o.getIdxbyList(t,s[r],i,n)},ii.getTLVbyList=function(t,e,i,n){var r=ii,s=r.getIdxbyList(t,e,i);if(void 0===s)throw"can't find nthList object";if(void 0!==n&&t.substr(s,2)!=n)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+n;return r.getTLV(t,s)},ii.getVbyList=function(t,e,i,n,r){var s,o,a=ii;if(void 0===(s=a.getIdxbyList(t,e,i,n)))throw"can't find nthList object";return o=a.getV(t,s),!0===r&&(o=o.substr(2)),o},ii.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},i=[],n=t.substr(0,2),r=parseInt(n,16);i[0]=new String(Math.floor(r/40)),i[1]=new String(r%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var u=[],h="";for(a=0;a<o.length;a++)128&o[a]?h+=e((127&o[a]).toString(2),7):(h+=e((127&o[a]).toString(2),7),u.push(new String(parseInt(h,2))),h="");var c=i.join(".");return u.length>0&&(c=c+"."+u.join(".")),c},ii.dump=function(t,e,i,n){var r=ii,s=r.getV,o=r.dump,a=r.getChildIdx,u=t;t instanceof Qe.asn1.ASN1Object&&(u=t.getEncodedHex());var h=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===i&&(i=0),void 0===n&&(n="");var c=e.ommit_long_octet;if("01"==u.substr(i,2))return"00"==(f=s(u,i))?n+"BOOLEAN FALSE\n":n+"BOOLEAN TRUE\n";if("02"==u.substr(i,2))return n+"INTEGER "+h(f=s(u,i),c)+"\n";if("03"==u.substr(i,2))return n+"BITSTRING "+h(f=s(u,i),c)+"\n";if("04"==u.substr(i,2)){var f=s(u,i);if(r.isASN1HEX(f)){var l=n+"OCTETSTRING, encapsulates\n";return l+=o(f,e,0,n+"  ")}return n+"OCTETSTRING "+h(f,c)+"\n"}if("05"==u.substr(i,2))return n+"NULL\n";if("06"==u.substr(i,2)){var d=s(u,i),p=Qe.asn1.ASN1Util.oidHexToInt(d),g=Qe.asn1.x509.OID.oid2name(p),v=p.replace(/\./g," ");return""!=g?n+"ObjectIdentifier "+g+" ("+v+")\n":n+"ObjectIdentifier ("+v+")\n"}if("0c"==u.substr(i,2))return n+"UTF8String '"+ci(s(u,i))+"'\n";if("13"==u.substr(i,2))return n+"PrintableString '"+ci(s(u,i))+"'\n";if("14"==u.substr(i,2))return n+"TeletexString '"+ci(s(u,i))+"'\n";if("16"==u.substr(i,2))return n+"IA5String '"+ci(s(u,i))+"'\n";if("17"==u.substr(i,2))return n+"UTCTime "+ci(s(u,i))+"\n";if("18"==u.substr(i,2))return n+"GeneralizedTime "+ci(s(u,i))+"\n";if("30"==u.substr(i,2)){if("3000"==u.substr(i,4))return n+"SEQUENCE {}\n";l=n+"SEQUENCE\n";var y=e;if((2==(S=a(u,i)).length||3==S.length)&&"06"==u.substr(S[0],2)&&"04"==u.substr(S[S.length-1],2)){g=r.oidname(s(u,S[0]));var m=JSON.parse(JSON.stringify(e));m.x509ExtName=g,y=m}for(var b=0;b<S.length;b++)l+=o(u,y,S[b],n+"  ");return l}if("31"==u.substr(i,2)){l=n+"SET\n";var S=a(u,i);for(b=0;b<S.length;b++)l+=o(u,e,S[b],n+"  ");return l}var w=parseInt(u.substr(i,2),16);if(0!=(128&w)){var x=31&w;if(0!=(32&w)){var l=n+"["+x+"]\n";for(S=a(u,i),b=0;b<S.length;b++)l+=o(u,e,S[b],n+"  ");return l}return"68747470"==(f=s(u,i)).substr(0,8)&&(f=ci(f)),"subjectAltName"===e.x509ExtName&&2==x&&(f=ci(f)),l=n+"["+x+"] "+f+"\n"}return n+"UNKNOWN("+u.substr(i,2)+") "+s(u,i)+"\n"},ii.isASN1HEX=function(t){var e=ii;if(t.length%2==1)return!1;var i=e.getVblen(t,0),n=t.substr(0,2),r=e.getL(t,0);return t.length-n.length-r.length==2*i},ii.oidname=function(t){var e=Qe.asn1;Qe.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var i=e.x509.OID.oid2name(t);return""===i&&(i=t),i},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.x509&&Qe.asn1.x509||(Qe.asn1.x509={}),Qe.asn1.x509.Certificate=function(t){Qe.asn1.x509.Certificate.superclass.constructor.call(this);var e=Qe,i=(e.crypto,e.asn1),n=i.DERSequence,r=i.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new Qe.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new n({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=t,this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new n({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+di(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ee.lang.extend(Qe.asn1.x509.Certificate,Qe.asn1.ASN1Object),Qe.asn1.x509.TBSCertificate=function(t){Qe.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=Qe.asn1,i=e.DERSequence,n=e.DERInteger,r=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,u=s.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new r({obj:new n({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new n(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){this.asn1SubjPKey=new u(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=xi.getKey(t);this.asn1SubjPKey=new u(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){Qe.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new i({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new i({array:this.extensionsArray}),n=new r({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(n)}var s=new i({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ee.lang.extend(Qe.asn1.x509.TBSCertificate,Qe.asn1.ASN1Object),Qe.asn1.x509.Extension=function(t){Qe.asn1.x509.Extension.superclass.constructor.call(this);var e=Qe.asn1,i=e.DERObjectIdentifier,n=e.DEROctetString,r=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new i({oid:this.oid}),e=new n({hex:this.getExtnValueHex()}),o=new Array;return o.push(t),this.critical&&o.push(new r),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},ee.lang.extend(Qe.asn1.x509.Extension,Qe.asn1.ASN1Object),Qe.asn1.x509.Extension.appendByNameToArray=function(t,e,i){var n=t.toLowerCase(),r=Qe.asn1.x509;if("basicconstraints"==n){var s=new r.BasicConstraints(e);i.push(s)}else if("keyusage"==n){s=new r.KeyUsage(e);i.push(s)}else if("crldistributionpoints"==n){s=new r.CRLDistributionPoints(e);i.push(s)}else if("extkeyusage"==n){s=new r.ExtKeyUsage(e);i.push(s)}else if("authoritykeyidentifier"==n){s=new r.AuthorityKeyIdentifier(e);i.push(s)}else if("authorityinfoaccess"==n){s=new r.AuthorityInfoAccess(e);i.push(s)}else if("subjectaltname"==n){s=new r.SubjectAltName(e);i.push(s)}else{if("issueraltname"!=n)throw"unsupported extension name: "+t;s=new r.IssuerAltName(e);i.push(s)}},Qe.asn1.x509.KeyUsage=function(t){Qe.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=Ci.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new Qe.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){for(var i=t.names,n="000000000",r=0;r<i.length;r++)for(var s=0;s<e.length;s++)i[r]===e[s]&&(n=n.substring(0,s)+"1"+n.substring(s+1,n.length));this.asn1ExtnValue=new Qe.asn1.DERBitString({bin:n})}},ee.lang.extend(Qe.asn1.x509.KeyUsage,Qe.asn1.x509.Extension),Qe.asn1.x509.BasicConstraints=function(t){Qe.asn1.x509.BasicConstraints.superclass.constructor.call(this,t),this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new Qe.asn1.DERBoolean),this.pathLen>-1&&t.push(new Qe.asn1.DERInteger({int:this.pathLen}));var e=new Qe.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},ee.lang.extend(Qe.asn1.x509.BasicConstraints,Qe.asn1.x509.Extension),Qe.asn1.x509.CRLDistributionPoints=function(t){Qe.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=Qe.asn1,i=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},this.setByOneURI=function(t){var e=new i.GeneralNames([{uri:t}]),n=new i.DistributionPointName(e),r=new i.DistributionPoint({dpobj:n});this.setByDPArray([r])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},ee.lang.extend(Qe.asn1.x509.CRLDistributionPoints,Qe.asn1.x509.Extension),Qe.asn1.x509.ExtKeyUsage=function(t){Qe.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=Qe.asn1;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var i=0;i<t.length;i++){var n=new e.DERObjectIdentifier(t[i]);this.asn1ExtnValue.appendASN1Object(n)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},ee.lang.extend(Qe.asn1.x509.ExtKeyUsage,Qe.asn1.x509.Extension),Qe.asn1.x509.AuthorityKeyIdentifier=function(t){Qe.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=Qe.asn1,i=e.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array;this.asn1KID&&t.push(new i({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new i({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&t.push(new i({explicit:!1,tag:"82",obj:this.asn1CertSN}));var n=new e.DERSequence({array:t});return this.asn1ExtnValue=n,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){this.asn1KID=new Qe.asn1.DEROctetString(t)},this.setCertIssuerByParam=function(t){this.asn1CertIssuer=new Qe.asn1.x509.X500Name(t)},this.setCertSNByParam=function(t){this.asn1CertSN=new Qe.asn1.DERInteger(t)},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn))},ee.lang.extend(Qe.asn1.x509.AuthorityKeyIdentifier,Qe.asn1.x509.Extension),Qe.asn1.x509.AuthorityInfoAccess=function(t){Qe.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(t){for(var e=new Array,i=Qe.asn1,n=i.DERSequence,r=0;r<t.length;r++){var s=new n({array:[new i.DERObjectIdentifier(t[r].accessMethod),new i.x509.GeneralName(t[r].accessLocation)]});e.push(s)}this.asn1ExtnValue=new n({array:e})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},ee.lang.extend(Qe.asn1.x509.AuthorityInfoAccess,Qe.asn1.x509.Extension),Qe.asn1.x509.SubjectAltName=function(t){Qe.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new Qe.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ee.lang.extend(Qe.asn1.x509.SubjectAltName,Qe.asn1.x509.Extension),Qe.asn1.x509.IssuerAltName=function(t){Qe.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new Qe.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ee.lang.extend(Qe.asn1.x509.IssuerAltName,Qe.asn1.x509.Extension),Qe.asn1.x509.CRL=function(t){Qe.asn1.x509.CRL.superclass.constructor.call(this),this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new Qe.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new Qe.asn1.DERBitString({hex:"00"+this.hexSig});var t=new Qe.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+di(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ee.lang.extend(Qe.asn1.x509.CRL,Qe.asn1.ASN1Object),Qe.asn1.x509.TBSCertList=function(t){Qe.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=Qe.asn1,i=e.DERSequence,n=e.x509,r=n.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new n.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new n.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new r(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new r(t)},this.addRevokedCert=function(t,e){var i={};null!=t&&null!=t&&(i.sn=t),null!=e&&null!=e&&(i.time=e);var r=new n.CRLEntry(i);this.aRevokedCert.push(r)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new i({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new i({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},ee.lang.extend(Qe.asn1.x509.TBSCertList,Qe.asn1.ASN1Object),Qe.asn1.x509.CRLEntry=function(t){Qe.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=Qe.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},ee.lang.extend(Qe.asn1.x509.CRLEntry,Qe.asn1.ASN1Object),Qe.asn1.x509.X500Name=function(t){Qe.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=Qe.asn1,i=e.x509,n=gi;if(this.setByString=function(t){var e=t.split("/");e.shift();for(var n=[],r=0;r<e.length;r++)if(e[r].match(/^[^=]+=.+$/))n.push(e[r]);else{var s=n.length-1;n[s]=n[s]+"/"+e[r]}for(r=0;r<n.length;r++)this.asn1Array.push(new i.RDN({str:n[r]}))},this.setByLdapString=function(t){var e=i.X500Name.ldapToOneline(t);this.setByString(e)},this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var i=new Qe.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(i):this.asn1Array=[i]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t){var r;if(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):"object"==typeof t&&this.setByObject(t),void 0!==t.certissuer)(r=new Ci).hex=n(t.certissuer),this.hTLV=r.getIssuerHex();if(void 0!==t.certsubject)(r=new Ci).hex=n(t.certsubject),this.hTLV=r.getSubjectHex()}},ee.lang.extend(Qe.asn1.x509.X500Name,Qe.asn1.ASN1Object),Qe.asn1.x509.X500Name.onelineToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map(function(t){return t.replace(/,/,"\\,")})).join(",")},Qe.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),i=!1,n=[],r=0;e.length>0;r++){var s=e.shift();if(!0===i){var o=(n.pop()+","+s).replace(/\\,/g,",");n.push(o),i=!1}else n.push(s);"\\"===s.substr(-1,1)&&(i=!0)}return(n=n.map(function(t){return t.replace("/","\\/")})).reverse(),"/"+n.join("/")},Qe.asn1.x509.RDN=function(t){Qe.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new Qe.asn1.x509.AttributeTypeAndValue({str:t}))},this.addByMultiValuedString=function(t){for(var e=Qe.asn1.x509.RDN.parseString(t),i=0;i<e.length;i++)this.addByString(e[i])},this.getEncodedHex=function(){var t=new Qe.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},ee.lang.extend(Qe.asn1.x509.RDN,Qe.asn1.ASN1Object),Qe.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),i=!1,n=[],r=0;e.length>0;r++){var s=e.shift();if(!0===i){var o=(n.pop()+"+"+s).replace(/\\\+/g,"+");n.push(o),i=!1}else n.push(s);"\\"===s.substr(-1,1)&&(i=!0)}var a=!1,u=[];for(r=0;n.length>0;r++){s=n.shift();if(!0===a){var h=u.pop();if(s.match(/"$/)){o=(h+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");u.push(o),a=!1}else u.push(h+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(a=!0)}return u},Qe.asn1.x509.AttributeTypeAndValue=function(t){Qe.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=Qe.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=Qe.asn1.x509.OID.atype2obj(t);var i="utf8";"C"==t&&(i="prn"),this.valueObj=this.getValueObj(i,e)},this.getValueObj=function(t,i){if("utf8"==t)return new e.DERUTF8String({str:i});if("prn"==t)return new e.DERPrintableString({str:i});if("tel"==t)return new e.DERTeletexString({str:i});if("ia5"==t)return new e.DERIA5String({str:i});throw"unsupported directory string type: type="+t+" value="+i},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},ee.lang.extend(Qe.asn1.x509.AttributeTypeAndValue,Qe.asn1.ASN1Object),Qe.asn1.x509.SubjectPublicKeyInfo=function(t){Qe.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=Qe,i=e.asn1,n=i.DERInteger,r=i.DERBitString,s=i.DERObjectIdentifier,o=i.DERSequence,a=i.ASN1Util.newObject,u=i.x509.AlgorithmIdentifier,h=e.crypto;h.ECDSA,h.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof Ge){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new r({hex:"00"+e})}}catch(t){}try{if(t instanceof Qe.crypto.ECDSA){var i=new s({name:t.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:i}),this.asn1SubjPKey=new r({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof Qe.crypto.DSA){i=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new u({name:"dsa",asn1params:i});var o=new n({bigint:t.y});this.asn1SubjPKey=new r({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},ee.lang.extend(Qe.asn1.x509.SubjectPublicKeyInfo,Qe.asn1.ASN1Object),Qe.asn1.x509.Time=function(t){Qe.asn1.x509.Time.superclass.constructor.call(this);var e=Qe.asn1,i=e.DERUTCTime,n=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null;return t=null!=this.timeParams?"utc"==this.type?new i(this.timeParams):new n(this.timeParams):"utc"==this.type?new i:new n,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},ee.lang.extend(Qe.asn1.x509.Time,Qe.asn1.ASN1Object),Qe.asn1.x509.AlgorithmIdentifier=function(t){Qe.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=Qe.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];null!==this.asn1Params&&t.push(this.asn1Params);var i=new e.DERSequence({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var i=this.nameAlg.toLowerCase();"withdsa"!==i.substr(-7,7)&&"withecdsa"!==i.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},ee.lang.extend(Qe.asn1.x509.AlgorithmIdentifier,Qe.asn1.ASN1Object),Qe.asn1.x509.GeneralName=function(t){Qe.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},i=Qe.asn1,n=(i.DERSequence,i.DEROctetString),r=i.DERIA5String,s=i.DERTaggedObject,o=i.ASN1Object,a=i.x509.X500Name,u=gi;this.explicit=!1,this.setByParam=function(t){var i=null;if(void 0!==t){if(void 0!==t.rfc822&&(this.type="rfc822",i=new r({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",i=new r({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",i=new r({str:t[this.type]})),void 0!==t.dn&&(this.type="dn",this.explicit=!0,i=new a({str:t.dn})),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,i=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var h=null;if((f=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(h=u(f)),null==h)throw"certissuer param not cert";(l=new Ci).hex=h;var c=l.getIssuerHex();(i=new o).hTLV=c}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var f,l;h=null;if((f=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(h=u(f)),null==h)throw"certsubj param not cert";(l=new Ci).hex=h;c=l.getSubjectHex();(i=new o).hTLV=c}if(void 0!==t.ip){this.type="ip",this.explicit=!1;var d,p=t.ip,g="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(d=function(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{var e=t.split(/,/).map(function(t,e,i){var n=parseInt(t);if(n<0||255<n)throw"integer not in range 0-255";var r=("00"+n.toString(16)).slice(-2);return r}).join("");return e}catch(t){throw"malformed integer array string: "+t}}("["+p.split(".").join(",")+"]")).length)throw g}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))d=function(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var i=(t=t.toLowerCase()).split(":").length-1;if(i<2)throw e;var n=":".repeat(7-i+2),r=(t=t.replace("::",n)).split(":");if(8!=r.length)throw e;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw g;d=p}i=new n({hex:d})}if(null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:i})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},ee.lang.extend(Qe.asn1.x509.GeneralName,Qe.asn1.ASN1Object),Qe.asn1.x509.GeneralNames=function(t){Qe.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=Qe.asn1;this.setByParamArray=function(t){for(var i=0;i<t.length;i++){var n=new e.x509.GeneralName(t[i]);this.asn1Array.push(n)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},ee.lang.extend(Qe.asn1.x509.GeneralNames,Qe.asn1.ASN1Object),Qe.asn1.x509.DistributionPointName=function(t){Qe.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=Qe.asn1,i=e.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new i({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},ee.lang.extend(Qe.asn1.x509.DistributionPointName,Qe.asn1.ASN1Object),Qe.asn1.x509.DistributionPoint=function(t){Qe.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=Qe.asn1;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var i=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(i)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},ee.lang.extend(Qe.asn1.x509.DistributionPoint,Qe.asn1.ASN1Object),Qe.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],i=new Qe.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=i,i},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],i=new Qe.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=i,i}},Qe.asn1.x509.OID.oid2name=function(t){var e=Qe.asn1.x509.OID.name2oidList;for(var i in e)if(e[i]==t)return i;return""},Qe.asn1.x509.OID.oid2atype=function(t){var e=Qe.asn1.x509.OID.atype2oidList;for(var i in e)if(e[i]==t)return i;return t},Qe.asn1.x509.OID.name2oid=function(t){var e=Qe.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},Qe.asn1.x509.X509Util={},Qe.asn1.x509.X509Util.newCertPEM=function(t){var e=Qe.asn1.x509,i=e.TBSCertificate,n=e.Certificate,r=new i;if(void 0===t.serial)throw"serial number undefined.";if(r.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(r.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(r.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(r.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(r.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(r.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(r.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])r.appendExtensionByName(key,t.ext[s][key]);if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new n({tbscertobj:r,prvkeyobj:!0===t.cakey.isPrivate?t.cakey:xi.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new n({tbscertobj:r})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.cms&&Qe.asn1.cms||(Qe.asn1.cms={}),Qe.asn1.cms.Attribute=function(t){var e=Qe.asn1;e.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var t,i,n;t=new e.DERObjectIdentifier({oid:this.attrTypeOid}),i=new e.DERSet({array:this.valueList});try{i.getEncodedHex()}catch(t){throw"fail valueSet.getEncodedHex in Attribute(1)/"+t}n=new e.DERSequence({array:[t,i]});try{this.hTLV=n.getEncodedHex()}catch(t){throw"failed seq.getEncodedHex in Attribute(2)/"+t}return this.hTLV}},ee.lang.extend(Qe.asn1.cms.Attribute,Qe.asn1.ASN1Object),Qe.asn1.cms.ContentType=function(t){var e=Qe.asn1;e.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var i=null;if(void 0!==t){i=new e.DERObjectIdentifier(t);this.valueList=[i]}},ee.lang.extend(Qe.asn1.cms.ContentType,Qe.asn1.cms.Attribute),Qe.asn1.cms.MessageDigest=function(t){var e=Qe,i=e.asn1,n=i.DEROctetString,r=i.cms;if(r.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",void 0!==t)if(t.eciObj instanceof r.EncapsulatedContentInfo&&"string"==typeof t.hashAlg){var s=t.eciObj.eContentValueHex,o=t.hashAlg;(a=new n({hex:e.crypto.Util.hashHex(s,o)})).getEncodedHex(),this.valueList=[a]}else{var a;(a=new n(t)).getEncodedHex(),this.valueList=[a]}},ee.lang.extend(Qe.asn1.cms.MessageDigest,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningTime=function(t){var e=Qe.asn1;if(e.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==t){var i=new e.x509.Time(t);try{i.getEncodedHex()}catch(t){throw"SigningTime.getEncodedHex() failed/"+t}this.valueList=[i]}},ee.lang.extend(Qe.asn1.cms.SigningTime,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningCertificate=function(t){var e=Qe,i=e.asn1,n=i.DERSequence,r=i.cms;e.crypto;r.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(t){for(var s=[],o=0;o<t.length;o++){var a=gi(t[o]),u=e.crypto.Util.hashHex(a,"sha1"),h=new i.DEROctetString({hex:u});h.getEncodedHex();var c=new r.IssuerAndSerialNumber({cert:t[o]});c.getEncodedHex();var f=new n({array:[h,c]});f.getEncodedHex(),s.push(f)}var l=new n({array:s});l.getEncodedHex(),this.valueList=[l]},void 0!==t&&"object"==typeof t.array&&this.setCerts(t.array)},ee.lang.extend(Qe.asn1.cms.SigningCertificate,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningCertificateV2=function(t){var e=Qe,i=e.asn1,n=i.DERSequence,r=i.x509,s=i.cms,o=e.crypto;if(s.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(t,e){for(var a=[],u=0;u<t.length;u++){var h=gi(t[u]),c=[];"sha256"!==e&&c.push(new r.AlgorithmIdentifier({name:e}));var f=o.Util.hashHex(h,e),l=new i.DEROctetString({hex:f});l.getEncodedHex(),c.push(l);var d=new s.IssuerAndSerialNumber({cert:t[u]});d.getEncodedHex(),c.push(d);var p=new n({array:c});p.getEncodedHex(),a.push(p)}var g=new n({array:a});g.getEncodedHex(),this.valueList=[g]},void 0!==t&&"object"==typeof t.array){var a="sha256";"string"==typeof t.hashAlg&&(a=t.hashAlg),this.setCerts(t.array,a)}},ee.lang.extend(Qe.asn1.cms.SigningCertificateV2,Qe.asn1.cms.Attribute),Qe.asn1.cms.IssuerAndSerialNumber=function(t){var e=Qe.asn1,i=e.DERInteger,n=e.cms,r=e.x509.X500Name,s=Ci;n.IssuerAndSerialNumber.superclass.constructor.call(this),this.setByCertPEM=function(t){var e=gi(t),n=new s;n.hex=e;var o=n.getIssuerHex();this.dIssuer=new r,this.dIssuer.hTLV=o;var a=n.getSerialNumberHex();this.dSerial=new i({hex:a})},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),t.issuer&&t.serial&&(t.issuer instanceof r?this.dIssuer=t.issuer:this.dIssuer=new r(t.issuer),t.serial instanceof i?this.dSerial=t.serial:this.dSerial=new i(t.serial)),"string"==typeof t.cert&&this.setByCertPEM(t.cert))},ee.lang.extend(Qe.asn1.cms.IssuerAndSerialNumber,Qe.asn1.ASN1Object),Qe.asn1.cms.AttributeList=function(t){var e=Qe.asn1,i=e.cms;i.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(t){t instanceof i.Attribute&&this.list.push(t)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ee.lang.extend(Qe.asn1.cms.AttributeList,Qe.asn1.ASN1Object),Qe.asn1.cms.SignerInfo=function(t){var e=Qe,i=e.asn1,n=i.DERTaggedObject,r=i.cms,s=r.AttributeList,o=r.ContentType,a=r.EncapsulatedContentInfo,u=r.MessageDigest,h=r.SignedData,c=i.x509.AlgorithmIdentifier,f=e.crypto,l=xi;r.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new i.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(t){"string"==typeof t&&-1!=t.indexOf("CERTIFICATE")&&-1!=t.indexOf("BEGIN")&&-1!=t.indexOf("END")&&(this.dSignerIdentifier=new r.IssuerAndSerialNumber({cert:t}))},this.setForContentAndHash=function(t){void 0!==t&&(t.eciObj instanceof a&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new u({eciObj:t.eciObj,hashAlg:t.hashAlg}))),void 0!==t.sdObj&&t.sdObj instanceof h&&-1==t.sdObj.digestAlgNameList.join(":").indexOf(t.hashAlg)&&t.sdObj.digestAlgNameList.push(t.hashAlg),"string"==typeof t.hashAlg&&(this.dDigestAlgorithm=new c({name:t.hashAlg})))},this.sign=function(t,e){this.dSigAlg=new c({name:e});var n=this.dSignedAttrs.getEncodedHex(),r=l.getKey(t),s=new f.Signature({alg:e});s.init(r),s.updateHex(n);var o=s.sign();this.dSig=new i.DEROctetString({hex:o})},this.addUnsigned=function(t){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(t)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var t=new n({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),e=null;this.dUnsignedAttrs.length()>0&&(e=new n({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var r=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,t,this.dSigAlg,this.dSig];null!=e&&r.push(e);var o=new i.DERSequence({array:r});return this.hTLV=o.getEncodedHex(),this.hTLV}},ee.lang.extend(Qe.asn1.cms.SignerInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.EncapsulatedContentInfo=function(t){var e=Qe.asn1,i=e.DERTaggedObject,n=e.DERSequence,r=e.DERObjectIdentifier,s=e.DEROctetString;e.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new r({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(t){t.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new r({oid:t}):this.dEContentType=new r({name:t})},this.setContentValue=function(t){void 0!==t&&("string"==typeof t.hex?this.eContentValueHex=t.hex:"string"==typeof t.str&&(this.eContentValueHex=hi(t.str)))},this.setContentValueHex=function(t){this.eContentValueHex=t},this.setContentValueStr=function(t){this.eContentValueHex=hi(t)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var t=new s({hex:this.eContentValueHex});this.dEContent=new i({obj:t,tag:"a0",explicit:!0});var e=[this.dEContentType];this.isDetached||e.push(this.dEContent);var r=new n({array:e});return this.hTLV=r.getEncodedHex(),this.hTLV}},ee.lang.extend(Qe.asn1.cms.EncapsulatedContentInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.ContentInfo=function(t){var e=Qe.asn1,i=e.DERTaggedObject,n=e.DERSequence,r=e.x509;Qe.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(t){"string"==typeof t&&(this.dContentType=r.OID.name2obj(t))},this.getEncodedHex=function(){var t=new i({obj:this.dContent,tag:"a0",explicit:!0}),e=new n({array:[this.dContentType,t]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof e.ASN1Object&&(this.dContent=t.obj))},ee.lang.extend(Qe.asn1.cms.ContentInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.SignedData=function(t){var e=Qe.asn1,i=e.ASN1Object,n=e.DERInteger,r=e.DERSet,s=e.DERSequence,o=e.DERTaggedObject,a=e.cms,u=a.EncapsulatedContentInfo,h=a.SignerInfo,c=a.ContentInfo,f=e.x509.AlgorithmIdentifier;Qe.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new n({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new u,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new h],this.addCertificatesByPEM=function(t){var e=gi(t),n=new i;n.hTLV=e,this.certificateList.push(n)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var t=[],e=0;e<this.digestAlgNameList.length;e++){var i=this.digestAlgNameList[e],n=new f({name:i});t.push(n)}this.dDigestAlgs=new r({array:t})}var a=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&this.certificateList.length>0){var u=new r({array:this.certificateList});this.dCerts=new o({obj:u,tag:"a0",explicit:!1})}null!=this.dCerts&&a.push(this.dCerts);var h=new r({array:this.signerInfoList});a.push(h);var c=new s({array:a});return this.hTLV=c.getEncodedHex(),this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new c({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},this.getPEM=function(){return pi(this.getContentInfoEncodedHex(),"CMS")}},ee.lang.extend(Qe.asn1.cms.SignedData,Qe.asn1.ASN1Object),Qe.asn1.cms.CMSUtil=new function(){},Qe.asn1.cms.CMSUtil.newSignedData=function(t){var e=Qe.asn1,i=e.cms,n=i.SignerInfo,r=i.SignedData,s=i.SigningTime,o=i.SigningCertificate,a=i.SigningCertificateV2,u=e.cades.SignaturePolicyIdentifier,h=new r;if(h.dEncapContentInfo.setContentValue(t.content),"object"==typeof t.certs)for(var c=0;c<t.certs.length;c++)h.addCertificatesByPEM(t.certs[c]);h.signerInfoList=[];for(c=0;c<t.signerInfos.length;c++){var f=t.signerInfos[c],l=new n;for(attrName in l.setSignerIdentifier(f.signerCert),l.setForContentAndHash({sdObj:h,eciObj:h.dEncapContentInfo,hashAlg:f.hashAlg}),f.sAttr){var d=f.sAttr[attrName];if("SigningTime"==attrName){var p=new s(d);l.dSignedAttrs.add(p)}if("SigningCertificate"==attrName){p=new o(d);l.dSignedAttrs.add(p)}if("SigningCertificateV2"==attrName){p=new a(d);l.dSignedAttrs.add(p)}if("SignaturePolicyIdentifier"==attrName){p=new u(d);l.dSignedAttrs.add(p)}}l.sign(f.signerPrvKey,f.sigAlg),h.signerInfoList.push(l)}return h},Qe.asn1.cms.CMSUtil.verifySignedData=function(t){var e=Qe,i=e.asn1,n=i.cms,r=(n.SignerInfo,n.SignedData,n.SigningTime,n.SigningCertificate,n.SigningCertificateV2,i.cades.SignaturePolicyIdentifier,e.lang.String.isHex),s=ii,o=s.getVbyList,a=s.getTLVbyList,u=s.getIdxbyList,h=s.getChildIdx,c=s.getTLV,f=s.oidname,l=e.crypto.Util.hashHex;void 0===t.cms&&r(t.cms);var d=t.cms,p=function(t,e){var i=e.idx;e.signerid_issuer1=a(t,i,[1,0],"30"),e.signerid_serial1=o(t,i,[1,1],"02"),e.hashalg=f(o(t,i,[2,0],"06"));var n=u(t,i,[3],"a0");e.idxSignedAttrs=n,g(t,e,n);var r=h(t,i).length;if(r<6)throw"malformed SignerInfo";e.sigalg=f(o(t,i,[r-2,0],"06")),e.sigval=o(t,i,[r-1],"04")},g=function(t,e,i){var n=h(t,i);e.signedAttrIdxList=n;for(var r=0;r<n.length;r++){var s,a=n[r],u=o(t,a,[0],"06");"2a864886f70d010905"===u?(s=ci(o(t,a,[1,0])),e.saSigningTime=s):"2a864886f70d010904"===u&&(s=o(t,a,[1,0],"04"),e.saMessageDigest=s)}},v=function(t,e,i,n){i.verifyDetail={};var r=i.verifyDetail,s=e.parse.econtent,o=i.hashalg,a=i.saMessageDigest;r.validMessageDigest=!1,l(s,o)===a&&(r.validMessageDigest=!0),function(t,e,i,n){var r,s=e.parse.certsIdx;if(void 0===e.certs){r=[],e.certkeys=[];for(var o=h(t,s),a=0;a<o.length;a++){var u=c(t,o[a]),f=new Ci;f.readCertHex(u),r[a]=f,e.certkeys[a]=f.getPublicKey()}e.certs=r}else r=e.certs;e.cccc=r.length,e.cccci=o.length;for(a=0;a<r.length;a++){var l=f.getIssuerHex(),d=f.getSerialNumberHex();i.signerid_issuer1===l&&i.signerid_serial1===d&&(i.certkey_idx=a)}}(t,e,i),r.validSignatureValue=!1;var u=i.sigalg,f="31"+c(t,i.idxSignedAttrs).substr(2);i.signedattrshex=f;var d=e.certs[i.certkey_idx].getPublicKey(),p=new Qe.crypto.Signature({alg:u});p.init(d),p.updateHex(f);var g=p.verify(i.sigval);r.validSignatureValue_isValid=g,!0===g&&(r.validSignatureValue=!0),i.isValid=!1,r.validMessageDigest&&r.validSignatureValue&&(i.isValid=!0)},y={isValid:!1,parse:{}};return function(t,e){if("2a864886f70d010702"!==o(t,0,[0],"06"))return e;e.cmsType="signedData",e.econtent=o(t,0,[1,0,2,1,0]),function(t,e){for(var i,n=3;n<6;n++)if(void 0!==(i=u(t,0,[1,0,n]))){var r=t.substr(i,2);"a0"===r&&(e.certsIdx=i),"a1"===r&&(e.revinfosIdx=i),"31"===r&&(e.signerinfosIdx=i)}}(t,e),e.signerInfos=[],function(t,e){var i=e.signerinfosIdx;if(void 0!==i){var n=h(t,i);e.signerInfoIdxList=n;for(var r=0;r<n.length;r++){var s={idx:n[r]};p(t,s),e.signerInfos.push(s)}}}(t,e)}(d,y.parse),function(t,e){for(var i=e.parse.signerInfos,n=i.length,r=!0,s=0;s<n;s++){var o=i[s];v(t,e,o,s),o.isValid||(r=!1)}e.isValid=r}(d,y),y},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.tsp&&Qe.asn1.tsp||(Qe.asn1.tsp={}),Qe.asn1.tsp.Accuracy=function(t){var e=Qe.asn1,i=e.DERInteger,n=e.DERSequence,r=e.DERTaggedObject;e.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var t=null,e=null,s=null,o=[];if(null!=this.seconds&&(t=new i({int:this.seconds}),o.push(t)),null!=this.millis){var a=new i({int:this.millis});e=new r({obj:a,tag:"80",explicit:!1}),o.push(e)}if(null!=this.micros){var u=new i({int:this.micros});s=new r({obj:u,tag:"81",explicit:!1}),o.push(s)}var h=new n({array:o});return this.hTLV=h.getEncodedHex(),this.hTLV},void 0!==t&&("number"==typeof t.seconds&&(this.seconds=t.seconds),"number"==typeof t.millis&&(this.millis=t.millis),"number"==typeof t.micros&&(this.micros=t.micros))},ee.lang.extend(Qe.asn1.tsp.Accuracy,Qe.asn1.ASN1Object),Qe.asn1.tsp.MessageImprint=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new i({array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==t&&("string"==typeof t.hashAlg&&(this.dHashAlg=new r({name:t.hashAlg})),"string"==typeof t.hashValue&&(this.dHashValue=new n({hex:t.hashValue})))},ee.lang.extend(Qe.asn1.tsp.MessageImprint,Qe.asn1.ASN1Object),Qe.asn1.tsp.TimeStampReq=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.DERInteger,r=e.DERBoolean,s=e.DERObjectIdentifier,o=e.tsp,a=o.MessageImprint;o.TimeStampReq.superclass.constructor.call(this),this.dVersion=new n({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(t){t instanceof a?this.dMessageImprint=t:"object"==typeof t&&(this.dMessageImprint=new a(t))},this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var t=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&t.push(this.dPolicy),null!=this.dNonce&&t.push(this.dNonce),this.certReq&&t.push(new r);var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.mi&&this.setMessageImprint(t.mi),"object"==typeof t.policy&&(this.dPolicy=new s(t.policy)),"object"==typeof t.nonce&&(this.dNonce=new n(t.nonce)),"boolean"==typeof t.certreq&&(this.certReq=t.certreq))},ee.lang.extend(Qe.asn1.tsp.TimeStampReq,Qe.asn1.ASN1Object),Qe.asn1.tsp.TSTInfo=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.DERInteger,r=e.DERBoolean,s=e.DERGeneralizedTime,o=e.DERObjectIdentifier,a=e.tsp,u=a.MessageImprint,h=a.Accuracy,c=e.x509.X500Name;if(a.TSTInfo.superclass.constructor.call(this),this.dVersion=new n({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var t=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(t.push(this.dPolicy),null==this.dMessageImprint)throw"messageImprint shall be specified.";if(t.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(t.push(this.dSerialNumber),null==this.dGenTime)throw"genTime shall be specified.";t.push(this.dGenTime),null!=this.dAccuracy&&t.push(this.dAccuracy),null!=this.dOrdering&&t.push(this.dOrdering),null!=this.dNonce&&t.push(this.dNonce),null!=this.dTsa&&t.push(this.dTsa);var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){if("string"==typeof t.policy){if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new o({oid:t.policy})}void 0!==t.messageImprint&&(this.dMessageImprint=new u(t.messageImprint)),void 0!==t.serialNumber&&(this.dSerialNumber=new n(t.serialNumber)),void 0!==t.genTime&&(this.dGenTime=new s(t.genTime)),void 0!==t.accuracy&&(this.dAccuracy=new h(t.accuracy)),void 0!==t.ordering&&1==t.ordering&&(this.dOrdering=new r),void 0!==t.nonce&&(this.dNonce=new n(t.nonce)),void 0!==t.tsa&&(this.dTsa=new c(t.tsa))}},ee.lang.extend(Qe.asn1.tsp.TSTInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.TimeStampResp=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.ASN1Object,r=e.tsp,s=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dTST&&t.push(this.dTST);var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new s(t.status)),void 0!==t.tst&&t.tst instanceof n&&(this.dTST=t.tst.getContentInfo()))},ee.lang.extend(Qe.asn1.tsp.TimeStampResp,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatusInfo=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.tsp,r=n.PKIStatus,s=n.PKIFreeText,o=n.PKIFailureInfo;n.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dStatusString&&t.push(this.dStatusString),null!=this.dFailureInfo&&t.push(this.dFailureInfo);var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new r(t.status)),"object"==typeof t.statstr&&(this.dStatusString=new s({array:t.statstr})),"object"==typeof t.failinfo&&(this.dFailureInfo=new o(t.failinfo)))},ee.lang.extend(Qe.asn1.tsp.PKIStatusInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatus=function(t){var e=Qe.asn1,i=e.DERInteger,n=e.tsp,r=n.PKIStatus;if(n.PKIStatus.superclass.constructor.call(this),this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==t)if(void 0!==t.name){var s=r.valueList;if(void 0===s[t.name])throw"name undefined: "+t.name;this.dStatus=new i({int:s[t.name]})}else this.dStatus=new i(t)},ee.lang.extend(Qe.asn1.tsp.PKIStatus,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5},Qe.asn1.tsp.PKIFreeText=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.DERUTF8String;e.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var t=[],e=0;e<this.textList.length;e++)t.push(new n({str:this.textList[e]}));var r=new i({array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&"object"==typeof t.array&&(this.textList=t.array)},ee.lang.extend(Qe.asn1.tsp.PKIFreeText,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIFailureInfo=function(t){var e=Qe.asn1,i=e.DERBitString,n=e.tsp.PKIFailureInfo;if(n.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified";var t=new Number(this.value).toString(2),e=new i;return e.setByBinaryString(t),this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t)if("string"==typeof t.name){var r=n.valueList;if(void 0===r[t.name])throw"name undefined: "+t.name;this.value=r[t.name]}else"number"==typeof t.int&&(this.value=t.int)},ee.lang.extend(Qe.asn1.tsp.PKIFailureInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},Qe.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(t,e){throw"not implemented yet"}},Qe.asn1.tsp.SimpleTSAAdapter=function(t){var e=Qe,i=e.asn1.tsp,n=e.crypto.Util.hashHex;i.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(t,e){var r=n(t,e);this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},this.params.tstInfo.serialNumber={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:s},i.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ee.lang.extend(Qe.asn1.tsp.SimpleTSAAdapter,Qe.asn1.tsp.AbstractTSAAdapter),Qe.asn1.tsp.FixedTSAAdapter=function(t){var e=Qe,i=e.asn1.tsp,n=e.crypto.Util.hashHex;i.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(t,e){var r=n(t,e);return this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},i.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ee.lang.extend(Qe.asn1.tsp.FixedTSAAdapter,Qe.asn1.tsp.AbstractTSAAdapter),Qe.asn1.tsp.TSPUtil=new function(){},Qe.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=Qe.asn1,i=e.cms,n=(e.tsp,e.tsp.TSTInfo),r=new i.SignedData,s=new n(t.tstInfo).getEncodedHex();if(r.dEncapContentInfo.setContentValue({hex:s}),r.dEncapContentInfo.setContentType("tstinfo"),"object"==typeof t.certs)for(var o=0;o<t.certs.length;o++)r.addCertificatesByPEM(t.certs[o]);var a=r.signerInfoList[0];a.setSignerIdentifier(t.signerCert),a.setForContentAndHash({sdObj:r,eciObj:r.dEncapContentInfo,hashAlg:t.hashAlg});var u=new i.SigningCertificate({array:[t.signerCert]});return a.dSignedAttrs.add(u),a.sign(t.signerPrvKey,t.sigAlg),r},Qe.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=ii,i=e.getChildIdx,n=e.getV,r=e.getTLV,s={certreq:!1},o=i(t,0);if(o.length<2)throw"TimeStampReq must have at least 2 items";var a=r(t,o[1]);s.mi=Qe.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<o.length;u++){var h=o[u],c=t.substr(h,2);if("06"==c){var f=n(t,h);s.policy=e.hextooidstr(f)}"02"==c&&(s.nonce=n(t,h)),"01"==c&&(s.certreq=!0)}return s},Qe.asn1.tsp.TSPUtil.parseMessageImprint=function(t){var e=ii,i=e.getChildIdx,n=e.getV,r=e.getIdxbyList,s={};if("30"!=t.substr(0,2))throw"head of messageImprint hex shall be '30'";i(t,0);var o=n(t,r(t,0,[0,0])),a=e.hextooidstr(o),u=Qe.asn1.x509.OID.oid2name(a);if(""==u)throw"hashAlg name undefined: "+a;var h=u,c=r(t,0,[1]);return s.hashAlg=h,s.hashValue=n(t,c),s},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.cades&&Qe.asn1.cades||(Qe.asn1.cades={}),Qe.asn1.cades.SignaturePolicyIdentifier=function(t){var e=Qe.asn1,i=e.DERObjectIdentifier,n=e.DERSequence,r=e.cades,s=r.OtherHashAlgAndValue;if(r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",void 0!==t&&"string"==typeof t.oid&&"object"==typeof t.hash){var o=new n({array:[new i({oid:t.oid}),new s(t.hash)]});this.valueList=[o]}},ee.lang.extend(Qe.asn1.cades.SignaturePolicyIdentifier,Qe.asn1.cms.Attribute),Qe.asn1.cades.OtherHashAlgAndValue=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var t=new i({array:[this.dAlg,this.dHash]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&"string"==typeof t.alg&&"string"==typeof t.hash&&(this.dAlg=new r({name:t.alg}),this.dHash=new n({hex:t.hash}))},ee.lang.extend(Qe.asn1.cades.OtherHashAlgAndValue,Qe.asn1.ASN1Object),Qe.asn1.cades.SignatureTimeStamp=function(t){var e=Qe.asn1,i=e.ASN1Object;e.x509;if(e.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==t){if(void 0!==t.res)if("string"==typeof t.res&&t.res.match(/^[0-9A-Fa-f]+$/));else if(!(t.res instanceof i))throw"res param shall be ASN1Object or hex string";if(void 0!==t.tst)if("string"==typeof t.tst&&t.tst.match(/^[0-9A-Fa-f]+$/)){var n=new i;this.tstHex=t.tst,n.hTLV=this.tstHex,n.getEncodedHex(),this.valueList=[n]}else if(!(t.tst instanceof i))throw"tst param shall be ASN1Object or hex string"}},ee.lang.extend(Qe.asn1.cades.SignatureTimeStamp,Qe.asn1.cms.Attribute),Qe.asn1.cades.CompleteCertificateRefs=function(t){var e=Qe.asn1.cades;e.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(t){this.valueList=[];for(var i=0;i<t.length;i++){var n=new e.OtherCertID(t[i]);this.valueList.push(n)}},void 0!==t&&"object"==typeof t&&"number"==typeof t.length&&this.setByArray(t)},ee.lang.extend(Qe.asn1.cades.CompleteCertificateRefs,Qe.asn1.cms.Attribute),Qe.asn1.cades.OtherCertID=function(t){var e=Qe.asn1,i=e.cms,n=e.cades;n.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(t){this.dOtherCertHash=new n.OtherHash(t),this.hasIssuerSerial&&(this.dIssuerSerial=new i.IssuerAndSerialNumber(t))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV;if(null==this.dOtherCertHash)throw"otherCertHash not set";var t=[this.dOtherCertHash];null!=this.dIssuerSerial&&t.push(this.dIssuerSerial);var i=new e.DERSequence({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),"object"==typeof t&&(!1===t.hasis&&(this.hasIssuerSerial=!1),"string"==typeof t.cert&&this.setByCertPEM(t.cert)))},ee.lang.extend(Qe.asn1.cades.OtherCertID,Qe.asn1.ASN1Object),Qe.asn1.cades.OtherHash=function(t){var e=Qe,i=e.asn1,n=(i.cms,i.cades),r=n.OtherHashAlgAndValue,s=e.crypto.Util.hashHex;if(n.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(t){if(-1==t.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var e=gi(t),i=s(e,this.alg);this.dOtherHash=new r({alg:this.alg,hash:i})},this.getEncodedHex=function(){if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==t)if("string"==typeof t)if(-1!=t.indexOf("-----BEGIN "))this.setByCertPEM(t);else{if(!t.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new i.DEROctetString({hex:t})}else"object"==typeof t&&("string"==typeof t.cert?("string"==typeof t.alg&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new r(t))},ee.lang.extend(Qe.asn1.cades.OtherHash,Qe.asn1.ASN1Object),Qe.asn1.cades.CAdESUtil=new function(){},Qe.asn1.cades.CAdESUtil.addSigTS=function(t,e,i){},Qe.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){var e=ii,i=e.getChildIdx,n=e.getTLV,r=e.getTLVbyList,s=e.getIdxbyList,o=Qe.asn1,a=o.ASN1Object,u=o.cms.SignedData,h=o.cades.CAdESUtil,c={};if("06092a864886f70d010702"!=r(t,0,[0]))throw"hex is not CMS SignedData";var f=i(t,s(t,0,[1,0]));if(f.length<4)throw"num of SignedData elem shall be 4 at least";var l=f.shift();c.version=n(t,l);var d=f.shift();c.algs=n(t,d);var p=f.shift();c.encapcontent=n(t,p),c.certs=null,c.revs=null,c.si=[];var g=f.shift();"a0"==t.substr(g,2)&&(c.certs=n(t,g),g=f.shift()),"a1"==t.substr(g,2)&&(c.revs=n(t,g),g=f.shift());var v=g;if("31"!=t.substr(v,2))throw"Can't find signerInfos";for(var y=i(t,v),m=0;m<y.length;m++){var b=y[m],S=h.parseSignerInfoForAddingUnsigned(t,b,m);c.si[m]=S}var w=null;c.obj=new u,(w=new a).hTLV=c.version,c.obj.dCMSVersion=w,(w=new a).hTLV=c.algs,c.obj.dDigestAlgs=w,(w=new a).hTLV=c.encapcontent,c.obj.dEncapContentInfo=w,(w=new a).hTLV=c.certs,c.obj.dCerts=w,c.obj.signerInfoList=[];for(m=0;m<c.si.length;m++)c.obj.signerInfoList.push(c.si[m].obj);return c},Qe.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,i){var n=ii,r=n.getChildIdx,s=n.getTLV,o=n.getV,a=Qe.asn1,u=a.ASN1Object,h=a.cms,c=h.AttributeList,f=h.SignerInfo,l={},d=r(t,e);if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();l.version=s(t,p);var g=d.shift();l.si=s(t,g);var v=d.shift();l.digalg=s(t,v);var y=d.shift();l.sattrs=s(t,y);var m=d.shift();l.sigalg=s(t,m);var b=d.shift();l.sig=s(t,b),l.sigval=o(t,b);var S=null;return l.obj=new f,(S=new u).hTLV=l.version,l.obj.dCMSVersion=S,(S=new u).hTLV=l.si,l.obj.dSignerIdentifier=S,(S=new u).hTLV=l.digalg,l.obj.dDigestAlgorithm=S,(S=new u).hTLV=l.sattrs,l.obj.dSignedAttrs=S,(S=new u).hTLV=l.sigalg,l.obj.dSigAlg=S,(S=new u).hTLV=l.sig,l.obj.dSig=S,l.obj.dUnsignedAttrs=new c,l},void 0!==Qe.asn1.csr&&Qe.asn1.csr||(Qe.asn1.csr={}),Qe.asn1.csr.CertificationRequest=function(t){var e=Qe,i=e.asn1,n=i.DERBitString,r=i.DERSequence,s=i.csr,o=i.x509;s.CertificationRequest.superclass.constructor.call(this),this.sign=function(t,i){null==this.prvKey&&(this.prvKey=i),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:t}),sig=new e.crypto.Signature({alg:t}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new n({hex:"00"+this.hexSig});var s=new r({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=s.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return pi(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==t&&void 0!==t.csrinfo&&(this.asn1CSRInfo=t.csrinfo)},ee.lang.extend(Qe.asn1.csr.CertificationRequest,Qe.asn1.ASN1Object),Qe.asn1.csr.CertificationRequestInfo=function(t){var e=Qe.asn1,i=e.DERInteger,n=e.DERSequence,r=e.DERSet,s=e.DERNull,o=e.DERTaggedObject,a=e.DERObjectIdentifier,u=e.csr,h=e.x509,c=h.X500Name,f=h.Extension,l=xi;u.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new i({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(t){this.asn1Subject=new c(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=l.getKey(t);this.asn1SubjPKey=new h.SubjectPublicKeyInfo(e)},this.appendExtensionByName=function(t,e){f.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var t=new n({array:this.extensionsArray}),e=new r({array:[t]}),i=new n({array:[new a({oid:"1.2.840.113549.1.9.14"}),e]}),u=new o({explicit:!0,tag:"a0",obj:i});this.asn1Array.push(u)}else{u=new o({explicit:!1,tag:"a0",obj:new s});this.asn1Array.push(u)}var h=new n({array:this.asn1Array});return this.hTLV=h.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ee.lang.extend(Qe.asn1.csr.CertificationRequestInfo,Qe.asn1.ASN1Object),Qe.asn1.csr.CSRUtil=new function(){},Qe.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=xi,i=Qe.asn1.csr;if(void 0===t.subject)throw"parameter subject undefined";if(void 0===t.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===t.sigalg)throw"parameter sigalg undefined";if(void 0===t.sbjprvkey)throw"parameter sbjpubkey undefined";var n=new i.CertificationRequestInfo;if(n.setSubjectByParam(t.subject),n.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var r=0;r<t.ext.length;r++)for(key in t.ext[r])n.appendExtensionByName(key,t.ext[r][key]);var s=new i.CertificationRequest({csrinfo:n}),o=e.getKey(t.sbjprvkey);return s.sign(t.sigalg,o),s.getPEMString()},Qe.asn1.csr.CSRUtil.getInfo=function(t){var e=ii.getTLVbyList,i={subject:{},pubkey:{}};if(-1==t.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var n=gi(t,"CERTIFICATE REQUEST");return i.subject.hex=e(n,0,[0,1]),i.subject.name=Ci.hex2dn(i.subject.hex),i.pubkey.hex=e(n,0,[0,2]),i.pubkey.obj=xi.getKey(i.pubkey.hex,null,"pkcs8pub"),i},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.ocsp&&Qe.asn1.ocsp||(Qe.asn1.ocsp={}),Qe.asn1.ocsp.DEFAULT_HASH="sha1",Qe.asn1.ocsp.CertID=function(t){var e=Qe,i=e.asn1,n=i.DEROctetString,r=i.DERInteger,s=i.DERSequence,o=i.x509.AlgorithmIdentifier,a=i.ocsp,u=a.DEFAULT_HASH,h=e.crypto.Util.hashHex,c=Ci,f=ii;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(t,e,i,s){void 0===s&&(s=u),this.dHashAlg=new o({name:s}),this.dIssuerNameHash=new n({hex:t}),this.dIssuerKeyHash=new n({hex:e}),this.dSerialNumber=new r({hex:i})},this.setByCert=function(t,e,i){void 0===i&&(i=u);var n=new c;n.readCertPEM(e);var r=new c;r.readCertPEM(t);var s=r.getPublicKeyHex(),o=f.getTLVbyList(s,0,[1,0],"30"),a=n.getSerialNumberHex(),l=h(r.getSubjectHex(),i),d=h(o,i);this.setByValue(l,d,a,i),this.hoge=n.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var t=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],e=new s({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var l=t;if(void 0!==l.issuerCert&&void 0!==l.subjectCert){var d=u;void 0===l.alg&&(d=void 0),this.setByCert(l.issuerCert,l.subjectCert,d)}else{if(void 0===l.namehash||void 0===l.keyhash||void 0===l.serial)throw"invalid constructor arguments";d=u;void 0===l.alg&&(d=void 0),this.setByValue(l.namehash,l.keyhash,l.serial,d)}}},ee.lang.extend(Qe.asn1.ocsp.CertID,Qe.asn1.ASN1Object),Qe.asn1.ocsp.Request=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.ocsp;if(n.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var t=[];if(null===this.dReqCert)throw"reqCert not set";t.push(this.dReqCert);var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var r=new n.CertID(t);this.dReqCert=r}},ee.lang.extend(Qe.asn1.ocsp.Request,Qe.asn1.ASN1Object),Qe.asn1.ocsp.TBSRequest=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.ocsp;n.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(t){for(var e=[],i=0;i<t.length;i++){var r=new n.Request(t[0]);e.push(r)}this.dRequestList=e},this.getEncodedHex=function(){var t=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var e=new i({array:this.dRequestList});if(t.push(e),null!==this.dRequestExt)throw"requestExtensions not supported";var n=new i({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList&&this.setRequestListByParam(t.reqList)},ee.lang.extend(Qe.asn1.ocsp.TBSRequest,Qe.asn1.ASN1Object),Qe.asn1.ocsp.OCSPRequest=function(t){var e=Qe.asn1,i=e.DERSequence,n=e.ocsp;if(n.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var t=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(t.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var e=new i({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList){var r=new n.TBSRequest(t);this.dTbsRequest=r}},ee.lang.extend(Qe.asn1.ocsp.OCSPRequest,Qe.asn1.ASN1Object),Qe.asn1.ocsp.OCSPUtil={},Qe.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,i){var n=Qe.asn1.ocsp;void 0===i&&(i=n.DEFAULT_HASH);var r={alg:i,issuerCert:t,subjectCert:e};return new n.OCSPRequest({reqList:[r]}).getEncodedHex()},Qe.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){var e=ii,i=e.getVbyList,n=e.getIdxbyList,r=(i=e.getVbyList,e.getV),s={};try{var o=i(t,0,[0],"0a");s.responseStatus=parseInt(o,16)}catch(t){}if(0!==s.responseStatus)return s;try{var a=n(t,0,[1,0,1,0,0,2,0,1]);"80"===t.substr(a,2)?s.certStatus="good":"a1"===t.substr(a,2)?(s.certStatus="revoked",s.revocationTime=ci(i(t,a,[0]))):"82"===t.substr(a,2)&&(s.certStatus="unknown")}catch(t){}try{var u=n(t,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=ci(r(t,u))}catch(t){}try{var h=n(t,0,[1,0,1,0,0,2,0,3]);"a0"===t.substr(h,2)&&(s.nextUpdate=ci(i(t,h,[0])))}catch(t){}return s},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.lang&&Qe.lang||(Qe.lang={}),Qe.lang.String=function(){},ti=function(t){return si(new vt(t,"utf8").toString("base64"))},ei=function(t){return new vt(oi(t),"base64").toString("utf8")},Qe.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},Qe.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},Qe.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},Qe.lang.String.isBase64URL=function(t){return!t.match(/[+\/=]/)&&(t=oi(t),Qe.lang.String.isBase64(t))},Qe.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:oe.algo.MD5,sha1:oe.algo.SHA1,sha224:oe.algo.SHA224,sha256:oe.algo.SHA256,sha384:oe.algo.SHA384,sha512:oe.algo.SHA512,ripemd160:oe.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,i){var n=this.getDigestInfoHex(t,e),r=i/4;if(n.length+22>r)throw"key is too short for SigAlg: keylen="+i+","+e;for(var s="0001",o="00"+n,a="",u=r-s.length-o.length,h=0;h<u;h+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new Qe.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new Qe.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new Qe.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new Qe.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new Qe.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new Qe.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new Qe.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},Qe.crypto.Util.md5=function(t){return new Qe.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},Qe.crypto.Util.ripemd160=function(t){return new Qe.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},Qe.crypto.Util.SECURERANDOMGEN=new qe,Qe.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return Qe.crypto.Util.SECURERANDOMGEN.nextBytes(e),ni(e)},Qe.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new fe(Qe.crypto.Util.getRandomHexOfNbytes(t),16)},Qe.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,i=new Array((t-e)/8+1);return Qe.crypto.Util.SECURERANDOMGEN.nextBytes(i),i[0]=(255<<e&255^255)&i[0],ni(i)},Qe.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new fe(Qe.crypto.Util.getRandomHexOfNbits(t),16)},Qe.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var i=Qe.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(i))return i}},Qe.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var i=t.compareTo(e);if(1==i)throw"biMin is greater than biMax";if(0==i)return t;var n=e.subtract(t);return Qe.crypto.Util.getRandomBigIntegerZeroToMax(n).add(t)},Qe.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=Qe.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=Qe.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=Qe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=oe.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(oe.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},Qe.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},Qe.crypto.MessageDigest.getHashLength=function(t){var e=Qe.crypto.MessageDigest,i=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[i])throw"not supported algorithm: "+t;return e.HASHLENGTH[i]},Qe.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},Qe.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=Qe.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var i=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(i)&&"cryptojs"==e){try{var n=Qe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[i];this.mac=oe.algo.HMAC.create(n,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+i+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=oe.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(oe.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=li(t)),void(this.pass=oe.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=hi(t.utf8)),void 0!==t.rstr&&(e=li(t.rstr)),void 0!==t.b64&&(e=ce(t.b64)),void 0!==t.b64u&&(e=ui(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=oe.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},Qe.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var i="",n=e/4-t.length,r=0;r<n;r++)i+="0";return i+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new Qe.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var i=null;try{i=void 0===e?xi.getKey(t):xi.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===i.isPrivate)this.prvKey=i,this.state="SIGN";else{if(!0!==i.isPublic)throw"init failed.:"+i;this.pubKey=i,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new Qe.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Ge&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof Qe.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof Qe.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new Qe.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Ge&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==Qe.crypto.ECDSA&&this.pubKey instanceof Qe.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==Qe.crypto.DSA&&this.pubKey instanceof Qe.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=xi.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},Qe.crypto.Cipher=function(t){},Qe.crypto.Cipher.encrypt=function(t,e,i){if(e instanceof Ge&&e.isPublic){var n=Qe.crypto.Cipher.getAlgByKeyAndName(e,i);if("RSA"===n)return e.encrypt(t);if("RSAOAEP"===n)return e.encryptOAEP(t,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.encryptOAEP(t,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+i}throw"Cipher.encrypt: unsupported key or algorithm"},Qe.crypto.Cipher.decrypt=function(t,e,i){if(e instanceof Ge&&e.isPrivate){var n=Qe.crypto.Cipher.getAlgByKeyAndName(e,i);if("RSA"===n)return e.decrypt(t);if("RSAOAEP"===n)return e.decryptOAEP(t,"sha1");var r=n.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.decryptOAEP(t,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+i}throw"Cipher.decrypt: unsupported key or algorithm"},Qe.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof Ge){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},Qe.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.ECDSA=function(t){var e=new qe;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new fe(t.bitLength(),e).mod(t.subtract(fe.ONE)).add(fe.ONE)},this.setNamedCurve=function(t){this.ecparams=Qe.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var i={};return i.x=t.substr(2,e),i.y=t.substr(2+e),i},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),i=this.ecparams.G.multiply(e),n=i.getX().toBigInteger(),r=i.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+n.toString(16)).slice(-s)+("0000000000"+r.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var i=new fe(e,16),n=this.ecparams.n,r=new fe(t,16);do{var s=this.getBigRandom(n),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(n)}while(o.compareTo(fe.ZERO)<=0);var a=s.modInverse(n).multiply(r.add(i.multiply(o))).mod(n);return Qe.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var i=e,n=this.ecparams.n,r=fe.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(n),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(n)}while(o.compareTo(fe.ZERO)<=0);var a=s.modInverse(n).multiply(r.add(i.multiply(o))).mod(n);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,i){var n,r,s,o=Qe.crypto.ECDSA.parseSigHex(e);n=o.r,r=o.s,s=Ye.decodeFromHex(this.ecparams.curve,i);var a=new fe(t,16);return this.verifyRaw(a,n,r,s)},this.verify=function(t,e,i){var n,r,s;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);n=o.r,r=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";n=e.r,r=e.s}if(i instanceof Ye)s=i;else{if(!Bitcoin.Util.isArray(i))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=Ye.decodeFrom(this.ecparams.curve,i)}var a=fe.fromByteArrayUnsigned(t);return this.verifyRaw(a,n,r,s)},this.verifyRaw=function(t,e,i,n){var r=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(fe.ONE)<0||e.compareTo(r)>=0)return!1;if(i.compareTo(fe.ONE)<0||i.compareTo(r)>=0)return!1;var o=i.modInverse(r),a=t.multiply(o).mod(r),u=e.multiply(o).mod(r);return s.multiply(a).add(n.multiply(u)).getX().toBigInteger().mod(r).equals(e)},this.serializeSig=function(t,e){var i=t.toByteArraySigned(),n=e.toByteArraySigned(),r=[];return r.push(2),r.push(i.length),(r=r.concat(i)).push(2),r.push(n.length),(r=r.concat(n)).unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:fe.fromByteArrayUnsigned(i),s:fe.fromByteArrayUnsigned(n)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var i=this.ecparams.n;return{r:fe.fromByteArrayUnsigned(t.slice(1,33)).mod(i),s:fe.fromByteArrayUnsigned(t.slice(33,65)).mod(i),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,i,n,r=ii,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),i=o(t,0,[1],"04");try{n=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,i,n,r=ii,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),i=o(t,0,[2,0,1],"04");try{n=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n),this.setPrivateKeyHex(i),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,i,n=ii,r=Qe.crypto.ECDSA.getName,s=n.getVbyList;if(!1===n.isASN1HEX(t))throw"not ASN.1 hex string";try{s(t,0,[0,0],"06"),e=s(t,0,[0,1],"06"),i=s(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var i,n,r=ii,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{i=o(t,0,[0,e,0,1],"06"),n=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(i),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},Qe.crypto.ECDSA.parseSigHex=function(t){var e=Qe.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new fe(e.r,16),s:new fe(e.s,16)}},Qe.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=ii,i=e.getChildIdx,n=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var r=i(t,0);if(2!=r.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=r[0],o=r[1];if("02"!=t.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:n(t,s),s:n(t,o)}},Qe.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=Qe.crypto.ECDSA.parseSigHexInHexRS(t),i=e.r,n=e.s;if("00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),"00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),i.length%32==30&&(i="00"+i),n.length%32==30&&(n="00"+n),i.length%32!=0)throw"unknown ECDSA sig r length error";if(n.length%32!=0)throw"unknown ECDSA sig s length error";return i+n},Qe.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),i=t.substr(t.length/2);return Qe.crypto.ECDSA.hexRSSigToASN1Sig(e,i)},Qe.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var i=new fe(t,16),n=new fe(e,16);return Qe.crypto.ECDSA.biRSSigToASN1Sig(i,n)},Qe.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var i=Qe.asn1,n=new i.DERInteger({bigint:t}),r=new i.DERInteger({bigint:e});return new i.DERSequence({array:[n,r]}).getEncodedHex()},Qe.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.ECParameterDB=new function(){var t={},e={};function i(t){return new fe(t,16)}this.getByName=function(i){var n=i;if(void 0!==e[n]&&(n=e[i]),void 0!==t[n])return t[n];throw"unregistered EC curve name: "+n},this.regist=function(n,r,s,o,a,u,h,c,f,l,d,p){t[n]={};var g=i(s),v=i(o),y=i(a),m=i(u),b=i(h),S=new Xe(g,v,y),w=S.decodePointHex("04"+c+f);t[n].name=n,t[n].keylen=r,t[n].curve=S,t[n].G=w,t[n].n=m,t[n].h=b,t[n].oid=d,t[n].info=p;for(var x=0;x<l.length;x++)e[l[x]]=n}},Qe.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),Qe.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),Qe.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),Qe.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),Qe.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),Qe.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),Qe.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),Qe.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),Qe.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),Qe.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,i,n,r){this.isPrivate=!0,this.p=t,this.q=e,this.g=i,this.y=n,this.x=r},this.setPrivateHex=function(t,e,i,n,r){var s,o,a,u,h;s=new fe(t,16),o=new fe(e,16),a=new fe(i,16),u="string"==typeof n&&n.length>1?new fe(n,16):null,h=new fe(r,16),this.setPrivate(s,o,a,u,h)},this.setPublic=function(t,e,i,n){this.isPublic=!0,this.p=t,this.q=e,this.g=i,this.y=n,this.x=null},this.setPublicHex=function(t,e,i,n){var r,s,o,a;r=new fe(t,16),s=new fe(e,16),o=new fe(i,16),a=new fe(n,16),this.setPublic(r,s,o,a)},this.signWithMessageHash=function(t){var e=this.p,i=this.q,n=this.g,r=(this.y,this.x),s=Qe.crypto.Util.getRandomBigIntegerMinToMax(fe.ONE.add(fe.ONE),i.subtract(fe.ONE)),o=new fe(t.substr(0,i.bitLength()/4),16),a=n.modPow(s,e).mod(i),u=s.modInverse(i).multiply(o.add(r.multiply(a))).mod(i);return Qe.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(t,e){var i=this.p,n=this.q,r=this.g,s=this.y,o=this.parseASN1Signature(e),a=o[0],u=o[1],h=new fe(t.substr(0,n.bitLength()/4),16);if(fe.ZERO.compareTo(a)>0||a.compareTo(n)>0)throw"invalid DSA signature";if(fe.ZERO.compareTo(u)>=0||u.compareTo(n)>0)throw"invalid DSA signature";var c=u.modInverse(n),f=h.multiply(c).mod(n),l=a.multiply(c).mod(n);return 0==r.modPow(f,i).multiply(s.modPow(l,i)).mod(i).mod(n).compareTo(a)},this.parseASN1Signature=function(t){try{return[new fe(ii.getVbyList(t,0,[0],"02"),16),new fe(ii.getVbyList(t,0,[1],"02"),16)]}catch(t){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(t){var e,i,n,r,s,o=ii,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{e=a(t,0,[1],"02"),i=a(t,0,[2],"02"),n=a(t,0,[3],"02"),r=a(t,0,[4],"02"),s=a(t,0,[5],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(e,i,n,r,s)},this.readPKCS8PrvKeyHex=function(t){var e,i,n,r,s=ii,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[1,1,0],"02"),i=o(t,0,[1,1,1],"02"),n=o(t,0,[1,1,2],"02"),r=o(t,0,[2,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(e,i,n,null,r)},this.readPKCS8PubKeyHex=function(t){var e,i,n,r,s=ii,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[0,1,0],"02"),i=o(t,0,[0,1,1],"02"),n=o(t,0,[0,1,2],"02"),r=o(t,0,[1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 DSA public key"}this.setPublicHex(e,i,n,r)},this.readCertPubKeyHex=function(t,e){var i,n,r,s;5!==e&&(e=6);var o=ii,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{i=a(t,0,[0,e,0,1,0],"02"),n=a(t,0,[0,e,0,1,1],"02"),r=a(t,0,[0,e,0,1,2],"02"),s=a(t,0,[0,e,1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed X.509 certificate DSA public key"}this.setPublicHex(i,n,r,s)}};var xi=function(){var t=function(t,i,n){return e(oe.AES,t,i,n)},e=function(t,e,i,n){var r=oe.enc.Hex.parse(e),s=oe.enc.Hex.parse(i),o=oe.enc.Hex.parse(n),a={};a.key=s,a.iv=o,a.ciphertext=r;var u=t.decrypt(a,s,{iv:o});return oe.enc.Hex.stringify(u)},i=function(t,e,i){return n(oe.AES,t,e,i)},n=function(t,e,i,n){var r=oe.enc.Hex.parse(e),s=oe.enc.Hex.parse(i),o=oe.enc.Hex.parse(n),a=t.encrypt(r,s,{iv:o}),u=oe.enc.Hex.parse(a.toString());return oe.enc.Base64.stringify(u)},r={"AES-256-CBC":{proc:t,eproc:i,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:i,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:i,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,i,n){return e(oe.TripleDES,t,i,n)},eproc:function(t,e,i){return n(oe.TripleDES,t,e,i)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,i,n){return e(oe.DES,t,i,n)},eproc:function(t,e,i){return n(oe.DES,t,e,i)},keylen:8,ivlen:8}},s=function(t){var e={},i=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));i&&(e.cipher=i[1],e.ivsalt=i[2]);var n=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));n&&(e.type=n[1]);var r=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(r=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(r=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=r&&-1!=o){var a=t.substring(r+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,i){for(var n=i.substring(0,16),s=oe.enc.Hex.parse(n),o=oe.enc.Utf8.parse(e),a=r[t].keylen+r[t].ivlen,u="",h=null;;){var c=oe.algo.MD5.create();if(null!=h&&c.update(h),c.update(o),c.update(s),h=c.finalize(),(u+=oe.enc.Hex.stringify(h)).length>=2*a)break}var f={};return f.keyhex=u.substr(0,2*r[t].keylen),f.ivhex=u.substr(2*r[t].keylen,2*r[t].ivlen),f},a=function(t,e,i,n){var s=oe.enc.Base64.parse(t),o=oe.enc.Hex.stringify(s);return(0,r[e].proc)(o,i,n)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,i){return o(t,e,i)},decryptKeyB64:function(t,e,i,n){return a(t,e,i,n)},getDecryptedKeyHex:function(t,e){var i=s(t),n=i.cipher,r=i.ivsalt,u=i.data,h=o(n,e,r).keyhex;return a(u,n,h,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,i,n,s){var a="";if(void 0!==n&&null!=n||(n="AES-256-CBC"),void 0===r[n])throw"KEYUTIL unsupported algorithm: "+n;void 0!==s&&null!=s||(s=function(t){var e=oe.lib.WordArray.random(t);return oe.enc.Hex.stringify(e)}(r[n].ivlen).toUpperCase());var u=function(t,e,i,n){return(0,r[e].eproc)(t,i,n)}(e,n,o(n,i,s).keyhex,s);a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+n+","+s+"\r\n",a+="\r\n",a+=u.replace(/(.{64})/g,"$1\r\n"),a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=ii,i=e.getChildIdx,n=e.getV,r={},s=i(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;r.ciphertext=n(t,s[1]);var o=i(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=n(t,o[0]))throw"this only supports pkcs5PBES2";var a=i(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=i(t,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=n(t,u[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=n(t,u[1]);var h=i(t,a[0]);if(2!=h.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+h.length;if("2a864886f70d01050c"!=n(t,h[0]))throw"this only supports pkcs5PBKDF2";var c=i(t,h[1]);if(c.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length;r.pbkdf2Salt=n(t,c[0]);var f=n(t,c[1]);try{r.pbkdf2Iter=parseInt(f,16)}catch(t){throw"malformed format pbkdf2Iter: "+f}return r},getPBKDF2KeyHexFromParam:function(t,e){var i=oe.enc.Hex.parse(t.pbkdf2Salt),n=t.pbkdf2Iter,r=oe.PBKDF2(e,i,{keySize:6,iterations:n});return oe.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var i=gi(t,"ENCRYPTED PRIVATE KEY"),n=this.parseHexOfEncryptedPKCS8(i),r=xi.getPBKDF2KeyHexFromParam(n,e),s={};s.ciphertext=oe.enc.Hex.parse(n.ciphertext);var o=oe.enc.Hex.parse(r),a=oe.enc.Hex.parse(n.encryptionSchemeIV),u=oe.TripleDES.decrypt(s,o,{iv:a});return oe.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(t,e){var i=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(i)},parsePlainPrivatePKCS8Hex:function(t){var e=ii,i=e.getChildIdx,n=e.getV,r={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=i(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=i(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(r.algoid=n(t,o[0]),"06"==t.substr(o[1],2)&&(r.algparam=n(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return r.keyidx=e.getVidx(t,s[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=gi(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,i=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==i.algoid)e=new Ge;else if("2a8648ce380401"==i.algoid)e=new Qe.crypto.DSA;else{if("2a8648ce3d0201"!=i.algoid)throw"unsupported private key algorithm";e=new Qe.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,i=ii.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===i)e=new Ge;else if("2a8648ce380401"===i)e=new Qe.crypto.DSA;else{if("2a8648ce3d0201"!==i)throw"unsupported PKCS#8 public key hex";e=new Qe.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=ii,i=e.getChildIdx,n=e.getV,r={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=i(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(r.n=n(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return r.e=n(t,s[1]),r},parsePublicPKCS8Hex:function(t){var e=ii,i=e.getChildIdx,n=e.getV,r={algparam:null},s=i(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=i(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(r.algoid=n(t,a[0]),"06"==t.substr(a[1],2)?r.algparam=n(t,a[1]):"30"==t.substr(a[1],2)&&(r.algparam={},r.algparam.p=e.getVbyList(t,a[1],[0],"02"),r.algparam.q=e.getVbyList(t,a[1],[1],"02"),r.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return r.key=n(t,s[1]).substr(2),r}}}();xi.getKey=function(t,e,i){var n=(v=ii).getChildIdx,r=(v.getV,v.getVbyList),s=Qe.crypto,o=s.ECDSA,a=s.DSA,u=Ge,h=gi,c=xi;if(void 0!==u&&t instanceof u)return t;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new u).setPublic(t.n,t.e),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(C=new u).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(C=new u).setPrivate(t.n,t.e,t.d),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(C=new a).setPublic(t.p,t.q,t.g,t.y),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(C=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new u).setPublic(ui(t.n),ui(t.e)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(C=new u).setPrivateEx(ui(t.n),ui(t.e),ui(t.d),ui(t.p),ui(t.q),ui(t.dp),ui(t.dq),ui(t.qi)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(C=new u).setPrivate(ui(t.n),ui(t.e),ui(t.d)),C;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var f=(D=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+ui(t.x)).slice(-f)+("0000000000"+ui(t.y)).slice(-f);return D.setPublicKeyHex(l),D}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){f=(D=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+ui(t.x)).slice(-f)+("0000000000"+ui(t.y)).slice(-f);var d=("0000000000"+ui(t.d)).slice(-f);return D.setPublicKeyHex(l),D.setPrivateKeyHex(d),D}if("pkcs5prv"===i){var p,g=t,v=ii;if(9===(p=n(g,0)).length)(C=new u).readPKCS5PrvKeyHex(g);else if(6===p.length)(C=new a).readPKCS5PrvKeyHex(g);else{if(!(p.length>2&&"04"===g.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(C=new o).readPKCS5PrvKeyHex(g)}return C}if("pkcs8prv"===i)return C=c.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===i)return c._getKeyFromPublicPKCS8Hex(t);if("x509pub"===i)return Ci.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return Ci.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var y=gi(t,"PUBLIC KEY");return c._getKeyFromPublicPKCS8Hex(y)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var m=h(t,"RSA PRIVATE KEY");return c.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var b=r(P=h(t,"DSA PRIVATE KEY"),0,[1],"02"),S=r(P,0,[2],"02"),w=r(P,0,[3],"02"),x=r(P,0,[4],"02"),F=r(P,0,[5],"02");return(C=new a).setPrivate(new fe(b,16),new fe(S,16),new fe(w,16),new fe(x,16),new fe(F,16)),C}if(-1!=t.indexOf("-END PRIVATE KEY-"))return c.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var E=c.getDecryptedKeyHex(t,e),A=new Ge;return A.readPKCS5PrvKeyHex(E),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var D,C=r(P=c.getDecryptedKeyHex(t,e),0,[1],"04"),I=r(P,0,[2,0],"06"),T=r(P,0,[3,0],"03").substr(2);if(void 0===Qe.crypto.OID.oidhex2name[I])throw"undefined OID(hex) in KJUR.crypto.OID: "+I;return(D=new o({curve:Qe.crypto.OID.oidhex2name[I]})).setPublicKeyHex(T),D.setPrivateKeyHex(C),D.isPublic=!1,D}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var P;b=r(P=c.getDecryptedKeyHex(t,e),0,[1],"02"),S=r(P,0,[2],"02"),w=r(P,0,[3],"02"),x=r(P,0,[4],"02"),F=r(P,0,[5],"02");return(C=new a).setPrivate(new fe(b,16),new fe(S,16),new fe(w,16),new fe(x,16),new fe(F,16)),C}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return c.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},xi.generateKeypair=function(t,e){if("RSA"==t){var i=e;(o=new Ge).generate(i,"10001"),o.isPrivate=!0,o.isPublic=!0;var n=new Ge,r=o.n.toString(16),s=o.e.toString(16);return n.setPublic(r,s),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=n,a}if("EC"==t){var o,a,u=e,h=new Qe.crypto.ECDSA({curve:u}).generateKeyPairHex();return(o=new Qe.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),o.setPrivateKeyHex(h.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(n=new Qe.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),n.isPrivate=!1,n.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=n,a}throw"unknown algorithm: "+t},xi.getPEM=function(t,e,i,n,r,s){var o=Qe,a=o.asn1,u=a.DERObjectIdentifier,h=a.DERInteger,c=a.ASN1Util.newObject,f=a.x509.SubjectPublicKeyInfo,l=o.crypto,d=l.DSA,p=l.ECDSA,g=Ge;function v(t){return c({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function y(t){return c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function m(t){return c({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==g&&t instanceof g||void 0!==d&&t instanceof d||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return pi(x=new f(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===i||null==i)&&1==t.isPrivate)return pi(x=v(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===i||null==i)&&1==t.isPrivate){var b=new u({name:t.curveName}).getEncodedHex(),S=y(t).getEncodedHex(),w="";return w+=pi(b,"EC PARAMETERS"),w+=pi(S,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==d&&t instanceof d&&(void 0===i||null==i)&&1==t.isPrivate)return pi(x=m(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==i&&null!=i&&1==t.isPrivate){var x=v(t).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,i,n,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==i&&null!=i&&1==t.isPrivate){x=y(t).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",x,i,n,s)}if("PKCS5PRV"==e&&void 0!==d&&t instanceof d&&void 0!==i&&null!=i&&1==t.isPrivate){x=m(t).getEncodedHex();return void 0===n&&(n="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",x,i,n,s)}var F=function(t,e){var i=E(t,e);return new c({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:i.pbkdf2Salt}},{int:i.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:i.encryptionSchemeIV}}]}]}]},{octstr:{hex:i.ciphertext}}]}).getEncodedHex()},E=function(t,e){var i=oe.lib.WordArray.random(8),n=oe.lib.WordArray.random(8),r=oe.PBKDF2(e,i,{keySize:6,iterations:100}),s=oe.enc.Hex.parse(t),o=oe.TripleDES.encrypt(s,r,{iv:n})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=oe.enc.Hex.stringify(i),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=oe.enc.Hex.stringify(n),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){var A=v(t).getEncodedHex();x=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===i||null==i?pi(x,"PRIVATE KEY"):pi(S=F(x,i),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){A=new c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===i||null==i?pi(x,"PRIVATE KEY"):pi(S=F(x,i),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==d&&t instanceof d&&1==t.isPrivate){A=new h({bigint:t.x}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===i||null==i?pi(x,"PRIVATE KEY"):pi(S=F(x,i),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},xi.getKeyFromCSRPEM=function(t){var e=gi(t,"CERTIFICATE REQUEST");return xi.getKeyFromCSRHex(e)},xi.getKeyFromCSRHex=function(t){var e=xi.parseCSRHex(t);return xi.getKey(e.p8pubkeyhex,null,"pkcs8pub")},xi.parseCSRHex=function(t){var e=ii,i=e.getChildIdx,n=e.getTLV,r={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=i(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=i(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=n(s,a[2]),r},xi.getJWKFromKey=function(t){var e={};if(t instanceof Ge&&t.isPrivate)return e.kty="RSA",e.n=ai(t.n.toString(16)),e.e=ai(t.e.toString(16)),e.d=ai(t.d.toString(16)),e.p=ai(t.p.toString(16)),e.q=ai(t.q.toString(16)),e.dp=ai(t.dmp1.toString(16)),e.dq=ai(t.dmq1.toString(16)),e.qi=ai(t.coeff.toString(16)),e;if(t instanceof Ge&&t.isPublic)return e.kty="RSA",e.n=ai(t.n.toString(16)),e.e=ai(t.e.toString(16)),e;if(t instanceof Qe.crypto.ECDSA&&t.isPrivate){if("P-256"!==(n=t.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;var i=t.getPublicKeyXYHex();return e.kty="EC",e.crv=n,e.x=ai(i.x),e.y=ai(i.y),e.d=ai(t.prvKeyHex),e}if(t instanceof Qe.crypto.ECDSA&&t.isPublic){var n;if("P-256"!==(n=t.getShortNISTPCurveName())&&"P-384"!==n)throw"unsupported curve name for JWT: "+n;i=t.getPublicKeyXYHex();return e.kty="EC",e.crv=n,e.x=ai(i.x),e.y=ai(i.y),e}throw"not supported key object"},Ge.getPosArrayOfChildrenFromHex=function(t){return ii.getChildIdx(t,0)},Ge.getHexValueArrayOfChildrenFromHex=function(t){var e,i=ii.getV,n=i(t,(e=Ge.getPosArrayOfChildrenFromHex(t))[0]),r=i(t,e[1]),s=i(t,e[2]),o=i(t,e[3]),a=i(t,e[4]),u=i(t,e[5]),h=i(t,e[6]),c=i(t,e[7]),f=i(t,e[8]);return(e=new Array).push(n,r,s,o,a,u,h,c,f),e},Ge.prototype.readPrivateKeyFromPEMString=function(t){var e=gi(t),i=Ge.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(i[1],i[2],i[3],i[4],i[5],i[6],i[7],i[8])},Ge.prototype.readPKCS5PrvKeyHex=function(t){var e=Ge.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Ge.prototype.readPKCS8PrvKeyHex=function(t){var e,i,n,r,s,o,a,u,h=ii,c=h.getVbyList;if(!1===h.isASN1HEX(t))throw"not ASN.1 hex string";try{e=c(t,0,[2,0,1],"02"),i=c(t,0,[2,0,2],"02"),n=c(t,0,[2,0,3],"02"),r=c(t,0,[2,0,4],"02"),s=c(t,0,[2,0,5],"02"),o=c(t,0,[2,0,6],"02"),a=c(t,0,[2,0,7],"02"),u=c(t,0,[2,0,8],"02")}catch(t){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,i,n,r,s,o,a,u)},Ge.prototype.readPKCS5PubKeyHex=function(t){var e=ii,i=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var n=e.getChildIdx(t,0);if(2!==n.length||"02"!==t.substr(n[0],2)||"02"!==t.substr(n[1],2))throw"wrong hex for PKCS#5 public key";var r=i(t,n[0]),s=i(t,n[1]);this.setPublic(r,s)},Ge.prototype.readPKCS8PubKeyHex=function(t){var e=ii;if(!1===e.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==e.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var i=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(i)},Ge.prototype.readCertPubKeyHex=function(t,e){var i,n;(i=new Ci).readCertHex(t),n=i.getPublicKeyHex(),this.readPKCS8PubKeyHex(n)};var Fi=new RegExp("");function Ei(t,e){for(var i="",n=e/4-t.length,r=0;r<n;r++)i+="0";return i+t}function Ai(t,e,i){for(var n="",r=0;n.length<e;)n+=fi(i(li(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return n}function Di(t){for(var e in Qe.crypto.Util.DIGESTINFOHEAD){var i=Qe.crypto.Util.DIGESTINFOHEAD[e],n=i.length;if(t.substring(0,n)==i)return[e,t.substring(n)]}return[]}function Ci(){var t=ii,e=t.getChildIdx,i=t.getV,n=t.getTLV,r=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,a=t.getVidx,u=t.oidname,h=Ci,c=gi;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return r(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return u(r(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return h.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return h.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=r(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=r(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return o(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return xi.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return u(r(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return r(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmName(),i=this.getSignatureValueHex(),n=s(this.hex,0,[0],"30"),r=new Qe.crypto.Signature({alg:e});return r.init(t),r.updateHex(n),r.verify(i)},this.parseExt=function(){if(3!==this.version)return-1;var i=o(this.hex,0,[0,7,0],"30"),n=e(this.hex,i);this.aExtInfo=new Array;for(var s=0;s<n.length;s++){var u={critical:!1},h=0;3===e(this.hex,n[s]).length&&(u.critical=!0,h=1),u.oid=t.hextooidstr(r(this.hex,n[s],[0],"06"));var c=o(this.hex,n[s],[1+h]);u.vidx=a(this.hex,c),this.aExtInfo.push(u)}},this.getExtInfo=function(t){var e=this.aExtInfo,i=t;if(t.match(/^[0-9.]+$/)||(i=Qe.asn1.x509.OID.name2oid(t)),""!==i)for(var n=0;n<e.length;n++)if(e[n].oid===i)return e[n]},this.getExtBasicConstraints=function(){var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=i(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var n=i(e,6);return{cA:!0,pathLen:parseInt(n,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=i(this.hex,t.vidx);if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var n=parseInt(e.substr(0,2)),r=parseInt(e.substr(2),16).toString(2);return r.substr(0,r.length-n)},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,i=0;i<t.length;i++)"1"==t.substr(i,1)&&e.push(Ci.KEYUSAGE_NAME[i]);return e.join(",")},this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:i(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var r={},s=n(this.hex,t.vidx),o=e(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(r.kid=i(s,o[a]));return r},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var r=new Array,s=n(this.hex,t.vidx);if(""===s)return r;for(var o=e(s,0),a=0;a<o.length;a++)r.push(u(i(s,o[a])));return r},this.getExtSubjectAltName=function(){for(var t=this.getExtSubjectAltName2(),e=new Array,i=0;i<t.length;i++)"DNS"===t[i][0]&&e.push(t[i][1]);return e},this.getExtSubjectAltName2=function(){var t,r,s,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,u=n(this.hex,o.vidx),h=e(u,0),c=0;c<h.length;c++)s=u.substr(h[c],2),t=i(u,h[c]),"81"===s&&(r=ci(t),a.push(["MAIL",r])),"82"===s&&(r=ci(t),a.push(["DNS",r])),"84"===s&&(r=Ci.hex2dn(t,0),a.push(["DN",r])),"86"===s&&(r=ci(t),a.push(["URI",r])),"87"===s&&(r=bi(t),a.push(["IP",r]));return a},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var i=new Array,n=e(this.hex,t.vidx),s=0;s<n.length;s++)try{var o=ci(r(this.hex,n[s],[0,0,0],"86"));i.push(o)}catch(t){}return i},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var i={ocsp:[],caissuer:[]},n=e(this.hex,t.vidx),s=0;s<n.length;s++){var o=r(this.hex,n[s],[0],"06"),a=r(this.hex,n[s],[1],"86");"2b06010505073001"===o&&i.ocsp.push(ci(a)),"2b06010505073002"===o&&i.caissuer.push(ci(a))}return i},this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var s=n(this.hex,t.vidx),o=[],a=e(s,0),h=0;h<a.length;h++){var c={},f=e(s,a[h]);if(c.id=u(i(s,f[0])),2===f.length)for(var l=e(s,f[1]),d=0;d<l.length;d++){var p=r(s,l[d],[0],"06");"2b06010505070201"===p?c.cps=ci(r(s,l[d],[1])):"2b06010505070202"===p&&(c.unotice=ci(r(s,l[d],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(c(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,i;if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+wi(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+wi(e.e.toString(16))+"\n"),null!=(i=this.aExtInfo)){t+="X509v3 Extensions:\n";for(var n=0;n<i.length;n++){var r=i[n],s=Qe.asn1.x509.OID.oid2name(r.oid);""===s&&(s=r.oid);var o="";if(!0===r.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n","basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var u=this.getExtAuthorityKeyIdentifier();void 0!==u.kid&&(t+="    kid="+u.kid+"\n")}else{if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var h=this.getExtAIAInfo();void 0!==h.ocsp&&(t+="    ocsp: "+h.ocsp.join(",")+"\n"),void 0!==h.caissuer&&(t+="    caissuer: "+h.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var c=this.getExtCertificatePolicies(),f=0;f<c.length;f++)void 0!==c[f].id&&(t+="    policy oid: "+c[f].id+"\n"),void 0!==c[f].cps&&(t+="    cps: "+c[f].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}Fi.compile("[^0-9a-f]","gi"),Ge.prototype.sign=function(t,e){var i,n=(i=t,Qe.crypto.Util.hashString(i,e));return this.signWithMessageHash(n,e)},Ge.prototype.signWithMessageHash=function(t,e){var i=$e(Qe.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return Ei(this.doPrivate(i).toString(16),this.n.bitLength())},Ge.prototype.signPSS=function(t,e,i){var n,r=(n=li(t),Qe.crypto.Util.hashHex(n,e));return void 0===i&&(i=-1),this.signWithMessageHashPSS(r,e,i)},Ge.prototype.signWithMessageHashPSS=function(t,e,i){var n,r=fi(t),s=r.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),u=function(t){return Qe.crypto.Util.hashHex(t,e)};if(-1===i||void 0===i)i=s;else if(-2===i)i=a-s-2;else if(i<-2)throw"invalid salt length";if(a<s+i+2)throw"data too long";var h="";i>0&&(h=new Array(i),(new qe).nextBytes(h),h=String.fromCharCode.apply(String,h));var c=fi(u(li("\0\0\0\0\0\0\0\0"+r+h))),f=[];for(n=0;n<a-i-s-2;n+=1)f[n]=0;var l=String.fromCharCode.apply(String,f)+""+h,d=Ai(c,l.length,u),p=[];for(n=0;n<l.length;n+=1)p[n]=l.charCodeAt(n)^d.charCodeAt(n);var g=65280>>8*a-o&255;for(p[0]&=~g,n=0;n<s;n++)p.push(c.charCodeAt(n));return p.push(188),Ei(this.doPrivate(new fe(p)).toString(16),this.n.bitLength())},Ge.prototype.verify=function(t,e){var i=$e(e=(e=e.replace(Fi,"")).replace(/[ \n]+/g,""),16);if(i.bitLength()>this.n.bitLength())return 0;var n=Di(this.doPublic(i).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;var r,s=n[0];return n[1]==(r=t,Qe.crypto.Util.hashString(r,s))},Ge.prototype.verifyWithMessageHash=function(t,e){var i=$e(e=(e=e.replace(Fi,"")).replace(/[ \n]+/g,""),16);if(i.bitLength()>this.n.bitLength())return 0;var n=Di(this.doPublic(i).toString(16).replace(/^1f+00/,""));if(0==n.length)return!1;n[0];return n[1]==t},Ge.prototype.verifyPSS=function(t,e,i,n){var r,s=(r=li(t),Qe.crypto.Util.hashHex(r,i));return void 0===n&&(n=-1),this.verifyWithMessageHashPSS(s,e,i,n)},Ge.prototype.verifyWithMessageHashPSS=function(t,e,i,n){var r=new fe(e,16);if(r.bitLength()>this.n.bitLength())return!1;var s,o=function(t){return Qe.crypto.Util.hashHex(t,i)},a=fi(t),u=a.length,h=this.n.bitLength()-1,c=Math.ceil(h/8);if(-1===n||void 0===n)n=u;else if(-2===n)n=c-u-2;else if(n<-2)throw"invalid salt length";if(c<u+n+2)throw"data too long";var f=this.doPublic(r).toByteArray();for(s=0;s<f.length;s+=1)f[s]&=255;for(;f.length<c;)f.unshift(0);if(188!==f[c-1])throw"encoded message does not end in 0xbc";var l=(f=String.fromCharCode.apply(String,f)).substr(0,c-u-1),d=f.substr(l.length,u),p=65280>>8*c-h&255;if(0!=(l.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=Ai(d,l.length,o),v=[];for(s=0;s<l.length;s+=1)v[s]=l.charCodeAt(s)^g.charCodeAt(s);v[0]&=~p;var y=c-u-n-2;for(s=0;s<y;s+=1)if(0!==v[s])throw"leftmost octets not zero";if(1!==v[y])throw"0x01 marker not found";return d===fi(o(li("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,v.slice(-n)))))},Ge.SALT_LEN_HLEN=-1,Ge.SALT_LEN_MAX=-2,Ge.SALT_LEN_RECOVER=-2,Ci.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var i=new Array,n=ii.getChildIdx(t,e),r=0;r<n.length;r++)i.push(Ci.hex2rdn(t,n[r]));return"/"+(i=i.map(function(t){return t.replace("/","\\/")})).join("/")},Ci.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var i=new Array,n=ii.getChildIdx(t,e),r=0;r<n.length;r++)i.push(Ci.hex2attrTypeValue(t,n[r]));return(i=i.map(function(t){return t.replace("+","\\+")})).join("+")},Ci.hex2attrTypeValue=function(t,e){var i=ii,n=i.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var r=i.getChildIdx(t,e);2!==r.length||t.substr(r[0],2);var s=n(t,r[0]),o=Qe.asn1.ASN1Util.oidHexToInt(s);return Qe.asn1.x509.OID.oid2atype(o)+"="+fi(n(t,r[1]))},Ci.getPublicKeyFromCertHex=function(t){var e=new Ci;return e.readCertHex(t),e.getPublicKey()},Ci.getPublicKeyFromCertPEM=function(t){var e=new Ci;return e.readCertPEM(t),e.getPublicKey()},Ci.getPublicKeyInfoPropOfCertPEM=function(t){var e,i,n=ii.getVbyList,r={};return r.algparam=null,(e=new Ci).readCertPEM(t),i=e.getPublicKeyHex(),r.keyhex=n(i,0,[1],"03").substr(2),r.algoid=n(i,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=n(i,0,[0,1],"06")),r},Ci.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.jws&&Qe.jws||(Qe.jws={}),Qe.jws.JWS=function(){var t=Qe.jws.JWS.isSafeJSONString;this.parseJWS=function(e,i){if(void 0===this.parsedJWS||!i&&void 0===this.parsedJWS.sigvalH){var n=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==n)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var r=n[1],s=n[2],o=n[3],a=r+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=r,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!i){var u=ui(o),h=$e(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=h}var c=ei(r),f=ei(s);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=f,!t(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},Qe.jws.JWS.sign=function(t,e,i,n,r){var s,o,a,u=Qe,h=u.jws.JWS,c=h.readSafeJSONString,f=h.isSafeJSONString,l=u.crypto,d=(l.ECDSA,l.Mac),p=l.Signature,g=JSON;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(o=e,s=g.stringify(o)),"string"==typeof e){if(!f(s=e))throw"JWS Head is not safe JSON string: "+s;o=c(s)}if(a=i,"object"==typeof i&&(a=g.stringify(i)),""!=t&&null!=t||void 0===o.alg||(t=o.alg),""!=t&&null!=t&&void 0===o.alg&&(o.alg=t,s=g.stringify(o)),t!==o.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+o.alg;var v=null;if(void 0===h.jwsalg2sigalg[t])throw"unsupported alg name: "+t;v=h.jwsalg2sigalg[t];var y=ti(s)+"."+ti(a),m="";if("Hmac"==v.substr(0,4)){if(void 0===n)throw"mac key shall be specified for HS* alg";var b=new d({alg:v,prov:"cryptojs",pass:n});b.updateString(y),m=b.doFinal()}else if(-1!=v.indexOf("withECDSA")){(w=new p({alg:v})).init(n,r),w.updateString(y);var S=w.sign();m=Qe.crypto.ECDSA.asn1SigToConcatSig(S)}else{var w;if("none"!=v)(w=new p({alg:v})).init(n,r),w.updateString(y),m=w.sign()}return y+"."+ai(m)},Qe.jws.JWS.verify=function(t,e,i){var n,r=Qe,s=r.jws.JWS,o=s.readSafeJSONString,a=r.crypto,u=a.ECDSA,h=a.Mac,c=a.Signature;n=Ge;var f=t.split(".");if(3!==f.length)return!1;var l=f[0]+"."+f[1],d=ui(f[2]),p=o(ei(f[0])),g=null,v=null;if(void 0===p.alg)throw"algorithm not specified in header";if((v=(g=p.alg).substr(0,2),null!=i&&"[object Array]"===Object.prototype.toString.call(i)&&i.length>0)&&-1==(":"+i.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=xi.getKey(e)),!("RS"!=v&&"PS"!=v||e instanceof n))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==v&&!(e instanceof u))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+g;if("none"==(y=s.jwsalg2sigalg[g]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var m=new h({alg:y,pass:e});return m.updateString(l),d==m.doFinal()}if(-1!=y.indexOf("withECDSA")){var b,S=null;try{S=u.concatSigToASN1Sig(d)}catch(t){return!1}return(b=new c({alg:y})).init(e),b.updateString(l),b.verify(S)}return(b=new c({alg:y})).init(e),b.updateString(l),b.verify(d)},Qe.jws.JWS.parse=function(t){var e,i,n,r=t.split("."),s={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=r[0],i=r[1],3==r.length&&(n=r[2]),s.headerObj=Qe.jws.JWS.readSafeJSONString(ei(e)),s.payloadObj=Qe.jws.JWS.readSafeJSONString(ei(i)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=ei(i):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==n&&(s.sigHex=ui(n)),s},Qe.jws.JWS.verifyJWT=function(t,e,i){var n=Qe.jws,r=n.JWS,s=r.readSafeJSONString,o=r.inArray,a=r.includedArray,u=t.split("."),h=u[0],c=u[1],f=(ui(u[2]),s(ei(h))),l=s(ei(c));if(void 0===f.alg)return!1;if(void 0===i.alg)throw"acceptField.alg shall be specified";if(!o(f.alg,i.alg))return!1;if(void 0!==l.iss&&"object"==typeof i.iss&&!o(l.iss,i.iss))return!1;if(void 0!==l.sub&&"object"==typeof i.sub&&!o(l.sub,i.sub))return!1;if(void 0!==l.aud&&"object"==typeof i.aud)if("string"==typeof l.aud){if(!o(l.aud,i.aud))return!1}else if("object"==typeof l.aud&&!a(l.aud,i.aud))return!1;var d=n.IntDate.getNow();return void 0!==i.verifyAt&&"number"==typeof i.verifyAt&&(d=i.verifyAt),void 0!==i.gracePeriod&&"number"==typeof i.gracePeriod||(i.gracePeriod=0),!(void 0!==l.exp&&"number"==typeof l.exp&&l.exp+i.gracePeriod<d)&&(!(void 0!==l.nbf&&"number"==typeof l.nbf&&d<l.nbf-i.gracePeriod)&&(!(void 0!==l.iat&&"number"==typeof l.iat&&d<l.iat-i.gracePeriod)&&((void 0===l.jti||void 0===i.jti||l.jti===i.jti)&&!!r.verify(t,e,i.alg))))},Qe.jws.JWS.includedArray=function(t,e){var i=Qe.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var n=0;n<t.length;n++)if(!i(t[n],e))return!1;return!0},Qe.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},Qe.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},Qe.jws.JWS.isSafeJSONString=function(t,e,i){var n=null;try{return"object"!=typeof(n=Ze(t))?0:n.constructor===Array?0:(e&&(e[i]=n),1)}catch(t){return 0}},Qe.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=Ze(t))?null:e.constructor===Array?null:e}catch(t){return null}},Qe.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},Qe.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var i=li(e);return ai(Qe.crypto.Util.hashHex(i,"sha256"))},Qe.jws.IntDate={},Qe.jws.IntDate.get=function(t){var e=Qe.jws.IntDate,i=e.getNow,n=e.getZulu;if("now"==t)return i();if("now + 1hour"==t)return i()+3600;if("now + 1day"==t)return i()+86400;if("now + 1month"==t)return i()+2592e3;if("now + 1year"==t)return i()+31536e3;if(t.match(/Z$/))return n(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},Qe.jws.IntDate.getZulu=function(t){return vi(t)},Qe.jws.IntDate.getNow=function(){return~~(new Date/1e3)},Qe.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},Qe.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.jws&&Qe.jws||(Qe.jws={}),Qe.jws.JWSJS=function(){var t=Qe.jws.JWS,e=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(t){this.init();var e=t.split(".");if(3!=e.length)throw"malformed input JWS";this.aHeader.push(e[0]),this.sPayload=e[1],this.aSignature.push(e[2])},this.addSignature=function(t,e,i,n){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var r=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=Qe.jws.JWS.sign(t,e,this.sPayload,i,n).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(t){throw this.aHeader.length>r&&this.aHeader.pop(),this.aSignature.length>r&&this.aSignature.pop(),"addSignature failed: "+t}},this.verifyAll=function(t){if(this.aHeader.length!==t.length||this.aSignature.length!==t.length)return!1;for(var e=0;e<t.length;e++){var i=t[e];if(2!==i.length)return!1;if(!1===this.verifyNth(e,i[0],i[1]))return!1}return!0},this.verifyNth=function(e,i,n){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1;var r=this.aHeader[e],s=this.aSignature[e],o=r+"."+this.sPayload+"."+s,a=!1;try{a=t.verify(o,i,n)}catch(t){return!1}return a},this.readJWSJS=function(t){if("string"==typeof t){var i=e(t);if(null==i)throw"argument is not safe JSON object string";this.aHeader=i.headers,this.sPayload=i.payload,this.aSignature=i.signatures}else try{if(!(t.headers.length>0))throw"malformed header";if(this.aHeader=t.headers,"string"!=typeof t.payload)throw"malformed signatures";if(this.sPayload=t.payload,!(t.signatures.length>0))throw"malformed signatures";this.aSignatures=t.signatures}catch(t){throw"malformed JWS-JS JSON object: "+t}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}};Qe.crypto.ECDSA,Qe.crypto.DSA,Qe.crypto.Signature;var Ii=Qe.crypto.MessageDigest,Ti=(Qe.crypto.Mac,Qe.crypto.Cipher,xi),Pi=gi,ji=(Qe.crypto,Qe.asn1),Hi=Qe.jws,_i=(Qe.lang,{apiRoot:"http://127.0.0.1:4944/api",request:function(t){t.headers=void 0!==t.headers?t.json:{"Content-Type":"application/json"},t.method="POST";var e=void 0!==t.uri?t.uri:this.apiRoot;return t.apiMethod&&(t.uri+="/"+t.apiMethod),t.apiIdType&&(t.uri+="/"+encodeURIComponent(t.apiIdType)),t.apiId&&(t.uri+="/"+encodeURIComponent(t.apiId)),t.apiAction&&(t.uri+="/"+t.apiAction),et(e,t)},getJwt:function(t,e){var i=Math.floor(Date.now()/1e3)+60;return e=tt({exp:i},e),Hi.sign({header:{typ:"JWT",alg:"ES256"},payload:e,privateKey:t})}}),Ri=r.JSON||(r.JSON={stringify:JSON.stringify}),ki=function(t){return Ri.stringify.apply(Ri,arguments)},Bi=e(i(function(t){t.exports={default:ki,__esModule:!0}})),Ni=e(i(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),Oi=b,Vi={},Li=c?Object.defineProperties:function(t,e){u(t);for(var i,n=G(e),r=n.length,s=0;r>s;)y.f(t,i=n[s++],e[i]);return t},Mi=n.document,Ki=Mi&&Mi.documentElement,Ui=K("IE_PROTO"),qi=function(){},$i=function(){var t,e=d("iframe"),i=z.length;for(e.style.display="none",Ki.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),$i=t.F;i--;)delete $i.prototype[z[i]];return $i()},zi=Object.create||function(t,e){var i;return null!==t?(qi.prototype=u(t),i=new qi,qi.prototype=null,i[Ui]=t):i=$i(),void 0===e?i:Li(i,e)},Gi=i(function(t){var e=N("wks"),i=n.Symbol,r="function"==typeof i;(t.exports=function(t){return e[t]||(e[t]=r&&i[t]||(r?i:L)("Symbol."+t))}).store=e}),Ji=y.f,Wi=Gi("toStringTag"),Yi=function(t,e,i){t&&!w(t=i?t:t.prototype,Wi)&&Ji(t,Wi,{configurable:!0,value:e})},Xi={};b(Xi,Gi("iterator"),function(){return this});var Zi,Qi=function(t,e,i){t.prototype=zi(Xi,{next:m(1,i)}),Yi(t,e+" Iterator")},tn=K("IE_PROTO"),en=Object.prototype,nn=Object.getPrototypeOf||function(t){return t=Y(t),w(t,tn)?t[tn]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?en:null},rn=Gi("iterator"),sn=!([].keys&&"next"in[].keys()),on=function(){return this},an=function(t,e,i,n,r,s,o){Qi(i,e,n);var a,u,h,c=function(t){if(!sn&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new i(this,t)}}return function(){return new i(this,t)}},f=e+" Iterator",l="values"==r,d=!1,p=t.prototype,g=p[rn]||p["@@iterator"]||r&&p[r],v=g||c(r),y=r?l?c("entries"):v:void 0,m="Array"==e&&p.entries||g;if(m&&(h=nn(m.call(new t)))!==Object.prototype&&h.next&&Yi(h,f,!0),l&&g&&"values"!==g.name&&(d=!0,v=function(){return g.call(this)}),o&&(sn||d||!p[rn])&&b(p,rn,v),Vi[e]=v,Vi[f]=on,r)if(a={values:l?v:c("values"),keys:s?v:c("keys"),entries:y},o)for(u in a)u in p||Oi(p,u,a[u]);else E(E.P+E.F*(sn||d),e,a);return a},un=(Zi=!0,function(t,e){var i,n,r=String(I(t)),s=H(e),o=r.length;return s<0||s>=o?Zi?"":void 0:(i=r.charCodeAt(s))<55296||i>56319||s+1===o||(n=r.charCodeAt(s+1))<56320||n>57343?Zi?r.charAt(s):i:Zi?r.slice(s,s+2):n-56320+(i-55296<<10)+65536});an(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,i=this._i;return i>=e.length?{value:void 0,done:!0}:(t=un(e,i),this._i+=t.length,{value:t,done:!1})});var hn=function(t,e){return{value:e,done:!!t}};an(Array,"Array",function(t,e){this._t=T(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,hn(1)):hn(0,"keys"==e?i:"values"==e?t[i]:[i,t[i]])},"values");Vi.Arguments=Vi.Array;for(var cn=Gi("toStringTag"),fn="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),ln=0;ln<fn.length;ln++){var dn=fn[ln],pn=n[dn],gn=pn&&pn.prototype;gn&&!gn[cn]&&b(gn,cn,dn),Vi[dn]=Vi.Array}var vn={f:Gi},yn=vn.f("iterator"),mn=i(function(t){t.exports={default:yn,__esModule:!0}});e(mn);var bn=i(function(t){var e=L("meta"),i=y.f,n=0,r=Object.isExtensible||function(){return!0},s=!h(function(){return r(Object.preventExtensions({}))}),o=function(t){i(t,e,{value:{i:"O"+ ++n,w:{}}})},u=t.exports={KEY:e,NEED:!1,fastKey:function(t,i){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,e)){if(!r(t))return"F";if(!i)return"E";o(t)}return t[e].i},getWeak:function(t,i){if(!w(t,e)){if(!r(t))return!0;if(!i)return!1;o(t)}return t[e].w},onFreeze:function(t){return s&&u.NEED&&r(t)&&!w(t,e)&&o(t),t}}}),Sn=(bn.KEY,bn.NEED,bn.fastKey,bn.getWeak,bn.onFreeze,y.f),wn=function(t){var e=r.Symbol||(r.Symbol={});"_"==t.charAt(0)||t in e||Sn(e,t,{value:vn.f(t)})},xn=Array.isArray||function(t){return"Array"==D(t)},Fn=z.concat("length","prototype"),En={f:Object.getOwnPropertyNames||function(t){return $(t,Fn)}},An=En.f,Dn={}.toString,Cn="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],In={f:function(t){return Cn&&"[object Window]"==Dn.call(t)?function(t){try{return An(t)}catch(t){return Cn.slice()}}(t):An(T(t))}},Tn=Object.getOwnPropertyDescriptor,Pn={f:c?Tn:function(t,e){if(t=T(t),e=g(e,!0),p)try{return Tn(t,e)}catch(t){}if(w(t,e))return m(!W.f.call(t,e),t[e])}},jn=bn.KEY,Hn=Pn.f,_n=y.f,Rn=In.f,kn=n.Symbol,Bn=n.JSON,Nn=Bn&&Bn.stringify,On=Gi("_hidden"),Vn=Gi("toPrimitive"),Ln={}.propertyIsEnumerable,Mn=N("symbol-registry"),Kn=N("symbols"),Un=N("op-symbols"),qn=Object.prototype,$n="function"==typeof kn,zn=n.QObject,Gn=!zn||!zn.prototype||!zn.prototype.findChild,Jn=c&&h(function(){return 7!=zi(_n({},"a",{get:function(){return _n(this,"a",{value:7}).a}})).a})?function(t,e,i){var n=Hn(qn,e);n&&delete qn[e],_n(t,e,i),n&&t!==qn&&_n(qn,e,n)}:_n,Wn=function(t){var e=Kn[t]=zi(kn.prototype);return e._k=t,e},Yn=$n&&"symbol"==typeof kn.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof kn},Xn=function(t,e,i){return t===qn&&Xn(Un,e,i),u(t),e=g(e,!0),u(i),w(Kn,e)?(i.enumerable?(w(t,On)&&t[On][e]&&(t[On][e]=!1),i=zi(i,{enumerable:m(0,!1)})):(w(t,On)||_n(t,On,m(1,{})),t[On][e]=!0),Jn(t,e,i)):_n(t,e,i)},Zn=function(t,e){u(t);for(var i,n=function(t){var e=G(t),i=J.f;if(i)for(var n,r=i(t),s=W.f,o=0;r.length>o;)s.call(t,n=r[o++])&&e.push(n);return e}(e=T(e)),r=0,s=n.length;s>r;)Xn(t,i=n[r++],e[i]);return t},Qn=function(t){var e=Ln.call(this,t=g(t,!0));return!(this===qn&&w(Kn,t)&&!w(Un,t))&&(!(e||!w(this,t)||!w(Kn,t)||w(this,On)&&this[On][t])||e)},tr=function(t,e){if(t=T(t),e=g(e,!0),t!==qn||!w(Kn,e)||w(Un,e)){var i=Hn(t,e);return!i||!w(Kn,e)||w(t,On)&&t[On][e]||(i.enumerable=!0),i}},er=function(t){for(var e,i=Rn(T(t)),n=[],r=0;i.length>r;)w(Kn,e=i[r++])||e==On||e==jn||n.push(e);return n},ir=function(t){for(var e,i=t===qn,n=Rn(i?Un:T(t)),r=[],s=0;n.length>s;)!w(Kn,e=n[s++])||i&&!w(qn,e)||r.push(Kn[e]);return r};$n||(Oi((kn=function(){if(this instanceof kn)throw TypeError("Symbol is not a constructor!");var t=L(arguments.length>0?arguments[0]:void 0),e=function(i){this===qn&&e.call(Un,i),w(this,On)&&w(this[On],t)&&(this[On][t]=!1),Jn(this,t,m(1,i))};return c&&Gn&&Jn(qn,t,{configurable:!0,set:e}),Wn(t)}).prototype,"toString",function(){return this._k}),Pn.f=tr,y.f=Xn,En.f=In.f=er,W.f=Qn,J.f=ir,vn.f=function(t){return Wn(Gi(t))}),E(E.G+E.W+E.F*!$n,{Symbol:kn});for(var nr="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rr=0;nr.length>rr;)Gi(nr[rr++]);for(var sr=G(Gi.store),or=0;sr.length>or;)wn(sr[or++]);E(E.S+E.F*!$n,"Symbol",{for:function(t){return w(Mn,t+="")?Mn[t]:Mn[t]=kn(t)},keyFor:function(t){if(!Yn(t))throw TypeError(t+" is not a symbol!");for(var e in Mn)if(Mn[e]===t)return e},useSetter:function(){Gn=!0},useSimple:function(){Gn=!1}}),E(E.S+E.F*!$n,"Object",{create:function(t,e){return void 0===e?zi(t):Zn(zi(t),e)},defineProperty:Xn,defineProperties:Zn,getOwnPropertyDescriptor:tr,getOwnPropertyNames:er,getOwnPropertySymbols:ir}),Bn&&E(E.S+E.F*(!$n||h(function(){var t=kn();return"[null]"!=Nn([t])||"{}"!=Nn({a:t})||"{}"!=Nn(Object(t))})),"JSON",{stringify:function(t){for(var e,i,n=[t],r=1;arguments.length>r;)n.push(arguments[r++]);if(i=e=n[1],(a(e)||void 0!==t)&&!Yn(t))return xn(e)||(e=function(t,e){if("function"==typeof i&&(e=i.call(this,t,e)),!Yn(e))return e}),n[1]=e,Nn.apply(Bn,n)}}),kn.prototype[Vn]||b(kn.prototype,Vn,kn.prototype.valueOf),Yi(kn,"Symbol"),Yi(Math,"Math",!0),Yi(n.JSON,"JSON",!0),wn("asyncIterator"),wn("observable");var ar=r.Symbol,ur=i(function(t){t.exports={default:ar,__esModule:!0}});e(ur);var hr=i(function(t,e){e.__esModule=!0;var i=s(mn),n=s(ur),r="function"==typeof n.default&&"symbol"==typeof i.default?function(t){return typeof t}:function(t){return t&&"function"==typeof n.default&&t.constructor===n.default&&t!==n.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof n.default&&"symbol"===r(i.default)?function(t){return void 0===t?"undefined":r(t)}:function(t){return t&&"function"==typeof n.default&&t.constructor===n.default&&t!==n.default.prototype?"symbol":void 0===t?"undefined":r(t)}});e(hr);var cr=e(i(function(t,e){e.__esModule=!0;var i,n=(i=hr)&&i.__esModule?i:{default:i};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,n.default)(e))&&"function"!=typeof e?t:e}})),fr=function(t,e){if(u(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},lr={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,i){try{(i=o(Function.call,Pn.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,n){return fr(t,n),e?t.__proto__=n:i(t,n),t}}({},!1):void 0),check:fr};E(E.S,"Object",{setPrototypeOf:lr.set});var dr=r.Object.setPrototypeOf,pr=i(function(t){t.exports={default:dr,__esModule:!0}});e(pr),E(E.S,"Object",{create:zi});var gr=r.Object,vr=function(t,e){return gr.create(t,e)},yr=i(function(t){t.exports={default:vr,__esModule:!0}});e(yr);var mr,br,Sr,wr=e(i(function(t,e){e.__esModule=!0;var i=s(pr),n=s(yr),r=s(hr);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,r.default)(e)));t.prototype=(0,n.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(i.default?(0,i.default)(t,e):t.__proto__=e)}})),xr=Gi("toStringTag"),Fr="Arguments"==D(function(){return arguments}()),Er=function(t){var e,i,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(i=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),xr))?i:Fr?D(e):"Object"==(n=D(e))&&"function"==typeof e.callee?"Arguments":n},Ar=function(t,e,i,n){try{return n?e(u(i)[0],i[1]):e(i)}catch(e){var r=t.return;throw void 0!==r&&u(r.call(t)),e}},Dr=Gi("iterator"),Cr=Array.prototype,Ir=Gi("iterator"),Tr=r.getIteratorMethod=function(t){if(null!=t)return t[Ir]||t["@@iterator"]||Vi[Er(t)]},Pr=i(function(t){var e={},i={},n=t.exports=function(t,n,r,s,a){var h,c,f,l,d,p=a?function(){return t}:Tr(t),g=o(r,s,n?2:1),v=0;if("function"!=typeof p)throw TypeError(t+" is not iterable!");if(void 0===(d=p)||Vi.Array!==d&&Cr[Dr]!==d){for(f=p.call(t);!(c=f.next()).done;)if((l=Ar(f,g,c.value,n))===e||l===i)return l}else for(h=R(t.length);h>v;v++)if((l=n?g(u(c=t[v])[0],c[1]):g(t[v]))===e||l===i)return l};n.BREAK=e,n.RETURN=i}),jr=Gi("species"),Hr=function(t,e){var i,n=u(t).constructor;return void 0===n||null==(i=u(n)[jr])?e:s(i)},_r=n.process,Rr=n.setImmediate,kr=n.clearImmediate,Br=n.MessageChannel,Nr=n.Dispatch,Or=0,Vr={},Lr=function(){var t=+this;if(Vr.hasOwnProperty(t)){var e=Vr[t];delete Vr[t],e()}},Mr=function(t){Lr.call(t.data)};Rr&&kr||(Rr=function(t){for(var e=[],i=1;arguments.length>i;)e.push(arguments[i++]);return Vr[++Or]=function(){!function(t,e,i){var n=void 0===i;switch(e.length){case 0:return n?t():t.call(i);case 1:return n?t(e[0]):t.call(i,e[0]);case 2:return n?t(e[0],e[1]):t.call(i,e[0],e[1]);case 3:return n?t(e[0],e[1],e[2]):t.call(i,e[0],e[1],e[2]);case 4:return n?t(e[0],e[1],e[2],e[3]):t.call(i,e[0],e[1],e[2],e[3])}t.apply(i,e)}("function"==typeof t?t:Function(t),e)},mr(Or),Or},kr=function(t){delete Vr[t]},"process"==D(_r)?mr=function(t){_r.nextTick(o(Lr,t,1))}:Nr&&Nr.now?mr=function(t){Nr.now(o(Lr,t,1))}:Br?(Sr=(br=new Br).port2,br.port1.onmessage=Mr,mr=o(Sr.postMessage,Sr,1)):n.addEventListener&&"function"==typeof postMessage&&!n.importScripts?(mr=function(t){n.postMessage(t+"","*")},n.addEventListener("message",Mr,!1)):mr="onreadystatechange"in d("script")?function(t){Ki.appendChild(d("script")).onreadystatechange=function(){Ki.removeChild(this),Lr.call(t)}}:function(t){setTimeout(o(Lr,t,1),0)});var Kr={set:Rr,clear:kr},Ur=Kr.set,qr=n.MutationObserver||n.WebKitMutationObserver,$r=n.process,zr=n.Promise,Gr="process"==D($r);function Jr(t){var e,i;this.promise=new t(function(t,n){if(void 0!==e||void 0!==i)throw TypeError("Bad Promise constructor");e=t,i=n}),this.resolve=s(e),this.reject=s(i)}var Wr={f:function(t){return new Jr(t)}},Yr=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Xr=n.navigator,Zr=Xr&&Xr.userAgent||"",Qr=function(t,e){if(u(t),a(e)&&e.constructor===t)return e;var i=Wr.f(t);return(0,i.resolve)(e),i.promise},ts=Gi("species"),es=Gi("iterator"),is=!1;try{[7][es]().return=function(){is=!0}}catch(t){}var ns,rs,ss,os,as,us,hs=Kr.set,cs=function(){var t,e,i,r=function(){var n,r;for(Gr&&(n=$r.domain)&&n.exit();t;){r=t.fn,t=t.next;try{r()}catch(n){throw t?i():e=void 0,n}}e=void 0,n&&n.enter()};if(Gr)i=function(){$r.nextTick(r)};else if(!qr||n.navigator&&n.navigator.standalone)if(zr&&zr.resolve){var s=zr.resolve(void 0);i=function(){s.then(r)}}else i=function(){Ur.call(n,r)};else{var o=!0,a=document.createTextNode("");new qr(r).observe(a,{characterData:!0}),i=function(){a.data=o=!o}}return function(n){var r={fn:n,next:void 0};e&&(e.next=r),t||(t=r,i()),e=r}}(),fs=n.TypeError,ls=n.process,ds=ls&&ls.versions,ps=ds&&ds.v8||"",gs=n.Promise,vs="process"==Er(ls),ys=function(){},ms=rs=Wr.f,bs=!!function(){try{var t=gs.resolve(1),e=(t.constructor={})[Gi("species")]=function(t){t(ys,ys)};return(vs||"function"==typeof PromiseRejectionEvent)&&t.then(ys)instanceof e&&0!==ps.indexOf("6.6")&&-1===Zr.indexOf("Chrome/66")}catch(t){}}(),Ss=function(t){var e;return!(!a(t)||"function"!=typeof(e=t.then))&&e},ws=function(t,e){if(!t._n){t._n=!0;var i=t._c;cs(function(){for(var n=t._v,r=1==t._s,s=0,o=function(e){var i,s,o,a=r?e.ok:e.fail,u=e.resolve,h=e.reject,c=e.domain;try{a?(r||(2==t._h&&Es(t),t._h=1),!0===a?i=n:(c&&c.enter(),i=a(n),c&&(c.exit(),o=!0)),i===e.promise?h(fs("Promise-chain cycle")):(s=Ss(i))?s.call(i,u,h):u(i)):h(n)}catch(t){c&&!o&&c.exit(),h(t)}};i.length>s;)o(i[s++]);t._c=[],t._n=!1,e&&!t._h&&xs(t)})}},xs=function(t){hs.call(n,function(){var e,i,r,s=t._v,o=Fs(t);if(o&&(e=Yr(function(){vs?ls.emit("unhandledRejection",s,t):(i=n.onunhandledrejection)?i({promise:t,reason:s}):(r=n.console)&&r.error&&r.error("Unhandled promise rejection",s)}),t._h=vs||Fs(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},Fs=function(t){return 1!==t._h&&0===(t._a||t._c).length},Es=function(t){hs.call(n,function(){var e;vs?ls.emit("rejectionHandled",t):(e=n.onrejectionhandled)&&e({promise:t,reason:t._v})})},As=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),ws(e,!0))},Ds=function(t){var e,i=this;if(!i._d){i._d=!0,i=i._w||i;try{if(i===t)throw fs("Promise can't be resolved itself");(e=Ss(t))?cs(function(){var n={_w:i,_d:!1};try{e.call(t,o(Ds,n,1),o(As,n,1))}catch(t){As.call(n,t)}}):(i._v=t,i._s=1,ws(i,!1))}catch(t){As.call({_w:i,_d:!1},t)}}};bs||(gs=function(t){!function(t,e,i,n){if(!(t instanceof e)||void 0!==n&&n in t)throw TypeError(i+": incorrect invocation!")}(this,gs,"Promise","_h"),s(t),ns.call(this);try{t(o(Ds,this,1),o(As,this,1))}catch(t){As.call(this,t)}},(ns=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,i){for(var n in e)i&&t[n]?t[n]=e[n]:b(t,n,e[n]);return t}(gs.prototype,{then:function(t,e){var i=ms(Hr(this,gs));return i.ok="function"!=typeof t||t,i.fail="function"==typeof e&&e,i.domain=vs?ls.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&ws(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}}),ss=function(){var t=new ns;this.promise=t,this.resolve=o(Ds,t,1),this.reject=o(As,t,1)},Wr.f=ms=function(t){return t===gs||t===os?new ss(t):rs(t)}),E(E.G+E.W+E.F*!bs,{Promise:gs}),Yi(gs,"Promise"),us="function"==typeof r[as="Promise"]?r[as]:n[as],c&&us&&!us[ts]&&y.f(us,ts,{configurable:!0,get:function(){return this}}),os=r.Promise,E(E.S+E.F*!bs,"Promise",{reject:function(t){var e=ms(this);return(0,e.reject)(t),e.promise}}),E(E.S+!0*E.F,"Promise",{resolve:function(t){return Qr(this===os?gs:this,t)}}),E(E.S+E.F*!(bs&&function(t,e){if(!e&&!is)return!1;var i=!1;try{var n=[7],r=n[es]();r.next=function(){return{done:i=!0}},n[es]=function(){return r},t(n)}catch(t){}return i}(function(t){gs.all(t).catch(ys)})),"Promise",{all:function(t){var e=this,i=ms(e),n=i.resolve,r=i.reject,s=Yr(function(){var i=[],s=0,o=1;Pr(t,!1,function(t){var a=s++,u=!1;i.push(void 0),o++,e.resolve(t).then(function(t){u||(u=!0,i[a]=t,--o||n(i))},r)}),--o||n(i)});return s.e&&r(s.v),i.promise},race:function(t){var e=this,i=ms(e),n=i.reject,r=Yr(function(){Pr(t,!1,function(t){e.resolve(t).then(i.resolve,n)})});return r.e&&n(r.v),i.promise}}),E(E.P+E.R,"Promise",{finally:function(t){var e=Hr(this,r.Promise||n.Promise),i="function"==typeof t;return this.then(i?function(i){return Qr(e,t()).then(function(){return i})}:t,i?function(i){return Qr(e,t()).then(function(){throw i})}:t)}}),E(E.S,"Promise",{try:function(t){var e=Wr.f(this),i=Yr(t);return(i.e?e.reject:e.resolve)(i.v),e.promise}});var Cs=r.Promise,Is=e(i(function(t){t.exports={default:Cs,__esModule:!0}})),Ts=!1;try{Ts="[object process]"===Object.prototype.toString.call(it.process)}catch(t){}var Ps={getHash:function(t){return new vt(new Ii({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},timeoutPromise:function(t,e){return Is.race([t,new Is(function(t){setTimeout(function(){t()},e)})])},isNode:Ts};!function(t,e){var i=(r.Object||{})[t]||Object[t],n={};n[t]=e(i),E(E.S+E.F*h(function(){i(1)}),"Object",n)}("keys",function(){return function(t){return G(Y(t))}});var js,Hs=r.Object.keys,_s=e(i(function(t){t.exports={default:Hs,__esModule:!0}})),Rs={email:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,bitcoin:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,bitcoin_address:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,ip:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/,ipv6:/^(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/,gpg_fingerprint:null,gpg_keyid:null,google_oauth2:null,tel:/^\d{7,}$/,phone:/^\d{7,}$/,keyID:null,url:/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,account:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i},ks=function(){function t(e){if(Ni(this,t),e.hasOwnProperty("val"))if(this.val=e.val,e.hasOwnProperty("name"))this.name=e.name;else{var i=t.guessTypeOf(this.val);if(!i)throw new Error("Type of attribute was omitted and could not be guessed");this.name=i}else{if(!Array.isArray(e))throw new Error("Invalid attribute data",e);if(2!==e.length)throw new Error("Invalid Attribute");this.name=e[0],this.val=e[1]}}return t.getUniqueIdValidators=function(){return Rs},t.isUniqueType=function(t){return _s(Rs).indexOf(t)>-1},t.guessTypeOf=function(t){for(var e in Rs)if(t.match(Rs[e]))return e},t.equals=function(e,i){return new t(e).equals(new t(i))},t.prototype.toArray=function(){return[this.name,this.val]},t.prototype.equals=function(t){return this.name===t.name&&this.val===t.val},t}(),Bs="Invalid Identifi message:",Ns=function(t){function e(){return Ni(this,e),cr(this,t.apply(this,arguments))}return wr(e,t),e}(Error),Os=function(){function t(e){Ni(this,t),this.signedData=e,this._validate()}return t.prototype.getSignerKeyID=function(){return Ps.getHash(this.jwsHeader.key||this.jwsHeader.kid)},t.prototype._validate=function(){if(!this.signedData)throw new Ns(Bs+" Missing signedData");if("object"!=typeof this.signedData)throw new Ns(Bs+" signedData must be an object");var t=this.signedData;if(!t.type)throw new Ns(Bs+" Missing type definition");if(!t.author)throw new Ns(Bs+" Missing author");if(!t.author.length)throw new Ns(Bs+" Author empty");var e=void 0,i=void 0;for(this.jwsHeader&&(this.signerKeyHash=this.getSignerKeyID()),e=0;e<t.author.length;e++){if(2!==t.author[e].length)throw new Ns(Bs+" Invalid author: "+t.author[e].toString());if("keyID"===t.author[e][0]){if(i)throw new Ns(Bs+" Author may have only one keyID");if(i=t.author[e][1],this.signerKeyHash&&i!==this.signerKeyHash)throw new Ns(Bs+" If message has a keyID author, it must be signed by the same key")}}if(!t.recipient)throw new Ns(Bs+" Missing recipient");if(!t.recipient.length)throw new Ns(Bs+" Author empty");for(e=0;e<t.recipient.length;e++)if(2!==t.recipient[e].length)throw new Ns(Bs+" Invalid recipient: "+t.recipient[e].toString());if(!t.timestamp)throw new Ns(Bs+" Missing timestamp");if(!Date.parse(t.timestamp))throw new Ns(Bs+" Invalid timestamp");if("rating"===t.type){if(isNaN(t.rating))throw new Ns(Bs+" Invalid rating");if(isNaN(t.maxRating))throw new Ns(Bs+" Invalid maxRating");if(isNaN(t.minRating))throw new Ns(Bs+" Invalid minRating");if(t.rating>t.maxRating)throw new Ns(Bs+" Rating is above maxRating");if(t.rating<t.minRating)throw new Ns(Bs+" Rating is below minRating");if("string"!=typeof t.context||!t.context.length)throw new Ns(Bs+" Rating messages must have a context field")}if(("verify_identity"===t.type||"unverify_identity"===t.type)&&t.recipient.length<2)throw new Ns(Bs+" At least 2 recipient attributes are needed for a connection / disconnection");return!0},t.prototype.isPositive=function(){return"rating"===this.signedData.type&&this.signedData.rating>(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNegative=function(){return"rating"===this.signedData.type&&this.signedData.rating<(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNeutral=function(){return"rating"===this.signedData.type&&this.signedData.rating===(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.sign=function(e,i){return this.jwsHeader={alg:"ES256",key:e.pubKeyASN1},this.jws=Hi.JWS.sign(this.jwsHeader.alg,Bi(this.jwsHeader),Bi(this.signedData),e),i||t._validateJws(this.jws),this.getHash(),this},t.create=function(e,i){!e.author&&i&&(e.author=[["keyID",i.keyID]]),e.timestamp=e.timestamp||(new Date).toISOString(),e.context=e.context||"identifi";var n=new t(e);return i&&n.sign(i),n},t.createVerification=function(e,i){return e.type="verification",t.create(e,i)},t.createRating=function(e,i){return e.type="rating",e.maxRating=e.maxRating||10,e.minRating=e.minRating||-10,t.create(e,i)},t.fromJws=function(e){t._validateJws(e);var i=Hi.JWS.parse(e),n=new t(i.payloadObj);return n.hash=t.getHash(e),n.jwsHeader=i.headerObj,n.jws=e,n},t.prototype.getAuthor=function(t){for(var e=0;e<this.signedData.author.length;e++){var i=this.signedData.author[e];if(ks.isUniqueType(i[0]))return t.get(i[1],i[0])}},t.prototype.getRecipient=function(t){for(var e=0;e<this.signedData.recipient.length;e++){var i=this.signedData.recipient[e];if(ks.isUniqueType(i[0]))return t.get(i[1],i[0])}},t.prototype.getHash=function(){return this.jws&&!this.hash&&(this.hash=t.getHash(this.jws)),this.hash},t.getHash=function(t){return new vt(new Ii({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},t.prototype.verify=function(){var e=this.jwsHeader.key||this.jwsHeader.kid,i=ji.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY"),n=Ti.getKey(i);if(!Hi.JWS.verify(this.jws,n,[this.jwsHeader.alg]))throw new Ns(Bs+" Invalid signature");if(this.hash){if(this.hash!==t.getHash(this.jws))throw new Ns(Bs+" Invalid message hash")}else this.getHash();return!0},t._validateJws=function(t){if("string"!=typeof t)throw new Ns(Bs+" Message JWS must be a string");if(t.length>1e4)throw new Ns(Bs+" Message JWS max length is 10000");return!0},t}(),Vs=i(function(t){!function(){function e(t,e){for(var i=2;i<arguments.length;i++)for(var n=0;n<arguments[i].length;n++)t[e++]=arguments[i].charAt(n)}function i(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function n(t){return String.fromCharCode(255&t,t>>8&255)}t.exports=function(t,r,s){this.width=t,this.height=r,this.depth=s,this.pix_size=r*(t+1),this.data_size=2+this.pix_size+5*Math.floor((65534+this.pix_size)/65535)+4,this.ihdr_offs=0,this.ihdr_size=25,this.plte_offs=this.ihdr_offs+this.ihdr_size,this.plte_size=8+3*s+4,this.trns_offs=this.plte_offs+this.plte_size,this.trns_size=8+s+4,this.idat_offs=this.trns_offs+this.trns_size,this.idat_size=8+this.data_size+4,this.iend_offs=this.idat_offs+this.idat_size,this.iend_size=12,this.buffer_size=this.iend_offs+this.iend_size,this.buffer=new Array,this.palette=new Object,this.pindex=0;for(var o=new Array,a=0;a<this.buffer_size;a++)this.buffer[a]="\0";e(this.buffer,this.ihdr_offs,i(this.ihdr_size-12),"IHDR",i(t),i(r),"\b"),e(this.buffer,this.plte_offs,i(this.plte_size-12),"PLTE"),e(this.buffer,this.trns_offs,i(this.trns_size-12),"tRNS"),e(this.buffer,this.idat_offs,i(this.idat_size-12),"IDAT"),e(this.buffer,this.iend_offs,i(this.iend_size-12),"IEND");var u,h=30912;h+=31-h%31,e(this.buffer,this.idat_offs+8,(u=h,String.fromCharCode(u>>8&255,255&u)));for(a=0;(a<<16)-1<this.pix_size;a++){var c,f;a+65535<this.pix_size?(c=65535,f="\0"):(c=this.pix_size-(a<<16)-a,f=""),e(this.buffer,this.idat_offs+8+2+(a<<16)+(a<<2),f,n(c),n(~c))}for(a=0;a<256;a++){for(var l=a,d=0;d<8;d++)l=1&l?-306674912^l>>1&2147483647:l>>1&2147483647;o[a]=l}this.index=function(t,e){var i=e*(this.width+1)+t+1;return this.idat_offs+8+2+5*Math.floor(i/65535+1)+i},this.color=function(t,e,i,n){var r=(((n=n>=0?n:255)<<8|t)<<8|e)<<8|i;if(void 0===this.palette[r]){if(this.pindex==this.depth)return"\0";var s=this.plte_offs+8+3*this.pindex;this.buffer[s+0]=String.fromCharCode(t),this.buffer[s+1]=String.fromCharCode(e),this.buffer[s+2]=String.fromCharCode(i),this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(n),this.palette[r]=String.fromCharCode(this.pindex++)}return this.palette[r]},this.getBase64=function(){var t,e,i,n,r,s,o,a=this.getDump(),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=a.length,c=0,f="";do{n=(t=a.charCodeAt(c))>>2,r=(3&t)<<4|(e=a.charCodeAt(c+1))>>4,i=a.charCodeAt(c+2),s=h<c+2?64:(15&e)<<2|i>>6,o=h<c+3?64:63&i,f+=u.charAt(n)+u.charAt(r)+u.charAt(s)+u.charAt(o)}while((c+=3)<h);return f},this.getDump=function(){for(var t=1,n=0,r=5552,s=0;s<this.height;s++)for(var a=-1;a<this.width;a++)n+=t+=this.buffer[this.index(a,s)].charCodeAt(0),0==(r-=1)&&(t%=65521,n%=65521,r=5552);function u(t,n,r){for(var s=-1,a=4;a<r-4;a+=1)s=o[255&(s^t[n+a].charCodeAt(0))]^s>>8&16777215;e(t,n+r-4,i(-1^s))}return t%=65521,n%=65521,e(this.buffer,this.idat_offs+this.idat_size-8,i(n<<16|t)),u(this.buffer,this.ihdr_offs,this.ihdr_size),u(this.buffer,this.plte_offs,this.plte_size),u(this.buffer,this.trns_offs,this.trns_size),u(this.buffer,this.idat_offs,this.idat_size),u(this.buffer,this.iend_offs,this.iend_size),"ÂPNG\r\n\n"+this.buffer.join("")}}}()}),Ls=i(function(t){!function(){var e;e=Vs;var i=function(t,e){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof e?e:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var i=parseInt(this.hash.substr(-7),16)/268435455,n=this.options.saturation||this.defaults.saturation,r=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(i,n,r)};i.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new n(this.size,this.foreground,this.background):new e(this.size,this.size,256)},render:function(){var t,e,i=this.image(),n=this.size,r=Math.floor(n*this.margin),s=Math.floor((n-2*r)/5),o=Math.floor((n-5*s)/2),a=i.color.apply(i,this.background),u=i.color.apply(i,this.foreground);for(t=0;t<15;t++)e=parseInt(this.hash.charAt(t),16)%2?a:u,t<5?this.rectangle(2*s+o,t*s+o,s,s,e,i):t<10?(this.rectangle(1*s+o,(t-5)*s+o,s,s,e,i),this.rectangle(3*s+o,(t-5)*s+o,s,s,e,i)):t<15&&(this.rectangle(0*s+o,(t-10)*s+o,s,s,e,i),this.rectangle(4*s+o,(t-10)*s+o,s,s,e,i));return i},rectangle:function(t,e,i,n,r,s){var o,a;if(this.isSvg())s.rectangles.push({x:t,y:e,w:i,h:n,color:r});else for(o=t;o<t+i;o++)for(a=e;a<e+n;a++)s.buffer[s.index(o,a)]=r},hsl2rgb:function(t,e,i){return[255*(e=[i+=e*=i<.5?i:1-i,i-(t*=6)%1*e*2,i-=e*=2,i,i+t%1*e,i+e])[~~t%6],255*e[(16|t)%6],255*e[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var n=function(t,e,i){this.size=t,this.foreground=this.color.apply(this,e),this.background=this.color.apply(this,i),this.rectangles=[]};n.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,e,i,n){var r=[t,e,i].map(Math.round);return r.push(n>=0&&n<=255?n/255:1),"rgba("+r.join(",")+")"},getDump:function(){var t,e,i,n=this.foreground,r=this.background,s=.005*this.size;for(e="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+r+";'><g style='fill:"+n+"; stroke:"+n+"; stroke-width:"+s+";'>",t=0;t<this.rectangles.length;t++)(i=this.rectangles[t]).color!=r&&(e+="<rect  x='"+i.x+"' y='"+i.y+"' width='"+i.w+"' height='"+i.h+"'/>");return e+="</g></svg>"},getBase64:function(){if(btoa)return btoa(this.getDump());if(vt)return new vt(this.getDump(),"binary").toString("base64");throw"Cannot generate base64 output"}},t.exports=i}()}),Ms=function(){function t(e){Ni(this,t),this.gun=e}return t.create=function(e,i){if(i.receivedNegative|=i.receivedNegative||0,i.receivedPositive|=i.receivedPositive||0,i.receivedNeutral=i.receivedNeutral||0,i.sentNegative=i.sentNegative||0,i.sentPositive=i.sentPositive||0,i.sentNeutral=i.sentNeutral||0,i.trustDistance=i.hasOwnProperty("trustDistance")?i.trustDistance:99,i.attrs=i.attrs||{},Array.isArray(i.attrs)){for(var n={};i.attrs.length;){var r=i.attrs.pop();n[encodeURIComponent(r.name)+":"+encodeURIComponent(r.val)]=r}i.attrs=n}i.mostVerifiedAttributes=t.getMostVerifiedAttributes(i.attrs);var s=-1;return _s(i.mostVerifiedAttributes).forEach(function(t){var e=i.mostVerifiedAttributes[t];ks.isUniqueType(t)&&e.verificationScore>s&&(i.linkTo={name:t,val:e.attribute.val},s=e.verificationScore)}),i.linkTo||(i.linkTo=i.attrs[_s(i.attrs)[0]]),"keyID"!==i.linkTo.name&&i.mostVerifiedAttributes.keyID&&(i.linkTo=i.mostVerifiedAttributes.keyID.attribute),new t(e.set(i))},t.getMostVerifiedAttributes=function(t){var e={};return _s(t).forEach(function(i){var n=t[i],r=_s(e).indexOf(n.name)>-1;2*n.conf>3*n.ref&&(!r||n.conf-n.ref>e[n.name].verificationScore)&&(e[n.name]={attribute:n,verificationScore:n.conf-n.ref})}),e},t.prototype.verified=function(t){return this.mostVerifiedAttributes.hasOwnProperty(t)?this.mostVerifiedAttributes[t].attribute.val:void 0},t.prototype.profileCard=function(){var e=this,i=document.createElement("div");i.className="identifi-card";var n=this.identicon(60);n.style.order=1,n.style.flexShrink=0,n.style.marginRight="15px";var r=document.createElement("div");r.style.padding="5px",r.style.order=2,r.style.flexGrow=1;var s=document.createElement("span"),o=document.createElement("small");return i.appendChild(n),i.appendChild(r),r.appendChild(s),r.appendChild(o),this.gun.on(async function(i){if(i){var n=await new Is(function(t){e.gun.get("attrs").load(function(e){return t(e)})}),r=await e.gun.get("linkTo").then(),a="https://identi.fi/#/identities/"+r.name+"/"+r.val,u=t.getMostVerifiedAttributes(n);s.innerHTML='<a href="'+a+'">'+(u.name&&u.name.attribute.val||u.nickname&&u.nickname.attribute.val||r.name+":"+r.val)+"</a><br>",s.innerHTML+='<small>Received: <span class="identifi-pos">+'+(i.receivedPositive||0)+'</span> / <span class="identifi-neg">-'+(i.receivedNegative||0)+"</span></small><br>",o.innerHTML="",_s(n).forEach(function(t){var e=n[t];e.link&&(o.innerHTML+=e.name+': <a href="'+e.link+'">'+e.val+"</a> ")})}}),i},t.appendSearchWidget=function(t,e){var i=document.createElement("form"),n=document.createElement("input");n.type="text",n.placeholder="Search",n.id="identifiSearchInput",i.innerHTML+='<div id="identifiSearchResults"></div>';var r=document.createElement("div");t.appendChild(i),i.appendChild(n),i.appendChild(r),n.addEventListener("keyup",async function(){var t=await e.search(n.value);r.innerHTML="",t.sort(function(t,e){return t.trustDistance-e.trustDistance}),t.forEach(function(t){r.appendChild(t.profileCard())})})},t._ordinal=function(t){var e=["th","st","nd","rd"],i=t%100;return t+(e[(i-20)%10]||e[i]||e[0])},t._injectCss=function(){if(!document.getElementById("identifiStyle")){var t=document.createElement("style");t.id="identifiStyle",t.innerHTML="\n      .identifi-identicon * {\n        box-sizing: border-box;\n      }\n\n      .identifi-identicon {\n        vertical-align: middle;\n        margin: auto;\n        border-radius: 50%;\n        text-align: center;\n        display: inline-block;\n        position: relative;\n        margin: auto;\n        max-width: 100%;\n      }\n\n      .identifi-distance {\n        z-index: 2;\n        position: absolute;\n        left:0%;\n        top:2px;\n        width: 100%;\n        text-align: right;\n        color: #fff;\n        text-shadow: 0 0 1px #000;\n        font-size: 75%;\n        line-height: 75%;\n        font-weight: bold;\n      }\n\n      .identifi-pie {\n        border-radius: 50%;\n        position: absolute;\n        top: 0;\n        left: 0;\n        box-shadow: 0px 0px 0px 0px #82FF84;\n        padding-bottom: 100%;\n        max-width: 100%;\n        -webkit-transition: all 0.2s ease-in-out;\n        -moz-transition: all 0.2s ease-in-out;\n        transition: all 0.2s ease-in-out;\n      }\n\n      .identifi-card {\n        padding: 10px;\n        background-color: #f7f7f7;\n        color: #777;\n        border: 1px solid #ddd;\n        display: flex;\n        flex-direction: row;\n        overflow: hidden;\n      }\n\n      .identifi-card a {\n        -webkit-transition: color 150ms;\n        transition: color 150ms;\n        text-decoration: none;\n        color: #337ab7;\n      }\n\n      .identifi-card a:hover, .identifi-card a:active {\n        text-decoration: underline;\n        color: #23527c;\n      }\n\n      .identifi-pos {\n        color: #3c763d;\n      }\n\n      .identifi-neg {\n        color: #a94442;\n      }\n\n      .identifi-identicon img {\n        position: absolute;\n        top: 0;\n        left: 0;\n        max-width: 100%;\n        border-radius: 50%;\n        border-color: transparent;\n        border-style: solid;\n      }",document.body.appendChild(t)}},t.prototype.identicon=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t._injectCss();var r=document.createElement("div");r.className="identifi-identicon",r.style.width=e+"px",r.style.height=e+"px";var s=document.createElement("div");s.className="identifi-pie",s.style.width=e+"px";var o=document.createElement("img");o.alt="",o.width=e,o.style.borderWidth=i+"px";var a=void 0;return n&&((a=document.createElement("span")).className="identifi-distance",a.style.fontSize=e>50?e/4+"px":"10px",r.appendChild(a)),r.appendChild(s),r.appendChild(o),this.gun.on(function(r){if(r){var u="rgba(0,0,0,0.2)",h="none",c="",f="0px 0px 0px 0px #82FF84";r.receivedPositive>20*r.receivedNegative?f="0px 0px "+i*r.receivedPositive/50+"px 0px #82FF84":r.receivedPositive<3*r.receivedNegative&&(f="0px 0px "+i*r.receivedNegative/10+"px 0px #BF0400"),r.receivedPositive+r.receivedNegative>0&&(r.receivedPositive>r.receivedNegative?(c="rotate("+(-r.receivedPositive/(r.receivedPositive+r.receivedNegative)*360-180)/2+"deg)",u="#A94442",h="linear-gradient("+r.receivedPositive/(r.receivedPositive+r.receivedNegative)*360+"deg, transparent 50%, #3C763D 50%), linear-gradient(0deg, #3C763D 50%, transparent 50%)"):(c="rotate("+((-r.receivedNegative/(r.receivedPositive+r.receivedNegative)*360-180)/2+180)+"deg)",u="#3C763D",h="linear-gradient("+r.receivedNegative/(r.receivedPositive+r.receivedNegative)*360+"deg, transparent 50%, #A94442 50%), linear-gradient(0deg, #A94442 50%, transparent 50%)")),s.style.backgroundColor=u,s.style.backgroundImage=h,s.style.boxShadow=f,s.style.transform=c,s.style.opacity=(r.receivedPositive+r.receivedNegative)/10*.5+.35;var l=new Ii({alg:"md5",prov:"cryptojs"}).digestString(Bi(r.linkTo)),d=new Ls(l,{width:e,format:"svg"});o.src="data:image/svg+xml;base64,"+d.toString(),n&&(a.textContent=r.trustDistance<1e3?t._ordinal(r.trustDistance):"â")}}),r},t}(),Ks=W.f,Us=(js=!1,function(t){for(var e,i=T(t),n=G(i),r=n.length,s=0,o=[];r>s;)Ks.call(i,e=n[s++])&&o.push(js?[e,i[e]]:i[e]);return o});E(E.S,"Object",{values:function(t){return Us(t)}});var qs=r.Object.values,$s=e(i(function(t){t.exports={default:qs,__esModule:!0}}));E(E.S,"Number",{isNaN:function(t){return t!=t}});var zs=r.Number.isNaN,Gs=e(i(function(t){t.exports={default:zs,__esModule:!0}})),Js=void 0,Ws=function(){function t(){Ni(this,t)}return t.getDefault=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";if(Js)return Js;if(Ps.isNode){var i=require("fs"),n=e+"/private.key";if(i.existsSync(n)){var r=i.readFileSync(n,"utf8");Js=t.fromJwk(r)}else Js=t.generate(),i.writeFileSync(n,t.toJwk(Js)),i.chmodSync(n,400)}else{var s=window.localStorage.getItem("identifi.myKey");s?Js=t.fromJwk(s):(Js=t.generate(),window.localStorage.setItem("identifi.myKey",t.toJwk(Js)))}return Js},t.toJwk=function(t){return Bi(Ti.getJWKFromKey(t))},t.fromJwk=function(e){var i=Ti.getKey(JSON.parse(e));return i.pubKeyASN1=t._getPubKeyASN1(i),i.keyID=Ps.getHash(i.pubKeyASN1),i},t.generate=function(){var e=Ti.generateKeypair("EC","secp256r1");return e.prvKeyObj.pubKeyASN1=t._getPubKeyASN1(e.pubKeyObj),e.prvKeyObj.keyID=Ps.getHash(e.prvKeyObj.pubKeyASN1),e.prvKeyObj},t._getPubKeyASN1=function(t){"P-256"===t.curveName&&(t.curveName="secp256r1");var e=Ti.getPEM(t);return Pi(e)},t}(),Ys=i(function(e){!function(){function i(t){function e(t){return t.split("/").slice(-1).toString().replace(".js","")}return t.slice?i[e(t)]:function(n,r){t(n={exports:{}}),i[e(r)]=n.exports}}var n;"undefined"!=typeof window&&(n=window),void 0!==t&&(n=t);var r=(n=n||{}).console||{log:function(){}},s=e;i(function(t){var e={fn:{is:function(t){return!!t&&"function"==typeof t}}};e.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},e.num={is:function(t){return!n(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},e.text={is:function(t){return"string"==typeof t}},e.text.ify=function(t){return e.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},e.text.random=function(t,e){var i="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)i+=e.charAt(Math.floor(Math.random()*e.length)),t--;return i},e.text.match=function(t,i){var n=!1;if(t=t||"",i=e.text.is(i)?{"=":i}:i||{},e.obj.has(i,"~")&&(t=t.toLowerCase(),i["="]=(i["="]||i["~"]).toLowerCase()),e.obj.has(i,"="))return t===i["="];if(e.obj.has(i,"*")){if(t.slice(0,i["*"].length)!==i["*"])return!1;n=!0,t=t.slice(i["*"].length)}if(e.obj.has(i,"!")){if(t.slice(-i["!"].length)!==i["!"])return!1;n=!0}if(e.obj.has(i,"+")&&e.list.map(e.list.is(i["+"])?i["+"]:[i["+"]],function(e){return!(t.indexOf(e)>=0)||void(n=!0)}))return!1;if(e.obj.has(i,"-")&&e.list.map(e.list.is(i["-"])?i["-"]:[i["-"]],function(e){return!(t.indexOf(e)<0)||void(n=!0)}))return!1;if(e.obj.has(i,">")){if(!(t>i[">"]))return!1;n=!0}if(e.obj.has(i,"<")){if(!(t<i["<"]))return!1;n=!0}if(e.obj.has(i,"?")){if(!function(t,e){for(var i,n=-1,r=0;i=e[r++];)if(!~(n=t.indexOf(i,n+1)))return!1;return!0}(t,i["?"]))return!1;n=!0}return n},e.list={is:function(t){return t instanceof Array}},e.list.slit=Array.prototype.slice,e.list.sort=function(t){return function(e,i){return e&&i?(e=e[t],(i=i[t])>e?-1:e>i?1:0):0}},e.list.map=function(t,e,i){return a(t,e,i)},e.list.index=1,e.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=function(t,e,i){return(t||{})[e]=i,t},e.obj.has=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},e.obj.del=function(t,e){return t?(t[e]=null,delete t[e],t):void 0},e.obj.as=function(t,e,i,n){return t[e]=t[e]||(n===i?{}:i)},e.obj.ify=function(t){if(s(t))return t;try{t=JSON.parse(t)}catch(e){t={}}return t},function(){function t(t,e){o(this,e)&&i!==this[e]||(this[e]=t)}var i;e.obj.to=function(e,i){return a(e,t,i=i||{}),i}}(),e.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,e){var i=this.n;if(!i||!(e===i||s(i)&&o(i,e)))return!!e||void 0}e.obj.empty=function(e,i){return!e||!a(e,t,{n:i})}}(),function(){function t(e,i){return 2===arguments.length?(t.r=t.r||{},void(t.r[e]=i)):(t.r=t.r||[],void t.r.push(e))}var r=Object.keys;e.obj.map=function(a,u,h){var c,f,l,d,p,g=0,v=i(u);if(t.r=null,r&&s(a)&&(d=r(a),p=!0),n(a)||d)for(f=(d||a).length;f>g;g++){var y=g+e.list.index;if(v){if((l=p?u.call(h||this,a[d[g]],d[g],t):u.call(h||this,a[g],y,t))!==c)return l}else if(u===a[p?d[g]:g])return d?d[g]:y}else for(g in a)if(v){if(o(a,g)&&(l=h?u.call(h,a[g],g,t):u(a[g],g,t))!==c)return l}else if(u===a[g])return g;return v?t.r:e.list.index?0:-1}}(),e.time={},e.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var i=e.fn.is,n=e.list.is,r=e.obj,s=r.is,o=r.has,a=r.map;t.exports=e})(i,"./type"),i(function(t){t.exports=function t(e,i,n){if(!e)return{to:t};e=(this.tag||(this.tag={}))[e]||(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}});if(i instanceof Function){var r={off:t.off||(t.off=function(){return this.next===t._.next||(this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,void(this.the.last===this.the&&delete this.on.tag[this.the.tag]))}),to:t._,next:i,the:e,on:this,as:n};return(r.back=e.last||e).to=r,e.last=r}return(e=e.to)&&void 0!==i&&e.next(i),e}})(i,"./onto"),i(function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var e=JSON.stringify;t.exports=function(t,i,n,r,s){if(i>t)return{defer:!0};if(n>i)return{historical:!0};if(i>n)return{converge:!0,incoming:!0};if(i===n){if((r=e(r)||"")===(s=e(s)||""))return{state:!0};if(s>r)return{converge:!0,current:!0};if(r>s)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+r+" to "+s+" at "+i+" to "+n+"!"}}})(i,"./HAM"),i(function(t){var e=i("./type"),n={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(a(t)||s(t)||o(t))||(n.rel.is(t)||!1)))}};n.link=n.rel={_:"#"},function(){function t(t,e){var i=this;return i.id?i.id=!1:e==r&&a(t)?void(i.id=t):i.id=!1}n.rel.is=function(e){if(e&&e[r]&&!e._&&h(e)){var i={};if(f(e,t,i),i.id)return i.id}return!1}}(),n.rel.ify=function(t){return c({},r,t)},e.obj.has._=".";var r=n.link._,s=e.bi.is,o=e.num.is,a=e.text.is,u=e.obj,h=u.is,c=u.put,f=u.map;t.exports=n})(i,"./val"),i(function(t){var e=i("./type"),n=i("./val"),r={_:"_",soul:function(t,e){return t&&t._&&t._[e||c]}};r.soul.ify=function(t,e){return e="string"==typeof e?{soul:e}:e||{},(t=t||{})._=t._||{},t._[c]=e.soul||t._[c]||h(),t},r.soul._=n.link._,function(){function t(t,e){return e!==r._?!n.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s)):void 0}r.is=function(e,i,n){var s;return!(!o(e)||!(s=r.soul(e)))&&!u(e,t,{as:n,cb:i,s:s,n:e})}}(),function(){function t(t,e){var i,r=this.o;return r.map?void(void 0===(i=r.map.call(this.as,t,""+e,r.node))?a(r.node,e):r.node&&(r.node[e]=i)):void(n.is(t)&&(r.node[e]=t))}r.ify=function(e,i,n){return i?"string"==typeof i?i={soul:i}:i instanceof Function&&(i={map:i}):i={},i.map&&(i.node=i.map.call(n,e,void 0,i.node||{})),(i.node=r.soul.ify(i.node||{},i))&&u(e,t,{o:i,as:n}),i.node}}();var s=e.obj,o=s.is,a=s.del,u=s.map,h=e.text.random,c=r.soul._;t.exports=r})(i,"./node"),i(function(t){function e(){var t;return(t=s())>o?(a=0,o=t+e.drift):o=t+(a+=1)/u+e.drift}var n=i("./type"),r=i("./node"),s=n.time.is,o=-1/0,a=0,u=1e3,h="undefined"!=typeof performance&&(performance.timing&&performance);h&&h.timing&&h.timing.navigationStart||(h=!1),e._=">",e.drift=0,e.is=function(t,i,n){var r=i&&t&&t[b]&&t[b][e._]||n;if(r)return y(r=r[i])?r:-1/0},e.lex=function(){return e().toString(36).replace(".","")},e.ify=function(t,i,n,s,o){if(!t||!t[b]){if(!o)return;t=r.soul.ify(t,o)}var a=l(t[b],e._);return c!==i&&i!==b&&(y(n)&&(a[i]=n),c!==s&&(t[i]=s)),t},e.to=function(t,i,n){var s=t[i];return p(s)&&(s=v(s)),e.ify(n,i,e.is(t,i),s,r.soul(t))},function(){function t(t,i){b!==i&&e.ify(this.o,i,this.s)}e.map=function(i,n,r){var s,o=p(o=i||n)?o:null;return i=m(i=i||n)?i:null,o&&!i?(n=y(n)?n:e(),o[b]=o[b]||{},g(o,t,{o:o,s:n}),o):(r=r||p(n)?n:s,n=y(n)?n:e(),function(e,o,a,u){return i?(i.call(r||this||{},e,o,a,u),void(d(a,o)&&s===a[o]||t.call({o:a,s:n},e,o))):(t.call({o:a,s:n},e,o),e)})}}();var c,f=n.obj,l=f.as,d=f.has,p=f.is,g=f.map,v=f.copy,y=n.num.is,m=n.fn.is,b=r._;t.exports=e})(i,"./state"),i(function(t){var e=i("./type"),n=i("./val"),r=i("./node"),s={};!function(){function t(t,i){return!t||i!==r.soul(t)||!r.is(t,this.fn,this.as)||void(this.cb&&(e.n=t,e.as=this.as,this.cb.call(e.as,t,i,e)))}function e(t){t&&r.is(e.n,t,e.as)}s.is=function(e,i,n,r){return!(!e||!u(e)||f(e))&&!d(e,t,{cb:i,fn:n,as:r})}}(),function(){function t(t,e){var s;return(s=function(t,e){for(var i,n=t.seen,r=n.length;r--;)if(i=n[r],e.obj===i.obj)return i;n.push(e)}(t,e))?s:(e.env=t,e.soul=a,r.ify(e.obj,i,e)&&(e.rel=e.rel||n.rel.ify(r.soul(e.node)),e.obj!==t.shell&&(t.graph[n.rel.is(e.rel)]=e.node)),e)}function i(e,i,s){var a,u,l=this,d=l.env;if(r._===i&&c(e,n.rel._))return s._;if(a=f(e,i,s,l,d)){if(i||(l.node=l.node||s||{},c(e,r._)&&r.soul(e)&&(l.node._=p(e._)),l.node=r.soul.ify(l.node,n.rel.is(l.rel)),l.rel=l.rel||n.rel.ify(r.soul(l.node))),(u=d.map)&&(u.call(d.as||{},e,i,s,l),c(s,i))){if(e=s[i],o===e)return void h(s,i);if(!(a=f(e,i,s,l,d)))return}if(!i)return l.node;if(!0===a)return e;if((u=t(d,{obj:e,path:l.path.concat(i)})).node)return u.rel}}function a(t){var e=this,i=n.link.is(e.rel),s=e.env.graph;e.rel=e.rel||n.rel.ify(t),e.rel[n.rel._]=t,e.node&&e.node[r._]&&(e.node[r._][n.rel._]=t),c(s,i)&&(s[t]=s[i],h(s,i))}function f(t,i,r,s,o){var a;return!!n.is(t)||(u(t)?1:(a=o.invalid)?f(t=a.call(o.as||{},t,i,r),i,r,s,o):(o.err="Invalid value at '"+s.path.concat(i).join(".")+"'!",void(e.list.is(t)&&(o.err+=" Use `.set(item)` instead of an Array."))))}s.ify=function(e,i,r){var s={path:[],obj:e};return i?"string"==typeof i?i={soul:i}:i instanceof Function&&(i.map=i):i={},i.soul&&(s.rel=n.rel.ify(i.soul)),i.shell=(r||{}).shell,i.graph=i.graph||{},i.seen=i.seen||[],i.as=i.as||r,t(i,s),i.root=s.node,i.graph}}(),s.node=function(t){var e=r.soul(t);if(e)return l({},e,t)},function(){function t(t,e){var i,o;if(r._!==e)return(i=n.rel.is(t))?(o=this.opt.seen[i])?void(this.obj[e]=o):void(this.obj[e]=this.opt.seen[i]=s.to(this.graph,i,this.opt)):void(this.obj[e]=t);f(t,n.rel._)||(this.obj[e]=p(t))}s.to=function(e,i,n){if(e){var r={};return n=n||{seen:{}},d(e[i],t,{obj:r,graph:e,opt:n}),r}}}();var o,a=(e.fn.is,e.obj),u=a.is,h=a.del,c=a.has,f=a.empty,l=a.put,d=a.map,p=a.copy;t.exports=s})(i,"./graph"),i(function(t){i("./onto"),t.exports=function(t,e){if(this.on){if(!(t instanceof Function)){if(!t||!e)return;var i=t["#"]||t,n=(this.tag||empty)[i];if(!n)return;return n=this.on(i,e),clearTimeout(n.err),!0}i=e&&e["#"]||Math.random().toString(36).slice(2);if(!t)return i;var r=this.on(i,t,e);return r.err=r.err||setTimeout(function(){r.next({err:"Error: No ACK received yet.",lack:!0}),r.off()},(this.opt||{}).lack||9e3),i}}})(i,"./ask"),i(function(t){var e=i("./type"),n=e.time.is;t.exports=function(t){var i={s:{}};return t=t||{max:1e3,age:9e3},i.check=function(t){var e;return!!(e=i.s[t])&&(e.pass?e.pass=!1:i.track(t))},i.track=function(r,s){var o=i.s[r]||(i.s[r]={});return o.was=n(),s&&(o.pass=!0),i.to||(i.to=setTimeout(function(){var r=n();e.obj.map(i.s,function(n,s){t.age>r-n.was||e.obj.del(i.s,s)}),i.to=null},t.age+9)),o},i}})(i,"./dup"),i(function(t){function e(t){return t instanceof e?(this._={gun:this,$:this}).$:this instanceof e?e.create(this._={gun:this,$:this,opt:t}):new e(t)}e.is=function(t){return t instanceof e||t&&t._&&t===t._.$||!1},e.version=.9,e.chain=e.prototype,e.chain.toJSON=function(){};var n=i("./type");n.obj.to(n,e),e.HAM=i("./HAM"),e.val=i("./val"),e.node=i("./node"),e.state=i("./state"),e.graph=i("./graph"),e.on=i("./onto"),e.ask=i("./ask"),e.dup=i("./dup"),function(){function t(i){var n,r,s=this,a=s.as,u=a.at||a,h=u.$;return(r=i["#"])||(r=i["#"]=c(9)),(n=u.dup).check(r)?void(a.out===i.out&&(i.out=o,s.to.next(i))):(n.track(r),u.ask(i["@"],i)||(i.get&&e.on.get(i,h),i.put&&e.on.put(i,h)),s.to.next(i),void(a.out||(i.out=t,u.on("out",i))))}e.create=function(i){i.root=i.root||i,i.graph=i.graph||{},i.on=i.on||e.on,i.ask=i.ask||e.ask,i.dup=i.dup||e.dup();var n=i.$.opt(i.opt);return i.once||(i.on("in",t,i),i.on("out",t,{at:i,out:t}),e.on("create",i),i.on("create",i)),i.once=1,n}}(),function(){function t(t,i,n,r){var s=this,o=e.state.is(n,i);if(!o)return s.err="Error: No state on '"+i+"' in node '"+r+"'!";var a=s.graph[r]||b,u=e.state.is(a,i,!0),h=a[i],c=e.HAM(s.machine,o,u,t,h);return c.incoming?(s.put[r]=e.state.to(n,i,s.put[r]),(s.diff||(s.diff={}))[r]=e.state.to(n,i,s.diff[r]),void(s.souls[r]=!0)):void(c.defer&&(s.defer=o<(s.defer||1/0)?o:s.defer))}function i(t,e){var i=this,o=i.$._,a=(o.next||b)[e];if(!a){if(!(o.opt||b).super)return void(i.souls[e]=!1);a=i.$.get(e)._}var u=i.map[e]={put:t,get:e,$:a.$},h={ctx:i,msg:u};i.async=!!o.tag.node,i.ack&&(u["@"]=i.ack),g(t,n,h),i.async&&(i.and||o.on("node",function(t){this.to.next(t),t===i.map[t.get]&&(i.souls[t.get]=!1,g(t.put,r,t),g(i.souls,function(t){return t||void 0})||i.c||(i.c=1,this.off(),g(i.map,s,i)))}),i.and=!0,o.on("node",u))}function n(t,i){var n=this.ctx,r=n.graph,s=this.msg,o=s.get,a=s.put,u=s.$._;r[o]=e.state.to(a,i,r[o]),n.async||(u.put=e.state.to(a,i,u.put))}function r(t,i){var n=this.put,r=this.$._;r.put=e.state.to(n,i,r.put)}function s(t){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}e.on.put=function(n,r){var a=r._,u={$:r,graph:a.graph,put:{},map:{},souls:{},machine:e.state(),ack:n["@"],cat:a,stop:{}};return e.graph.is(n.put,null,t,u)||(u.err="Error: Invalid graph!"),u.err?a.on("in",{"@":n["#"],err:e.log(u.err)}):(g(u.put,i,u),u.async||g(u.map,s,u),o!==u.defer&&setTimeout(function(){e.on.put(n,r)},u.defer-u.machine),void(u.diff&&a.on("put",p(n,{put:u.diff}))))},e.on.get=function(t,i){var n=i._,r=t.get,s=r[y],o=n.graph[s],a=r[m],u=(n.next||(n.next={}))[s];if(r["*"]){var h={};e.obj.map(n.graph,function(t,i){e.text.match(i,r)&&(h[i]=e.obj.copy(t))}),e.obj.empty(h)||n.on("in",{"@":t["#"],how:"*",put:h,$:i})}if(!o)return n.on("get",t);if(a){if(!d(o,a))return n.on("get",t);o=e.state.to(o,a)}else o=e.obj.copy(o);o=e.graph.node(o),(u||b).ack,n.on("in",{"@":t["#"],how:"mem",put:o,$:i}),n.on("get",t)}}(),e.chain.opt=function(t){t=t||{};var i=this._,n=t.peers||t;return l(t)||(t={}),l(i.opt)||(i.opt=t),h(n)&&(n=[n]),a(n)&&(n=g(n,function(t,e,i){i(t,{url:t})}),l(i.opt.peers)||(i.opt.peers={}),i.opt.peers=p(n,i.opt.peers)),i.opt.peers=i.opt.peers||{},p(t,i.opt),e.on("opt",i),i.opt.uuid=i.opt.uuid||function(){return v()+c(12)},this};var o,a=e.list.is,u=e.text,h=u.is,c=u.random,f=e.obj,l=f.is,d=f.has,p=f.to,g=f.map,v=(f.copy,e.state.lex),y=e.val.rel._,m=".",b=(e.node._,e.val.link.is,{});r.debug=function(t,e){return r.debug.i&&t===r.debug.i&&r.debug.i++&&(r.log.apply(r,arguments)||e)},e.log=function(){return!e.log.off&&r.log.apply(r,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(t,i,n){return(n=e.log.once)[t]=n[t]||0,n[t]++||e.log(i)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.Gun=e).window=window);try{void 0!==s&&(s.exports=e)}catch(t){}t.exports=e})(i,"./root"),i(function(){var t=i("./root");t.chain.back=function(i,r){if(-1===(i=i||1)||1/0===i)return this._.root.$;if(1===i)return(this._.back||this._).$;var s=this._;if("string"==typeof i&&(i=i.split(".")),!(i instanceof Array)){if(i instanceof Function){for(var o,a={back:s};(a=a.back)&&e===(o=i(a,r)););return o}return t.num.is(i)?(s.back||s).$.back(i-1):this}var u=0,h=i.length;for(a=s;h>u;u++)a=(a||n)[i[u]];return e!==a?r?this:a:(a=s.back)?a.$.back(i,r):void 0};var e,n={}})(i,"./back"),i(function(){function t(t){var e,i,n,r=this.as,s=r.back,o=r.root;if(t.I||(t.I=r.$),t.$||(t.$=r.$),this.to.next(t),i=t.get){if(i["#"]||r.soul){if(i["#"]=i["#"]||r.soul,t["#"]||(t["#"]=y(9)),s=o.$.get(i["#"])._,i=i["."]){if(d(s.put,i)&&((n=(e=s.$.get(i)._).ack)||(e.ack=-1),s.on("in",{$:s.$,put:h.state.to(s.put,i),get:s.get}),n))return}else{if((n=s.ack)||(s.ack=-1),d(s,"put")&&s.on("in",s),n)return;t.$=s.$}return o.ask(u,t),o.on("in",t)}if(o.now&&(o.now[r.id]=o.now[r.id]||!0,r.pass={}),i["."])return r.get?(t={get:{".":r.get},$:r.$},s.ask||(s.ask={}),s.ask[r.get]=t.$._,s.on("out",t)):(t={get:{},$:r.$},s.on("out",t));if(r.ack=r.ack||-1,r.get)return t.$=r.$,i["."]=r.get,(s.ask||(s.ask={}))[r.get]=t.$._,s.on("out",t)}return s.on("out",t)}function e(t){var e,i,s=this,u=s.as,l=u.root,y=(t.$||f)._||f,m=t.put;if(u.get&&t.get!==u.get&&(t=g(t,{get:u.get})),u.has&&y!==u&&(t=g(t,{$:u.$}),y.ack&&(u.ack=y.ack)),c===m){if(i=y.put,s.to.next(t),u.soul)return;if(c===i&&c!==y.put)return;return r(u,t),u.has&&a(u,t),p(y.echo,u.id),void p(u.map,y.id)}return u.soul?(s.to.next(t),r(u,t),void(u.next&&v(m,o,{msg:t,cat:u}))):(e=h.val.link.is(m))?(l.stop,(i=(i=l.stop||{})[y.id]||(i[y.id]={})).is=i.is||y.put,i[u.id]=y.put||!0,s.to.next(t),n(u,t,y,e),void r(u,t)):h.val.is(m)?(u.has||u.soul?a(u,t):(y.has||y.soul)&&((y.echo||(y.echo={}))[u.id]=y.echo[y.id]||u,(u.map||(u.map={}))[y.id]=u.map[y.id]||{at:y}),s.to.next(t),void r(u,t)):(u.has&&y!==u&&d(y,"put")&&(u.put=y.put),(e=h.node.soul(m))&&y.has&&(y.put=u.root.$.get(e)._.put),i=(l.stop||{})[y.id],s.to.next(t),n(u,t,y,e),r(u,t),void(u.next&&v(m,o,{msg:t,cat:u})))}function n(t,e,i,r){if(r&&m!==t.get){var s=t.root.$.get(r)._;t.has?i=s:i.has&&n(i,e,i,r),i!==t&&(i.$||(i={}),(i.echo||(i.echo={}))[t.id]=i.echo[t.id]||t,t.has&&!(t.map||f)[i.id]&&a(t,e),(r!==(s=i.id?(t.map||(t.map={}))[i.id]=t.map[i.id]||{at:i}:{}).link||s.pass||t.pass)&&(t.pass&&(h.obj.map(t.map,function(t){t.pass=!0}),p(t,"pass")),s.pass&&p(s,"pass"),t.has&&(t.link=r),function(t,e){var i=t.root.$.get(e)._;(!t.ack||(i.on("out",{get:{"#":e}}),t.ask))&&(i=t.ask,h.obj.del(t,"ask"),v(i||t.next,function(t,i){t.on("out",{get:{"#":e,".":i}})}),h.obj.del(t,"ask"))}(t,s.link=r)))}}function r(t,e){t.echo&&v(t.echo,s,e)}function s(t){t&&t.on&&t.on("in",this)}function o(t,e){var i,n,r,s=this.cat.next||f,o=this.msg;(m!==e||s[e])&&(n=s[e])&&(n.has?(c!==n.put&&h.val.link.is(t)||(n.put=t),i=n.$):(r=o.$)&&(r=(i=o.$.get(e))._,c!==r.put&&h.val.link.is(t)||(r.put=t)),n.on("in",{put:t,get:e,$:i,via:o}))}function a(t,e){if(t.has||t.soul){var i=t.map;t.root,t.map=null,t.has&&(t.link=null),(t.pass||e["@"]||null!==i)&&(c===i&&h.val.link.is(t.put)||(v(i,function(e){(e=e.at)&&p(e.echo,t.id)}),i=t.put,v(t.next,function(e,n){return c===i&&c!==t.put||(e.put=c,e.ack&&(e.ack=-1),void e.on("in",{get:n,$:e.$,put:c}))})))}}function u(t){var e=this.as,i=e.get||f,n=e.$._,r=(t.put||f)[i["#"]];if(n.ack&&(n.ack=n.ack+1||1),t.put&&(!i["."]||d(r,n.get)))return m==i["."]?void n.on("in",{get:n.get,put:h.val.link.ify(i["#"]),$:n.$,"@":t["@"]}):(t.$=n.root.$,void h.on.put(t,n.root.$));n.put===c&&n.on("in",{get:n.get,put:n.put=c,$:n.$,"@":t["@"]})}var h=i("./root");h.chain.chain=function(i){var n,r=this,s=r._,o=new(i||r).constructor(r),a=o._;return a.root=n=s.root,a.id=++n.once,a.back=r._,a.on=h.on,a.on("in",e,a),a.on("out",t,a),o};var c,f={},l=h.obj,d=l.has,p=(l.put,l.del),g=l.to,v=l.map,y=h.text.random,m=(h.val.rel._,h.node._)})(i,"./chain"),i(function(){function t(t,e,i,n){var r,s=t._;return(r=s.soul)?(e(r,n,s),t):(r=s.link)?(e(r,n,s),t):(t.get(function(t,i){i.rid(t);var s=(s=t.$)&&s._||{};r=s.link||s.soul||u.is(t.put)||h(t.put),e(r,n,t,i)},{out:{get:{".":!0}}}),t)}function e(t){var e,i=this,n=i.as,r=n.at.root,a=(t.$||{})._||{},h=t.put||a.put;if((e=r.now)&&i!==e[n.now])return i.to.next(t);if(i.seen&&a.id&&i.seen[a.id])return i.to.next(t);if((e=h)&&e[u._]&&(e=u.is(e))&&(e=(t.$$=a.root.gun.get(e))._,s!==e.put&&(t=o(t,{put:h=e.put}))),(e=r.mum)&&a.id){if(e[a.id])return;s===h||u.is(h)||(e[a.id]=!0)}return n.use(t,i),i.stun?void(i.stun=null):void i.to.next(t)}function n(t){var e,i=this.on;return!t||i.soul||i.has?this.off():(t=(t=(t=t.$||t)._||t).id)?(i.map,!!(e=this.seen||(this.seen={}))[t]||void(e[t]=!0)):void 0}var r=i("./root");r.chain.get=function(i,s,o){var h;if("string"!=typeof i){if(i instanceof Function){if(!0===s)return t(this,i,0,o);var f,l=(h=this)._,d=l.root,p=d.now;(o=s||{}).at=l,o.use=i,o.out=o.out||{},o.out.get=o.out.get||{},(f=l.on("in",e,o)).rid=n,(d.now={$:1})[o.now=l.id]=f;var g=d.mum;return d.mum={},l.on("out",o.out),d.mum=g,d.now=p,h}return a(i)?this.get(""+i,s,o):(p=u.is(i))?this.get(p,s,o):((o=this.chain())._.err={err:r.log("Invalid get request!",i)},s&&s.call(o,o._.err),o)}var v=this._;return(h=(v.next||c)[i])||(h=function(t,e){var i=e._,n=i.next,r=e.chain()._;return n||(n=i.next={}),n[r.get=t]=r,e===i.root.$?r.soul=t:(i.soul||i.has)&&(r.has=t),r}(i,this)),h=h.$,(p=v.stun)&&(h._.stun=h._.stun||p),s&&s instanceof Function&&h.get(s,o),h};var s,o=(r.obj.has,r.obj.to),a=r.num.is,u=r.val.link,h=r.node.soul,c=(r.node._,{})})(i,"./get"),i(function(){function t(t){t.batch=n;var e=t.opt||{},i=t.env=c.state.map(o,e.state);return i.soul=t.soul,t.graph=c.graph.ify(t.data,i,t),i.err?((t.ack||y).call(t,t.out={err:c.log(i.err)}),void(t.res&&t.res())):void t.batch()}function e(t){t&&t()}function n(){var t=this;t.graph&&!g(t.stun,s)&&(t.res=t.res||function(t){t&&t()},t.res(function(){var e=t.$.back(-1)._,i=e.ask(function(i){e.root.on("ack",i),i.err&&c.log(i),i.lack||this.off(),t.ack&&t.ack(i,this)},t.opt),n=e.root.now;l.del(e.root,"now");var r=e.root.mum;e.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":i}),e.root.mum=r?l.to(r,e.root.mum):r,e.root.now=n},t),t.res&&t.res())}function s(t){return!!t||void 0}function o(t,e,i,n){var r=this,s=c.is(t);!e&&n.path.length&&(r.res||m)(function(){for(var e=n.path,i=r.ref,o=(r.opt,0),u=e.length;u>o;o++)i=i.get(e[o]);s&&(i=t);var h=i._.dub;return h||(h=c.node.soul(n.obj))?(i.back(-1).get(h),void n.soul(h)):((r.stun=r.stun||{})[e]=!0,void i.get(a,!0,{as:{at:n,as:r,p:e}}))},{as:r,at:n})}function a(t,e,i,n){var r=(e=e.as).at;e=e.as;var s=((i||{}).$||{})._||{};return t=s.dub=s.dub||t||c.node.soul(r.obj)||c.node.soul(i.put||s.put)||c.val.rel.is(i.put||s.put)||(e.via.back("opt.uuid")||c.text.random)(),n&&(n.stun=!0),t?void u(s,s.dub=t,r,e):void s.via.back("opt.uuid")(function(t,i){return t?c.log(t):void u(s,s.dub=s.dub||i,r,e)})}function u(t,e,i,n){t.$.back(-1).get(e),i.soul(e),n.stun[i.path]=!1,n.batch()}function h(t,e,i,n){if(e=e.as,i.$&&i.$._){if(i.err)return void r.log("Please report this as an issue! Put.any.err");var s,o=i.$._,a=o.put,u=e.opt||{};if(!(s=e.ref)||!s._.now){if(n&&(n.stun=!0),e.ref!==e.$){if(!(s=e.$._.get||o.get))return void r.log("Please report this as an issue! Put.no.get");e.data=p({},s,e.data),s=null}if(f===a){if(!o.get)return;t||(s=o.$.back(function(t){return t.link||t.soul?t.link||t.soul:void(e.data=p({},t.get,e.data))})),s=s||o.get,o=o.root.$.get(s)._,e.soul=s,a=e.data}return e.not||(e.soul=e.soul||t)||(e.path&&d(e.data)?e.soul=(u.uuid||e.via.back("opt.uuid")||c.text.random)():(b==o.get&&(e.soul=(o.put||v)["#"]||o.dub),e.soul=e.soul||o.soul||o.soul||(u.uuid||e.via.back("opt.uuid")||c.text.random)()),e.soul)?void e.ref.put(e.data,e.soul,e):void e.via.back("opt.uuid")(function(t,i){return t?c.log(t):void e.ref.put(e.data,e.soul=i,e)})}}}var c=i("./root");c.chain.put=function(i,n,r){var s,o=this,a=o._,u=a.root.$;return(r=r||{}).data=i,r.via=r.$=r.via||r.$||o,"string"==typeof n?r.soul=n:r.ack=r.ack||n,a.soul&&(r.soul=a.soul),r.soul||u===o?d(r.data)?(r.soul=r.soul||(r.not=c.node.soul(r.data)||(r.via.back("opt.uuid")||c.text.random)()),r.soul?(r.$=o=u.get(r.soul),r.ref=r.$,t(r),o):(r.via.back("opt.uuid")(function(t,e){return t?c.log(t):void(r.ref||r.$).put(r.data,r.soul=e,r)}),o)):((r.ack||y).call(r,r.out={err:c.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),o):c.is(i)?(i.get(function(t,e,i){return!t&&c.val.is(i.put)?c.log("The reference you are saving is a",typeof i.put,'"'+i.put+'", not a node (object)!'):void o.put(c.val.rel.ify(t),n,r)},!0),o):(r.ref=r.ref||u._===(s=a.back)?o:s.$,r.ref._.soul&&c.val.is(r.data)&&a.get?(r.data=p({},a.get,r.data),r.ref.put(r.data,r.soul,r),o):(r.ref.get(h,!0,{as:r}),r.out||(r.res=r.res||e,r.$._.stun=r.ref._.stun),o))};var f,l=c.obj,d=l.is,p=l.put,g=l.map,v={},y=function(){},m=function(t,e){t.call(e||v)},b=c.node._})(i,"./put"),i(function(t){var e=i("./root");i("./chain"),i("./back"),i("./put"),i("./get"),t.exports=e})(i,"./index"),i(function(){function t(t,e){var i,n=this,s=t.$,o=((s||{})._||{}).put||t.put;if(n.at,r!==o){if(i=t.$$){if(i=t.$$._,r===i.put)return;o=i.put}n.change&&(o=t.put),n.as?n.ok.call(n.as,t,e):n.ok.call(s,o,t.get,t,e)}}function e(t,i,n){var s,o,a=this.as,u=(a.at,t.$),h=u._,c=h.put||t.put;if(o=t.$$){if(s=o=t.$$._,r===o.put)return;c=o.put}return(o=i.wait)&&(o=o[h.id])&&clearTimeout(o),n||r!==c&&!h.soul&&!h.link&&(!s||0<s.ack)?(i.rid(t),void a.ok.call(u||a.$,c,t.get)):void(o=(i.wait={})[h.id]=setTimeout(function(){e.call({as:a},t,i,o||1)},a.wait||99))}var n=i("./index");n.chain.on=function(e,i,n,r){var s,o=this,a=o._;if("string"==typeof e)return i?(s=a.on(e,i,n||a,r),n&&n.$&&(n.subs||(n.subs=[])).push(s),o):a.on(e);var u=i;return(u=!0===u?{change:!0}:u||{}).at=a,u.ok=e,o.get(t,u),o},n.chain.val=function(t,e){return n.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,e)},n.chain.once=function(t,i){var s=this,o=s._,a=o.put;if(0<o.ack&&r!==a)return(t||u).call(s,a,o.get),s;if(!t){n.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var h=s.chain();return h._.nix=s.once(function(){h._.on("in",s._)}),h}return(i=i||{}).ok=t,i.at=o,i.out={"#":n.text.random(9)},s.get(e,{as:i}),i.async=!0,s},n.chain.off=function(){var t,e=this._,i=e.back;return i?((t=i.next)&&t[e.get]&&a(t,e.get),(t=i.ask)&&a(t,e.get),(t=i.put)&&a(t,e.get),(t=e.soul)&&a(i.root.graph,t),(t=e.map)&&o(t,function(t){t.link&&i.root.$.get(t.link).off()}),(t=e.next)&&o(t,function(t){t.$.off()}),e.on("off",{}),this):void 0};var r,s=n.obj,o=s.map,a=(s.has,s.del),u=(s.to,n.val.link,function(){})})(i,"./on"),i(function(){function t(t){return!t.put||n.val.is(t.put)?this.to.next(t):(this.as.nix&&this.off(),r(t.put,e,{at:this.as,msg:t}),void this.to.next(t))}function e(t,e){if(o!==e){var i=this.msg.$,n=this.at,r=i.get(e)._;(r.echo||(r.echo={}))[n.id]=r.echo[n.id]||n}}var n=i("./index");n.chain.map=function(e){var i,r=this,o=r._;return e?(n.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),i=r.chain(),r.map().on(function(t,r,o,a){var u=(e||s).call(this,t,r,o,a);if(void 0!==u)return t===u?i._.on("in",o):n.is(u)?i._.on("in",u._):void i._.on("in",{get:r,put:u})}),i):(i=o.each)?i:(o.each=i=r.chain(),i._.nix=r.back("nix"),r.on("in",t,i._),i)};var r=n.obj.map,s=function(){},o=n.node._})(i,"./map"),i(function(){var t=i("./index");t.chain.set=function(e,i,n){var r,s=this;if(i=i||function(){},(n=n||{}).item=n.item||e,r=t.node.soul(e))return s.set(s.back(-1).get(r),i,n);if(!t.is(e)){var o=s.back("opt.uuid")();return o&&t.obj.is(e)?s.set(s._.root.$.put(e,o),i,n):s.get(t.state.lex()+t.text.random(7)).put(e,i,n)}return e.get(function(e,r,o){return e?void s.put(t.obj.put({},e,t.val.link.ify(e)),i,n):i.call(s,{err:t.log('Only a node can be linked! Not "'+o.put+'"!')})},!0),e}})(i,"./set"),i(function(){if("undefined"!=typeof Gun){var t,e=function(){};"undefined"!=typeof window&&(t=window);var i=t.localStorage||{setItem:e,removeItem:e,getItem:e};Gun.on("create",function(t){function e(t){if(!t.err&&t.ok){var e=t["@"];setTimeout(function(){Gun.obj.map(a,function(t,i){Gun.obj.map(t,function(i,n){e===i&&delete t[n]}),u(t)&&delete a[i]}),l()},r.wait||1)}}var n=this.to,r=t.opt;if(t.once)return n.next(t);r.prefix=r.file||"gun/";var s,o,a=Gun.obj.ify(i.getItem("gap/"+r.prefix))||{},u=Gun.obj.empty;if(!u(a)){var h=Gun.obj.ify(i.getItem(r.prefix))||{},c={};Gun.obj.map(a,function(t,e){Gun.obj.map(t,function(t,i){c[e]=Gun.state.to(h[e],i,c[e])})}),setTimeout(function(){t.on("out",{put:c,"#":t.ask(e),I:t.$})},1)}t.on("out",function(t){t.lS||(t.I&&t.put&&!t["@"]&&!u(r.peers)&&(s=t["#"],Gun.graph.is(t.put,null,f),o||(o=setTimeout(l,r.wait||1))),this.to.next(t))}),t.on("ack",e),n.next(t);var f=function(t,e,i,n){(a[n]||(a[n]={}))[e]=s},l=function(){clearTimeout(o),o=!1;try{i.setItem("gap/"+r.prefix,JSON.stringify(a))}catch(t){Gun.log(err=t||"localStorage failure")}}}),Gun.on("create",function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";var n,r=(t.graph,{}),s=0,o=Gun.obj.ify(i.getItem(e.prefix))||{};t.on("localStorage",o),t.on("put",function(t){return this.to.next(t),Gun.graph.is(t.put,null,a),t["@"]||(r[t["#"]]=!0),(s+=1)>=(e.batch||1e3)?u():void(n||(n=setTimeout(u,e.wait||1)))}),t.on("get",function(i){function n(){if(u&&(r=u["#"])){var n=u["."];(s=o[r]||a)&&n&&(s=Gun.state.to(s,n)),(s||Gun.obj.empty(e.peers))&&t.on("in",{"@":i["#"],put:Gun.graph.node(s),how:"lS",lS:i.I})}}this.to.next(i);var r,s,a,u=i.get;Gun.debug?setTimeout(n,1):n()});var a=function(t,e,i,n){o[n]=Gun.state.to(i,e,o[n])},u=function(a){var h;s=0,clearTimeout(n),n=!1;var c=r;r={},a&&(o=a);try{i.setItem(e.prefix,JSON.stringify(o))}catch(i){Gun.log(h=i||"localStorage failure"),t.on("localStorage:error",{err:h,file:e.prefix,flush:o,retry:u})}(h||Gun.obj.empty(e.peers))&&Gun.obj.map(c,function(e,i){t.on("in",{"@":i,err:h,ok:0})})}}})}})(i,"./adapters/localStorage"),i(function(t){function e(t){var i=function(){},a=t.opt;return i.out=function(e){var n;return this.to&&this.to.next(e),(n=e["@"])&&(n=t.dup.s[n])&&(n=n.it)&&n.mesh?(i.say(e,n.mesh.via,1),void(n["##"]=e["##"])):void i.say(e)},t.on("create",function(e){e.opt.pid=e.opt.pid||n.text.random(9),this.to.next(e),t.on("out",i.out)}),i.hear=function(e,s){if(e){var o,a,u,h=t.dup,c=e[0];try{u=JSON.parse(e)}catch(t){r.log("DAM JSON parse error",t)}if("{"===c){if(!u)return;if(h.check(o=u["#"]))return;if(h.track(o,!0).it=u,(c=u["@"])&&u.put&&(c+=a=u["##"]||(u["##"]=i.hash(u)))!=o){if(h.check(c))return;(c=h.s)[a]=c[o]}return(u.mesh=function(){}).via=s,(c=u["><"])&&(u.mesh.to=n.obj.map(c.split(","),function(t,e,i){i(t,!0)})),u.dam?void((c=i.hear[u.dam])&&c(u,s,t)):void t.on("in",u)}if("["!==c);else{if(!u)return;for(var f,l=0;f=u[l++];)i.hear(f,s)}}},function(){function e(t,e){var i=e.wire;try{i.send?i.send(t):e.say&&e.say(t)}catch(i){(e.queue=e.queue||[]).push(t)}}i.say=function(r,s,u){var h,c,f;if(s){if((s.wire||a.wire&&a.wire(s))&&(c=r.mesh||o,s!==c.via&&((f=c.raw)||(f=i.raw(r)),!((h=r["@"])&&(h=t.dup.s[h])&&(h=h.it)&&h.get&&h["##"]&&h["##"]===r["##"]||(h=c.to)&&(h[s.url]||h[s.id])&&!u)))){if(s.batch)return void s.batch.push(f);s.batch=[],setTimeout(function(){var t=s.batch;t&&(s.batch=null,t.length&&e(JSON.stringify(t),s))},a.gap||a.wait||1),e(f,s)}}else n.obj.map(a.peers,function(t){i.say(r,t)})}}(),function(){function r(t,e){var i;return e instanceof Object?(n.obj.map(Object.keys(e).sort(),o,{to:i={},on:e}),i):e}function o(t){this.to[t]=this.on[t]}i.raw=function(e){if(!e)return"";var o,c,f,l=t.dup,d=e.mesh||{};if(f=d.raw)return f;if("string"==typeof e)return e;e["@"]&&(f=e.put)&&((c=e["##"])||(o=u(f,r)||"",c=i.hash(e,o),e["##"]=c),(f=l.s)[c=e["@"]+c]=f[e["#"]],e["#"]=c||e["#"],o&&((e=n.obj.to(e)).put=h));var p=0,g=[];n.obj.map(a.peers,function(t){return g.push(t.url||t.id),++p>9||void 0}),e["><"]=g.join();var v=u(e);return s!==o&&(f=v.indexOf(h,v.indexOf("put")),v=v.slice(0,f-1)+o+v.slice(f+h.length+1)),d&&(d.raw=v),v},i.hash=function(t,i){return e.hash(i||u(t.put,r)||"")||t["#"]||n.text.random(9)};var u=JSON.stringify,h=":])([:"}(),i.hi=function(e){var r=e.wire||{};e.id||e.url?(a.peers[e.url||e.id]=e,n.obj.del(a.peers,r.id)):(r=r.id=r.id||n.text.random(9),i.say({dam:"?"},a.peers[r]=e)),r.hied||t.on(r.hied="hi",e),r=e.queue,e.queue=[],n.obj.map(r,function(t){i.say(t,e)})},i.bye=function(e){n.obj.del(a.peers,e.id),t.on("bye",e)},i.hear["?"]=function(t,e){return t.pid?(e.id=e.id||t.pid,void i.hi(e)):i.say({dam:"?",pid:a.pid,"@":t["#"]},e)},i}var n=i("../type");e.hash=function(t){if("string"!=typeof t)return{err:1};var e=0;if(!t.length)return e;for(var i=0,n=t.length;n>i;++i)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e};var s,o={};Object.keys=Object.keys||function(t){return map(t,function(t,e,i){i(e)})};try{t.exports=e}catch(t){}})(i,"./adapters/mesh"),i(function(){var e=i("../index");e.Mesh=i("./mesh"),e.on("opt",function(i){function n(t){if(!t||!t.url)return i&&i(t);var e=t.url.replace("http","ws"),i=t.wire=new s.WebSocket(e);return i.onclose=function(){s.mesh.bye(t),r(t)},i.onerror=function(e){r(t),e&&e.code},i.onopen=function(){s.mesh.hi(t)},i.onmessage=function(e){e&&s.mesh.hear(e.data||e,t)},i}function r(t){clearTimeout(t.defer),t.defer=setTimeout(function(){n(t)},2e3)}this.to.next(i);var s=i.opt;if(!i.once&&!1!==s.WebSocket){var o;"undefined"!=typeof window&&(o=window),void 0!==t&&(o=t),o=o||{};var a=s.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;a&&(s.WebSocket=a,s.mesh=s.mesh||e.Mesh(i),s.wire,s.wire=n)}})})(i,"./adapters/websocket")}()}),Xs=i(function(e){!function(){var i;"undefined"!=typeof window&&(i=window),void 0!==t&&(i=t);var n=(i=i||{}).console||{log:function(){}};function r(t){return t.slice?r[e(t)]:function(i,n){t(i={exports:{}}),r[e(n)]=i.exports};function e(t){return t.split("/").slice(-1).toString().replace(".js","")}}var s=e;r(function(t){var e={fn:{is:function(t){return!!t&&"function"==typeof t}}};e.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},e.num={is:function(t){return!n(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},e.text={is:function(t){return"string"==typeof t}},e.text.ify=function(t){return e.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},e.text.random=function(t,e){var i="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)i+=e.charAt(Math.floor(Math.random()*e.length)),t--;return i},e.text.match=function(t,i){var n=!1;if(t=t||"",i=e.text.is(i)?{"=":i}:i||{},e.obj.has(i,"~")&&(t=t.toLowerCase(),i["="]=(i["="]||i["~"]).toLowerCase()),e.obj.has(i,"="))return t===i["="];if(e.obj.has(i,"*")){if(t.slice(0,i["*"].length)!==i["*"])return!1;n=!0,t=t.slice(i["*"].length)}if(e.obj.has(i,"!")){if(t.slice(-i["!"].length)!==i["!"])return!1;n=!0}if(e.obj.has(i,"+")&&e.list.map(e.list.is(i["+"])?i["+"]:[i["+"]],function(e){if(!(t.indexOf(e)>=0))return!0;n=!0}))return!1;if(e.obj.has(i,"-")&&e.list.map(e.list.is(i["-"])?i["-"]:[i["-"]],function(e){if(!(t.indexOf(e)<0))return!0;n=!0}))return!1;if(e.obj.has(i,">")){if(!(t>i[">"]))return!1;n=!0}if(e.obj.has(i,"<")){if(!(t<i["<"]))return!1;n=!0}if(e.obj.has(i,"?")){if(!function(t,e){for(var i,n=-1,r=0;i=e[r++];)if(!~(n=t.indexOf(i,n+1)))return!1;return!0}(t,i["?"]))return!1;n=!0}return n},e.list={is:function(t){return t instanceof Array}},e.list.slit=Array.prototype.slice,e.list.sort=function(t){return function(e,i){return e&&i?(e=e[t])<(i=i[t])?-1:e>i?1:0:0}},e.list.map=function(t,e,i){return a(t,e,i)},e.list.index=1,e.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=function(t,e,i){return(t||{})[e]=i,t},e.obj.has=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},e.obj.del=function(t,e){if(t)return t[e]=null,delete t[e],t},e.obj.as=function(t,e,i,n){return t[e]=t[e]||(n===i?{}:i)},e.obj.ify=function(t){if(s(t))return t;try{t=JSON.parse(t)}catch(e){t={}}return t},function(){var t;function i(e,i){o(this,i)&&t!==this[i]||(this[i]=e)}e.obj.to=function(t,e){return a(t,i,e=e||{}),e}}(),e.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,e){var i=this.n;if(!i||!(e===i||s(i)&&o(i,e)))return!!e||void 0}e.obj.empty=function(e,i){return!e||!a(e,t,{n:i})}}(),function(){function t(e,i){if(2===arguments.length)return t.r=t.r||{},void(t.r[e]=i);t.r=t.r||[],t.r.push(e)}var r=Object.keys;e.obj.map=function(a,u,h){var c,f,l,d,p,g=0,v=i(u);if(t.r=null,r&&s(a)&&(d=r(a),p=!0),n(a)||d)for(f=(d||a).length;g<f;g++){var y=g+e.list.index;if(v){if((l=p?u.call(h||this,a[d[g]],d[g],t):u.call(h||this,a[g],y,t))!==c)return l}else if(u===a[p?d[g]:g])return d?d[g]:y}else for(g in a)if(v){if(o(a,g)&&(l=h?u.call(h,a[g],g,t):u(a[g],g,t))!==c)return l}else if(u===a[g])return g;return v?t.r:e.list.index?0:-1}}(),e.time={},e.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var i=e.fn.is,n=e.list.is,r=e.obj,s=r.is,o=r.has,a=r.map;t.exports=e})(r,"./type"),r(function(t){t.exports=function t(e,i,n){if(!e)return{to:t};e=(this.tag||(this.tag={}))[e]||(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}});if(i instanceof Function){var r={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:i,the:e,on:this,as:n};return(r.back=e.last||e).to=r,e.last=r}return(e=e.to)&&void 0!==i&&e.next(i),e}})(r,"./onto"),r(function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var e=JSON.stringify;t.exports=function(t,i,n,r,s){if(t<i)return{defer:!0};if(i<n)return{historical:!0};if(n<i)return{converge:!0,incoming:!0};if(i===n){if((r=e(r)||"")===(s=e(s)||""))return{state:!0};if(r<s)return{converge:!0,current:!0};if(s<r)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+r+" to "+s+" at "+i+" to "+n+"!"}}})(r,"./HAM"),r(function(t){var e=r("./type"),i={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(a(t)||s(t)||o(t))||(i.rel.is(t)||!1)))}};i.link=i.rel={_:"#"},function(){function t(t,e){var i=this;return i.id?i.id=!1:e==n&&a(t)?void(i.id=t):i.id=!1}i.rel.is=function(e){if(e&&e[n]&&!e._&&h(e)){var i={};if(f(e,t,i),i.id)return i.id}return!1}}(),i.rel.ify=function(t){return c({},n,t)},e.obj.has._=".";var n=i.link._,s=e.bi.is,o=e.num.is,a=e.text.is,u=e.obj,h=u.is,c=u.put,f=u.map;t.exports=i})(r,"./val"),r(function(t){var e=r("./type"),i=r("./val"),n={_:"_",soul:function(t,e){return t&&t._&&t._[e||c]}};n.soul.ify=function(t,e){return e="string"==typeof e?{soul:e}:e||{},(t=t||{})._=t._||{},t._[c]=e.soul||t._[c]||h(),t},n.soul._=i.link._,function(){function t(t,e){if(e!==n._)return!i.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s))}n.is=function(e,i,r){var s;return!!o(e)&&(!!(s=n.soul(e))&&!u(e,t,{as:r,cb:i,s:s,n:e}))}}(),function(){function t(t,e){var n,r=this.o;r.map?void 0===(n=r.map.call(this.as,t,""+e,r.node))?a(r.node,e):r.node&&(r.node[e]=n):i.is(t)&&(r.node[e]=t)}n.ify=function(e,i,r){return i?"string"==typeof i?i={soul:i}:i instanceof Function&&(i={map:i}):i={},i.map&&(i.node=i.map.call(r,e,void 0,i.node||{})),(i.node=n.soul.ify(i.node||{},i))&&u(e,t,{o:i,as:r}),i.node}}();var s=e.obj,o=s.is,a=s.del,u=s.map,h=e.text.random,c=n.soul._;t.exports=n})(r,"./node"),r(function(t){var e=r("./type"),i=r("./node");function n(){var t;return t=s(),o<t?(a=0,o=t+n.drift):o=t+(a+=1)/u+n.drift}var s=e.time.is,o=-1/0,a=0,u=1e3,h="undefined"!=typeof performance&&(performance.timing&&performance);h&&h.timing&&h.timing.navigationStart||(h=!1);n._=">",n.drift=0,n.is=function(t,e,i){var r=e&&t&&t[b]&&t[b][n._]||i;if(r)return y(r=r[e])?r:-1/0},n.lex=function(){return n().toString(36).replace(".","")},n.ify=function(t,e,r,s,o){if(!t||!t[b]){if(!o)return;t=i.soul.ify(t,o)}var a=l(t[b],n._);return c!==e&&e!==b&&(y(r)&&(a[e]=r),c!==s&&(t[e]=s)),t},n.to=function(t,e,r){var s=t[e];return p(s)&&(s=v(s)),n.ify(r,e,n.is(t,e),s,i.soul(t))},function(){function t(t,e){b!==e&&n.ify(this.o,e,this.s)}n.map=function(e,i,r){var s,o=p(o=e||i)?o:null;return e=m(e=e||i)?e:null,o&&!e?(i=y(i)?i:n(),o[b]=o[b]||{},g(o,t,{o:o,s:i}),o):(r=r||p(i)?i:s,i=y(i)?i:n(),function(n,o,a,u){if(!e)return t.call({o:a,s:i},n,o),n;e.call(r||this||{},n,o,a,u),d(a,o)&&s===a[o]||t.call({o:a,s:i},n,o)})}}();var c,f=e.obj,l=f.as,d=f.has,p=f.is,g=f.map,v=f.copy,y=e.num.is,m=e.fn.is,b=i._;t.exports=n})(r,"./state"),r(function(t){var e=r("./type"),i=r("./val"),n=r("./node"),s={};!function(){function t(t,i){if(!t||i!==n.soul(t)||!n.is(t,this.fn,this.as))return!0;this.cb&&(e.n=t,e.as=this.as,this.cb.call(e.as,t,i,e))}function e(t){t&&n.is(e.n,t,e.as)}s.is=function(e,i,n,r){return!(!e||!u(e)||f(e))&&!d(e,t,{cb:i,fn:n,as:r})}}(),function(){function t(t,e){var s;return(s=function(t,e){var i,n=t.seen,r=n.length;for(;r--;)if(i=n[r],e.obj===i.obj)return i;n.push(e)}(t,e))?s:(e.env=t,e.soul=a,n.ify(e.obj,r,e)&&(e.rel=e.rel||i.rel.ify(n.soul(e.node)),e.obj!==t.shell&&(t.graph[i.rel.is(e.rel)]=e.node)),e)}function r(e,r,s){var a,u,l=this,d=l.env;if(n._===r&&c(e,i.rel._))return s._;if(a=f(e,r,s,l,d)){if(r||(l.node=l.node||s||{},c(e,n._)&&n.soul(e)&&(l.node._=p(e._)),l.node=n.soul.ify(l.node,i.rel.is(l.rel)),l.rel=l.rel||i.rel.ify(n.soul(l.node))),(u=d.map)&&(u.call(d.as||{},e,r,s,l),c(s,r))){if(e=s[r],o===e)return void h(s,r);if(!(a=f(e,r,s,l,d)))return}if(!r)return l.node;if(!0===a)return e;if((u=t(d,{obj:e,path:l.path.concat(r)})).node)return u.rel}}function a(t){var e=this,r=i.link.is(e.rel),s=e.env.graph;e.rel=e.rel||i.rel.ify(t),e.rel[i.rel._]=t,e.node&&e.node[n._]&&(e.node[n._][i.rel._]=t),c(s,r)&&(s[t]=s[r],h(s,r))}function f(t,n,r,s,o){var a;return!!i.is(t)||(u(t)?1:(a=o.invalid)?f(t=a.call(o.as||{},t,n,r),n,r,s,o):(o.err="Invalid value at '"+s.path.concat(n).join(".")+"'!",void(e.list.is(t)&&(o.err+=" Use `.set(item)` instead of an Array."))))}s.ify=function(e,n,r){var s={path:[],obj:e};return n?"string"==typeof n?n={soul:n}:n instanceof Function&&(n.map=n):n={},n.soul&&(s.rel=i.rel.ify(n.soul)),n.shell=(r||{}).shell,n.graph=n.graph||{},n.seen=n.seen||[],n.as=n.as||r,t(n,s),n.root=s.node,n.graph}}(),s.node=function(t){var e=n.soul(t);if(e)return l({},e,t)},function(){function t(t,e){var r,o;if(n._!==e)(r=i.rel.is(t))?(o=this.opt.seen[r])?this.obj[e]=o:this.obj[e]=this.opt.seen[r]=s.to(this.graph,r,this.opt):this.obj[e]=t;else{if(f(t,i.rel._))return;this.obj[e]=p(t)}}s.to=function(e,i,n){if(e){var r={};return n=n||{seen:{}},d(e[i],t,{obj:r,graph:e,opt:n}),r}}}();e.fn.is;var o,a=e.obj,u=a.is,h=a.del,c=a.has,f=a.empty,l=a.put,d=a.map,p=a.copy;t.exports=s})(r,"./graph"),r(function(t){r("./onto"),t.exports=function(t,e){if(this.on){if(!(t instanceof Function)){if(!t||!e)return;var i=t["#"]||t,n=(this.tag||empty)[i];if(!n)return;return n=this.on(i,e),clearTimeout(n.err),!0}i=e&&e["#"]||Math.random().toString(36).slice(2);if(!t)return i;var r=this.on(i,t,e);return r.err=r.err||setTimeout(function(){r.next({err:"Error: No ACK received yet.",lack:!0}),r.off()},(this.opt||{}).lack||9e3),i}}})(r,"./ask"),r(function(t){var e=r("./type");var i=e.time.is;t.exports=function(t){var n={s:{}};return t=t||{max:1e3,age:9e3},n.check=function(t){var e;return!!(e=n.s[t])&&(e.pass?e.pass=!1:n.track(t))},n.track=function(r,s){var o=n.s[r]||(n.s[r]={});return o.was=i(),s&&(o.pass=!0),n.to||(n.to=setTimeout(function(){var r=i();e.obj.map(n.s,function(i,s){t.age>r-i.was||e.obj.del(n.s,s)}),n.to=null},t.age+9)),o},n}})(r,"./dup"),r(function(t){function e(t){return t instanceof e?(this._={gun:this,$:this}).$:this instanceof e?e.create(this._={gun:this,$:this,opt:t}):new e(t)}e.is=function(t){return t instanceof e||t&&t._&&t===t._.$||!1},e.version=.9,e.chain=e.prototype,e.chain.toJSON=function(){};var i=r("./type");i.obj.to(i,e),e.HAM=r("./HAM"),e.val=r("./val"),e.node=r("./node"),e.state=r("./state"),e.graph=r("./graph"),e.on=r("./onto"),e.ask=r("./ask"),e.dup=r("./dup"),function(){function t(i){var n,r,s=this.as,a=s.at||s,u=a.$;(r=i["#"])||(r=i["#"]=c(9)),(n=a.dup).check(r)?s.out===i.out&&(i.out=o,this.to.next(i)):(n.track(r),a.ask(i["@"],i)||(i.get&&e.on.get(i,u),i.put&&e.on.put(i,u)),this.to.next(i),s.out||(i.out=t,a.on("out",i)))}e.create=function(i){i.root=i.root||i,i.graph=i.graph||{},i.on=i.on||e.on,i.ask=i.ask||e.ask,i.dup=i.dup||e.dup();var n=i.$.opt(i.opt);return i.once||(i.on("in",t,i),i.on("out",t,{at:i,out:t}),e.on("create",i),i.on("create",i)),i.once=1,n}}(),function(){function t(t,i,n,r){var s=this,o=e.state.is(n,i);if(!o)return s.err="Error: No state on '"+i+"' in node '"+r+"'!";var a=s.graph[r]||b,u=e.state.is(a,i,!0),h=a[i],c=e.HAM(s.machine,o,u,t,h);c.incoming?(s.put[r]=e.state.to(n,i,s.put[r]),(s.diff||(s.diff={}))[r]=e.state.to(n,i,s.diff[r]),s.souls[r]=!0):c.defer&&(s.defer=o<(s.defer||1/0)?o:s.defer)}function i(t,e){var i=this,o=i.$._,a=(o.next||b)[e];if(!a){if(!(o.opt||b).super)return void(i.souls[e]=!1);a=i.$.get(e)._}var u=i.map[e]={put:t,get:e,$:a.$},h={ctx:i,msg:u};i.async=!!o.tag.node,i.ack&&(u["@"]=i.ack),g(t,n,h),i.async&&(i.and||o.on("node",function(t){this.to.next(t),t===i.map[t.get]&&(i.souls[t.get]=!1,g(t.put,r,t),g(i.souls,function(t){if(t)return t})||i.c||(i.c=1,this.off(),g(i.map,s,i)))}),i.and=!0,o.on("node",u))}function n(t,i){var n=this.ctx,r=n.graph,s=this.msg,o=s.get,a=s.put,u=s.$._;r[o]=e.state.to(a,i,r[o]),n.async||(u.put=e.state.to(a,i,u.put))}function r(t,i){var n=this.put,r=this.$._;r.put=e.state.to(n,i,r.put)}function s(t,e){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}e.on.put=function(n,r){var a=r._,u={$:r,graph:a.graph,put:{},map:{},souls:{},machine:e.state(),ack:n["@"],cat:a,stop:{}};if(e.graph.is(n.put,null,t,u)||(u.err="Error: Invalid graph!"),u.err)return a.on("in",{"@":n["#"],err:e.log(u.err)});g(u.put,i,u),u.async||g(u.map,s,u),o!==u.defer&&setTimeout(function(){e.on.put(n,r)},u.defer-u.machine),u.diff&&a.on("put",p(n,{put:u.diff}))},e.on.get=function(t,i){var n=i._,r=t.get,s=r[y],o=n.graph[s],a=r[m],u=(n.next||(n.next={}))[s];if(r["*"]){var h={};e.obj.map(n.graph,function(t,i){e.text.match(i,r)&&(h[i]=e.obj.copy(t))}),e.obj.empty(h)||n.on("in",{"@":t["#"],how:"*",put:h,$:i})}if(!o)return n.on("get",t);if(a){if(!d(o,a))return n.on("get",t);o=e.state.to(o,a)}else o=e.obj.copy(o);o=e.graph.node(o),(u||b).ack,n.on("in",{"@":t["#"],how:"mem",put:o,$:i}),n.on("get",t)}}(),e.chain.opt=function(t){t=t||{};var i=this._,n=t.peers||t;return l(t)||(t={}),l(i.opt)||(i.opt=t),h(n)&&(n=[n]),a(n)&&(n=g(n,function(t,e,i){i(t,{url:t})}),l(i.opt.peers)||(i.opt.peers={}),i.opt.peers=p(n,i.opt.peers)),i.opt.peers=i.opt.peers||{},p(t,i.opt),e.on("opt",i),i.opt.uuid=i.opt.uuid||function(){return v()+c(12)},this};var o,a=e.list.is,u=e.text,h=u.is,c=u.random,f=e.obj,l=f.is,d=f.has,p=f.to,g=f.map,v=(f.copy,e.state.lex),y=e.val.rel._,m=".",b=(e.node._,e.val.link.is,{});n.debug=function(t,e){return n.debug.i&&t===n.debug.i&&n.debug.i++&&(n.log.apply(n,arguments)||e)},e.log=function(){return!e.log.off&&n.log.apply(n,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(t,i,n){return(n=e.log.once)[t]=n[t]||0,n[t]++||e.log(i)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.Gun=e).window=window);try{void 0!==s&&(s.exports=e)}catch(t){}t.exports=e})(r,"./root"),r(function(t){var e=r("./root");e.chain.back=function(t,r){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var s=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var o=0,a=t.length,u=s;o<a;o++)u=(u||n)[t[o]];return i!==u?r?this:u:(u=s.back)?u.$.back(t,r):void 0}if(t instanceof Function){var h;for(u={back:s};(u=u.back)&&i===(h=t(u,r)););return h}return e.num.is(t)?(s.back||s).$.back(t-1):this};var i,n={}})(r,"./back"),r(function(t){var e=r("./root");function i(t){var i,n,r,s=this.as,o=s.back,a=s.root;if(t.I||(t.I=s.$),t.$||(t.$=s.$),this.to.next(t),n=t.get){if(n["#"]||s.soul){if(n["#"]=n["#"]||s.soul,t["#"]||(t["#"]=m(9)),o=a.$.get(n["#"])._,n=n["."]){if(p(o.put,n)&&((r=(i=o.$.get(n)._).ack)||(i.ack=-1),o.on("in",{$:o.$,put:e.state.to(o.put,n),get:o.get}),r))return}else{if((r=o.ack)||(o.ack=-1),p(o,"put")&&o.on("in",o),r)return;t.$=o.$}return a.ask(c,t),a.on("in",t)}if(a.now&&(a.now[s.id]=a.now[s.id]||!0,s.pass={}),n["."])return s.get?(t={get:{".":s.get},$:s.$},o.ask||(o.ask={}),o.ask[s.get]=t.$._,o.on("out",t)):(t={get:{},$:s.$},o.on("out",t));if(s.ack=s.ack||-1,s.get)return t.$=s.$,n["."]=s.get,(o.ask||(o.ask={}))[s.get]=t.$._,o.on("out",t)}return o.on("out",t)}function n(t){var i,n,r=this,a=r.as,c=a.root,d=(t.$||l)._||l,m=t.put;if(a.get&&t.get!==a.get&&(t=v(t,{get:a.get})),a.has&&d!==a&&(t=v(t,{$:a.$}),d.ack&&(a.ack=d.ack)),f===m){if(n=d.put,r.to.next(t),a.soul)return;if(f===n&&f!==d.put)return;return o(a,t,r),a.has&&h(a,t),g(d.echo,a.id),void g(a.map,d.id)}if(a.soul)return r.to.next(t),o(a,t,r),void(a.next&&y(m,u,{msg:t,cat:a}));if(!(i=e.val.link.is(m)))return e.val.is(m)?(a.has||a.soul?h(a,t):(d.has||d.soul)&&((d.echo||(d.echo={}))[a.id]=d.echo[d.id]||a,(a.map||(a.map={}))[d.id]=a.map[d.id]||{at:d}),r.to.next(t),void o(a,t,r)):(a.has&&d!==a&&p(d,"put")&&(a.put=d.put),(i=e.node.soul(m))&&d.has&&(d.put=a.root.$.get(i)._.put),n=(c.stop||{})[d.id],r.to.next(t),s(a,t,d,i),o(a,t,r),void(a.next&&y(m,u,{msg:t,cat:a})));c.stop;(n=(n=c.stop||{})[d.id]||(n[d.id]={})).is=n.is||d.put,n[a.id]=d.put||!0,r.to.next(t),s(a,t,d,i),o(a,t,r)}function s(t,i,n,r){if(r&&b!==t.get){var o=t.root.$.get(r)._;t.has?n=o:n.has&&s(n,i,n,r),n!==t&&(n.$||(n={}),(n.echo||(n.echo={}))[t.id]=n.echo[t.id]||t,t.has&&!(t.map||l)[n.id]&&h(t,i),(r!==(o=n.id?(t.map||(t.map={}))[n.id]=t.map[n.id]||{at:n}:{}).link||o.pass||t.pass)&&(t.pass&&(e.obj.map(t.map,function(t){t.pass=!0}),g(t,"pass")),o.pass&&g(o,"pass"),t.has&&(t.link=r),function(t,i){var n=t.root.$.get(i)._;if(t.ack&&(n.on("out",{get:{"#":i}}),!t.ask))return;n=t.ask,e.obj.del(t,"ask"),y(n||t.next,function(t,e){t.on("out",{get:{"#":i,".":e}})}),e.obj.del(t,"ask")}(t,o.link=r)))}}function o(t,e,i){t.echo&&y(t.echo,a,e)}function a(t){t&&t.on&&t.on("in",this)}function u(t,i){var n,r,s,o=this.cat.next||l,a=this.msg;(b!==i||o[i])&&(r=o[i])&&(r.has?(f!==r.put&&e.val.link.is(t)||(r.put=t),n=r.$):(s=a.$)&&(s=(n=a.$.get(i))._,f!==s.put&&e.val.link.is(t)||(s.put=t)),r.on("in",{put:t,get:i,$:n,via:a}))}function h(t,i){if(t.has||t.soul){var n=t.map;t.root;t.map=null,t.has&&(t.link=null),(t.pass||i["@"]||null!==n)&&(f===n&&e.val.link.is(t.put)||(y(n,function(e){(e=e.at)&&g(e.echo,t.id)}),n=t.put,y(t.next,function(e,i){if(f===n&&f!==t.put)return!0;e.put=f,e.ack&&(e.ack=-1),e.on("in",{get:i,$:e.$,put:f})})))}}function c(t,i){var n=this.as,r=n.get||l,s=n.$._,o=(t.put||l)[r["#"]];if(s.ack&&(s.ack=s.ack+1||1),!t.put||r["."]&&!p(o,s.get)){if(s.put!==f)return;s.on("in",{get:s.get,put:s.put=f,$:s.$,"@":t["@"]})}else b!=r["."]?(t.$=s.root.$,e.on.put(t,s.root.$)):s.on("in",{get:s.get,put:e.val.link.ify(r["#"]),$:s.$,"@":t["@"]})}e.chain.chain=function(t){var r,s=this._,o=new(t||this).constructor(this),a=o._;return a.root=r=s.root,a.id=++r.once,a.back=this._,a.on=e.on,a.on("in",n,a),a.on("out",i,a),o};var f,l={},d=e.obj,p=d.has,g=(d.put,d.del),v=d.to,y=d.map,m=e.text.random,b=(e.val.rel._,e.node._)})(r,"./chain"),r(function(t){var e=r("./root");function i(t){var e,i=this,n=i.as,r=n.at.root,a=(t.$||{})._||{},h=t.put||a.put;if((e=r.now)&&i!==e[n.now])return i.to.next(t);if(i.seen&&a.id&&i.seen[a.id])return i.to.next(t);if((e=h)&&e[u._]&&(e=u.is(e))&&(e=(t.$$=a.root.gun.get(e))._,s!==e.put&&(t=o(t,{put:h=e.put}))),(e=r.mum)&&a.id){if(e[a.id])return;s===h||u.is(h)||(e[a.id]=!0)}n.use(t,i),i.stun?i.stun=null:i.to.next(t)}function n(t){var e=this.on;if(!t||e.soul||e.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var i;e.map;if((i=this.seen||(this.seen={}))[t])return!0;i[t]=!0}}e.chain.get=function(t,r,s){var o;if("string"!=typeof t){if(t instanceof Function){if(!0===r)return function(t,e,i,n){var r,s=t._;if(r=s.soul)return e(r,n,s),t;if(r=s.link)return e(r,n,s),t;return t.get(function(t,i){i.rid(t);var s=(s=t.$)&&s._||{};r=s.link||s.soul||u.is(t.put)||h(t.put),e(r,n,t,i)},{out:{get:{".":!0}}}),t}(this,t,0,s);var f,l=(o=this)._,d=l.root,p=d.now;(s=r||{}).at=l,s.use=t,s.out=s.out||{},s.out.get=s.out.get||{},(f=l.on("in",i,s)).rid=n,(d.now={$:1})[s.now=l.id]=f;var g=d.mum;return d.mum={},l.on("out",s.out),d.mum=g,d.now=p,o}return a(t)?this.get(""+t,r,s):(p=u.is(t))?this.get(p,r,s):((s=this.chain())._.err={err:e.log("Invalid get request!",t)},r&&r.call(s,s._.err),s)}var v=this._;return(o=(v.next||c)[t])||(o=function(t,e){var i=e._,n=i.next,r=e.chain()._;n||(n=i.next={});n[r.get=t]=r,e===i.root.$?r.soul=t:(i.soul||i.has)&&(r.has=t);return r}(t,this)),o=o.$,(p=v.stun)&&(o._.stun=o._.stun||p),r&&r instanceof Function&&o.get(r,s),o};e.obj.has;var s,o=e.obj.to,a=e.num.is,u=e.val.link,h=e.node.soul,c=(e.node._,{})})(r,"./get"),r(function(t){var e=r("./root");function i(t){t&&t()}function s(){var t=this;t.graph&&!g(t.stun,o)&&(t.res=t.res||function(t){t&&t()},t.res(function(){var i=t.$.back(-1)._,n=i.ask(function(n){i.root.on("ack",n),n.err&&e.log(n),n.lack||this.off(),t.ack&&t.ack(n,this)},t.opt),r=i.root.now;l.del(i.root,"now");var s=i.root.mum;i.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":n}),i.root.mum=s?l.to(s,i.root.mum):s,i.root.now=r},t),t.res&&t.res())}function o(t,e){if(t)return!0}function a(t,i,n,r){var s=this,o=e.is(t);!i&&r.path.length&&(s.res||m)(function(){for(var i=r.path,n=s.ref,a=(s.opt,0),h=i.length;a<h;a++)n=n.get(i[a]);o&&(n=t);var c=n._.dub;if(c||(c=e.node.soul(r.obj)))return n.back(-1).get(c),void r.soul(c);(s.stun=s.stun||{})[i]=!0,n.get(u,!0,{as:{at:r,as:s,p:i}})},{as:s,at:r})}function u(t,i,n,r){var s=(i=i.as).at;i=i.as;var o=((n||{}).$||{})._||{};t=o.dub=o.dub||t||e.node.soul(s.obj)||e.node.soul(n.put||o.put)||e.val.rel.is(n.put||o.put)||(i.via.back("opt.uuid")||e.text.random)(),r&&(r.stun=!0),t?h(o,o.dub=t,s,i):o.via.back("opt.uuid")(function(t,n){if(t)return e.log(t);h(o,o.dub=o.dub||n,s,i)})}function h(t,e,i,n){t.$.back(-1).get(e),i.soul(e),n.stun[i.path]=!1,n.batch()}function c(t,i,r,s){if(i=i.as,r.$&&r.$._)if(r.err)n.log("Please report this as an issue! Put.any.err");else{var o,a=r.$._,u=a.put,h=i.opt||{};if(!(o=i.ref)||!o._.now){if(s&&(s.stun=!0),i.ref!==i.$){if(!(o=i.$._.get||a.get))return void n.log("Please report this as an issue! Put.no.get");i.data=p({},o,i.data),o=null}if(f===u){if(!a.get)return;t||(o=a.$.back(function(t){if(t.link||t.soul)return t.link||t.soul;i.data=p({},t.get,i.data)})),o=o||a.get,a=a.root.$.get(o)._,i.soul=o,u=i.data}i.not||(i.soul=i.soul||t)||(i.path&&d(i.data)?i.soul=(h.uuid||i.via.back("opt.uuid")||e.text.random)():(b==a.get&&(i.soul=(a.put||v)["#"]||a.dub),i.soul=i.soul||a.soul||a.soul||(h.uuid||i.via.back("opt.uuid")||e.text.random)()),i.soul)?i.ref.put(i.data,i.soul,i):i.via.back("opt.uuid")(function(t,n){if(t)return e.log(t);i.ref.put(i.data,i.soul=n,i)})}}}e.chain.put=function(t,n,r){var o,u=this,h=u._,f=h.root.$;return(r=r||{}).data=t,r.via=r.$=r.via||r.$||u,"string"==typeof n?r.soul=n:r.ack=r.ack||n,h.soul&&(r.soul=h.soul),r.soul||f===u?d(r.data)?(r.soul=r.soul||(r.not=e.node.soul(r.data)||(r.via.back("opt.uuid")||e.text.random)()),r.soul?(r.$=u=f.get(r.soul),r.ref=r.$,function(t){t.batch=s;var i=t.opt||{},n=t.env=e.state.map(a,i.state);if(n.soul=t.soul,t.graph=e.graph.ify(t.data,n,t),n.err)return(t.ack||y).call(t,t.out={err:e.log(n.err)}),void(t.res&&t.res());t.batch()}(r),u):(r.via.back("opt.uuid")(function(t,i){if(t)return e.log(t);(r.ref||r.$).put(r.data,r.soul=i,r)}),u)):((r.ack||y).call(r,r.out={err:e.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),u):e.is(t)?(t.get(function(t,i,s){if(!t&&e.val.is(s.put))return e.log("The reference you are saving is a",typeof s.put,'"'+s.put+'", not a node (object)!');u.put(e.val.rel.ify(t),n,r)},!0),u):(r.ref=r.ref||f._===(o=h.back)?u:o.$,r.ref._.soul&&e.val.is(r.data)&&h.get?(r.data=p({},h.get,r.data),r.ref.put(r.data,r.soul,r),u):(r.ref.get(c,!0,{as:r}),r.out||(r.res=r.res||i,r.$._.stun=r.ref._.stun),u))};var f,l=e.obj,d=l.is,p=l.put,g=l.map,v={},y=function(){},m=function(t,e){t.call(e||v)},b=e.node._})(r,"./put"),r(function(t){var e=r("./root");r("./chain"),r("./back"),r("./put"),r("./get"),t.exports=e})(r,"./index"),r(function(t){var e=r("./index");function i(t,e){var i,n=t.$,r=((n||{})._||{}).put||t.put;this.at;if(s!==r){if(i=t.$$){if(i=t.$$._,s===i.put)return;r=i.put}this.change&&(r=t.put),this.as?this.ok.call(this.as,t,e):this.ok.call(n,r,t.get,t,e)}}function n(t,e,i){var r,o,a=this.as,u=(a.at,t.$),h=u._,c=h.put||t.put;if(o=t.$$){if(r=o=t.$$._,s===o.put)return;c=o.put}(o=e.wait)&&(o=o[h.id])&&clearTimeout(o),i||s!==c&&!h.soul&&!h.link&&(!r||0<r.ack)?(e.rid(t),a.ok.call(u||a.$,c,t.get)):o=(e.wait={})[h.id]=setTimeout(function(){n.call({as:a},t,e,o||1)},a.wait||99)}e.chain.on=function(t,e,n,r){var s,o=this._;if("string"==typeof t)return e?(s=o.on(t,e,n||o,r),n&&n.$&&(n.subs||(n.subs=[])).push(s),this):o.on(t);var a=e;return(a=!0===a?{change:!0}:a||{}).at=o,a.ok=t,this.get(i,a),this},e.chain.val=function(t,i){return e.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,i)},e.chain.once=function(t,i){var r=this,o=r._,a=o.put;if(0<o.ack&&s!==a)return(t||h).call(r,a,o.get),r;if(!t){e.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var u=r.chain();return u._.nix=r.once(function(){u._.on("in",r._)}),u}return(i=i||{}).ok=t,i.at=o,i.out={"#":e.text.random(9)},r.get(n,{as:i}),i.async=!0,r},e.chain.off=function(){var t,e=this._,i=e.back;if(i)return(t=i.next)&&t[e.get]&&u(t,e.get),(t=i.ask)&&u(t,e.get),(t=i.put)&&u(t,e.get),(t=e.soul)&&u(i.root.graph,t),(t=e.map)&&a(t,function(t){t.link&&i.root.$.get(t.link).off()}),(t=e.next)&&a(t,function(t){t.$.off()}),e.on("off",{}),this};var s,o=e.obj,a=o.map,u=(o.has,o.del),h=(o.to,e.val.link,function(){})})(r,"./on"),r(function(t){var e=r("./index");function i(t){if(!t.put||e.val.is(t.put))return this.to.next(t);this.as.nix&&this.off(),s(t.put,n,{at:this.as,msg:t}),this.to.next(t)}function n(t,e){if(a!==e){var i=this.msg.$,n=this.at,r=i.get(e)._;(r.echo||(r.echo={}))[n.id]=r.echo[n.id]||n}}e.chain.map=function(t,n,r){var s,a=this._;return t?(e.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),s=this.chain(),this.map().on(function(i,n,r,a){var u=(t||o).call(this,i,n,r,a);if(void 0!==u)return i===u?s._.on("in",r):e.is(u)?s._.on("in",u._):void s._.on("in",{get:n,put:u})}),s):(s=a.each)?s:(a.each=s=this.chain(),s._.nix=this.back("nix"),this.on("in",i,s._),s)};var s=e.obj.map,o=function(){},a=e.node._})(r,"./map"),r(function(t){var e=r("./index");e.chain.set=function(t,i,n){var r,s=this;if(i=i||function(){},(n=n||{}).item=n.item||t,r=e.node.soul(t))return s.set(s.back(-1).get(r),i,n);if(!e.is(t)){var o=s.back("opt.uuid")();return o&&e.obj.is(t)?s.set(s._.root.$.put(t,o),i,n):s.get(e.state.lex()+e.text.random(7)).put(t,i,n)}return t.get(function(t,r,o){if(!t)return i.call(s,{err:e.log('Only a node can be linked! Not "'+o.put+'"!')});s.put(e.obj.put({},t,e.val.link.ify(t)),i,n)},!0),t}})(r,"./set"),r(function(t){if("undefined"!=typeof Gun){var e,i=function(){};"undefined"!=typeof window&&(e=window);var n=e.localStorage||{setItem:i,removeItem:i,getItem:i};Gun.on("create",function(t){var e=this.to,i=t.opt;if(t.once)return e.next(t);i.prefix=i.file||"gun/";var r,s,o=Gun.obj.ify(n.getItem("gap/"+i.prefix))||{},a=Gun.obj.empty;if(!a(o)){var u=Gun.obj.ify(n.getItem(i.prefix))||{},h={};Gun.obj.map(o,function(t,e){Gun.obj.map(t,function(t,i){h[e]=Gun.state.to(u[e],i,h[e])})}),setTimeout(function(){t.on("out",{put:h,"#":t.ask(c),I:t.$})},1)}function c(t){if(!t.err&&t.ok){var e=t["@"];setTimeout(function(){Gun.obj.map(o,function(t,i){Gun.obj.map(t,function(i,n){e===i&&delete t[n]}),a(t)&&delete o[i]}),l()},i.wait||1)}}t.on("out",function(t){t.lS||(t.I&&t.put&&!t["@"]&&!a(i.peers)&&(r=t["#"],Gun.graph.is(t.put,null,f),s||(s=setTimeout(l,i.wait||1))),this.to.next(t))}),t.on("ack",c),e.next(t);var f=function(t,e,i,n){(o[n]||(o[n]={}))[e]=r},l=function(){clearTimeout(s),s=!1;try{n.setItem("gap/"+i.prefix,JSON.stringify(o))}catch(t){Gun.log(err=t||"localStorage failure")}}}),Gun.on("create",function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";t.graph;var i,r={},s=0,o=Gun.obj.ify(n.getItem(e.prefix))||{};t.on("localStorage",o),t.on("put",function(t){if(this.to.next(t),Gun.graph.is(t.put,null,a),t["@"]||(r[t["#"]]=!0),(s+=1)>=(e.batch||1e3))return u();i||(i=setTimeout(u,e.wait||1))}),t.on("get",function(i){this.to.next(i);var n,r,s,a=i.get;function u(){if(a&&(n=a["#"])){var u=a["."];(r=o[n]||s)&&u&&(r=Gun.state.to(r,u)),(r||Gun.obj.empty(e.peers))&&t.on("in",{"@":i["#"],put:Gun.graph.node(r),how:"lS",lS:i.I})}}Gun.debug?setTimeout(u,1):u()});var a=function(t,e,i,n){o[n]=Gun.state.to(i,e,o[n])},u=function(a){var h;s=0,clearTimeout(i),i=!1;var c=r;r={},a&&(o=a);try{n.setItem(e.prefix,JSON.stringify(o))}catch(i){Gun.log(h=i||"localStorage failure"),t.on("localStorage:error",{err:h,file:e.prefix,flush:o,retry:u})}(h||Gun.obj.empty(e.peers))&&Gun.obj.map(c,function(e,i){t.on("in",{"@":i,err:h,ok:0})})}}})}})(r,"./adapters/localStorage"),r(function(t){var e=r("../type");function i(t){var r=function(){},a=t.opt;return r.out=function(e){var i;if(this.to&&this.to.next(e),(i=e["@"])&&(i=t.dup.s[i])&&(i=i.it)&&i.mesh)return r.say(e,i.mesh.via,1),void(i["##"]=e["##"]);r.say(e)},t.on("create",function(i){i.opt.pid=i.opt.pid||e.text.random(9),this.to.next(i),t.on("out",r.out)}),r.hear=function(i,s){if(i){var o,a,u,h=t.dup,c=i[0];try{u=JSON.parse(i)}catch(t){n.log("DAM JSON parse error",t)}if("{"===c){if(!u)return;if(h.check(o=u["#"]))return;if(h.track(o,!0).it=u,(c=u["@"])&&u.put&&(c+=a=u["##"]||(u["##"]=r.hash(u)))!=o){if(h.check(c))return;(c=h.s)[a]=c[o]}return(u.mesh=function(){}).via=s,(c=u["><"])&&(u.mesh.to=e.obj.map(c.split(","),function(t,e,i){i(t,!0)})),u.dam?void((c=r.hear[u.dam])&&c(u,s,t)):void t.on("in",u)}if("["!==c);else{if(!u)return;for(var f,l=0;f=u[l++];)r.hear(f,s)}}},function(){function i(t,e){var i=e.wire;try{i.send?i.send(t):e.say&&e.say(t)}catch(i){(e.queue=e.queue||[]).push(t)}}r.say=function(n,s,u){var h,c,f;s?(s.wire||a.wire&&a.wire(s))&&(c=n.mesh||o,s!==c.via&&((f=c.raw)||(f=r.raw(n)),(h=n["@"])&&(h=t.dup.s[h])&&(h=h.it)&&h.get&&h["##"]&&h["##"]===n["##"]||(h=c.to)&&(h[s.url]||h[s.id])&&!u||(s.batch?s.batch.push(f):(s.batch=[],setTimeout(function(){var t=s.batch;t&&(s.batch=null,t.length&&i(JSON.stringify(t),s))},a.gap||a.wait||1),i(f,s))))):e.obj.map(a.peers,function(t){r.say(n,t)})}}(),function(){function n(t,i){var n;return i instanceof Object?(e.obj.map(Object.keys(i).sort(),o,{to:n={},on:i}),n):i}function o(t){this.to[t]=this.on[t]}r.raw=function(i){if(!i)return"";var o,c,f,l=t.dup,d=i.mesh||{};if(f=d.raw)return f;if("string"==typeof i)return i;i["@"]&&(f=i.put)&&((c=i["##"])||(o=u(f,n)||"",c=r.hash(i,o),i["##"]=c),(f=l.s)[c=i["@"]+c]=f[i["#"]],i["#"]=c||i["#"],o&&((i=e.obj.to(i)).put=h));var p=0,g=[];e.obj.map(a.peers,function(t){if(g.push(t.url||t.id),++p>9)return!0}),i["><"]=g.join();var v=u(i);return s!==o&&(f=v.indexOf(h,v.indexOf("put")),v=v.slice(0,f-1)+o+v.slice(f+h.length+1)),d&&(d.raw=v),v},r.hash=function(t,r){return i.hash(r||u(t.put,n)||"")||t["#"]||e.text.random(9)};var u=JSON.stringify,h=":])([:"}(),r.hi=function(i){var n=i.wire||{};i.id||i.url?(a.peers[i.url||i.id]=i,e.obj.del(a.peers,n.id)):(n=n.id=n.id||e.text.random(9),r.say({dam:"?"},a.peers[n]=i)),n.hied||t.on(n.hied="hi",i),n=i.queue,i.queue=[],e.obj.map(n,function(t){r.say(t,i)})},r.bye=function(i){e.obj.del(a.peers,i.id),t.on("bye",i)},r.hear["?"]=function(t,e){if(!t.pid)return r.say({dam:"?",pid:a.pid,"@":t["#"]},e);e.id=e.id||t.pid,r.hi(e)},r}i.hash=function(t){if("string"!=typeof t)return{err:1};var e=0;if(!t.length)return e;for(var i=0,n=t.length;i<n;++i)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e};var s,o={};Object.keys=Object.keys||function(t){return map(t,function(t,e,i){i(e)})};try{t.exports=i}catch(t){}})(r,"./adapters/mesh"),r(function(e){var i=r("../index");i.Mesh=r("./mesh"),i.on("opt",function(e){this.to.next(e);var n=e.opt;if(!e.once&&!1!==n.WebSocket){var r;"undefined"!=typeof window&&(r=window),void 0!==t&&(r=t),r=r||{};var s=n.WebSocket||r.WebSocket||r.webkitWebSocket||r.mozWebSocket;if(s){n.WebSocket=s;n.mesh=n.mesh||i.Mesh(e),n.wire;n.wire=o}}function o(t){if(!t||!t.url)return i&&i(t);var e=t.url.replace("http","ws"),i=t.wire=new n.WebSocket(e);return i.onclose=function(){n.mesh.bye(t),a(t)},i.onerror=function(e){a(t),e&&e.code},i.onopen=function(){n.mesh.hi(t)},i.onmessage=function(e){e&&n.mesh.hear(e.data||e,t)},i}function a(t){clearTimeout(t.defer),t.defer=setTimeout(function(){o(t)},2e3)}})})(r,"./adapters/websocket")}()}),Zs="undefined"!=typeof window?window.Gun:Xs;Zs.chain.promise=function(t){var e=this;t=t||function(t){return t};return new Promise(function(t,i){e.once(function(e,i){t({put:e,get:i,gun:this})})}).then(t)},Zs.chain.then=function(t){return this.promise(function(e){return t?t(e.put):e.put})};var Qs="undefined"!=typeof window?window.Gun:Xs;Qs.chain.open=function(t,e,i){return(e=e||{}).doc=e.doc||{},e.ids=e.ids||{},e.any=e.any||t,e.ev=e.ev||{off:function(){Qs.obj.map(e.ev.s,function(t){t&&t.off()}),e.ev.s={}},s:{}},this.on(function(t,n,r,s){if(delete((t=Qs.obj.copy(t))||{})._,clearTimeout(e.to),e.to=setTimeout(function(){e.any&&(e.any.call(e.at.$,e.doc,e.key,e,e.ev),e.off&&(e.ev.off(),e.any=null))},e.wait||1),e.at=e.at||r,e.key=e.key||n,e.ev.s[this._.id]=s,Qs.val.is(t))i?i[n]=t:e.doc=t;else{var o,a=this;Qs.obj.map(t,function(t,n){(o=Qs.val.link.is(t))?e.ids[o]?(i||e.doc)[n]=e.ids[o]:a.get(n).open(e.any,e,e.ids[o]=(i||e.doc)[n]={}):(i||e.doc)[n]=t})}})};var to="undefined"!=typeof window?window.Gun:Xs;async function eo(t,e,i,n){return new Is(function(r){var s=[];function o(){s.sort(function(t,e){return t.key<e.key?-1:t.key>e.key?1:0}),r(s)}t.map(function(t,r){(!n||r>n)&&0===r.indexOf(e)&&(t&&s.push({value:t,key:r}),s.length>=i&&o())}),setTimeout(function(){o()},300)})}to.chain.open,to.chain.load=function(t,e,i){return(e=e||{}).off=!0,this.open(t,e,i)};var io=function(){function t(e,i){var n=this;Ni(this,t),this.gun=e||new Ys,this.viewpoint=i?new ks(i):{name:"keyID",val:Ws.getDefault().keyID,conf:1,ref:0};var r=Ms.create(this.gun.get("identities"),{attrs:[this.viewpoint],trustDistance:0});this.ready=new Is(async function(t,e){try{await n._addIdentityToIndexes(r.gun),t()}catch(t){e(t)}})}return t.create=async function(e,i){var n=new t(e,i);return await n.ready,n},t.getMsgIndexKey=function(t){var e=parseInt(t.distance);return(e=("00"+(e=Gs(e)?99:e)).substring(e.toString().length))+":"+Math.floor(Date.parse(t.timestamp||t.signedData.timestamp)/1e3)+":"+(t.ipfs_hash||t.hash).substr(0,9)},t.getIdentityIndexKeys=async function(t,e){var i=[],n=await t.get("trustDistance").then();return await t.get("attrs").map().once(function(t){var r=void 0!==n?n:parseInt(t.dist);r=("00"+(r=Gs(r)?99:r)).substring(r.toString().length);var s=t.val||t[1],o=t.name||t[0],a=encodeURIComponent(s),u=encodeURIComponent(s.toLowerCase()),h=encodeURIComponent(o),c=r+":"+a+":"+h,f=r+":"+u+":"+h;if(ks.isUniqueType(o)||(c=c+":"+e.substr(0,9),f=f+":"+e.substr(0,9)),i.push(c),c!==f&&i.push(f),s.indexOf(" ")>-1)for(var l=s.toLowerCase().split(" "),d=0;d<l.length;d+=1){var p=r+":"+encodeURIComponent(l[d])+":"+h;ks.isUniqueType(o)||(p=p+":"+e.substr(0,9)),i.push(p)}if(c.match(/^http(s)?:\/\/.+\/[a-zA-Z0-9_]+$/)){var g=c.split("/");i.push(g[g.length-1])}}).then(),i},t.prototype.getViewpoint=async function(){var t=await eo(this.gun.get("identitiesByTrustDistance"),"00",1);if(t.length)return new Ms(this.gun.get("identitiesByTrustDistance").get(t[0].key))},t.prototype.get=async function(t,e){if(void 0===t)throw"Value is undefined";void 0===e&&(e=ks.guessTypeOf(t));var i=encodeURIComponent(t)+":"+encodeURIComponent(e);if(await this.gun.get("identitiesBySearchKey").get(i).then())return new Ms(this.gun.get("identitiesBySearchKey").get(i))},t.prototype._getMsgs=async function(t,e,i){var n=await eo(t,"",e,i),r=[];return n.forEach(function(t){var e=Os.fromJws(t.value);r.push(e)}),r},t.prototype._addIdentityToIndexes=async function(e){for(var i=Ys.node.soul(e)||"todo",n=await t.getIdentityIndexKeys(e,i.substr(0,6)),r=0;r<n.length;r++){var s=n[r];console.log("adding key "+s),await this.gun.get("identitiesByTrustDistance").get(s).put(e).then(),await this.gun.get("identitiesBySearchKey").get(s.substr(s.indexOf(":")+1)).put(e).then()}},t.prototype.getSentMsgs=async function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._getMsgs(t.gun.get("sent"),e,i)},t.prototype.getReceivedMsgs=async function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._getMsgs(t.gun.get("received"),e,i)},t.prototype._getAttributeTrustDistance=async function(t){if(ks.isUniqueType(t.name)){var e=await this.get(t.val,t.name);return e&&e.gun.get("trustDistance").then()}},t.prototype.getMsgTrustDistance=async function(t){var e=1/0;if(await this.get(t.getSignerKeyID(),"keyID")){for(var i=0;i<t.signedData.author.length;i++){var n=new ks(t.signedData.author[i]);if(ks.equals(n,this.viewpoint))return 0;var r=await this._getAttributeTrustDistance(n);r<e&&(e=r)}return e<1/0?e:void 0}},t.prototype._updateMsgRecipientIdentity=async function(e,i,n){var r=await t.getIdentityIndexKeys(n,"todo".substr(0,6)),s=await new Is(function(t){n.get("attrs").load(function(e){return t(e)})});if("verification"===e.signedData.type&&(e.signedData.recipient.forEach(function(t){var e=!1;_s(s).forEach(function(i){ks.equals(t,s[i])&&(s[i].conf=(s[i].conf||0)+1,e=!0)}),e||(s[encodeURIComponent(t[0])+":"+encodeURIComponent(t[1])]={name:t[0],val:t[1],conf:1,ref:0})}),await n.get("mostVerifiedAttributes").put(Ms.getMostVerifiedAttributes(s)),await n.get("attrs").put(s)),"rating"===e.signedData.type){var o=await n.then();e.isPositive()?(e.distance+1<o.trustDistance&&n.get("trustDistance").put(e.distance+1),await n.get("receivedPositive").put(o.receivedPositive+1)):e.isNegative()?await n.get("receivedNegative").put(o.receivedNegative+1):await n.get("receivedNeutral").put(o.receivedNeutral+1)}await n.get("received").get(i).put(e.jws).then();for(var a=await t.getIdentityIndexKeys(n,"todo".substr(0,6)),u=0;u<r.length;u++){var h=r[u];-1===a.indexOf(h)&&(await this.gun.get("identitiesByTrustDistance").get(h).put(null),await this.gun.get("identitiesBySearchKey").get(h.substr(h.indexOf(":")+1)).put(null))}},t.prototype._updateMsgAuthorIdentity=async function(t,e,i){if("rating"===t.signedData.type){var n=await i.then();t.isPositive()?await i.get("sentPositive").put(n.sentPositive+1):t.isNegative()?await i.get("sentNegative").put(n.sentNegative+1):await i.get("sentNeutral").put(n.sentNeutral+1)}return i.get("sent").get(e).put(t.jws).then()},t.prototype._updateIdentityProfilesByMsg=async function(e,i,n){var r=t.getMsgIndexKey(e);r=r.substr(r.indexOf(":")+1);for(var s=$s(tt({},i,n)),o=0;o<s.length;o++)n.hasOwnProperty(s[o].gun._.link)&&await this._updateMsgRecipientIdentity(e,r,s[o].gun),i.hasOwnProperty(s[o].gun._.link)&&await this._updateMsgAuthorIdentity(e,r,s[o].gun),await this._addIdentityToIndexes(s[o].gun)},t.prototype._updateIdentityIndexesByMsg=async function(t){for(var e={},i={},n=0;n<t.signedData.author.length;n++){var r=t.signedData.author[n],s=await this.get(r[1],r[0]);s&&(i[s.gun._.link]=s)}if(_s(i).length){for(var o=0;o<t.signedData.recipient.length;o++){var a=t.signedData.recipient[o],u=await this.get(a[1],a[0]);u&&(e[u.gun._.link]=u)}if(!_s(e).length){var h=[];t.signedData.recipient.forEach(function(t){h.push({name:t[0],val:t[1],conf:1,ref:0})});var c=Ms.create(this.gun.get("identities"),{attrs:h});e[c.gun._.link]=c}return this._updateIdentityProfilesByMsg(t,i,e)}},t.prototype.addMessages=async function(t){var e={};if(!Array.isArray(t))throw"msgs param must be an array";console.log("sorting "+t.length+" messages onto a search tree...");for(var i=0;i<t.length;i++)for(var n=0;n<t[i].signedData.author.length;n++){var r=t[i].signedData.author[n];if(ks.isUniqueType(r[0]))e[encodeURIComponent(r[1])+":"+encodeURIComponent(r[0])+":"+t[i].getHash()]=t[i]}console.log("...done");var s=_s(e).sort();if(s.length){var o=void 0,a=void 0,u=this.gun.get("identitiesBySearchKey");do{var h=await eo(u,""),c=0,f=s[c],l=h.shift();for(o=s.length;f&&l;)if(0===f.indexOf(l.key)){try{var d=Os.fromJws(e[f].jws);await this.addMessage(d)}catch(t){var p=Os.fromJws(e[f].jws);console.log("adding failed:",t,Bi(p,null,2))}s.splice(c,1),f=c<s.length?s[c]:void 0}else f<l.key?f=c<s.length?s[++c]:void 0:l=h.shift();a=s.length}while(a!==o);return!0}},t.prototype.addMessage=async function(e){if(e.distance=await this.getMsgTrustDistance(e),void 0===e.distance)return!1;var i=t.getMsgIndexKey(e);return await this.gun.get("messagesByDistance").get(i).put(e.jws).then(),i=i.substr(i.indexOf(":")+1),await this.gun.get("messagesByTimestamp").get(i).put(e.jws).then(),await this._updateIdentityIndexesByMsg(e),!0},t.prototype.search=async function(t){var e=this,i={};return new Is(function(n){e.gun.get("identitiesByTrustDistance").map(function(n,r){-1!==r.indexOf(encodeURIComponent(t))&&(i.hasOwnProperty(Ys.node.soul(n))||(i[Ys.node.soul(n)]=new Ms(e.gun.get("identitiesByTrustDistance").get(r))))}),setTimeout(function(){n($s(i))},200)})},t}();return{VERSION:"0.0.63",APIClient:_i,Message:Os,Identity:Ms,Attribute:ks,Index:io,Key:Ws,util:Ps}});
