!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.identifiLib=e()}(this,function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function n(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function i(t,e){return t(e={exports:{}},e.exports),e.exports}var r=i(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),s=i(function(t){var e=t.exports={version:"2.5.3"};"number"==typeof __e&&(__e=e)}),o=(s.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),a=function(t,e,n){if(o(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}},h=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!h(t))throw TypeError(t+" is not an object!");return t},c=function(t){try{return!!t()}catch(t){return!0}},f=!c(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),l=r.document,d=h(l)&&h(l.createElement),p=function(t){return d?l.createElement(t):{}},g=!f&&!c(function(){return 7!=Object.defineProperty(p("div"),"a",{get:function(){return 7}}).a}),y=function(t,e){if(!h(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!h(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!h(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!h(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},v=Object.defineProperty,m={f:f?Object.defineProperty:function(t,e,n){if(u(t),e=y(e,!0),u(n),g)try{return v(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},w=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=f?function(t,e,n){return m.f(t,e,w(1,n))}:function(t,e,n){return t[e]=n,t},S=function(t,e,n){var i,o,h,u=t&S.F,c=t&S.G,f=t&S.S,l=t&S.P,d=t&S.B,p=t&S.W,g=c?s:s[e]||(s[e]={}),y=g.prototype,v=c?r:f?r[e]:(r[e]||{}).prototype;for(i in c&&(n=e),n)(o=!u&&v&&void 0!==v[i])&&i in g||(h=o?v[i]:n[i],g[i]=c&&"function"!=typeof v[i]?n[i]:d&&o?a(h,r):p&&v[i]==h?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(h):l&&"function"==typeof h?a(Function.call,h):h,l&&((g.virtual||(g.virtual={}))[i]=h,t&S.R&&y&&!y[i]&&b(y,i,h)))};S.F=1,S.G=2,S.S=4,S.P=8,S.B=16,S.W=32,S.U=64,S.R=128;var x,E=S,F={}.hasOwnProperty,A=function(t,e){return F.call(t,e)},C={}.toString,T=function(t){return C.call(t).slice(8,-1)},P=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==T(t)?t.split(""):Object(t)},D=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},I=function(t){return P(D(t))},R=Math.ceil,B=Math.floor,H=function(t){return isNaN(t=+t)?0:(t>0?B:R)(t)},_=Math.min,N=function(t){return t>0?_(H(t),9007199254740991):0},O=Math.max,k=Math.min,j=r["__core-js_shared__"]||(r["__core-js_shared__"]={}),L=function(t){return j[t]||(j[t]={})},M=0,V=Math.random(),K=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++M+V).toString(36))},U=L("keys"),q=function(t){return U[t]||(U[t]=K(t))},z=(x=!1,function(t,e,n){var i,r=I(t),s=N(r.length),o=function(t,e){return(t=H(t))<0?O(t+e,0):k(t,e)}(n,s);if(x&&e!=e){for(;s>o;)if((i=r[o++])!=i)return!0}else for(;s>o;o++)if((x||o in r)&&r[o]===e)return x||o||0;return!x&&-1}),Y=q("IE_PROTO"),W=function(t,e){var n,i=I(t),r=0,s=[];for(n in i)n!=Y&&A(i,n)&&s.push(n);for(;e.length>r;)A(i,n=e[r++])&&(~z(s,n)||s.push(n));return s},J="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),G=Object.keys||function(t){return W(t,J)},X={f:Object.getOwnPropertySymbols},$={f:{}.propertyIsEnumerable},Z=function(t){return Object(D(t))},Q=Object.assign,tt=!Q||c(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=Q({},t)[n]||Object.keys(Q({},e)).join("")!=i})?function(t,e){for(var n=Z(t),i=arguments.length,r=1,s=X.f,o=$.f;i>r;)for(var a,h=P(arguments[r++]),u=s?G(h).concat(s(h)):G(h),c=u.length,f=0;c>f;)o.call(h,a=u[f++])&&(n[a]=h[a]);return n}:Q;E(E.S+E.F,"Object",{assign:tt});var et=s.Object.assign,nt=n(i(function(t){t.exports={default:et,__esModule:!0}})),it=i(function(t,e){t.exports=e=window.fetch,e.default=window.fetch.bind(window),e.Headers=window.Headers,e.Request=window.Request,e.Response=window.Response}),rt=(it.Headers,it.Request,it.Response,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),st=[],ot=[],at="undefined"!=typeof Uint8Array?Uint8Array:Array,ht=!1;function ut(){ht=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)st[e]=t[e],ot[t.charCodeAt(e)]=e;ot["-".charCodeAt(0)]=62,ot["_".charCodeAt(0)]=63}function ct(t,e,n){for(var i,r,s=[],o=e;o<n;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(st[(r=i)>>18&63]+st[r>>12&63]+st[r>>6&63]+st[63&r]);return s.join("")}function ft(t){var e;ht||ut();for(var n=t.length,i=n%3,r="",s=[],o=0,a=n-i;o<a;o+=16383)s.push(ct(t,o,o+16383>a?a:o+16383));return 1===i?(e=t[n-1],r+=st[e>>2],r+=st[e<<4&63],r+="=="):2===i&&(e=(t[n-2]<<8)+t[n-1],r+=st[e>>10],r+=st[e>>4&63],r+=st[e<<2&63],r+="="),s.push(r),s.join("")}function lt(t,e,n,i,r){var s,o,a=8*r-i-1,h=(1<<a)-1,u=h>>1,c=-7,f=n?r-1:0,l=n?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=u}return(d?-1:1)*o*Math.pow(2,s-i)}function dt(t,e,n,i,r,s){var o,a,h,u=8*s-r-1,c=(1<<u)-1,f=c>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+f>=1?l/h:l*Math.pow(2,1-f))*h>=2&&(o++,h/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*h-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[n+d]=255&a,d+=p,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*g}var pt={}.toString,gt=Array.isArray||function(t){return"[object Array]"==pt.call(t)};function yt(){return mt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function vt(t,e){if(yt()<e)throw new RangeError("Invalid typed array length");return mt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=mt.prototype:(null===t&&(t=new mt(e)),t.length=e),t}function mt(t,e,n){if(!(mt.TYPED_ARRAY_SUPPORT||this instanceof mt))return new mt(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return St(this,t)}return wt(this,t,e,n)}function wt(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);mt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=mt.prototype:t=xt(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!mt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|At(e,n),r=(t=vt(t,i)).write(e,n);r!==i&&(t=t.slice(0,r));return t}(t,e,n):function(t,e){if(Ft(e)){var n=0|Et(e.length);return 0===(t=vt(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?vt(t,0):xt(t,e);if("Buffer"===e.type&&gt(e.data))return xt(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function bt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function St(t,e){if(bt(e),t=vt(t,e<0?0:0|Et(e)),!mt.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function xt(t,e){var n=e.length<0?0:0|Et(e.length);t=vt(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function Et(t){if(t>=yt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+yt().toString(16)+" bytes");return 0|t}function Ft(t){return!(null==t||!t._isBuffer)}function At(t,e){if(Ft(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return $t(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Zt(t).length;default:if(i)return $t(t).length;e=(""+e).toLowerCase(),i=!0}}function Ct(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Tt(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=mt.from(e,i)),Ft(e))return 0===e.length?-1:Pt(t,e,n,i,r);if("number"==typeof e)return e&=255,mt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):Pt(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function Pt(t,e,n,i,r){var s,o=1,a=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var f=!0,l=0;l<h;l++)if(u(t,s+l)!==u(e,l)){f=!1;break}if(f)return s}return-1}function Dt(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function It(t,e,n,i){return Qt($t(e,t.length-n),t,n,i)}function Rt(t,e,n,i){return Qt(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function Bt(t,e,n,i){return Rt(t,e,n,i)}function Ht(t,e,n,i){return Qt(Zt(e),t,n,i)}function _t(t,e,n,i){return Qt(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function Nt(t,e,n){return 0===e&&n===t.length?ft(t):ft(t.slice(e,n))}function Ot(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,h,u=t[r],c=null,f=u>239?4:u>223?3:u>191?2:1;if(r+f<=n)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[r+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,f=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=f}return function(t){var e=t.length;if(e<=kt)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=kt));return n}(i)}mt.TYPED_ARRAY_SUPPORT=void 0===rt.TYPED_ARRAY_SUPPORT||rt.TYPED_ARRAY_SUPPORT,mt.poolSize=8192,mt._augment=function(t){return t.__proto__=mt.prototype,t},mt.from=function(t,e,n){return wt(null,t,e,n)},mt.TYPED_ARRAY_SUPPORT&&(mt.prototype.__proto__=Uint8Array.prototype,mt.__proto__=Uint8Array),mt.alloc=function(t,e,n){return function(t,e,n,i){return bt(e),e<=0?vt(t,e):void 0!==n?"string"==typeof i?vt(t,e).fill(n,i):vt(t,e).fill(n):vt(t,e)}(null,t,e,n)},mt.allocUnsafe=function(t){return St(null,t)},mt.allocUnsafeSlow=function(t){return St(null,t)},mt.isBuffer=te,mt.compare=function(t,e){if(!Ft(t)||!Ft(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},mt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},mt.concat=function(t,e){if(!gt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return mt.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=mt.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var s=t[n];if(!Ft(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},mt.byteLength=At,mt.prototype._isBuffer=!0,mt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Ct(this,e,e+1);return this},mt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Ct(this,e,e+3),Ct(this,e+1,e+2);return this},mt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Ct(this,e,e+7),Ct(this,e+1,e+6),Ct(this,e+2,e+5),Ct(this,e+3,e+4);return this},mt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Ot(this,0,t):function(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Mt(this,e,n);case"utf8":case"utf-8":return Ot(this,e,n);case"ascii":return jt(this,e,n);case"latin1":case"binary":return Lt(this,e,n);case"base64":return Nt(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},mt.prototype.equals=function(t){if(!Ft(t))throw new TypeError("Argument must be a Buffer");return this===t||0===mt.compare(this,t)},mt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},mt.prototype.compare=function(t,e,n,i,r){if(!Ft(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),h=this.slice(i,r),u=t.slice(e,n),c=0;c<a;++c)if(h[c]!==u[c]){s=h[c],o=u[c];break}return s<o?-1:o<s?1:0},mt.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},mt.prototype.indexOf=function(t,e,n){return Tt(this,t,e,n,!0)},mt.prototype.lastIndexOf=function(t,e,n){return Tt(this,t,e,n,!1)},mt.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return Dt(this,t,e,n);case"utf8":case"utf-8":return It(this,t,e,n);case"ascii":return Rt(this,t,e,n);case"latin1":case"binary":return Bt(this,t,e,n);case"base64":return Ht(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _t(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},mt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var kt=4096;function jt(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function Lt(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function Mt(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=e;s<n;++s)r+=Xt(t[s]);return r}function Vt(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function Kt(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Ut(t,e,n,i,r,s){if(!Ft(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function qt(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function zt(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function Yt(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Wt(t,e,n,i,r){return r||Yt(t,0,n,4),dt(t,e,n,i,23,4),n+4}function Jt(t,e,n,i,r){return r||Yt(t,0,n,8),dt(t,e,n,i,52,8),n+8}mt.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),mt.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=mt.prototype;else{var r=e-t;n=new mt(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},mt.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},mt.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},mt.prototype.readUInt8=function(t,e){return e||Kt(t,1,this.length),this[t]},mt.prototype.readUInt16LE=function(t,e){return e||Kt(t,2,this.length),this[t]|this[t+1]<<8},mt.prototype.readUInt16BE=function(t,e){return e||Kt(t,2,this.length),this[t]<<8|this[t+1]},mt.prototype.readUInt32LE=function(t,e){return e||Kt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},mt.prototype.readUInt32BE=function(t,e){return e||Kt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},mt.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},mt.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||Kt(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},mt.prototype.readInt8=function(t,e){return e||Kt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},mt.prototype.readInt16LE=function(t,e){e||Kt(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},mt.prototype.readInt16BE=function(t,e){e||Kt(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},mt.prototype.readInt32LE=function(t,e){return e||Kt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},mt.prototype.readInt32BE=function(t,e){return e||Kt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},mt.prototype.readFloatLE=function(t,e){return e||Kt(t,4,this.length),lt(this,t,!0,23,4)},mt.prototype.readFloatBE=function(t,e){return e||Kt(t,4,this.length),lt(this,t,!1,23,4)},mt.prototype.readDoubleLE=function(t,e){return e||Kt(t,8,this.length),lt(this,t,!0,52,8)},mt.prototype.readDoubleBE=function(t,e){return e||Kt(t,8,this.length),lt(this,t,!1,52,8)},mt.prototype.writeUIntLE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||Ut(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},mt.prototype.writeUIntBE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||Ut(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},mt.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,1,255,0),mt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},mt.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,65535,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},mt.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,65535,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},mt.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,4294967295,0),mt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):zt(this,t,e,!0),e+4},mt.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,4294967295,0),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):zt(this,t,e,!1),e+4},mt.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Ut(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},mt.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Ut(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},mt.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,1,127,-128),mt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},mt.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,32767,-32768),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):qt(this,t,e,!0),e+2},mt.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,2,32767,-32768),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):qt(this,t,e,!1),e+2},mt.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,2147483647,-2147483648),mt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):zt(this,t,e,!0),e+4},mt.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Ut(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),mt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):zt(this,t,e,!1),e+4},mt.prototype.writeFloatLE=function(t,e,n){return Wt(this,t,e,!0,n)},mt.prototype.writeFloatBE=function(t,e,n){return Wt(this,t,e,!1,n)},mt.prototype.writeDoubleLE=function(t,e,n){return Jt(this,t,e,!0,n)},mt.prototype.writeDoubleBE=function(t,e,n){return Jt(this,t,e,!1,n)},mt.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!mt.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},mt.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!mt.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=Ft(t)?t:$t(new mt(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var Gt=/[^+\/0-9A-Za-z-_]/g;function Xt(t){return t<16?"0"+t.toString(16):t.toString(16)}function $t(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Zt(t){return function(t){var e,n,i,r,s,o;ht||ut();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new at(3*a/4-s),i=s>0?a-4:a;var h=0;for(e=0,n=0;e<i;e+=4,n+=3)r=ot[t.charCodeAt(e)]<<18|ot[t.charCodeAt(e+1)]<<12|ot[t.charCodeAt(e+2)]<<6|ot[t.charCodeAt(e+3)],o[h++]=r>>16&255,o[h++]=r>>8&255,o[h++]=255&r;return 2===s?(r=ot[t.charCodeAt(e)]<<2|ot[t.charCodeAt(e+1)]>>4,o[h++]=255&r):1===s&&(r=ot[t.charCodeAt(e)]<<10|ot[t.charCodeAt(e+1)]<<4|ot[t.charCodeAt(e+2)]>>2,o[h++]=r>>8&255,o[h++]=255&r),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Gt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Qt(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function te(t){return null!=t&&(!!t._isBuffer||ee(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&ee(t.slice(0,0))}(t))}function ee(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ne={userAgent:!1},ie={};if(void 0===re)var re={};re.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var r;for(r in n)t.prototype[r]=n[r];var s=function(){},o=["toString","valueOf"];try{/MSIE/.test(ne.userAgent)&&(s=function(t,e){for(r=0;r<o.length;r+=1){var n=o[r],i=e[n];"function"==typeof i&&i!=Object.prototype[n]&&(t[n]=i)}})}catch(t){}s(t.prototype,n)}}};var se,oe,ae,he,ue=ue||function(t,e){var n={},i=n.lib={},r=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=i.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(s=0;s<r;s+=4)e[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;i<e;i+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),o=n.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},h=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(h.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return h.parse(unescape(encodeURIComponent(t)))}},c=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,o=this.blockSize,a=r/(4*o),h=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,u=t.min(4*h,r);if(h){for(var c=0;c<h;c+=o)this._doProcessBlock(i,c);var f=i.splice(0,h);n.sigBytes-=u}return new s.init(f,u)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(i.Hasher=c.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new f.HMAC.init(t,n).finalize(e)}}}),n.algo={});return n}(Math);!function(t){var e,n=(e=ue).lib,i=n.Base,r=n.WordArray;(e=e.x64={}).Word=i.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],i=0;i<e;i++){var s=t[i];n.push(s.high),n.push(s.low)}return r.create(n,this.sigBytes)},clone:function(){for(var t=i.clone.call(this),e=t.words=this.words.slice(0),n=e.length,r=0;r<n;r++)e[r]=e[r].clone();return t}})}(),ue.lib.Cipher||function(t){var e=(d=ue).lib,n=e.Base,i=e.WordArray,r=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=r.extend({cfg:n.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,i){return("string"==typeof n?p:l).encrypt(t,e,n,i)},decrypt:function(e,n,i){return("string"==typeof n?p:l).decrypt(t,e,n,i)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var h=d.mode={},u=function(t,e,n){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var r=0;r<n;r++)t[e+r]^=i[r]},c=(e.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();c.Encryptor=c.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize;u.call(this,t,e,i),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),c.Decryptor=c.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=t.slice(e,e+i);n.decryptBlock(t,e),u.call(this,t,e,i),this._prevBlock=r}}),h=h.CBC=c,c=(d.pad={}).Pkcs7={pad:function(t,e){for(var n,r=(n=(n=4*e)-t.sigBytes%n)<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(r);n=i.create(s,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:h,padding:c}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=e.CipherParams=n.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(h=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var n=i.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:n})}},e.SerializableCipher=n.extend({cfg:n.extend({format:h}),encrypt:function(t,e,n,i){i=this.cfg.extend(i);var r=t.createEncryptor(n,i);return e=r.finalize(e),r=r.cfg,f.create({ciphertext:e,key:n,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(n,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,n,r){return r||(r=i.random(8)),t=o.create({keySize:e+n}).compute(t,r),n=i.create(t.words.slice(e),4*n),t.sigBytes=4*e,f.create({key:t,iv:n,salt:r})}},p=e.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:d}),encrypt:function(t,e,n,i){return n=(i=this.cfg.extend(i)).kdf.execute(n,t.keySize,t.ivSize),i.iv=n.iv,(t=l.encrypt.call(this,t,e,n.key,i)).mixIn(n),t},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),n=i.kdf.execute(n,t.keySize,t.ivSize,e.salt),i.iv=n.iv,l.decrypt.call(this,t,e,n.key,i)}})}(),function(){for(var t=ue,e=t.lib.BlockCipher,n=t.algo,i=[],r=[],s=[],o=[],a=[],h=[],u=[],c=[],f=[],l=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;var g=0,y=0;for(p=0;256>p;p++){var v=(v=y^y<<1^y<<2^y<<3^y<<4)>>>8^255&v^99;i[g]=v,r[v]=g;var m=d[g],w=d[m],b=d[w],S=257*d[v]^16843008*v;s[g]=S<<24|S>>>8,o[g]=S<<16|S>>>16,a[g]=S<<8|S>>>24,h[g]=S,S=16843009*b^65537*w^257*m^16843008*g,u[v]=S<<24|S>>>8,c[v]=S<<16|S>>>16,f[v]=S<<8|S>>>24,l[v]=S,g?(g=m^d[d[d[b^m]]],y^=d[d[y]]):g=y=1}var x=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=e.extend({_doReset:function(){for(var t=(n=this._key).words,e=n.sigBytes/4,n=4*((this._nRounds=e+6)+1),r=this._keySchedule=[],s=0;s<n;s++)if(s<e)r[s]=t[s];else{var o=r[s-1];s%e?6<e&&4==s%e&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=i[(o=o<<8|o>>>24)>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=x[s/e|0]<<24),r[s]=r[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<n;e++)s=n-e,o=e%4?r[s]:r[s-4],t[e]=4>e||4>=s?o:u[i[o>>>24]]^c[i[o>>>16&255]]^f[i[o>>>8&255]]^l[i[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,h,i)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,u,c,f,l,r),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,i,r,s,o,a){for(var h=this._nRounds,u=t[e]^n[0],c=t[e+1]^n[1],f=t[e+2]^n[2],l=t[e+3]^n[3],d=4,p=1;p<h;p++){var g=i[u>>>24]^r[c>>>16&255]^s[f>>>8&255]^o[255&l]^n[d++],y=i[c>>>24]^r[f>>>16&255]^s[l>>>8&255]^o[255&u]^n[d++],v=i[f>>>24]^r[l>>>16&255]^s[u>>>8&255]^o[255&c]^n[d++];l=i[l>>>24]^r[u>>>16&255]^s[c>>>8&255]^o[255&f]^n[d++],u=g,c=y,f=v}g=(a[u>>>24]<<24|a[c>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^n[d++],y=(a[c>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&u])^n[d++],v=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[u>>>8&255]<<8|a[255&c])^n[d++],l=(a[l>>>24]<<24|a[u>>>16&255]<<16|a[c>>>8&255]<<8|a[255&f])^n[d++],t[e]=g,t[e+1]=y,t[e+2]=v,t[e+3]=l},keySize:8});t.AES=e._createHelper(n)}(),function(){function t(t,e){var n=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=n,this._lBlock^=n<<t}function e(t,e){var n=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=n,this._rBlock^=n<<t}var n=ue,i=(r=n.lib).WordArray,r=r.BlockCipher,s=n.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],h=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],u=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=r.extend({_doReset:function(){for(var t=this._key.words,e=[],n=0;56>n;n++){var i=o[n]-1;e[n]=t[i>>>5]>>>31-i%32&1}for(t=this._subKeys=[],i=0;16>i;i++){var r=t[i]=[],s=h[i];for(n=0;24>n;n++)r[n/6|0]|=e[(a[n]-1+s)%28]<<31-n%6,r[4+(n/6|0)]|=e[28+(a[n+24]-1+s)%28]<<31-n%6;for(r[0]=r[0]<<1|r[0]>>>31,n=1;7>n;n++)r[n]>>>=4*(n-1)+3;r[7]=r[7]<<5|r[7]>>>27}for(e=this._invSubKeys=[],n=0;16>n;n++)e[n]=t[15-n]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(n,i,r){this._lBlock=n[i],this._rBlock=n[i+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;16>s;s++){for(var o=r[s],a=this._lBlock,h=this._rBlock,f=0,l=0;8>l;l++)f|=u[l][((h^o[l])&c[l])>>>0];this._lBlock=h,this._rBlock=a^f}r=this._lBlock,this._lBlock=this._rBlock,this._rBlock=r,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),n[i]=this._lBlock,n[i+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=r._createHelper(f),s=s.TripleDES=r.extend({_doReset:function(){var t=this._key.words;this._des1=f.createEncryptor(i.create(t.slice(0,2))),this._des2=f.createEncryptor(i.create(t.slice(2,4))),this._des3=f.createEncryptor(i.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=r._createHelper(s)}(),function(){var t=ue,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp(),t=[];for(var r=0;r<n;r+=3)for(var s=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<n;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,i=this._map;(r=i.charAt(64))&&(-1!=(r=t.indexOf(r))&&(n=r));for(var r=[],s=0,o=0;o<n;o++)if(o%4){var a=i.indexOf(t.charAt(o-1))<<o%4*2,h=i.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|h)<<24-s%4*8,s++}return e.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,n,i,r,s,o){return((t=t+(e&n|~e&i)+r+o)<<s|t>>>32-s)+e}function n(t,e,n,i,r,s,o){return((t=t+(e&i|n&~i)+r+o)<<s|t>>>32-s)+e}function i(t,e,n,i,r,s,o){return((t=t+(e^n^i)+r+o)<<s|t>>>32-s)+e}function r(t,e,n,i,r,s,o){return((t=t+(n^(e|~i))+r+o)<<s|t>>>32-s)+e}for(var s=ue,o=(h=s.lib).WordArray,a=h.Hasher,h=s.algo,u=[],c=0;64>c;c++)u[c]=4294967296*t.abs(t.sin(c+1))|0;h=h.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[h=s+o];t[h]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var h=t[s+0],c=(a=t[s+1],t[s+2]),f=t[s+3],l=t[s+4],d=t[s+5],p=t[s+6],g=t[s+7],y=t[s+8],v=t[s+9],m=t[s+10],w=t[s+11],b=t[s+12],S=t[s+13],x=t[s+14],E=t[s+15],F=e(F=o[0],T=o[1],C=o[2],A=o[3],h,7,u[0]),A=e(A,F,T,C,a,12,u[1]),C=e(C,A,F,T,c,17,u[2]),T=e(T,C,A,F,f,22,u[3]);F=e(F,T,C,A,l,7,u[4]),A=e(A,F,T,C,d,12,u[5]),C=e(C,A,F,T,p,17,u[6]),T=e(T,C,A,F,g,22,u[7]),F=e(F,T,C,A,y,7,u[8]),A=e(A,F,T,C,v,12,u[9]),C=e(C,A,F,T,m,17,u[10]),T=e(T,C,A,F,w,22,u[11]),F=e(F,T,C,A,b,7,u[12]),A=e(A,F,T,C,S,12,u[13]),C=e(C,A,F,T,x,17,u[14]),F=n(F,T=e(T,C,A,F,E,22,u[15]),C,A,a,5,u[16]),A=n(A,F,T,C,p,9,u[17]),C=n(C,A,F,T,w,14,u[18]),T=n(T,C,A,F,h,20,u[19]),F=n(F,T,C,A,d,5,u[20]),A=n(A,F,T,C,m,9,u[21]),C=n(C,A,F,T,E,14,u[22]),T=n(T,C,A,F,l,20,u[23]),F=n(F,T,C,A,v,5,u[24]),A=n(A,F,T,C,x,9,u[25]),C=n(C,A,F,T,f,14,u[26]),T=n(T,C,A,F,y,20,u[27]),F=n(F,T,C,A,S,5,u[28]),A=n(A,F,T,C,c,9,u[29]),C=n(C,A,F,T,g,14,u[30]),F=i(F,T=n(T,C,A,F,b,20,u[31]),C,A,d,4,u[32]),A=i(A,F,T,C,y,11,u[33]),C=i(C,A,F,T,w,16,u[34]),T=i(T,C,A,F,x,23,u[35]),F=i(F,T,C,A,a,4,u[36]),A=i(A,F,T,C,l,11,u[37]),C=i(C,A,F,T,g,16,u[38]),T=i(T,C,A,F,m,23,u[39]),F=i(F,T,C,A,S,4,u[40]),A=i(A,F,T,C,h,11,u[41]),C=i(C,A,F,T,f,16,u[42]),T=i(T,C,A,F,p,23,u[43]),F=i(F,T,C,A,v,4,u[44]),A=i(A,F,T,C,b,11,u[45]),C=i(C,A,F,T,E,16,u[46]),F=r(F,T=i(T,C,A,F,c,23,u[47]),C,A,h,6,u[48]),A=r(A,F,T,C,g,10,u[49]),C=r(C,A,F,T,x,15,u[50]),T=r(T,C,A,F,d,21,u[51]),F=r(F,T,C,A,b,6,u[52]),A=r(A,F,T,C,f,10,u[53]),C=r(C,A,F,T,m,15,u[54]),T=r(T,C,A,F,a,21,u[55]),F=r(F,T,C,A,y,6,u[56]),A=r(A,F,T,C,E,10,u[57]),C=r(C,A,F,T,p,15,u[58]),T=r(T,C,A,F,S,21,u[59]),F=r(F,T,C,A,l,6,u[60]),A=r(A,F,T,C,w,10,u[61]),C=r(C,A,F,T,c,15,u[62]),T=r(T,C,A,F,v,21,u[63]);o[0]=o[0]+F|0,o[1]=o[1]+T|0,o[2]=o[2]+C|0,o[3]=o[3]+A|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var s=t.floor(i/4294967296);for(n[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(n.length+1),this._process(),n=(e=this._hash).words,i=0;4>i;i++)r=n[i],n[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(h),s.HmacMD5=a._createHmacHelper(h)}(Math),function(){var t=ue,e=(r=t.lib).WordArray,n=r.Hasher,i=[],r=t.algo.SHA1=n.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],s=n[1],o=n[2],a=n[3],h=n[4],u=0;80>u;u++){if(16>u)i[u]=0|t[e+u];else{var c=i[u-3]^i[u-8]^i[u-14]^i[u-16];i[u]=c<<1|c>>>31}c=(r<<5|r>>>27)+h+i[u],c=20>u?c+(1518500249+(s&o|~s&a)):40>u?c+(1859775393+(s^o^a)):60>u?c+((s&o|s&a|o&a)-1894007588):c+((s^o^a)-899497514),h=a,a=o,o=s<<30|s>>>2,s=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+h|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(r),t.HmacSHA1=n._createHmacHelper(r)}(),function(t){for(var e=ue,n=(r=e.lib).WordArray,i=r.Hasher,r=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},h=2,u=0;64>u;){var c;t:{c=h;for(var f=t.sqrt(c),l=2;l<=f;l++)if(!(c%l)){c=!1;break t}c=!0}c&&(8>u&&(s[u]=a(t.pow(h,.5))),o[u]=a(t.pow(h,1/3)),u++),h++}var d=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],a=n[3],h=n[4],u=n[5],c=n[6],f=n[7],l=0;64>l;l++){if(16>l)d[l]=0|t[e+l];else{var p=d[l-15],g=d[l-2];d[l]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[l-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[l-16]}p=f+((h<<26|h>>>6)^(h<<21|h>>>11)^(h<<7|h>>>25))+(h&u^~h&c)+o[l]+d[l],g=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&s^r&s),f=c,c=u,u=h,h=a+p|0,a=s,s=r,r=i,i=p+g|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+h|0,n[5]=n[5]+u|0,n[6]=n[6]+c|0,n[7]=n[7]+f|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(r),e.HmacSHA256=i._createHmacHelper(r)}(Math),oe=(se=ue).lib.WordArray,ae=(he=se.algo).SHA256,he=he.SHA224=ae.extend({_doReset:function(){this._hash=new oe.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=ae._doFinalize.call(this);return t.sigBytes-=4,t}}),se.SHA224=ae._createHelper(he),se.HmacSHA224=ae._createHmacHelper(he),function(){function t(){return i.create.apply(i,arguments)}for(var e=ue,n=e.lib.Hasher,i=(s=e.x64).Word,r=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],h=0;80>h;h++)a[h]=t();s=s.SHA512=n.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=(f=this._hash.words)[0],i=f[1],r=f[2],s=f[3],h=f[4],u=f[5],c=f[6],f=f[7],l=n.high,d=n.low,p=i.high,g=i.low,y=r.high,v=r.low,m=s.high,w=s.low,b=h.high,S=h.low,x=u.high,E=u.low,F=c.high,A=c.low,C=f.high,T=f.low,P=l,D=d,I=p,R=g,B=y,H=v,_=m,N=w,O=b,k=S,j=x,L=E,M=F,V=A,K=C,U=T,q=0;80>q;q++){var z=a[q];if(16>q)var Y=z.high=0|t[e+2*q],W=z.low=0|t[e+2*q+1];else{Y=((W=(Y=a[q-15]).high)>>>1|(J=Y.low)<<31)^(W>>>8|J<<24)^W>>>7;var J=(J>>>1|W<<31)^(J>>>8|W<<24)^(J>>>7|W<<25),G=((W=(G=a[q-2]).high)>>>19|(X=G.low)<<13)^(W<<3|X>>>29)^W>>>6,X=(X>>>19|W<<13)^(X<<3|W>>>29)^(X>>>6|W<<26),$=(W=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low;Y=(Y=(Y=Y+$+((W=J+W.low)>>>0<J>>>0?1:0))+G+((W=W+X)>>>0<X>>>0?1:0))+Z+((W=W+Q)>>>0<Q>>>0?1:0);z.high=Y,z.low=W}$=O&j^~O&M,Q=k&L^~k&V,z=P&I^P&B^I&B;var tt=D&R^D&H^R&H,et=(J=(P>>>28|D<<4)^(P<<30|D>>>2)^(P<<25|D>>>7),G=(D>>>28|P<<4)^(D<<30|P>>>2)^(D<<25|P>>>7),(X=o[q]).high),nt=X.low;Z=K+((O>>>14|k<<18)^(O>>>18|k<<14)^(O<<23|k>>>9))+((X=U+((k>>>14|O<<18)^(k>>>18|O<<14)^(k<<23|O>>>9)))>>>0<U>>>0?1:0),K=M,U=V,M=j,V=L,j=O,L=k,O=_+(Z=(Z=(Z=Z+$+((X=X+Q)>>>0<Q>>>0?1:0))+et+((X=X+nt)>>>0<nt>>>0?1:0))+Y+((X=X+W)>>>0<W>>>0?1:0))+((k=N+X|0)>>>0<N>>>0?1:0)|0,_=B,N=H,B=I,H=R,I=P,R=D,P=Z+(z=J+z+((W=G+tt)>>>0<G>>>0?1:0))+((D=X+W|0)>>>0<X>>>0?1:0)|0}d=n.low=d+D,n.high=l+P+(d>>>0<D>>>0?1:0),g=i.low=g+R,i.high=p+I+(g>>>0<R>>>0?1:0),v=r.low=v+H,r.high=y+B+(v>>>0<H>>>0?1:0),w=s.low=w+N,s.high=m+_+(w>>>0<N>>>0?1:0),S=h.low=S+k,h.high=b+O+(S>>>0<k>>>0?1:0),E=u.low=E+L,u.high=x+j+(E>>>0<L>>>0?1:0),A=c.low=A+V,c.high=F+M+(A>>>0<V>>>0?1:0),T=f.low=T+U,f.high=C+K+(T>>>0<U>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(i+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=n._createHelper(s),e.HmacSHA512=n._createHmacHelper(s)}(),function(){var t=ue,e=(r=t.x64).Word,n=r.WordArray,i=(r=t.algo).SHA512,r=r.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=i._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=i._createHelper(r),t.HmacSHA384=i._createHmacHelper(r)}(),function(){var t=ue,e=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,r=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),h=e.create([0,1518500249,1859775393,2400959708,2840853838]),u=e.create([1352829926,1548603684,1836072691,2053994217,0]);i=i.RIPEMD160=n.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=0;16>n;n++){var i=t[b=e+n];t[b]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var c,f,l,d,p,g,y,v,m,w,b=this._hash.words,S=(i=h.words,u.words),x=r.words,E=s.words,F=o.words,A=a.words;g=c=b[0],y=f=b[1],v=l=b[2],m=d=b[3],w=p=b[4];var C;for(n=0;80>n;n+=1)C=c+t[e+x[n]]|0,C=16>n?C+((f^l^d)+i[0]):32>n?C+((f&l|~f&d)+i[1]):48>n?C+(((f|~l)^d)+i[2]):64>n?C+((f&d|l&~d)+i[3]):C+((f^(l|~d))+i[4]),C=(C=(C|=0)<<F[n]|C>>>32-F[n])+p|0,c=p,p=d,d=l<<10|l>>>22,l=f,f=C,C=g+t[e+E[n]]|0,C=16>n?C+((y^(v|~m))+S[0]):32>n?C+((y&m|v&~m)+S[1]):48>n?C+(((y|~v)^m)+S[2]):64>n?C+((y&v|~y&m)+S[3]):C+((y^v^m)+S[4]),C=(C=(C|=0)<<A[n]|C>>>32-A[n])+w|0,g=w,w=m,m=v<<10|v>>>22,v=y,y=C;C=b[1]+l+m|0,b[1]=b[2]+d+w|0,b[2]=b[3]+p+g|0,b[3]=b[4]+c+y|0,b[4]=b[0]+f+v|0,b[0]=C},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;for(e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,n=0;5>n;n++)i=e[n],e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.RIPEMD160=n._createHelper(i),t.HmacRIPEMD160=n._createHmacHelper(i)}(Math),function(){var t=ue,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var i=t.blockSize,r=4*i;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,h=o.words,u=0;u<i;u++)a[u]^=1549556828,h[u]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t,e=ue,n=(t=e.lib).Base,i=t.WordArray,r=(t=e.algo).HMAC,s=t.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){var n=this.cfg,s=r.create(n.hasher,t),o=i.create(),a=i.create([1]),h=o.words,u=a.words,c=n.keySize;for(n=n.iterations;h.length<c;){var f=s.update(e).finalize(a);s.reset();for(var l=f.words,d=l.length,p=f,g=1;g<n;g++){p=s.finalize(p),s.reset();for(var y=p.words,v=0;v<d;v++)l[v]^=y[v]}o.concat(f),u[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(t,e,n){return s.create(n).compute(t,e)}}();var ce="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fe="=";function le(t){var e,n,i="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),i+=ce.charAt(n>>6)+ce.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),i+=ce.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),i+=ce.charAt(n>>2)+ce.charAt((3&n)<<4));(3&i.length)>0;)i+=fe;return i}function de(t){var e,n,i,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=fe;++e)(i=ce.indexOf(t.charAt(e)))<0||(0==s?(r+=be(i>>2),n=3&i,s=1):1==s?(r+=be(n<<2|i>>4),n=15&i,s=2):2==s?(r+=be(n),r+=be(i>>2),n=3&i,s=3):(r+=be(n<<2|i>>4),r+=be(15&i),s=0));return 1==s&&(r+=be(n<<2)),r}function pe(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function ge(){return new pe(null)}pe.prototype.am=function(t,e,n,i,r,s){for(;--s>=0;){var o=e*this[t++]+n[i]+r;r=Math.floor(o/67108864),n[i++]=67108863&o}return r},pe.prototype.DB=26,pe.prototype.DM=67108863,pe.prototype.DV=1<<26;pe.prototype.FV=Math.pow(2,52),pe.prototype.F1=26,pe.prototype.F2=0;var ye,ve,me="0123456789abcdefghijklmnopqrstuvwxyz",we=new Array;for(ye="0".charCodeAt(0),ve=0;ve<=9;++ve)we[ye++]=ve;for(ye="a".charCodeAt(0),ve=10;ve<36;++ve)we[ye++]=ve;for(ye="A".charCodeAt(0),ve=10;ve<36;++ve)we[ye++]=ve;function be(t){return me.charAt(t)}function Se(t,e){var n=we[t.charCodeAt(e)];return null==n?-1:n}function xe(t){var e=ge();return e.fromInt(t),e}function Ee(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function Fe(t){this.m=t}function Ae(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Ce(t,e){return t&e}function Te(t,e){return t|e}function Pe(t,e){return t^e}function De(t,e){return t&~e}function Ie(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Re(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Be(){}function He(t){return t}function _e(t){this.r2=ge(),this.q3=ge(),pe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}Fe.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},Fe.prototype.revert=function(t){return t},Fe.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},Fe.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},Fe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},Ae.prototype.convert=function(t){var e=ge();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(pe.ZERO)>0&&this.m.subTo(e,e),e},Ae.prototype.revert=function(t){var e=ge();return t.copyTo(e),this.reduce(e),e},Ae.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},Ae.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},Ae.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},pe.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},pe.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},pe.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,r=!1,s=0;--i>=0;){var o=8==n?255&t[i]:Se(t,i);o<0?"-"==t.charAt(i)&&(r=!0):(r=!1,0==s?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&pe.ZERO.subTo(this,this)},pe.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},pe.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},pe.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},pe.prototype.lShiftTo=function(t,e){var n,i=t%this.DB,r=this.DB-i,s=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>r|a,a=(this[n]&s)<<i;for(n=o-1;n>=0;--n)e[n]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},pe.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var i=t%this.DB,r=this.DB-i,s=(1<<i)-1;e[0]=this[n]>>i;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&s)<<r,e[o-n]=this[o]>>i;i>0&&(e[this.t-n-1]|=(this.s&s)<<r),e.t=this.t-n,e.clamp()}},pe.prototype.subTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()},pe.prototype.multiplyTo=function(t,e){var n=this.abs(),i=t.abs(),r=n.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+n.t]=n.am(0,i[r],e,r,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&pe.ZERO.subTo(e,e)},pe.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},pe.prototype.divRemTo=function(t,e,n){var i=t.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=ge());var s=ge(),o=this.s,a=t.s,h=this.DB-Ee(i[i.t-1]);h>0?(i.lShiftTo(h,s),r.lShiftTo(h,n)):(i.copyTo(s),r.copyTo(n));var u=s.t,c=s[u-1];if(0!=c){var f=c*(1<<this.F1)+(u>1?s[u-2]>>this.F2:0),l=this.FV/f,d=(1<<this.F1)/f,p=1<<this.F2,g=n.t,y=g-u,v=null==e?ge():e;for(s.dlShiftTo(y,v),n.compareTo(v)>=0&&(n[n.t++]=1,n.subTo(v,n)),pe.ONE.dlShiftTo(u,v),v.subTo(s,s);s.t<u;)s[s.t++]=0;for(;--y>=0;){var m=n[--g]==c?this.DM:Math.floor(n[g]*l+(n[g-1]+p)*d);if((n[g]+=s.am(0,m,n,y,0,u))<m)for(s.dlShiftTo(y,v),n.subTo(v,n);n[g]<--m;)n.subTo(v,n)}null!=e&&(n.drShiftTo(u,e),o!=a&&pe.ZERO.subTo(e,e)),n.t=u,n.clamp(),h>0&&n.rShiftTo(h,n),o<0&&pe.ZERO.subTo(n,n)}}},pe.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},pe.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},pe.prototype.exp=function(t,e){if(t>4294967295||t<1)return pe.ONE;var n=ge(),i=ge(),r=e.convert(this),s=Ee(t)-1;for(r.copyTo(n);--s>=0;)if(e.sqrTo(n,i),(t&1<<s)>0)e.mulTo(i,r,n);else{var o=n;n=i,i=o}return e.revert(n)},pe.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(r=!0,s=be(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&i,a<=0&&(a+=this.DB,--o)),n>0&&(r=!0),r&&(s+=be(n));return r?s:"0"},pe.prototype.negate=function(){var t=ge();return pe.ZERO.subTo(this,t),t},pe.prototype.abs=function(){return this.s<0?this.negate():this},pe.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},pe.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Ee(this[this.t-1]^this.s&this.DM)},pe.prototype.mod=function(t){var e=ge();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(pe.ZERO)>0&&t.subTo(e,e),e},pe.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new Fe(e):new Ae(e),this.exp(t,n)},pe.ZERO=xe(0),pe.ONE=xe(1),Be.prototype.convert=He,Be.prototype.revert=He,Be.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},Be.prototype.sqrTo=function(t,e){t.squareTo(e)},_e.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=ge();return t.copyTo(e),this.reduce(e),e},_e.prototype.revert=function(t){return t},_e.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},_e.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},_e.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var Ne=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],Oe=(1<<26)/Ne[Ne.length-1];function ke(){this.i=0,this.j=0,this.S=new Array}pe.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},pe.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),i=xe(n),r=ge(),s=ge(),o="";for(this.divRemTo(i,r,s);r.signum()>0;)o=(n+s.intValue()).toString(t).substr(1)+o,r.divRemTo(i,r,s);return s.intValue().toString(t)+o},pe.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),r=!1,s=0,o=0,a=0;a<t.length;++a){var h=Se(t,a);h<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+h,++s>=n&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&pe.ZERO.subTo(this,this)},pe.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(pe.ONE.shiftLeft(t-1),Te,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(pe.ONE.shiftLeft(t-1),this);else{var i=new Array,r=7&t;i.length=1+(t>>3),e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}},pe.prototype.bitwiseTo=function(t,e,n){var i,r,s=Math.min(t.t,this.t);for(i=0;i<s;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=s;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=s;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},pe.prototype.changeBit=function(t,e){var n=pe.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},pe.prototype.addTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()},pe.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},pe.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},pe.prototype.multiplyLowerTo=function(t,e,n){var i,r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},pe.prototype.multiplyUpperTo=function(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)},pe.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n},pe.prototype.millerRabin=function(t){var e=this.subtract(pe.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var i=e.shiftRight(n);(t=t+1>>1)>Ne.length&&(t=Ne.length);for(var r=ge(),s=0;s<t;++s){r.fromInt(Ne[Math.floor(Math.random()*Ne.length)]);var o=r.modPow(i,this);if(0!=o.compareTo(pe.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<n&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(pe.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},pe.prototype.clone=function(){var t=ge();return this.copyTo(t),t},pe.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},pe.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},pe.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},pe.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},pe.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e},pe.prototype.equals=function(t){return 0==this.compareTo(t)},pe.prototype.min=function(t){return this.compareTo(t)<0?this:t},pe.prototype.max=function(t){return this.compareTo(t)>0?this:t},pe.prototype.and=function(t){var e=ge();return this.bitwiseTo(t,Ce,e),e},pe.prototype.or=function(t){var e=ge();return this.bitwiseTo(t,Te,e),e},pe.prototype.xor=function(t){var e=ge();return this.bitwiseTo(t,Pe,e),e},pe.prototype.andNot=function(t){var e=ge();return this.bitwiseTo(t,De,e),e},pe.prototype.not=function(){for(var t=ge(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},pe.prototype.shiftLeft=function(t){var e=ge();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},pe.prototype.shiftRight=function(t){var e=ge();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},pe.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+Ie(this[t]);return this.s<0?this.t*this.DB:-1},pe.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=Re(this[n]^e);return t},pe.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},pe.prototype.setBit=function(t){return this.changeBit(t,Te)},pe.prototype.clearBit=function(t){return this.changeBit(t,De)},pe.prototype.flipBit=function(t){return this.changeBit(t,Pe)},pe.prototype.add=function(t){var e=ge();return this.addTo(t,e),e},pe.prototype.subtract=function(t){var e=ge();return this.subTo(t,e),e},pe.prototype.multiply=function(t){var e=ge();return this.multiplyTo(t,e),e},pe.prototype.divide=function(t){var e=ge();return this.divRemTo(t,e,null),e},pe.prototype.remainder=function(t){var e=ge();return this.divRemTo(t,null,e),e},pe.prototype.divideAndRemainder=function(t){var e=ge(),n=ge();return this.divRemTo(t,e,n),new Array(e,n)},pe.prototype.modPow=function(t,e){var n,i,r=t.bitLength(),s=xe(1);if(r<=0)return s;n=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new Fe(e):e.isEven()?new _e(e):new Ae(e);var o=new Array,a=3,h=n-1,u=(1<<n)-1;if(o[1]=i.convert(this),n>1){var c=ge();for(i.sqrTo(o[1],c);a<=u;)o[a]=ge(),i.mulTo(c,o[a-2],o[a]),a+=2}var f,l,d=t.t-1,p=!0,g=ge();for(r=Ee(t[d])-1;d>=0;){for(r>=h?f=t[d]>>r-h&u:(f=(t[d]&(1<<r+1)-1)<<h-r,d>0&&(f|=t[d-1]>>this.DB+r-h)),a=n;0==(1&f);)f>>=1,--a;if((r-=a)<0&&(r+=this.DB,--d),p)o[f].copyTo(s),p=!1;else{for(;a>1;)i.sqrTo(s,g),i.sqrTo(g,s),a-=2;a>0?i.sqrTo(s,g):(l=s,s=g,g=l),i.mulTo(g,o[f],s)}for(;d>=0&&0==(t[d]&1<<r);)i.sqrTo(s,g),l=s,s=g,g=l,--r<0&&(r=this.DB-1,--d)}return i.revert(s)},pe.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return pe.ZERO;for(var n=t.clone(),i=this.clone(),r=xe(1),s=xe(0),o=xe(0),a=xe(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);n.compareTo(i)>=0?(n.subTo(i,n),e&&r.subTo(o,r),s.subTo(a,s)):(i.subTo(n,i),e&&o.subTo(r,o),a.subTo(s,a))}return 0!=i.compareTo(pe.ONE)?pe.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},pe.prototype.pow=function(t){return this.exp(t,new Be)},pe.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},pe.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=Ne[Ne.length-1]){for(e=0;e<Ne.length;++e)if(n[0]==Ne[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<Ne.length;){for(var i=Ne[e],r=e+1;r<Ne.length&&i<Oe;)i*=Ne[r++];for(i=n.modInt(i);e<r;)if(i%Ne[e++]==0)return!1}return n.millerRabin(t)},pe.prototype.square=function(){var t=ge();return this.squareTo(t),t},ke.prototype.init=function(t){var e,n,i;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[n],this.S[n]=i;this.i=0,this.j=0},ke.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var je,Le,Me,Ve=256;function Ke(){var t;t=(new Date).getTime(),Le[Me++]^=255&t,Le[Me++]^=t>>8&255,Le[Me++]^=t>>16&255,Le[Me++]^=t>>24&255,Me>=Ve&&(Me-=Ve)}if(null==Le){var Ue;if(Le=new Array,Me=0,void 0!==ie&&void 0!==ie.msCrypto)ie.msCrypto.getRandomValues;for(;Me<Ve;)Ue=Math.floor(65536*Math.random()),Le[Me++]=Ue>>>8,Le[Me++]=255&Ue;Me=0,Ke()}function qe(){if(null==je){for(Ke(),(je=new ke).init(Le),Me=0;Me<Le.length;++Me)Le[Me]=0;Me=0}return je.next()}function ze(){}function Ye(t,e){return new pe(t,e)}function We(t,e,n){for(var i="",r=0;i.length<e;)i+=n(String.fromCharCode.apply(String,t.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]))),r+=1;return i}function Je(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Ge(t,e,n){for(var i="",r=0;i.length<e;)i+=n(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])),r+=1;return i}function Xe(t,e){this.x=e,this.q=t}function $e(t,e,n,i){this.curve=t,this.x=e,this.y=n,this.z=null==i?pe.ONE:i,this.zinv=null}function Ze(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new $e(this,null,null)}ze.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=qe()},Je.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},Je.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=Ye(t,16),this.e=parseInt(e,16)}},Je.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var n=new Array,i=t.length-1;i>=0&&e>0;){var r=t.charCodeAt(i--);r<128?n[--e]=r:r>127&&r<2048?(n[--e]=63&r|128,n[--e]=r>>6|192):(n[--e]=63&r|128,n[--e]=r>>6&63|128,n[--e]=r>>12|224)}n[--e]=0;for(var s=new ze,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);n[--e]=o[0]}return n[--e]=2,n[--e]=0,new pe(n)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var i=n.toString(16);return 0==(1&i.length)?i:"0"+i},Je.prototype.encryptOAEP=function(t,e,n){var i=function(t,e,n,i){var r=tn.crypto.MessageDigest,s=tn.crypto.Util,o=null;if(n||(n="sha1"),"string"==typeof n&&(o=r.getCanonicalAlgName(n),i=r.getHashLength(o),n=function(t){return dn(s.hashHex(pn(t),o))}),t.length+2*i+2>e)throw"Message too long for RSA";var a,h="";for(a=0;a<e-t.length-2*i-2;a+=1)h+="\0";var u=n("")+h+""+t,c=new Array(i);(new ze).nextBytes(c);var f=We(c,u.length,n),l=[];for(a=0;a<u.length;a+=1)l[a]=u.charCodeAt(a)^f.charCodeAt(a);var d=We(l,c.length,n),p=[0];for(a=0;a<c.length;a+=1)p[a+1]=c[a]^d.charCodeAt(a);return new pe(p.concat(l))}(t,this.n.bitLength()+7>>3,e,n);if(null==i)return null;var r=this.doPublic(i);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},Je.prototype.type="RSA",Je.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},Je.prototype.setPrivate=function(t,e,n){if(this.isPrivate=!0,"string"!=typeof t)this.n=t,this.e=e,this.d=n;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=Ye(t,16),this.e=parseInt(e,16),this.d=Ye(n,16)}},Je.prototype.setPrivateEx=function(t,e,n,i,r,s,o,a){if(this.isPrivate=!0,this.isPublic=!1,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=Ye(t,16),this.e=parseInt(e,16),this.d=Ye(n,16),this.p=Ye(i,16),this.q=Ye(r,16),this.dmp1=Ye(s,16),this.dmq1=Ye(o,16),this.coeff=Ye(a,16)},Je.prototype.generate=function(t,e){var n=new ze,i=t>>1;this.e=parseInt(e,16);for(var r=new pe(e,16);;){for(;this.p=new pe(t-i,1,n),0!=this.p.subtract(pe.ONE).gcd(r).compareTo(pe.ONE)||!this.p.isProbablePrime(10););for(;this.q=new pe(i,1,n),0!=this.q.subtract(pe.ONE).gcd(r).compareTo(pe.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(pe.ONE),a=this.q.subtract(pe.ONE),h=o.multiply(a);if(0==h.gcd(r).compareTo(pe.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(h),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},Je.prototype.decrypt=function(t){var e=Ye(t,16),n=this.doPrivate(e);return null==n?null:function(t,e){for(var n=t.toByteArray(),i=0;i<n.length&&0==n[i];)++i;if(n.length-i!=e-1||2!=n[i])return null;for(++i;0!=n[i];)if(++i>=n.length)return null;for(var r="";++i<n.length;){var s=255&n[i];s<128?r+=String.fromCharCode(s):s>191&&s<224?(r+=String.fromCharCode((31&s)<<6|63&n[i+1]),++i):(r+=String.fromCharCode((15&s)<<12|(63&n[i+1])<<6|63&n[i+2]),i+=2)}return r}(n,this.n.bitLength()+7>>3)},Je.prototype.decryptOAEP=function(t,e,n){var i=Ye(t,16),r=this.doPrivate(i);return null==r?null:function(t,e,n,i){var r=tn.crypto.MessageDigest,s=tn.crypto.Util,o=null;for(n||(n="sha1"),"string"==typeof n&&(o=r.getCanonicalAlgName(n),i=r.getHashLength(o),n=function(t){return dn(s.hashHex(pn(t),o))}),t=t.toByteArray(),a=0;a<t.length;a+=1)t[a]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*i+2)throw"Cipher too short";var a,h=t.substr(1,i),u=t.substr(i+1),c=Ge(u,i,n),f=[];for(a=0;a<h.length;a+=1)f[a]=h.charCodeAt(a)^c.charCodeAt(a);var l=Ge(String.fromCharCode.apply(String,f),t.length-i,n),d=[];for(a=0;a<u.length;a+=1)d[a]=u.charCodeAt(a)^l.charCodeAt(a);if((d=String.fromCharCode.apply(String,d)).substr(0,i)!==n(""))throw"Hash mismatch";var p=(d=d.substr(i)).indexOf("");if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}(r,this.n.bitLength()+7>>3,e,n)},Xe.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},Xe.prototype.toBigInteger=function(){return this.x},Xe.prototype.negate=function(){return new Xe(this.q,this.x.negate().mod(this.q))},Xe.prototype.add=function(t){return new Xe(this.q,this.x.add(t.toBigInteger()).mod(this.q))},Xe.prototype.subtract=function(t){return new Xe(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},Xe.prototype.multiply=function(t){return new Xe(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},Xe.prototype.square=function(){return new Xe(this.q,this.x.square().mod(this.q))},Xe.prototype.divide=function(t){return new Xe(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},$e.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},$e.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},$e.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(pe.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(pe.ZERO))},$e.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(pe.ZERO)&&!this.y.toBigInteger().equals(pe.ZERO)},$e.prototype.negate=function(){return new $e(this.curve,this.x,this.y.negate(),this.z)},$e.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),n=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(pe.ZERO.equals(n))return pe.ZERO.equals(e)?this.twice():this.curve.getInfinity();var i=new pe("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),n.square()),a=o.multiply(n),h=r.multiply(o),u=e.square().multiply(this.z),c=u.subtract(h.shiftLeft(1)).multiply(t.z).subtract(a).multiply(n).mod(this.curve.q),f=h.multiply(i).multiply(e).subtract(s.multiply(a)).subtract(u.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),l=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new $e(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(f),l)},$e.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new pe("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),i=n.multiply(this.z),r=i.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);pe.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(i).mod(this.curve.q),h=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),u=i.square().multiply(i).shiftLeft(3).mod(this.curve.q);return new $e(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(h),u)},$e.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new pe("3")),r=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=n.testBit(e)&&(s=s.add(o?this:r))}return s},$e.prototype.multiplyTwo=function(t,e,n){var i;i=t.bitLength()>n.bitLength()?t.bitLength()-1:n.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);i>=0;)r=r.twice(),t.testBit(i)?r=n.testBit(i)?r.add(s):r.add(this):n.testBit(i)&&(r=r.add(e)),--i;return r},Ze.prototype.getQ=function(){return this.q},Ze.prototype.getA=function(){return this.a},Ze.prototype.getB=function(){return this.b},Ze.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},Ze.prototype.getInfinity=function(){return this.infinity},Ze.prototype.fromBigInteger=function(t){return new Xe(this.q,t)},Ze.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,n=t.substr(2,e),i=t.substr(e+2,e);return new $e(this,this.fromBigInteger(new pe(n,16)),this.fromBigInteger(new pe(i,16)));default:return null}},Xe.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},$e.prototype.getEncoded=function(t){var e=function(t,e){var n=t.toByteArrayUnsigned();if(e<n.length)n=n.slice(n.length-e);else for(;e>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),i=this.getY().toBigInteger(),r=e(n,32);return t?i.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(i,32))),r},$e.decodeFrom=function(t,e){e[0];var n=e.length-1,i=e.slice(1,1+n/2),r=e.slice(1+n/2,1+n);i.unshift(0),r.unshift(0);var s=new pe(i),o=new pe(r);return new $e(t,t.fromBigInteger(s),t.fromBigInteger(o))},$e.decodeFromHex=function(t,e){e.substr(0,2);var n=e.length-2,i=e.substr(2,n/2),r=e.substr(2+n/2,n/2),s=new pe(i,16),o=new pe(r,16);return new $e(t,t.fromBigInteger(s),t.fromBigInteger(o))},$e.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),i=n.square().subtract(this.x).subtract(t.x),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new $e(this.curve,i,r)},$e.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(pe.valueOf(2)),e=this.curve.fromBigInteger(pe.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),i=n.square().subtract(this.x.multiply(t)),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new $e(this.curve,i,r)},$e.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new pe("3")),r=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=n.testBit(e)&&(s=s.add2D(o?this:r))}return s},$e.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(n.multiply(t)).add(i).mod(r);return s.equals(o)},$e.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},$e.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(e.compareTo(pe.ONE)<0||e.compareTo(t.subtract(pe.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(pe.ONE)<0||n.compareTo(t.subtract(pe.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Qe=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(t,e,i){return e?n[e]:String.fromCharCode(parseInt(i,16))}var r=new String(""),s=Object.hasOwnProperty;return function(n,o){var a,h,u=n.match(t),c=u[0],f=!1;"{"===c?a={}:"["===c?a=[]:(a=[],f=!0);for(var l=[a],d=1-f,p=u.length;d<p;++d){var g;switch((c=u[d]).charCodeAt(0)){default:(g=l[0])[h||g.length]=+c,h=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(e,i)),g=l[0],!h){if(!(g instanceof Array)){h=c||r;break}h=g.length}g[h]=c,h=void 0;break;case 91:g=l[0],l.unshift(g[h||g.length]=[]),h=void 0;break;case 93:l.shift();break;case 102:(g=l[0])[h||g.length]=!1,h=void 0;break;case 110:(g=l[0])[h||g.length]=null,h=void 0;break;case 116:(g=l[0])[h||g.length]=!0,h=void 0;break;case 123:g=l[0],l.unshift(g[h||g.length]={}),h=void 0;break;case 125:l.shift()}}if(f){if(1!==l.length)throw new Error;a=a[0]}else if(l.length)throw new Error;if(o){var y=function(t,e){var n=t[e];if(n&&"object"==typeof n){var i=null;for(var r in n)if(s.call(n,r)&&n!==t){var a=y(n,r);void 0!==a?n[r]=a:(i||(i=[]),i.push(r))}if(i)for(var h=i.length;--h>=0;)delete n[i[h]]}return o.call(t,e,n)};a=y({"":a},"")}return a}}();void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),tn.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var i="",r=0;r<n;r++)i+="f";e=new pe(i,16).xor(t).add(pe.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return yn(t,e)},this.newObject=function(t){var e=tn.asn1,n=e.DERBoolean,i=e.DERInteger,r=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,h=e.DEREnumerated,u=e.DERUTF8String,c=e.DERNumericString,f=e.DERPrintableString,l=e.DERTeletexString,d=e.DERIA5String,p=e.DERUTCTime,g=e.DERGeneralizedTime,y=e.DERSequence,v=e.DERSet,m=e.DERTaggedObject,w=e.ASN1Util.newObject,b=Object.keys(t);if(1!=b.length)throw"key of param shall be only one.";var S=b[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+S+":"))throw"undefined key: "+S;if("bool"==S)return new n(t[S]);if("int"==S)return new i(t[S]);if("bitstr"==S)return new r(t[S]);if("octstr"==S)return new s(t[S]);if("null"==S)return new o(t[S]);if("oid"==S)return new a(t[S]);if("enum"==S)return new h(t[S]);if("utf8str"==S)return new u(t[S]);if("numstr"==S)return new c(t[S]);if("prnstr"==S)return new f(t[S]);if("telstr"==S)return new l(t[S]);if("ia5str"==S)return new d(t[S]);if("utctime"==S)return new p(t[S]);if("gentime"==S)return new g(t[S]);if("seq"==S){for(var x=t[S],E=[],F=0;F<x.length;F++){var A=w(x[F]);E.push(A)}return new y({array:E})}if("set"==S){for(x=t[S],E=[],F=0;F<x.length;F++){A=w(x[F]);E.push(A)}return new v({array:E})}if("tag"==S){var C=t[S];if("[object Array]"===Object.prototype.toString.call(C)&&3==C.length){var T=w(C[2]);return new m({tag:C[0],explicit:C[1],obj:T})}var P={};if(void 0!==C.explicit&&(P.explicit=C.explicit),void 0!==C.tag&&(P.tag=C.tag),void 0===C.obj)throw"obj shall be specified for 'tag'.";return P.obj=w(C.obj),new m(P)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},tn.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),i=(e=Math.floor(n/40)+"."+n%40,""),r=2;r<t.length;r+=2){var s=("00000000"+parseInt(t.substr(r,2),16).toString(2)).slice(-8);if(i+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new pe(i,2).toString(10),i=""}return e},tn.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=new pe(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);return i},tn.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},tn.asn1.DERAbstractString=function(t){tn.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=fn(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},re.lang.extend(tn.asn1.DERAbstractString,tn.asn1.ASN1Object),tn.asn1.DERAbstractTime=function(t){tn.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+i(String(r.getMonth()+1),2)+i(String(r.getDate()),2)+i(String(r.getHours()),2)+i(String(r.getMinutes()),2)+i(String(r.getSeconds()),2);if(!0===n){var a=r.getMilliseconds();if(0!=a){var h=i(String(a),3);o=o+"."+(h=h.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=on(t)},this.setByDateValue=function(t,e,n,i,r,s){var o=new Date(Date.UTC(t,e-1,n,i,r,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},re.lang.extend(tn.asn1.DERAbstractTime,tn.asn1.ASN1Object),tn.asn1.DERAbstractStructured=function(t){tn.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},re.lang.extend(tn.asn1.DERAbstractStructured,tn.asn1.ASN1Object),tn.asn1.DERBoolean=function(){tn.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},re.lang.extend(tn.asn1.DERBoolean,tn.asn1.ASN1Object),tn.asn1.DERInteger=function(t){tn.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=tn.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new pe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},re.lang.extend(tn.asn1.DERInteger,tn.asn1.ASN1Object),tn.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=tn.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}tn.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var i="";for(n=0;n<t.length-1;n+=8){var r=t.substr(n,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),i+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+i},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},re.lang.extend(tn.asn1.DERBitString,tn.asn1.ASN1Object),tn.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=tn.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}tn.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},re.lang.extend(tn.asn1.DEROctetString,tn.asn1.DERAbstractString),tn.asn1.DERNull=function(){tn.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},re.lang.extend(tn.asn1.DERNull,tn.asn1.ASN1Object),tn.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=new pe(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};tn.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=i},this.setValueName=function(t){var e=tn.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},re.lang.extend(tn.asn1.DERObjectIdentifier,tn.asn1.ASN1Object),tn.asn1.DEREnumerated=function(t){tn.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=tn.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new pe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},re.lang.extend(tn.asn1.DEREnumerated,tn.asn1.ASN1Object),tn.asn1.DERUTF8String=function(t){tn.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},re.lang.extend(tn.asn1.DERUTF8String,tn.asn1.DERAbstractString),tn.asn1.DERNumericString=function(t){tn.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},re.lang.extend(tn.asn1.DERNumericString,tn.asn1.DERAbstractString),tn.asn1.DERPrintableString=function(t){tn.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},re.lang.extend(tn.asn1.DERPrintableString,tn.asn1.DERAbstractString),tn.asn1.DERTeletexString=function(t){tn.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},re.lang.extend(tn.asn1.DERTeletexString,tn.asn1.DERAbstractString),tn.asn1.DERIA5String=function(t){tn.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},re.lang.extend(tn.asn1.DERIA5String,tn.asn1.DERAbstractString),tn.asn1.DERUTCTime=function(t){tn.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=on(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=on(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},re.lang.extend(tn.asn1.DERUTCTime,tn.asn1.DERAbstractTime),tn.asn1.DERGeneralizedTime=function(t){tn.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=on(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=on(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},re.lang.extend(tn.asn1.DERGeneralizedTime,tn.asn1.DERAbstractTime),tn.asn1.DERSequence=function(t){tn.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},re.lang.extend(tn.asn1.DERSequence,tn.asn1.DERAbstractStructured),tn.asn1.DERSet=function(t){tn.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},re.lang.extend(tn.asn1.DERSet,tn.asn1.DERAbstractStructured),tn.asn1.DERTaggedObject=function(t){tn.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},re.lang.extend(tn.asn1.DERTaggedObject,tn.asn1.ASN1Object);var tn,en,nn,rn=new function(){};function sn(t){for(var e="",n=0;n<t.length;n++){var i=t[n].toString(16);1==i.length&&(i="0"+i),e+=i}return e}function on(t){return sn(function(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t))}function an(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function hn(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function un(t){return t.length%2==1&&(t="0"+t),an(le(t))}function cn(t){return de(hn(t))}function fn(t){return wn(xn(t))}function ln(t){return decodeURIComponent(bn(t))}function dn(t){for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function pn(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}function gn(t){var e=function(t){return le(t)}(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function yn(t,e){return"-----BEGIN "+e+"-----\r\n"+gn(t)+"\r\n-----END "+e+"-----\r\n"}function vn(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return function(t){return de(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}(t=void 0!==e?(t=t.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):(t=t.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function mn(t){return~~(function(t){var e,n,i,r,s,o,a,h,u,c,f;if(f=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return h=f[1],e=parseInt(h),2===h.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(f[2])-1,i=parseInt(f[3]),r=parseInt(f[4]),s=parseInt(f[5]),o=parseInt(f[6]),a=0,""!==(u=f[7])&&(c=(u.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(e,n,i,r,s,o,a);throw"unsupported zulu format: "+t}(t)/1e3)}function wn(t){return t.replace(/%/g,"")}function bn(t){return t.replace(/(..)/g,"%$1")}function Sn(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?function(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),""==e[n]&&(e[n]="0");var i=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===i)return t.slice(1,-1);var r="";for(n=0;n<i.length;n++)i[n].length>r.length&&(r=i[n]);return(t=t.replace(r,"::")).slice(1,-1)}(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function xn(t){for(var e=encodeURIComponent(t),n="",i=0;i<e.length;i++)"%"==e[i]?(n+=e.substr(i,3),i+=2):n=n+"%"+on(e[i]);return n}function En(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}rn.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var n=parseInt(t.substr(e+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},rn.getL=function(t,e){var n=rn.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},rn.getVblen=function(t,e){var n;return""==(n=rn.getL(t,e))?-1:("8"===n.substr(0,1)?new pe(n.substr(2),16):new pe(n,16)).intValue()},rn.getVidx=function(t,e){var n=rn.getLblen(t,e);return n<0?n:e+2*(n+1)},rn.getV=function(t,e){var n=rn.getVidx(t,e),i=rn.getVblen(t,e);return t.substr(n,2*i)},rn.getTLV=function(t,e){return t.substr(e,2)+rn.getL(t,e)+rn.getV(t,e)},rn.getNextSiblingIdx=function(t,e){return rn.getVidx(t,e)+2*rn.getVblen(t,e)},rn.getChildIdx=function(t,e){var n=rn,i=new Array,r=n.getVidx(t,e);"03"==t.substr(e,2)?i.push(r+2):i.push(r);for(var s=n.getVblen(t,e),o=r,a=0;;){var h=n.getNextSiblingIdx(t,o);if(null==h||h-r>=2*s)break;if(a>=200)break;i.push(h),o=h,a++}return i},rn.getNthChildIdx=function(t,e,n){return rn.getChildIdx(t,e)[n]},rn.getIdxbyList=function(t,e,n,i){var r,s,o=rn;if(0==n.length){if(void 0!==i&&t.substr(e,2)!==i)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+i;return e}return r=n.shift(),s=o.getChildIdx(t,e),o.getIdxbyList(t,s[r],n,i)},rn.getTLVbyList=function(t,e,n,i){var r=rn,s=r.getIdxbyList(t,e,n);if(void 0===s)throw"can't find nthList object";if(void 0!==i&&t.substr(s,2)!=i)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+i;return r.getTLV(t,s)},rn.getVbyList=function(t,e,n,i,r){var s,o,a=rn;if(void 0===(s=a.getIdxbyList(t,e,n,i)))throw"can't find nthList object";return o=a.getV(t,s),!0===r&&(o=o.substr(2)),o},rn.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=[],i=t.substr(0,2),r=parseInt(i,16);n[0]=new String(Math.floor(r/40)),n[1]=new String(r%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var h=[],u="";for(a=0;a<o.length;a++)128&o[a]?u+=e((127&o[a]).toString(2),7):(u+=e((127&o[a]).toString(2),7),h.push(new String(parseInt(u,2))),u="");var c=n.join(".");return h.length>0&&(c=c+"."+h.join(".")),c},rn.dump=function(t,e,n,i){var r=rn,s=r.getV,o=r.dump,a=r.getChildIdx,h=t;t instanceof tn.asn1.ASN1Object&&(h=t.getEncodedHex());var u=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===n&&(n=0),void 0===i&&(i="");var c=e.ommit_long_octet;if("01"==h.substr(n,2))return"00"==(f=s(h,n))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==h.substr(n,2))return i+"INTEGER "+u(f=s(h,n),c)+"\n";if("03"==h.substr(n,2))return i+"BITSTRING "+u(f=s(h,n),c)+"\n";if("04"==h.substr(n,2)){var f=s(h,n);if(r.isASN1HEX(f)){var l=i+"OCTETSTRING, encapsulates\n";return l+=o(f,e,0,i+"  ")}return i+"OCTETSTRING "+u(f,c)+"\n"}if("05"==h.substr(n,2))return i+"NULL\n";if("06"==h.substr(n,2)){var d=s(h,n),p=tn.asn1.ASN1Util.oidHexToInt(d),g=tn.asn1.x509.OID.oid2name(p),y=p.replace(/\./g," ");return""!=g?i+"ObjectIdentifier "+g+" ("+y+")\n":i+"ObjectIdentifier ("+y+")\n"}if("0c"==h.substr(n,2))return i+"UTF8String '"+ln(s(h,n))+"'\n";if("13"==h.substr(n,2))return i+"PrintableString '"+ln(s(h,n))+"'\n";if("14"==h.substr(n,2))return i+"TeletexString '"+ln(s(h,n))+"'\n";if("16"==h.substr(n,2))return i+"IA5String '"+ln(s(h,n))+"'\n";if("17"==h.substr(n,2))return i+"UTCTime "+ln(s(h,n))+"\n";if("18"==h.substr(n,2))return i+"GeneralizedTime "+ln(s(h,n))+"\n";if("30"==h.substr(n,2)){if("3000"==h.substr(n,4))return i+"SEQUENCE {}\n";l=i+"SEQUENCE\n";var v=e;if((2==(b=a(h,n)).length||3==b.length)&&"06"==h.substr(b[0],2)&&"04"==h.substr(b[b.length-1],2)){g=r.oidname(s(h,b[0]));var m=JSON.parse(JSON.stringify(e));m.x509ExtName=g,v=m}for(var w=0;w<b.length;w++)l+=o(h,v,b[w],i+"  ");return l}if("31"==h.substr(n,2)){l=i+"SET\n";var b=a(h,n);for(w=0;w<b.length;w++)l+=o(h,e,b[w],i+"  ");return l}var S=parseInt(h.substr(n,2),16);if(0!=(128&S)){var x=31&S;if(0!=(32&S)){var l=i+"["+x+"]\n";for(b=a(h,n),w=0;w<b.length;w++)l+=o(h,e,b[w],i+"  ");return l}return"68747470"==(f=s(h,n)).substr(0,8)&&(f=ln(f)),"subjectAltName"===e.x509ExtName&&2==x&&(f=ln(f)),l=i+"["+x+"] "+f+"\n"}return i+"UNKNOWN("+h.substr(n,2)+") "+s(h,n)+"\n"},rn.isASN1HEX=function(t){var e=rn;if(t.length%2==1)return!1;var n=e.getVblen(t,0),i=t.substr(0,2),r=e.getL(t,0);return t.length-i.length-r.length==2*n},rn.oidname=function(t){var e=tn.asn1;tn.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return""===n&&(n=t),n},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.x509&&tn.asn1.x509||(tn.asn1.x509={}),tn.asn1.x509.Certificate=function(t){tn.asn1.x509.Certificate.superclass.constructor.call(this);var e=tn,n=(e.crypto,e.asn1),i=n.DERSequence,r=n.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new tn.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=t,this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+gn(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},re.lang.extend(tn.asn1.x509.Certificate,tn.asn1.ASN1Object),tn.asn1.x509.TBSCertificate=function(t){tn.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=tn.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,h=s.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new r({obj:new i({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new i(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){this.asn1SubjPKey=new h(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=Fn.getKey(t);this.asn1SubjPKey=new h(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){tn.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new n({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new n({array:this.extensionsArray}),i=new r({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(i)}var s=new n({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},re.lang.extend(tn.asn1.x509.TBSCertificate,tn.asn1.ASN1Object),tn.asn1.x509.Extension=function(t){tn.asn1.x509.Extension.superclass.constructor.call(this);var e=tn.asn1,n=e.DERObjectIdentifier,i=e.DEROctetString,r=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new n({oid:this.oid}),e=new i({hex:this.getExtnValueHex()}),o=new Array;return o.push(t),this.critical&&o.push(new r),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},re.lang.extend(tn.asn1.x509.Extension,tn.asn1.ASN1Object),tn.asn1.x509.Extension.appendByNameToArray=function(t,e,n){var i=t.toLowerCase(),r=tn.asn1.x509;if("basicconstraints"==i){var s=new r.BasicConstraints(e);n.push(s)}else if("keyusage"==i){s=new r.KeyUsage(e);n.push(s)}else if("crldistributionpoints"==i){s=new r.CRLDistributionPoints(e);n.push(s)}else if("extkeyusage"==i){s=new r.ExtKeyUsage(e);n.push(s)}else if("authoritykeyidentifier"==i){s=new r.AuthorityKeyIdentifier(e);n.push(s)}else if("authorityinfoaccess"==i){s=new r.AuthorityInfoAccess(e);n.push(s)}else if("subjectaltname"==i){s=new r.SubjectAltName(e);n.push(s)}else{if("issueraltname"!=i)throw"unsupported extension name: "+t;s=new r.IssuerAltName(e);n.push(s)}},tn.asn1.x509.KeyUsage=function(t){tn.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=Dn.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new tn.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){for(var n=t.names,i="000000000",r=0;r<n.length;r++)for(var s=0;s<e.length;s++)n[r]===e[s]&&(i=i.substring(0,s)+"1"+i.substring(s+1,i.length));this.asn1ExtnValue=new tn.asn1.DERBitString({bin:i})}},re.lang.extend(tn.asn1.x509.KeyUsage,tn.asn1.x509.Extension),tn.asn1.x509.BasicConstraints=function(t){tn.asn1.x509.BasicConstraints.superclass.constructor.call(this,t),this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new tn.asn1.DERBoolean),this.pathLen>-1&&t.push(new tn.asn1.DERInteger({int:this.pathLen}));var e=new tn.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},re.lang.extend(tn.asn1.x509.BasicConstraints,tn.asn1.x509.Extension),tn.asn1.x509.CRLDistributionPoints=function(t){tn.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=tn.asn1,n=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},this.setByOneURI=function(t){var e=new n.GeneralNames([{uri:t}]),i=new n.DistributionPointName(e),r=new n.DistributionPoint({dpobj:i});this.setByDPArray([r])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},re.lang.extend(tn.asn1.x509.CRLDistributionPoints,tn.asn1.x509.Extension),tn.asn1.x509.ExtKeyUsage=function(t){tn.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=tn.asn1;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var n=0;n<t.length;n++){var i=new e.DERObjectIdentifier(t[n]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},re.lang.extend(tn.asn1.x509.ExtKeyUsage,tn.asn1.x509.Extension),tn.asn1.x509.AuthorityKeyIdentifier=function(t){tn.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=tn.asn1,n=e.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array;this.asn1KID&&t.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new n({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&t.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var i=new e.DERSequence({array:t});return this.asn1ExtnValue=i,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){this.asn1KID=new tn.asn1.DEROctetString(t)},this.setCertIssuerByParam=function(t){this.asn1CertIssuer=new tn.asn1.x509.X500Name(t)},this.setCertSNByParam=function(t){this.asn1CertSN=new tn.asn1.DERInteger(t)},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn))},re.lang.extend(tn.asn1.x509.AuthorityKeyIdentifier,tn.asn1.x509.Extension),tn.asn1.x509.AuthorityInfoAccess=function(t){tn.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(t){for(var e=new Array,n=tn.asn1,i=n.DERSequence,r=0;r<t.length;r++){var s=new i({array:[new n.DERObjectIdentifier(t[r].accessMethod),new n.x509.GeneralName(t[r].accessLocation)]});e.push(s)}this.asn1ExtnValue=new i({array:e})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},re.lang.extend(tn.asn1.x509.AuthorityInfoAccess,tn.asn1.x509.Extension),tn.asn1.x509.SubjectAltName=function(t){tn.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new tn.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},re.lang.extend(tn.asn1.x509.SubjectAltName,tn.asn1.x509.Extension),tn.asn1.x509.IssuerAltName=function(t){tn.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new tn.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},re.lang.extend(tn.asn1.x509.IssuerAltName,tn.asn1.x509.Extension),tn.asn1.x509.CRL=function(t){tn.asn1.x509.CRL.superclass.constructor.call(this),this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new tn.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new tn.asn1.DERBitString({hex:"00"+this.hexSig});var t=new tn.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+gn(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},re.lang.extend(tn.asn1.x509.CRL,tn.asn1.ASN1Object),tn.asn1.x509.TBSCertList=function(t){tn.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=tn.asn1,n=e.DERSequence,i=e.x509,r=i.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new i.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new i.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new r(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new r(t)},this.addRevokedCert=function(t,e){var n={};null!=t&&null!=t&&(n.sn=t),null!=e&&null!=e&&(n.time=e);var r=new i.CRLEntry(n);this.aRevokedCert.push(r)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new n({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new n({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},re.lang.extend(tn.asn1.x509.TBSCertList,tn.asn1.ASN1Object),tn.asn1.x509.CRLEntry=function(t){tn.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=tn.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},re.lang.extend(tn.asn1.x509.CRLEntry,tn.asn1.ASN1Object),tn.asn1.x509.X500Name=function(t){tn.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=tn.asn1,n=e.x509,i=vn;if(this.setByString=function(t){var e=t.split("/");e.shift();for(var i=[],r=0;r<e.length;r++)if(e[r].match(/^[^=]+=.+$/))i.push(e[r]);else{var s=i.length-1;i[s]=i[s]+"/"+e[r]}for(r=0;r<i.length;r++)this.asn1Array.push(new n.RDN({str:i[r]}))},this.setByLdapString=function(t){var e=n.X500Name.ldapToOneline(t);this.setByString(e)},this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=new tn.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(n):this.asn1Array=[n]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t){var r;if(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):"object"==typeof t&&this.setByObject(t),void 0!==t.certissuer)(r=new Dn).hex=i(t.certissuer),this.hTLV=r.getIssuerHex();if(void 0!==t.certsubject)(r=new Dn).hex=i(t.certsubject),this.hTLV=r.getSubjectHex()}},re.lang.extend(tn.asn1.x509.X500Name,tn.asn1.ASN1Object),tn.asn1.x509.X500Name.onelineToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map(function(t){return t.replace(/,/,"\\,")})).join(",")},tn.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),n=!1,i=[],r=0;e.length>0;r++){var s=e.shift();if(!0===n){var o=(i.pop()+","+s).replace(/\\,/g,",");i.push(o),n=!1}else i.push(s);"\\"===s.substr(-1,1)&&(n=!0)}return(i=i.map(function(t){return t.replace("/","\\/")})).reverse(),"/"+i.join("/")},tn.asn1.x509.RDN=function(t){tn.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new tn.asn1.x509.AttributeTypeAndValue({str:t}))},this.addByMultiValuedString=function(t){for(var e=tn.asn1.x509.RDN.parseString(t),n=0;n<e.length;n++)this.addByString(e[n])},this.getEncodedHex=function(){var t=new tn.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},re.lang.extend(tn.asn1.x509.RDN,tn.asn1.ASN1Object),tn.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),n=!1,i=[],r=0;e.length>0;r++){var s=e.shift();if(!0===n){var o=(i.pop()+"+"+s).replace(/\\\+/g,"+");i.push(o),n=!1}else i.push(s);"\\"===s.substr(-1,1)&&(n=!0)}var a=!1,h=[];for(r=0;i.length>0;r++){s=i.shift();if(!0===a){var u=h.pop();if(s.match(/"$/)){o=(u+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");h.push(o),a=!1}else h.push(u+"+"+s)}else h.push(s);s.match(/^[^=]+="/)&&(a=!0)}return h},tn.asn1.x509.AttributeTypeAndValue=function(t){tn.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=tn.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=tn.asn1.x509.OID.atype2obj(t);var n="utf8";"C"==t&&(n="prn"),this.valueObj=this.getValueObj(n,e)},this.getValueObj=function(t,n){if("utf8"==t)return new e.DERUTF8String({str:n});if("prn"==t)return new e.DERPrintableString({str:n});if("tel"==t)return new e.DERTeletexString({str:n});if("ia5"==t)return new e.DERIA5String({str:n});throw"unsupported directory string type: type="+t+" value="+n},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},re.lang.extend(tn.asn1.x509.AttributeTypeAndValue,tn.asn1.ASN1Object),tn.asn1.x509.SubjectPublicKeyInfo=function(t){tn.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=tn,n=e.asn1,i=n.DERInteger,r=n.DERBitString,s=n.DERObjectIdentifier,o=n.DERSequence,a=n.ASN1Util.newObject,h=n.x509.AlgorithmIdentifier,u=e.crypto;u.ECDSA,u.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof Je){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex();this.asn1AlgId=new h({name:"rsaEncryption"}),this.asn1SubjPKey=new r({hex:"00"+e})}}catch(t){}try{if(t instanceof tn.crypto.ECDSA){var n=new s({name:t.curveName});this.asn1AlgId=new h({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new r({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof tn.crypto.DSA){n=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new h({name:"dsa",asn1params:n});var o=new i({bigint:t.y});this.asn1SubjPKey=new r({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},re.lang.extend(tn.asn1.x509.SubjectPublicKeyInfo,tn.asn1.ASN1Object),tn.asn1.x509.Time=function(t){tn.asn1.x509.Time.superclass.constructor.call(this);var e=tn.asn1,n=e.DERUTCTime,i=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null;return t=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new i(this.timeParams):"utc"==this.type?new n:new i,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},re.lang.extend(tn.asn1.x509.Time,tn.asn1.ASN1Object),tn.asn1.x509.AlgorithmIdentifier=function(t){tn.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=tn.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];null!==this.asn1Params&&t.push(this.asn1Params);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var n=this.nameAlg.toLowerCase();"withdsa"!==n.substr(-7,7)&&"withecdsa"!==n.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},re.lang.extend(tn.asn1.x509.AlgorithmIdentifier,tn.asn1.ASN1Object),tn.asn1.x509.GeneralName=function(t){tn.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},n=tn.asn1,i=(n.DERSequence,n.DEROctetString),r=n.DERIA5String,s=n.DERTaggedObject,o=n.ASN1Object,a=n.x509.X500Name,h=vn;this.explicit=!1,this.setByParam=function(t){var n=null;if(void 0!==t){if(void 0!==t.rfc822&&(this.type="rfc822",n=new r({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",n=new r({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",n=new r({str:t[this.type]})),void 0!==t.dn&&(this.type="dn",this.explicit=!0,n=new a({str:t.dn})),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,n=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var u=null;if((f=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(u=h(f)),null==u)throw"certissuer param not cert";(l=new Dn).hex=u;var c=l.getIssuerHex();(n=new o).hTLV=c}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var f,l;u=null;if((f=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(u=h(f)),null==u)throw"certsubj param not cert";(l=new Dn).hex=u;c=l.getSubjectHex();(n=new o).hTLV=c}if(void 0!==t.ip){this.type="ip",this.explicit=!1;var d,p=t.ip,g="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(d=function(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{var e=t.split(/,/).map(function(t,e,n){var i=parseInt(t);if(i<0||255<i)throw"integer not in range 0-255";var r=("00"+i.toString(16)).slice(-2);return r}).join("");return e}catch(t){throw"malformed integer array string: "+t}}("["+p.split(".").join(",")+"]")).length)throw g}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))d=function(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e;var i=":".repeat(7-n+2),r=(t=t.replace("::",i)).split(":");if(8!=r.length)throw e;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw g;d=p}n=new i({hex:d})}if(null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:n})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},re.lang.extend(tn.asn1.x509.GeneralName,tn.asn1.ASN1Object),tn.asn1.x509.GeneralNames=function(t){tn.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=tn.asn1;this.setByParamArray=function(t){for(var n=0;n<t.length;n++){var i=new e.x509.GeneralName(t[n]);this.asn1Array.push(i)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},re.lang.extend(tn.asn1.x509.GeneralNames,tn.asn1.ASN1Object),tn.asn1.x509.DistributionPointName=function(t){tn.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=tn.asn1,n=e.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},re.lang.extend(tn.asn1.x509.DistributionPointName,tn.asn1.ASN1Object),tn.asn1.x509.DistributionPoint=function(t){tn.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=tn.asn1;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var n=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(n)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},re.lang.extend(tn.asn1.x509.DistributionPoint,tn.asn1.ASN1Object),tn.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],n=new tn.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],n=new tn.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n}},tn.asn1.x509.OID.oid2name=function(t){var e=tn.asn1.x509.OID.name2oidList;for(var n in e)if(e[n]==t)return n;return""},tn.asn1.x509.OID.oid2atype=function(t){var e=tn.asn1.x509.OID.atype2oidList;for(var n in e)if(e[n]==t)return n;return t},tn.asn1.x509.OID.name2oid=function(t){var e=tn.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},tn.asn1.x509.X509Util={},tn.asn1.x509.X509Util.newCertPEM=function(t){var e=tn.asn1.x509,n=e.TBSCertificate,i=e.Certificate,r=new n;if(void 0===t.serial)throw"serial number undefined.";if(r.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(r.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(r.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(r.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(r.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(r.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(r.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])r.appendExtensionByName(key,t.ext[s][key]);if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new i({tbscertobj:r,prvkeyobj:!0===t.cakey.isPrivate?t.cakey:Fn.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new i({tbscertobj:r})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.cms&&tn.asn1.cms||(tn.asn1.cms={}),tn.asn1.cms.Attribute=function(t){var e=tn.asn1;e.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var t,n,i;t=new e.DERObjectIdentifier({oid:this.attrTypeOid}),n=new e.DERSet({array:this.valueList});try{n.getEncodedHex()}catch(t){throw"fail valueSet.getEncodedHex in Attribute(1)/"+t}i=new e.DERSequence({array:[t,n]});try{this.hTLV=i.getEncodedHex()}catch(t){throw"failed seq.getEncodedHex in Attribute(2)/"+t}return this.hTLV}},re.lang.extend(tn.asn1.cms.Attribute,tn.asn1.ASN1Object),tn.asn1.cms.ContentType=function(t){var e=tn.asn1;e.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var n=null;if(void 0!==t){n=new e.DERObjectIdentifier(t);this.valueList=[n]}},re.lang.extend(tn.asn1.cms.ContentType,tn.asn1.cms.Attribute),tn.asn1.cms.MessageDigest=function(t){var e=tn,n=e.asn1,i=n.DEROctetString,r=n.cms;if(r.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",void 0!==t)if(t.eciObj instanceof r.EncapsulatedContentInfo&&"string"==typeof t.hashAlg){var s=t.eciObj.eContentValueHex,o=t.hashAlg;(a=new i({hex:e.crypto.Util.hashHex(s,o)})).getEncodedHex(),this.valueList=[a]}else{var a;(a=new i(t)).getEncodedHex(),this.valueList=[a]}},re.lang.extend(tn.asn1.cms.MessageDigest,tn.asn1.cms.Attribute),tn.asn1.cms.SigningTime=function(t){var e=tn.asn1;if(e.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==t){var n=new e.x509.Time(t);try{n.getEncodedHex()}catch(t){throw"SigningTime.getEncodedHex() failed/"+t}this.valueList=[n]}},re.lang.extend(tn.asn1.cms.SigningTime,tn.asn1.cms.Attribute),tn.asn1.cms.SigningCertificate=function(t){var e=tn,n=e.asn1,i=n.DERSequence,r=n.cms;e.crypto;r.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(t){for(var s=[],o=0;o<t.length;o++){var a=vn(t[o]),h=e.crypto.Util.hashHex(a,"sha1"),u=new n.DEROctetString({hex:h});u.getEncodedHex();var c=new r.IssuerAndSerialNumber({cert:t[o]});c.getEncodedHex();var f=new i({array:[u,c]});f.getEncodedHex(),s.push(f)}var l=new i({array:s});l.getEncodedHex(),this.valueList=[l]},void 0!==t&&"object"==typeof t.array&&this.setCerts(t.array)},re.lang.extend(tn.asn1.cms.SigningCertificate,tn.asn1.cms.Attribute),tn.asn1.cms.SigningCertificateV2=function(t){var e=tn,n=e.asn1,i=n.DERSequence,r=n.x509,s=n.cms,o=e.crypto;if(s.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(t,e){for(var a=[],h=0;h<t.length;h++){var u=vn(t[h]),c=[];"sha256"!==e&&c.push(new r.AlgorithmIdentifier({name:e}));var f=o.Util.hashHex(u,e),l=new n.DEROctetString({hex:f});l.getEncodedHex(),c.push(l);var d=new s.IssuerAndSerialNumber({cert:t[h]});d.getEncodedHex(),c.push(d);var p=new i({array:c});p.getEncodedHex(),a.push(p)}var g=new i({array:a});g.getEncodedHex(),this.valueList=[g]},void 0!==t&&"object"==typeof t.array){var a="sha256";"string"==typeof t.hashAlg&&(a=t.hashAlg),this.setCerts(t.array,a)}},re.lang.extend(tn.asn1.cms.SigningCertificateV2,tn.asn1.cms.Attribute),tn.asn1.cms.IssuerAndSerialNumber=function(t){var e=tn.asn1,n=e.DERInteger,i=e.cms,r=e.x509.X500Name,s=Dn;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.setByCertPEM=function(t){var e=vn(t),i=new s;i.hex=e;var o=i.getIssuerHex();this.dIssuer=new r,this.dIssuer.hTLV=o;var a=i.getSerialNumberHex();this.dSerial=new n({hex:a})},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),t.issuer&&t.serial&&(t.issuer instanceof r?this.dIssuer=t.issuer:this.dIssuer=new r(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),"string"==typeof t.cert&&this.setByCertPEM(t.cert))},re.lang.extend(tn.asn1.cms.IssuerAndSerialNumber,tn.asn1.ASN1Object),tn.asn1.cms.AttributeList=function(t){var e=tn.asn1,n=e.cms;n.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(t){t instanceof n.Attribute&&this.list.push(t)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},re.lang.extend(tn.asn1.cms.AttributeList,tn.asn1.ASN1Object),tn.asn1.cms.SignerInfo=function(t){var e=tn,n=e.asn1,i=n.DERTaggedObject,r=n.cms,s=r.AttributeList,o=r.ContentType,a=r.EncapsulatedContentInfo,h=r.MessageDigest,u=r.SignedData,c=n.x509.AlgorithmIdentifier,f=e.crypto,l=Fn;r.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new n.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(t){"string"==typeof t&&-1!=t.indexOf("CERTIFICATE")&&-1!=t.indexOf("BEGIN")&&-1!=t.indexOf("END")&&(this.dSignerIdentifier=new r.IssuerAndSerialNumber({cert:t}))},this.setForContentAndHash=function(t){void 0!==t&&(t.eciObj instanceof a&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new h({eciObj:t.eciObj,hashAlg:t.hashAlg}))),void 0!==t.sdObj&&t.sdObj instanceof u&&-1==t.sdObj.digestAlgNameList.join(":").indexOf(t.hashAlg)&&t.sdObj.digestAlgNameList.push(t.hashAlg),"string"==typeof t.hashAlg&&(this.dDigestAlgorithm=new c({name:t.hashAlg})))},this.sign=function(t,e){this.dSigAlg=new c({name:e});var i=this.dSignedAttrs.getEncodedHex(),r=l.getKey(t),s=new f.Signature({alg:e});s.init(r),s.updateHex(i);var o=s.sign();this.dSig=new n.DEROctetString({hex:o})},this.addUnsigned=function(t){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(t)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var t=new i({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),e=null;this.dUnsignedAttrs.length()>0&&(e=new i({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var r=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,t,this.dSigAlg,this.dSig];null!=e&&r.push(e);var o=new n.DERSequence({array:r});return this.hTLV=o.getEncodedHex(),this.hTLV}},re.lang.extend(tn.asn1.cms.SignerInfo,tn.asn1.ASN1Object),tn.asn1.cms.EncapsulatedContentInfo=function(t){var e=tn.asn1,n=e.DERTaggedObject,i=e.DERSequence,r=e.DERObjectIdentifier,s=e.DEROctetString;e.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new r({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(t){t.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new r({oid:t}):this.dEContentType=new r({name:t})},this.setContentValue=function(t){void 0!==t&&("string"==typeof t.hex?this.eContentValueHex=t.hex:"string"==typeof t.str&&(this.eContentValueHex=fn(t.str)))},this.setContentValueHex=function(t){this.eContentValueHex=t},this.setContentValueStr=function(t){this.eContentValueHex=fn(t)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var t=new s({hex:this.eContentValueHex});this.dEContent=new n({obj:t,tag:"a0",explicit:!0});var e=[this.dEContentType];this.isDetached||e.push(this.dEContent);var r=new i({array:e});return this.hTLV=r.getEncodedHex(),this.hTLV}},re.lang.extend(tn.asn1.cms.EncapsulatedContentInfo,tn.asn1.ASN1Object),tn.asn1.cms.ContentInfo=function(t){var e=tn.asn1,n=e.DERTaggedObject,i=e.DERSequence,r=e.x509;tn.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(t){"string"==typeof t&&(this.dContentType=r.OID.name2obj(t))},this.getEncodedHex=function(){var t=new n({obj:this.dContent,tag:"a0",explicit:!0}),e=new i({array:[this.dContentType,t]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof e.ASN1Object&&(this.dContent=t.obj))},re.lang.extend(tn.asn1.cms.ContentInfo,tn.asn1.ASN1Object),tn.asn1.cms.SignedData=function(t){var e=tn.asn1,n=e.ASN1Object,i=e.DERInteger,r=e.DERSet,s=e.DERSequence,o=e.DERTaggedObject,a=e.cms,h=a.EncapsulatedContentInfo,u=a.SignerInfo,c=a.ContentInfo,f=e.x509.AlgorithmIdentifier;tn.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new i({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new h,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new u],this.addCertificatesByPEM=function(t){var e=vn(t),i=new n;i.hTLV=e,this.certificateList.push(i)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var t=[],e=0;e<this.digestAlgNameList.length;e++){var n=this.digestAlgNameList[e],i=new f({name:n});t.push(i)}this.dDigestAlgs=new r({array:t})}var a=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&this.certificateList.length>0){var h=new r({array:this.certificateList});this.dCerts=new o({obj:h,tag:"a0",explicit:!1})}null!=this.dCerts&&a.push(this.dCerts);var u=new r({array:this.signerInfoList});a.push(u);var c=new s({array:a});return this.hTLV=c.getEncodedHex(),this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new c({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},this.getPEM=function(){return yn(this.getContentInfoEncodedHex(),"CMS")}},re.lang.extend(tn.asn1.cms.SignedData,tn.asn1.ASN1Object),tn.asn1.cms.CMSUtil=new function(){},tn.asn1.cms.CMSUtil.newSignedData=function(t){var e=tn.asn1,n=e.cms,i=n.SignerInfo,r=n.SignedData,s=n.SigningTime,o=n.SigningCertificate,a=n.SigningCertificateV2,h=e.cades.SignaturePolicyIdentifier,u=new r;if(u.dEncapContentInfo.setContentValue(t.content),"object"==typeof t.certs)for(var c=0;c<t.certs.length;c++)u.addCertificatesByPEM(t.certs[c]);u.signerInfoList=[];for(c=0;c<t.signerInfos.length;c++){var f=t.signerInfos[c],l=new i;for(attrName in l.setSignerIdentifier(f.signerCert),l.setForContentAndHash({sdObj:u,eciObj:u.dEncapContentInfo,hashAlg:f.hashAlg}),f.sAttr){var d=f.sAttr[attrName];if("SigningTime"==attrName){var p=new s(d);l.dSignedAttrs.add(p)}if("SigningCertificate"==attrName){p=new o(d);l.dSignedAttrs.add(p)}if("SigningCertificateV2"==attrName){p=new a(d);l.dSignedAttrs.add(p)}if("SignaturePolicyIdentifier"==attrName){p=new h(d);l.dSignedAttrs.add(p)}}l.sign(f.signerPrvKey,f.sigAlg),u.signerInfoList.push(l)}return u},tn.asn1.cms.CMSUtil.verifySignedData=function(t){var e=tn,n=e.asn1,i=n.cms,r=(i.SignerInfo,i.SignedData,i.SigningTime,i.SigningCertificate,i.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,e.lang.String.isHex),s=rn,o=s.getVbyList,a=s.getTLVbyList,h=s.getIdxbyList,u=s.getChildIdx,c=s.getTLV,f=s.oidname,l=e.crypto.Util.hashHex;void 0===t.cms&&r(t.cms);var d=t.cms,p=function(t,e){var n=e.idx;e.signerid_issuer1=a(t,n,[1,0],"30"),e.signerid_serial1=o(t,n,[1,1],"02"),e.hashalg=f(o(t,n,[2,0],"06"));var i=h(t,n,[3],"a0");e.idxSignedAttrs=i,g(t,e,i);var r=u(t,n).length;if(r<6)throw"malformed SignerInfo";e.sigalg=f(o(t,n,[r-2,0],"06")),e.sigval=o(t,n,[r-1],"04")},g=function(t,e,n){var i=u(t,n);e.signedAttrIdxList=i;for(var r=0;r<i.length;r++){var s,a=i[r],h=o(t,a,[0],"06");"2a864886f70d010905"===h?(s=ln(o(t,a,[1,0])),e.saSigningTime=s):"2a864886f70d010904"===h&&(s=o(t,a,[1,0],"04"),e.saMessageDigest=s)}},y=function(t,e,n,i){n.verifyDetail={};var r=n.verifyDetail,s=e.parse.econtent,o=n.hashalg,a=n.saMessageDigest;r.validMessageDigest=!1,l(s,o)===a&&(r.validMessageDigest=!0),function(t,e,n,i){var r,s=e.parse.certsIdx;if(void 0===e.certs){r=[],e.certkeys=[];for(var o=u(t,s),a=0;a<o.length;a++){var h=c(t,o[a]),f=new Dn;f.readCertHex(h),r[a]=f,e.certkeys[a]=f.getPublicKey()}e.certs=r}else r=e.certs;e.cccc=r.length,e.cccci=o.length;for(a=0;a<r.length;a++){var l=f.getIssuerHex(),d=f.getSerialNumberHex();n.signerid_issuer1===l&&n.signerid_serial1===d&&(n.certkey_idx=a)}}(t,e,n),r.validSignatureValue=!1;var h=n.sigalg,f="31"+c(t,n.idxSignedAttrs).substr(2);n.signedattrshex=f;var d=e.certs[n.certkey_idx].getPublicKey(),p=new tn.crypto.Signature({alg:h});p.init(d),p.updateHex(f);var g=p.verify(n.sigval);r.validSignatureValue_isValid=g,!0===g&&(r.validSignatureValue=!0),n.isValid=!1,r.validMessageDigest&&r.validSignatureValue&&(n.isValid=!0)},v={isValid:!1,parse:{}};return function(t,e){if("2a864886f70d010702"!==o(t,0,[0],"06"))return e;e.cmsType="signedData",e.econtent=o(t,0,[1,0,2,1,0]),function(t,e){for(var n,i=3;i<6;i++)if(void 0!==(n=h(t,0,[1,0,i]))){var r=t.substr(n,2);"a0"===r&&(e.certsIdx=n),"a1"===r&&(e.revinfosIdx=n),"31"===r&&(e.signerinfosIdx=n)}}(t,e),e.signerInfos=[],function(t,e){var n=e.signerinfosIdx;if(void 0!==n){var i=u(t,n);e.signerInfoIdxList=i;for(var r=0;r<i.length;r++){var s={idx:i[r]};p(t,s),e.signerInfos.push(s)}}}(t,e)}(d,v.parse),function(t,e){for(var n=e.parse.signerInfos,i=n.length,r=!0,s=0;s<i;s++){var o=n[s];y(t,e,o,s),o.isValid||(r=!1)}e.isValid=r}(d,v),v},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.tsp&&tn.asn1.tsp||(tn.asn1.tsp={}),tn.asn1.tsp.Accuracy=function(t){var e=tn.asn1,n=e.DERInteger,i=e.DERSequence,r=e.DERTaggedObject;e.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var t=null,e=null,s=null,o=[];if(null!=this.seconds&&(t=new n({int:this.seconds}),o.push(t)),null!=this.millis){var a=new n({int:this.millis});e=new r({obj:a,tag:"80",explicit:!1}),o.push(e)}if(null!=this.micros){var h=new n({int:this.micros});s=new r({obj:h,tag:"81",explicit:!1}),o.push(s)}var u=new i({array:o});return this.hTLV=u.getEncodedHex(),this.hTLV},void 0!==t&&("number"==typeof t.seconds&&(this.seconds=t.seconds),"number"==typeof t.millis&&(this.millis=t.millis),"number"==typeof t.micros&&(this.micros=t.micros))},re.lang.extend(tn.asn1.tsp.Accuracy,tn.asn1.ASN1Object),tn.asn1.tsp.MessageImprint=function(t){var e=tn.asn1,n=e.DERSequence,i=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new n({array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==t&&("string"==typeof t.hashAlg&&(this.dHashAlg=new r({name:t.hashAlg})),"string"==typeof t.hashValue&&(this.dHashValue=new i({hex:t.hashValue})))},re.lang.extend(tn.asn1.tsp.MessageImprint,tn.asn1.ASN1Object),tn.asn1.tsp.TimeStampReq=function(t){var e=tn.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERBoolean,s=e.DERObjectIdentifier,o=e.tsp,a=o.MessageImprint;o.TimeStampReq.superclass.constructor.call(this),this.dVersion=new i({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(t){t instanceof a?this.dMessageImprint=t:"object"==typeof t&&(this.dMessageImprint=new a(t))},this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var t=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&t.push(this.dPolicy),null!=this.dNonce&&t.push(this.dNonce),this.certReq&&t.push(new r);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.mi&&this.setMessageImprint(t.mi),"object"==typeof t.policy&&(this.dPolicy=new s(t.policy)),"object"==typeof t.nonce&&(this.dNonce=new i(t.nonce)),"boolean"==typeof t.certreq&&(this.certReq=t.certreq))},re.lang.extend(tn.asn1.tsp.TimeStampReq,tn.asn1.ASN1Object),tn.asn1.tsp.TSTInfo=function(t){var e=tn.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERBoolean,s=e.DERGeneralizedTime,o=e.DERObjectIdentifier,a=e.tsp,h=a.MessageImprint,u=a.Accuracy,c=e.x509.X500Name;if(a.TSTInfo.superclass.constructor.call(this),this.dVersion=new i({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var t=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(t.push(this.dPolicy),null==this.dMessageImprint)throw"messageImprint shall be specified.";if(t.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(t.push(this.dSerialNumber),null==this.dGenTime)throw"genTime shall be specified.";t.push(this.dGenTime),null!=this.dAccuracy&&t.push(this.dAccuracy),null!=this.dOrdering&&t.push(this.dOrdering),null!=this.dNonce&&t.push(this.dNonce),null!=this.dTsa&&t.push(this.dTsa);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){if("string"==typeof t.policy){if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new o({oid:t.policy})}void 0!==t.messageImprint&&(this.dMessageImprint=new h(t.messageImprint)),void 0!==t.serialNumber&&(this.dSerialNumber=new i(t.serialNumber)),void 0!==t.genTime&&(this.dGenTime=new s(t.genTime)),void 0!==t.accuracy&&(this.dAccuracy=new u(t.accuracy)),void 0!==t.ordering&&1==t.ordering&&(this.dOrdering=new r),void 0!==t.nonce&&(this.dNonce=new i(t.nonce)),void 0!==t.tsa&&(this.dTsa=new c(t.tsa))}},re.lang.extend(tn.asn1.tsp.TSTInfo,tn.asn1.ASN1Object),tn.asn1.tsp.TimeStampResp=function(t){var e=tn.asn1,n=e.DERSequence,i=e.ASN1Object,r=e.tsp,s=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dTST&&t.push(this.dTST);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new s(t.status)),void 0!==t.tst&&t.tst instanceof i&&(this.dTST=t.tst.getContentInfo()))},re.lang.extend(tn.asn1.tsp.TimeStampResp,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatusInfo=function(t){var e=tn.asn1,n=e.DERSequence,i=e.tsp,r=i.PKIStatus,s=i.PKIFreeText,o=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dStatusString&&t.push(this.dStatusString),null!=this.dFailureInfo&&t.push(this.dFailureInfo);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new r(t.status)),"object"==typeof t.statstr&&(this.dStatusString=new s({array:t.statstr})),"object"==typeof t.failinfo&&(this.dFailureInfo=new o(t.failinfo)))},re.lang.extend(tn.asn1.tsp.PKIStatusInfo,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatus=function(t){var e=tn.asn1,n=e.DERInteger,i=e.tsp,r=i.PKIStatus;if(i.PKIStatus.superclass.constructor.call(this),this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==t)if(void 0!==t.name){var s=r.valueList;if(void 0===s[t.name])throw"name undefined: "+t.name;this.dStatus=new n({int:s[t.name]})}else this.dStatus=new n(t)},re.lang.extend(tn.asn1.tsp.PKIStatus,tn.asn1.ASN1Object),tn.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5},tn.asn1.tsp.PKIFreeText=function(t){var e=tn.asn1,n=e.DERSequence,i=e.DERUTF8String;e.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var t=[],e=0;e<this.textList.length;e++)t.push(new i({str:this.textList[e]}));var r=new n({array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&"object"==typeof t.array&&(this.textList=t.array)},re.lang.extend(tn.asn1.tsp.PKIFreeText,tn.asn1.ASN1Object),tn.asn1.tsp.PKIFailureInfo=function(t){var e=tn.asn1,n=e.DERBitString,i=e.tsp.PKIFailureInfo;if(i.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified";var t=new Number(this.value).toString(2),e=new n;return e.setByBinaryString(t),this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t)if("string"==typeof t.name){var r=i.valueList;if(void 0===r[t.name])throw"name undefined: "+t.name;this.value=r[t.name]}else"number"==typeof t.int&&(this.value=t.int)},re.lang.extend(tn.asn1.tsp.PKIFailureInfo,tn.asn1.ASN1Object),tn.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},tn.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(t,e){throw"not implemented yet"}},tn.asn1.tsp.SimpleTSAAdapter=function(t){var e=tn,n=e.asn1.tsp,i=e.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(t,e){var r=i(t,e);this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},this.params.tstInfo.serialNumber={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:s},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},re.lang.extend(tn.asn1.tsp.SimpleTSAAdapter,tn.asn1.tsp.AbstractTSAAdapter),tn.asn1.tsp.FixedTSAAdapter=function(t){var e=tn,n=e.asn1.tsp,i=e.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(t,e){var r=i(t,e);return this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},re.lang.extend(tn.asn1.tsp.FixedTSAAdapter,tn.asn1.tsp.AbstractTSAAdapter),tn.asn1.tsp.TSPUtil=new function(){},tn.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=tn.asn1,n=e.cms,i=(e.tsp,e.tsp.TSTInfo),r=new n.SignedData,s=new i(t.tstInfo).getEncodedHex();if(r.dEncapContentInfo.setContentValue({hex:s}),r.dEncapContentInfo.setContentType("tstinfo"),"object"==typeof t.certs)for(var o=0;o<t.certs.length;o++)r.addCertificatesByPEM(t.certs[o]);var a=r.signerInfoList[0];a.setSignerIdentifier(t.signerCert),a.setForContentAndHash({sdObj:r,eciObj:r.dEncapContentInfo,hashAlg:t.hashAlg});var h=new n.SigningCertificate({array:[t.signerCert]});return a.dSignedAttrs.add(h),a.sign(t.signerPrvKey,t.sigAlg),r},tn.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=rn,n=e.getChildIdx,i=e.getV,r=e.getTLV,s={certreq:!1},o=n(t,0);if(o.length<2)throw"TimeStampReq must have at least 2 items";var a=r(t,o[1]);s.mi=tn.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var h=2;h<o.length;h++){var u=o[h],c=t.substr(u,2);if("06"==c){var f=i(t,u);s.policy=e.hextooidstr(f)}"02"==c&&(s.nonce=i(t,u)),"01"==c&&(s.certreq=!0)}return s},tn.asn1.tsp.TSPUtil.parseMessageImprint=function(t){var e=rn,n=e.getChildIdx,i=e.getV,r=e.getIdxbyList,s={};if("30"!=t.substr(0,2))throw"head of messageImprint hex shall be '30'";n(t,0);var o=i(t,r(t,0,[0,0])),a=e.hextooidstr(o),h=tn.asn1.x509.OID.oid2name(a);if(""==h)throw"hashAlg name undefined: "+a;var u=h,c=r(t,0,[1]);return s.hashAlg=u,s.hashValue=i(t,c),s},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.cades&&tn.asn1.cades||(tn.asn1.cades={}),tn.asn1.cades.SignaturePolicyIdentifier=function(t){var e=tn.asn1,n=e.DERObjectIdentifier,i=e.DERSequence,r=e.cades,s=r.OtherHashAlgAndValue;if(r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",void 0!==t&&"string"==typeof t.oid&&"object"==typeof t.hash){var o=new i({array:[new n({oid:t.oid}),new s(t.hash)]});this.valueList=[o]}},re.lang.extend(tn.asn1.cades.SignaturePolicyIdentifier,tn.asn1.cms.Attribute),tn.asn1.cades.OtherHashAlgAndValue=function(t){var e=tn.asn1,n=e.DERSequence,i=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var t=new n({array:[this.dAlg,this.dHash]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&"string"==typeof t.alg&&"string"==typeof t.hash&&(this.dAlg=new r({name:t.alg}),this.dHash=new i({hex:t.hash}))},re.lang.extend(tn.asn1.cades.OtherHashAlgAndValue,tn.asn1.ASN1Object),tn.asn1.cades.SignatureTimeStamp=function(t){var e=tn.asn1,n=e.ASN1Object;e.x509;if(e.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==t){if(void 0!==t.res)if("string"==typeof t.res&&t.res.match(/^[0-9A-Fa-f]+$/));else if(!(t.res instanceof n))throw"res param shall be ASN1Object or hex string";if(void 0!==t.tst)if("string"==typeof t.tst&&t.tst.match(/^[0-9A-Fa-f]+$/)){var i=new n;this.tstHex=t.tst,i.hTLV=this.tstHex,i.getEncodedHex(),this.valueList=[i]}else if(!(t.tst instanceof n))throw"tst param shall be ASN1Object or hex string"}},re.lang.extend(tn.asn1.cades.SignatureTimeStamp,tn.asn1.cms.Attribute),tn.asn1.cades.CompleteCertificateRefs=function(t){var e=tn.asn1.cades;e.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(t){this.valueList=[];for(var n=0;n<t.length;n++){var i=new e.OtherCertID(t[n]);this.valueList.push(i)}},void 0!==t&&"object"==typeof t&&"number"==typeof t.length&&this.setByArray(t)},re.lang.extend(tn.asn1.cades.CompleteCertificateRefs,tn.asn1.cms.Attribute),tn.asn1.cades.OtherCertID=function(t){var e=tn.asn1,n=e.cms,i=e.cades;i.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(t){this.dOtherCertHash=new i.OtherHash(t),this.hasIssuerSerial&&(this.dIssuerSerial=new n.IssuerAndSerialNumber(t))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV;if(null==this.dOtherCertHash)throw"otherCertHash not set";var t=[this.dOtherCertHash];null!=this.dIssuerSerial&&t.push(this.dIssuerSerial);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),"object"==typeof t&&(!1===t.hasis&&(this.hasIssuerSerial=!1),"string"==typeof t.cert&&this.setByCertPEM(t.cert)))},re.lang.extend(tn.asn1.cades.OtherCertID,tn.asn1.ASN1Object),tn.asn1.cades.OtherHash=function(t){var e=tn,n=e.asn1,i=(n.cms,n.cades),r=i.OtherHashAlgAndValue,s=e.crypto.Util.hashHex;if(i.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(t){if(-1==t.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var e=vn(t),n=s(e,this.alg);this.dOtherHash=new r({alg:this.alg,hash:n})},this.getEncodedHex=function(){if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==t)if("string"==typeof t)if(-1!=t.indexOf("-----BEGIN "))this.setByCertPEM(t);else{if(!t.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new n.DEROctetString({hex:t})}else"object"==typeof t&&("string"==typeof t.cert?("string"==typeof t.alg&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new r(t))},re.lang.extend(tn.asn1.cades.OtherHash,tn.asn1.ASN1Object),tn.asn1.cades.CAdESUtil=new function(){},tn.asn1.cades.CAdESUtil.addSigTS=function(t,e,n){},tn.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){var e=rn,n=e.getChildIdx,i=e.getTLV,r=e.getTLVbyList,s=e.getIdxbyList,o=tn.asn1,a=o.ASN1Object,h=o.cms.SignedData,u=o.cades.CAdESUtil,c={};if("06092a864886f70d010702"!=r(t,0,[0]))throw"hex is not CMS SignedData";var f=n(t,s(t,0,[1,0]));if(f.length<4)throw"num of SignedData elem shall be 4 at least";var l=f.shift();c.version=i(t,l);var d=f.shift();c.algs=i(t,d);var p=f.shift();c.encapcontent=i(t,p),c.certs=null,c.revs=null,c.si=[];var g=f.shift();"a0"==t.substr(g,2)&&(c.certs=i(t,g),g=f.shift()),"a1"==t.substr(g,2)&&(c.revs=i(t,g),g=f.shift());var y=g;if("31"!=t.substr(y,2))throw"Can't find signerInfos";for(var v=n(t,y),m=0;m<v.length;m++){var w=v[m],b=u.parseSignerInfoForAddingUnsigned(t,w,m);c.si[m]=b}var S=null;c.obj=new h,(S=new a).hTLV=c.version,c.obj.dCMSVersion=S,(S=new a).hTLV=c.algs,c.obj.dDigestAlgs=S,(S=new a).hTLV=c.encapcontent,c.obj.dEncapContentInfo=S,(S=new a).hTLV=c.certs,c.obj.dCerts=S,c.obj.signerInfoList=[];for(m=0;m<c.si.length;m++)c.obj.signerInfoList.push(c.si[m].obj);return c},tn.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,n){var i=rn,r=i.getChildIdx,s=i.getTLV,o=i.getV,a=tn.asn1,h=a.ASN1Object,u=a.cms,c=u.AttributeList,f=u.SignerInfo,l={},d=r(t,e);if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();l.version=s(t,p);var g=d.shift();l.si=s(t,g);var y=d.shift();l.digalg=s(t,y);var v=d.shift();l.sattrs=s(t,v);var m=d.shift();l.sigalg=s(t,m);var w=d.shift();l.sig=s(t,w),l.sigval=o(t,w);var b=null;return l.obj=new f,(b=new h).hTLV=l.version,l.obj.dCMSVersion=b,(b=new h).hTLV=l.si,l.obj.dSignerIdentifier=b,(b=new h).hTLV=l.digalg,l.obj.dDigestAlgorithm=b,(b=new h).hTLV=l.sattrs,l.obj.dSignedAttrs=b,(b=new h).hTLV=l.sigalg,l.obj.dSigAlg=b,(b=new h).hTLV=l.sig,l.obj.dSig=b,l.obj.dUnsignedAttrs=new c,l},void 0!==tn.asn1.csr&&tn.asn1.csr||(tn.asn1.csr={}),tn.asn1.csr.CertificationRequest=function(t){var e=tn,n=e.asn1,i=n.DERBitString,r=n.DERSequence,s=n.csr,o=n.x509;s.CertificationRequest.superclass.constructor.call(this),this.sign=function(t,n){null==this.prvKey&&(this.prvKey=n),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:t}),sig=new e.crypto.Signature({alg:t}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new i({hex:"00"+this.hexSig});var s=new r({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=s.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return yn(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==t&&void 0!==t.csrinfo&&(this.asn1CSRInfo=t.csrinfo)},re.lang.extend(tn.asn1.csr.CertificationRequest,tn.asn1.ASN1Object),tn.asn1.csr.CertificationRequestInfo=function(t){var e=tn.asn1,n=e.DERInteger,i=e.DERSequence,r=e.DERSet,s=e.DERNull,o=e.DERTaggedObject,a=e.DERObjectIdentifier,h=e.csr,u=e.x509,c=u.X500Name,f=u.Extension,l=Fn;h.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(t){this.asn1Subject=new c(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=l.getKey(t);this.asn1SubjPKey=new u.SubjectPublicKeyInfo(e)},this.appendExtensionByName=function(t,e){f.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var t=new i({array:this.extensionsArray}),e=new r({array:[t]}),n=new i({array:[new a({oid:"1.2.840.113549.1.9.14"}),e]}),h=new o({explicit:!0,tag:"a0",obj:n});this.asn1Array.push(h)}else{h=new o({explicit:!1,tag:"a0",obj:new s});this.asn1Array.push(h)}var u=new i({array:this.asn1Array});return this.hTLV=u.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},re.lang.extend(tn.asn1.csr.CertificationRequestInfo,tn.asn1.ASN1Object),tn.asn1.csr.CSRUtil=new function(){},tn.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=Fn,n=tn.asn1.csr;if(void 0===t.subject)throw"parameter subject undefined";if(void 0===t.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===t.sigalg)throw"parameter sigalg undefined";if(void 0===t.sbjprvkey)throw"parameter sbjpubkey undefined";var i=new n.CertificationRequestInfo;if(i.setSubjectByParam(t.subject),i.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var r=0;r<t.ext.length;r++)for(key in t.ext[r])i.appendExtensionByName(key,t.ext[r][key]);var s=new n.CertificationRequest({csrinfo:i}),o=e.getKey(t.sbjprvkey);return s.sign(t.sigalg,o),s.getPEMString()},tn.asn1.csr.CSRUtil.getInfo=function(t){var e=rn.getTLVbyList,n={subject:{},pubkey:{}};if(-1==t.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var i=vn(t,"CERTIFICATE REQUEST");return n.subject.hex=e(i,0,[0,1]),n.subject.name=Dn.hex2dn(n.subject.hex),n.pubkey.hex=e(i,0,[0,2]),n.pubkey.obj=Fn.getKey(n.pubkey.hex,null,"pkcs8pub"),n},void 0!==tn&&tn||(tn={}),void 0!==tn.asn1&&tn.asn1||(tn.asn1={}),void 0!==tn.asn1.ocsp&&tn.asn1.ocsp||(tn.asn1.ocsp={}),tn.asn1.ocsp.DEFAULT_HASH="sha1",tn.asn1.ocsp.CertID=function(t){var e=tn,n=e.asn1,i=n.DEROctetString,r=n.DERInteger,s=n.DERSequence,o=n.x509.AlgorithmIdentifier,a=n.ocsp,h=a.DEFAULT_HASH,u=e.crypto.Util.hashHex,c=Dn,f=rn;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(t,e,n,s){void 0===s&&(s=h),this.dHashAlg=new o({name:s}),this.dIssuerNameHash=new i({hex:t}),this.dIssuerKeyHash=new i({hex:e}),this.dSerialNumber=new r({hex:n})},this.setByCert=function(t,e,n){void 0===n&&(n=h);var i=new c;i.readCertPEM(e);var r=new c;r.readCertPEM(t);var s=r.getPublicKeyHex(),o=f.getTLVbyList(s,0,[1,0],"30"),a=i.getSerialNumberHex(),l=u(r.getSubjectHex(),n),d=u(o,n);this.setByValue(l,d,a,n),this.hoge=i.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var t=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],e=new s({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var l=t;if(void 0!==l.issuerCert&&void 0!==l.subjectCert){var d=h;void 0===l.alg&&(d=void 0),this.setByCert(l.issuerCert,l.subjectCert,d)}else{if(void 0===l.namehash||void 0===l.keyhash||void 0===l.serial)throw"invalid constructor arguments";d=h;void 0===l.alg&&(d=void 0),this.setByValue(l.namehash,l.keyhash,l.serial,d)}}},re.lang.extend(tn.asn1.ocsp.CertID,tn.asn1.ASN1Object),tn.asn1.ocsp.Request=function(t){var e=tn.asn1,n=e.DERSequence,i=e.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var t=[];if(null===this.dReqCert)throw"reqCert not set";t.push(this.dReqCert);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var r=new i.CertID(t);this.dReqCert=r}},re.lang.extend(tn.asn1.ocsp.Request,tn.asn1.ASN1Object),tn.asn1.ocsp.TBSRequest=function(t){var e=tn.asn1,n=e.DERSequence,i=e.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(t){for(var e=[],n=0;n<t.length;n++){var r=new i.Request(t[0]);e.push(r)}this.dRequestList=e},this.getEncodedHex=function(){var t=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var e=new n({array:this.dRequestList});if(t.push(e),null!==this.dRequestExt)throw"requestExtensions not supported";var i=new n({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList&&this.setRequestListByParam(t.reqList)},re.lang.extend(tn.asn1.ocsp.TBSRequest,tn.asn1.ASN1Object),tn.asn1.ocsp.OCSPRequest=function(t){var e=tn.asn1,n=e.DERSequence,i=e.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var t=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(t.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList){var r=new i.TBSRequest(t);this.dTbsRequest=r}},re.lang.extend(tn.asn1.ocsp.OCSPRequest,tn.asn1.ASN1Object),tn.asn1.ocsp.OCSPUtil={},tn.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,n){var i=tn.asn1.ocsp;void 0===n&&(n=i.DEFAULT_HASH);var r={alg:n,issuerCert:t,subjectCert:e};return new i.OCSPRequest({reqList:[r]}).getEncodedHex()},tn.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){var e=rn,n=e.getVbyList,i=e.getIdxbyList,r=(n=e.getVbyList,e.getV),s={};try{var o=n(t,0,[0],"0a");s.responseStatus=parseInt(o,16)}catch(t){}if(0!==s.responseStatus)return s;try{var a=i(t,0,[1,0,1,0,0,2,0,1]);"80"===t.substr(a,2)?s.certStatus="good":"a1"===t.substr(a,2)?(s.certStatus="revoked",s.revocationTime=ln(n(t,a,[0]))):"82"===t.substr(a,2)&&(s.certStatus="unknown")}catch(t){}try{var h=i(t,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=ln(r(t,h))}catch(t){}try{var u=i(t,0,[1,0,1,0,0,2,0,3]);"a0"===t.substr(u,2)&&(s.nextUpdate=ln(n(t,u,[0])))}catch(t){}return s},void 0!==tn&&tn||(tn={}),void 0!==tn.lang&&tn.lang||(tn.lang={}),tn.lang.String=function(){},en=function(t){return an(new mt(t,"utf8").toString("base64"))},nn=function(t){return new mt(hn(t),"base64").toString("utf8")},tn.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},tn.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},tn.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},tn.lang.String.isBase64URL=function(t){return!t.match(/[+\/=]/)&&(t=hn(t),tn.lang.String.isBase64(t))},tn.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:ue.algo.MD5,sha1:ue.algo.SHA1,sha224:ue.algo.SHA224,sha256:ue.algo.SHA256,sha384:ue.algo.SHA384,sha512:ue.algo.SHA512,ripemd160:ue.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,n){var i=this.getDigestInfoHex(t,e),r=n/4;if(i.length+22>r)throw"key is too short for SigAlg: keylen="+n+","+e;for(var s="0001",o="00"+i,a="",h=r-s.length-o.length,u=0;u<h;u+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new tn.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new tn.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new tn.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new tn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new tn.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new tn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new tn.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},tn.crypto.Util.md5=function(t){return new tn.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},tn.crypto.Util.ripemd160=function(t){return new tn.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},tn.crypto.Util.SECURERANDOMGEN=new ze,tn.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return tn.crypto.Util.SECURERANDOMGEN.nextBytes(e),sn(e)},tn.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new pe(tn.crypto.Util.getRandomHexOfNbytes(t),16)},tn.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return tn.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],sn(n)},tn.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new pe(tn.crypto.Util.getRandomHexOfNbits(t),16)},tn.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var n=tn.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(n))return n}},tn.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e);if(1==n)throw"biMin is greater than biMax";if(0==n)return t;var i=e.subtract(t);return tn.crypto.Util.getRandomBigIntegerZeroToMax(i).add(t)},tn.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=tn.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=tn.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=tn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=ue.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(ue.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},tn.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},tn.crypto.MessageDigest.getHashLength=function(t){var e=tn.crypto.MessageDigest,n=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[n])throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},tn.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},tn.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=tn.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==e){try{var i=tn.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=ue.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=ue.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(ue.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=pn(t)),void(this.pass=ue.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=fn(t.utf8)),void 0!==t.rstr&&(e=pn(t.rstr)),void 0!==t.b64&&(e=de(t.b64)),void 0!==t.b64u&&(e=cn(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=ue.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},tn.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new tn.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var n=null;try{n=void 0===e?Fn.getKey(t):Fn.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new tn.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof Je&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Je&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof tn.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof tn.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new tn.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof Je&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Je&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==tn.crypto.ECDSA&&this.pubKey instanceof tn.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==tn.crypto.DSA&&this.pubKey instanceof tn.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=tn.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Fn.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},tn.crypto.Cipher=function(t){},tn.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof Je&&e.isPublic){var i=tn.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.encrypt(t);if("RSAOAEP"===i)return e.encryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.encryptOAEP(t,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},tn.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof Je&&e.isPrivate){var i=tn.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.decrypt(t);if("RSAOAEP"===i)return e.decryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.decryptOAEP(t,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},tn.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof Je){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},tn.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.ECDSA=function(t){var e=new ze;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new pe(t.bitLength(),e).mod(t.subtract(pe.ONE)).add(pe.ONE)},this.setNamedCurve=function(t){this.ecparams=tn.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var n={};return n.x=t.substr(2,e),n.y=t.substr(2+e),n},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),n=this.ecparams.G.multiply(e),i=n.getX().toBigInteger(),r=n.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+r.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var n=new pe(e,16),i=this.ecparams.n,r=new pe(t,16);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(pe.ZERO)<=0);var a=s.modInverse(i).multiply(r.add(n.multiply(o))).mod(i);return tn.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var n=e,i=this.ecparams.n,r=pe.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(pe.ZERO)<=0);var a=s.modInverse(i).multiply(r.add(n.multiply(o))).mod(i);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,n){var i,r,s,o=tn.crypto.ECDSA.parseSigHex(e);i=o.r,r=o.s,s=$e.decodeFromHex(this.ecparams.curve,n);var a=new pe(t,16);return this.verifyRaw(a,i,r,s)},this.verify=function(t,e,n){var i,r,s;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);i=o.r,r=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";i=e.r,r=e.s}if(n instanceof $e)s=n;else{if(!Bitcoin.Util.isArray(n))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=$e.decodeFrom(this.ecparams.curve,n)}var a=pe.fromByteArrayUnsigned(t);return this.verifyRaw(a,i,r,s)},this.verifyRaw=function(t,e,n,i){var r=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(pe.ONE)<0||e.compareTo(r)>=0)return!1;if(n.compareTo(pe.ONE)<0||n.compareTo(r)>=0)return!1;var o=n.modInverse(r),a=t.multiply(o).mod(r),h=e.multiply(o).mod(r);return s.multiply(a).add(i.multiply(h)).getX().toBigInteger().mod(r).equals(e)},this.serializeSig=function(t,e){var n=t.toByteArraySigned(),i=e.toByteArraySigned(),r=[];return r.push(2),r.push(n.length),(r=r.concat(n)).push(2),r.push(i.length),(r=r.concat(i)).unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:pe.fromByteArrayUnsigned(n),s:pe.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:pe.fromByteArrayUnsigned(t.slice(1,33)).mod(n),s:pe.fromByteArrayUnsigned(t.slice(33,65)).mod(n),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,n,i,r=rn,s=tn.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),n=o(t,0,[1],"04");try{i=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,n,i,r=rn,s=tn.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),n=o(t,0,[2,0,1],"04");try{i=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,n,i=rn,r=tn.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{s(t,0,[0,0],"06"),e=s(t,0,[0,1],"06"),n=s(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var n,i,r=rn,s=tn.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{n=o(t,0,[0,e,0,1],"06"),i=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(n),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},tn.crypto.ECDSA.parseSigHex=function(t){var e=tn.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new pe(e.r,16),s:new pe(e.s,16)}},tn.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=rn,n=e.getChildIdx,i=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var r=n(t,0);if(2!=r.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=r[0],o=r[1];if("02"!=t.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:i(t,s),s:i(t,o)}},tn.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=tn.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,i=e.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),n.length%32==30&&(n="00"+n),i.length%32==30&&(i="00"+i),n.length%32!=0)throw"unknown ECDSA sig r length error";if(i.length%32!=0)throw"unknown ECDSA sig s length error";return n+i},tn.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return tn.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},tn.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new pe(t,16),i=new pe(e,16);return tn.crypto.ECDSA.biRSSigToASN1Sig(n,i)},tn.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=tn.asn1,i=new n.DERInteger({bigint:t}),r=new n.DERInteger({bigint:e});return new n.DERSequence({array:[i,r]}).getEncodedHex()},tn.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.ECParameterDB=new function(){var t={},e={};function n(t){return new pe(t,16)}this.getByName=function(n){var i=n;if(void 0!==e[i]&&(i=e[n]),void 0!==t[i])return t[i];throw"unregistered EC curve name: "+i},this.regist=function(i,r,s,o,a,h,u,c,f,l,d,p){t[i]={};var g=n(s),y=n(o),v=n(a),m=n(h),w=n(u),b=new Ze(g,y,v),S=b.decodePointHex("04"+c+f);t[i].name=i,t[i].keylen=r,t[i].curve=b,t[i].G=S,t[i].n=m,t[i].h=w,t[i].oid=d,t[i].info=p;for(var x=0;x<l.length;x++)e[l[x]]=i}},tn.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),tn.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),tn.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),tn.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),tn.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),tn.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),tn.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),tn.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),tn.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),tn.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==tn&&tn||(tn={}),void 0!==tn.crypto&&tn.crypto||(tn.crypto={}),tn.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,n,i,r){this.isPrivate=!0,this.p=t,this.q=e,this.g=n,this.y=i,this.x=r},this.setPrivateHex=function(t,e,n,i,r){var s,o,a,h,u;s=new pe(t,16),o=new pe(e,16),a=new pe(n,16),h="string"==typeof i&&i.length>1?new pe(i,16):null,u=new pe(r,16),this.setPrivate(s,o,a,h,u)},this.setPublic=function(t,e,n,i){this.isPublic=!0,this.p=t,this.q=e,this.g=n,this.y=i,this.x=null},this.setPublicHex=function(t,e,n,i){var r,s,o,a;r=new pe(t,16),s=new pe(e,16),o=new pe(n,16),a=new pe(i,16),this.setPublic(r,s,o,a)},this.signWithMessageHash=function(t){var e=this.p,n=this.q,i=this.g,r=(this.y,this.x),s=tn.crypto.Util.getRandomBigIntegerMinToMax(pe.ONE.add(pe.ONE),n.subtract(pe.ONE)),o=new pe(t.substr(0,n.bitLength()/4),16),a=i.modPow(s,e).mod(n),h=s.modInverse(n).multiply(o.add(r.multiply(a))).mod(n);return tn.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:h}}]})},this.verifyWithMessageHash=function(t,e){var n=this.p,i=this.q,r=this.g,s=this.y,o=this.parseASN1Signature(e),a=o[0],h=o[1],u=new pe(t.substr(0,i.bitLength()/4),16);if(pe.ZERO.compareTo(a)>0||a.compareTo(i)>0)throw"invalid DSA signature";if(pe.ZERO.compareTo(h)>=0||h.compareTo(i)>0)throw"invalid DSA signature";var c=h.modInverse(i),f=u.multiply(c).mod(i),l=a.multiply(c).mod(i);return 0==r.modPow(f,n).multiply(s.modPow(l,n)).mod(n).mod(i).compareTo(a)},this.parseASN1Signature=function(t){try{return[new pe(rn.getVbyList(t,0,[0],"02"),16),new pe(rn.getVbyList(t,0,[1],"02"),16)]}catch(t){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(t){var e,n,i,r,s,o=rn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{e=a(t,0,[1],"02"),n=a(t,0,[2],"02"),i=a(t,0,[3],"02"),r=a(t,0,[4],"02"),s=a(t,0,[5],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(e,n,i,r,s)},this.readPKCS8PrvKeyHex=function(t){var e,n,i,r,s=rn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[1,1,0],"02"),n=o(t,0,[1,1,1],"02"),i=o(t,0,[1,1,2],"02"),r=o(t,0,[2,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(e,n,i,null,r)},this.readPKCS8PubKeyHex=function(t){var e,n,i,r,s=rn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[0,1,0],"02"),n=o(t,0,[0,1,1],"02"),i=o(t,0,[0,1,2],"02"),r=o(t,0,[1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 DSA public key"}this.setPublicHex(e,n,i,r)},this.readCertPubKeyHex=function(t,e){var n,i,r,s;5!==e&&(e=6);var o=rn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{n=a(t,0,[0,e,0,1,0],"02"),i=a(t,0,[0,e,0,1,1],"02"),r=a(t,0,[0,e,0,1,2],"02"),s=a(t,0,[0,e,1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed X.509 certificate DSA public key"}this.setPublicHex(n,i,r,s)}};var Fn=function(){var t=function(t,n,i){return e(ue.AES,t,n,i)},e=function(t,e,n,i){var r=ue.enc.Hex.parse(e),s=ue.enc.Hex.parse(n),o=ue.enc.Hex.parse(i),a={};a.key=s,a.iv=o,a.ciphertext=r;var h=t.decrypt(a,s,{iv:o});return ue.enc.Hex.stringify(h)},n=function(t,e,n){return i(ue.AES,t,e,n)},i=function(t,e,n,i){var r=ue.enc.Hex.parse(e),s=ue.enc.Hex.parse(n),o=ue.enc.Hex.parse(i),a=t.encrypt(r,s,{iv:o}),h=ue.enc.Hex.parse(a.toString());return ue.enc.Base64.stringify(h)},r={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,n,i){return e(ue.TripleDES,t,n,i)},eproc:function(t,e,n){return i(ue.TripleDES,t,e,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,n,i){return e(ue.DES,t,n,i)},eproc:function(t,e,n){return i(ue.DES,t,e,n)},keylen:8,ivlen:8}},s=function(t){var e={},n=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(e.cipher=n[1],e.ivsalt=n[2]);var i=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(e.type=i[1]);var r=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(r=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(r=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=r&&-1!=o){var a=t.substring(r+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,n){for(var i=n.substring(0,16),s=ue.enc.Hex.parse(i),o=ue.enc.Utf8.parse(e),a=r[t].keylen+r[t].ivlen,h="",u=null;;){var c=ue.algo.MD5.create();if(null!=u&&c.update(u),c.update(o),c.update(s),u=c.finalize(),(h+=ue.enc.Hex.stringify(u)).length>=2*a)break}var f={};return f.keyhex=h.substr(0,2*r[t].keylen),f.ivhex=h.substr(2*r[t].keylen,2*r[t].ivlen),f},a=function(t,e,n,i){var s=ue.enc.Base64.parse(t),o=ue.enc.Hex.stringify(s);return(0,r[e].proc)(o,n,i)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,n){return o(t,e,n)},decryptKeyB64:function(t,e,n,i){return a(t,e,n,i)},getDecryptedKeyHex:function(t,e){var n=s(t),i=n.cipher,r=n.ivsalt,h=n.data,u=o(i,e,r).keyhex;return a(h,i,u,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,n,i,s){var a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===r[i])throw"KEYUTIL unsupported algorithm: "+i;void 0!==s&&null!=s||(s=function(t){var e=ue.lib.WordArray.random(t);return ue.enc.Hex.stringify(e)}(r[i].ivlen).toUpperCase());var h=function(t,e,n,i){return(0,r[e].eproc)(t,n,i)}(e,i,o(i,n,s).keyhex,s);a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+s+"\r\n",a+="\r\n",a+=h.replace(/(.{64})/g,"$1\r\n"),a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=rn,n=e.getChildIdx,i=e.getV,r={},s=n(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;r.ciphertext=i(t,s[1]);var o=n(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=i(t,o[0]))throw"this only supports pkcs5PBES2";var a=n(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var h=n(t,a[1]);if(2!=h.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+h.length;if("2a864886f70d0307"!=i(t,h[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=i(t,h[1]);var u=n(t,a[0]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+u.length;if("2a864886f70d01050c"!=i(t,u[0]))throw"this only supports pkcs5PBKDF2";var c=n(t,u[1]);if(c.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length;r.pbkdf2Salt=i(t,c[0]);var f=i(t,c[1]);try{r.pbkdf2Iter=parseInt(f,16)}catch(t){throw"malformed format pbkdf2Iter: "+f}return r},getPBKDF2KeyHexFromParam:function(t,e){var n=ue.enc.Hex.parse(t.pbkdf2Salt),i=t.pbkdf2Iter,r=ue.PBKDF2(e,n,{keySize:6,iterations:i});return ue.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var n=vn(t,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(n),r=Fn.getPBKDF2KeyHexFromParam(i,e),s={};s.ciphertext=ue.enc.Hex.parse(i.ciphertext);var o=ue.enc.Hex.parse(r),a=ue.enc.Hex.parse(i.encryptionSchemeIV),h=ue.TripleDES.decrypt(s,o,{iv:a});return ue.enc.Hex.stringify(h)},getKeyFromEncryptedPKCS8PEM:function(t,e){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(t){var e=rn,n=e.getChildIdx,i=e.getV,r={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=n(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=n(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(r.algoid=i(t,o[0]),"06"==t.substr(o[1],2)&&(r.algparam=i(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return r.keyidx=e.getVidx(t,s[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=vn(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,n=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==n.algoid)e=new Je;else if("2a8648ce380401"==n.algoid)e=new tn.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";e=new tn.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,n=rn.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===n)e=new Je;else if("2a8648ce380401"===n)e=new tn.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";e=new tn.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=rn,n=e.getChildIdx,i=e.getV,r={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=n(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(r.n=i(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return r.e=i(t,s[1]),r},parsePublicPKCS8Hex:function(t){var e=rn,n=e.getChildIdx,i=e.getV,r={algparam:null},s=n(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=n(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(r.algoid=i(t,a[0]),"06"==t.substr(a[1],2)?r.algparam=i(t,a[1]):"30"==t.substr(a[1],2)&&(r.algparam={},r.algparam.p=e.getVbyList(t,a[1],[0],"02"),r.algparam.q=e.getVbyList(t,a[1],[1],"02"),r.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return r.key=i(t,s[1]).substr(2),r}}}();Fn.getKey=function(t,e,n){var i=(y=rn).getChildIdx,r=(y.getV,y.getVbyList),s=tn.crypto,o=s.ECDSA,a=s.DSA,h=Je,u=vn,c=Fn;if(void 0!==h&&t instanceof h)return t;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(T=new h).setPublic(t.n,t.e),T;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(T=new h).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),T;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(T=new h).setPrivate(t.n,t.e,t.d),T;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(T=new a).setPublic(t.p,t.q,t.g,t.y),T;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(T=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(T=new h).setPublic(cn(t.n),cn(t.e)),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(T=new h).setPrivateEx(cn(t.n),cn(t.e),cn(t.d),cn(t.p),cn(t.q),cn(t.dp),cn(t.dq),cn(t.qi)),T;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(T=new h).setPrivate(cn(t.n),cn(t.e),cn(t.d)),T;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var f=(C=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+cn(t.x)).slice(-f)+("0000000000"+cn(t.y)).slice(-f);return C.setPublicKeyHex(l),C}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){f=(C=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+cn(t.x)).slice(-f)+("0000000000"+cn(t.y)).slice(-f);var d=("0000000000"+cn(t.d)).slice(-f);return C.setPublicKeyHex(l),C.setPrivateKeyHex(d),C}if("pkcs5prv"===n){var p,g=t,y=rn;if(9===(p=i(g,0)).length)(T=new h).readPKCS5PrvKeyHex(g);else if(6===p.length)(T=new a).readPKCS5PrvKeyHex(g);else{if(!(p.length>2&&"04"===g.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(T=new o).readPKCS5PrvKeyHex(g)}return T}if("pkcs8prv"===n)return T=c.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===n)return c._getKeyFromPublicPKCS8Hex(t);if("x509pub"===n)return Dn.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return Dn.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var v=vn(t,"PUBLIC KEY");return c._getKeyFromPublicPKCS8Hex(v)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var m=u(t,"RSA PRIVATE KEY");return c.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var w=r(I=u(t,"DSA PRIVATE KEY"),0,[1],"02"),b=r(I,0,[2],"02"),S=r(I,0,[3],"02"),x=r(I,0,[4],"02"),E=r(I,0,[5],"02");return(T=new a).setPrivate(new pe(w,16),new pe(b,16),new pe(S,16),new pe(x,16),new pe(E,16)),T}if(-1!=t.indexOf("-END PRIVATE KEY-"))return c.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var F=c.getDecryptedKeyHex(t,e),A=new Je;return A.readPKCS5PrvKeyHex(F),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var C,T=r(I=c.getDecryptedKeyHex(t,e),0,[1],"04"),P=r(I,0,[2,0],"06"),D=r(I,0,[3,0],"03").substr(2);if(void 0===tn.crypto.OID.oidhex2name[P])throw"undefined OID(hex) in KJUR.crypto.OID: "+P;return(C=new o({curve:tn.crypto.OID.oidhex2name[P]})).setPublicKeyHex(D),C.setPrivateKeyHex(T),C.isPublic=!1,C}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var I;w=r(I=c.getDecryptedKeyHex(t,e),0,[1],"02"),b=r(I,0,[2],"02"),S=r(I,0,[3],"02"),x=r(I,0,[4],"02"),E=r(I,0,[5],"02");return(T=new a).setPrivate(new pe(w,16),new pe(b,16),new pe(S,16),new pe(x,16),new pe(E,16)),T}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return c.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},Fn.generateKeypair=function(t,e){if("RSA"==t){var n=e;(o=new Je).generate(n,"10001"),o.isPrivate=!0,o.isPublic=!0;var i=new Je,r=o.n.toString(16),s=o.e.toString(16);return i.setPublic(r,s),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}if("EC"==t){var o,a,h=e,u=new tn.crypto.ECDSA({curve:h}).generateKeyPairHex();return(o=new tn.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),o.setPrivateKeyHex(u.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(i=new tn.crypto.ECDSA({curve:h})).setPublicKeyHex(u.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},Fn.getPEM=function(t,e,n,i,r,s){var o=tn,a=o.asn1,h=a.DERObjectIdentifier,u=a.DERInteger,c=a.ASN1Util.newObject,f=a.x509.SubjectPublicKeyInfo,l=o.crypto,d=l.DSA,p=l.ECDSA,g=Je;function y(t){return c({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function v(t){return c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function m(t){return c({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==g&&t instanceof g||void 0!==d&&t instanceof d||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return yn(x=new f(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===n||null==n)&&1==t.isPrivate)return yn(x=y(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===n||null==n)&&1==t.isPrivate){var w=new h({name:t.curveName}).getEncodedHex(),b=v(t).getEncodedHex(),S="";return S+=yn(w,"EC PARAMETERS"),S+=yn(b,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==d&&t instanceof d&&(void 0===n||null==n)&&1==t.isPrivate)return yn(x=m(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==n&&null!=n&&1==t.isPrivate){var x=y(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,n,i,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==n&&null!=n&&1==t.isPrivate){x=v(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",x,n,i,s)}if("PKCS5PRV"==e&&void 0!==d&&t instanceof d&&void 0!==n&&null!=n&&1==t.isPrivate){x=m(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",x,n,i,s)}var E=function(t,e){var n=F(t,e);return new c({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},F=function(t,e){var n=ue.lib.WordArray.random(8),i=ue.lib.WordArray.random(8),r=ue.PBKDF2(e,n,{keySize:6,iterations:100}),s=ue.enc.Hex.parse(t),o=ue.TripleDES.encrypt(s,r,{iv:i})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=ue.enc.Hex.stringify(n),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=ue.enc.Hex.stringify(i),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){var A=y(t).getEncodedHex();x=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){A=new c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==d&&t instanceof d&&1==t.isPrivate){A=new u({bigint:t.x}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?yn(x,"PRIVATE KEY"):yn(b=E(x,n),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Fn.getKeyFromCSRPEM=function(t){var e=vn(t,"CERTIFICATE REQUEST");return Fn.getKeyFromCSRHex(e)},Fn.getKeyFromCSRHex=function(t){var e=Fn.parseCSRHex(t);return Fn.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Fn.parseCSRHex=function(t){var e=rn,n=e.getChildIdx,i=e.getTLV,r={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=n(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=n(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=i(s,a[2]),r},Fn.getJWKFromKey=function(t){var e={};if(t instanceof Je&&t.isPrivate)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e.d=un(t.d.toString(16)),e.p=un(t.p.toString(16)),e.q=un(t.q.toString(16)),e.dp=un(t.dmp1.toString(16)),e.dq=un(t.dmq1.toString(16)),e.qi=un(t.coeff.toString(16)),e;if(t instanceof Je&&t.isPublic)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e;if(t instanceof tn.crypto.ECDSA&&t.isPrivate){if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=un(n.x),e.y=un(n.y),e.d=un(t.prvKeyHex),e}if(t instanceof tn.crypto.ECDSA&&t.isPublic){var i;if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=un(n.x),e.y=un(n.y),e}throw"not supported key object"},Je.getPosArrayOfChildrenFromHex=function(t){return rn.getChildIdx(t,0)},Je.getHexValueArrayOfChildrenFromHex=function(t){var e,n=rn.getV,i=n(t,(e=Je.getPosArrayOfChildrenFromHex(t))[0]),r=n(t,e[1]),s=n(t,e[2]),o=n(t,e[3]),a=n(t,e[4]),h=n(t,e[5]),u=n(t,e[6]),c=n(t,e[7]),f=n(t,e[8]);return(e=new Array).push(i,r,s,o,a,h,u,c,f),e},Je.prototype.readPrivateKeyFromPEMString=function(t){var e=vn(t),n=Je.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},Je.prototype.readPKCS5PrvKeyHex=function(t){var e=Je.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Je.prototype.readPKCS8PrvKeyHex=function(t){var e,n,i,r,s,o,a,h,u=rn,c=u.getVbyList;if(!1===u.isASN1HEX(t))throw"not ASN.1 hex string";try{e=c(t,0,[2,0,1],"02"),n=c(t,0,[2,0,2],"02"),i=c(t,0,[2,0,3],"02"),r=c(t,0,[2,0,4],"02"),s=c(t,0,[2,0,5],"02"),o=c(t,0,[2,0,6],"02"),a=c(t,0,[2,0,7],"02"),h=c(t,0,[2,0,8],"02")}catch(t){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,n,i,r,s,o,a,h)},Je.prototype.readPKCS5PubKeyHex=function(t){var e=rn,n=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var i=e.getChildIdx(t,0);if(2!==i.length||"02"!==t.substr(i[0],2)||"02"!==t.substr(i[1],2))throw"wrong hex for PKCS#5 public key";var r=n(t,i[0]),s=n(t,i[1]);this.setPublic(r,s)},Je.prototype.readPKCS8PubKeyHex=function(t){var e=rn;if(!1===e.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==e.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var n=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},Je.prototype.readCertPubKeyHex=function(t,e){var n,i;(n=new Dn).readCertHex(t),i=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(i)};var An=new RegExp("");function Cn(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t}function Tn(t,e,n){for(var i="",r=0;i.length<e;)i+=dn(n(pn(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return i}function Pn(t){for(var e in tn.crypto.Util.DIGESTINFOHEAD){var n=tn.crypto.Util.DIGESTINFOHEAD[e],i=n.length;if(t.substring(0,i)==n)return[e,t.substring(i)]}return[]}function Dn(){var t=rn,e=t.getChildIdx,n=t.getV,i=t.getTLV,r=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,a=t.getVidx,h=t.oidname,u=Dn,c=vn;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return r(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return h(r(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return u.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return u.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=r(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=r(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return o(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Fn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return h(r(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return r(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmName(),n=this.getSignatureValueHex(),i=s(this.hex,0,[0],"30"),r=new tn.crypto.Signature({alg:e});return r.init(t),r.updateHex(i),r.verify(n)},this.parseExt=function(){if(3!==this.version)return-1;var n=o(this.hex,0,[0,7,0],"30"),i=e(this.hex,n);this.aExtInfo=new Array;for(var s=0;s<i.length;s++){var h={critical:!1},u=0;3===e(this.hex,i[s]).length&&(h.critical=!0,u=1),h.oid=t.hextooidstr(r(this.hex,i[s],[0],"06"));var c=o(this.hex,i[s],[1+u]);h.vidx=a(this.hex,c),this.aExtInfo.push(h)}},this.getExtInfo=function(t){var e=this.aExtInfo,n=t;if(t.match(/^[0-9.]+$/)||(n=tn.asn1.x509.OID.name2oid(t)),""!==n)for(var i=0;i<e.length;i++)if(e[i].oid===n)return e[i]},this.getExtBasicConstraints=function(){var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=n(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var i=n(e,6);return{cA:!0,pathLen:parseInt(i,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=n(this.hex,t.vidx);if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var i=parseInt(e.substr(0,2)),r=parseInt(e.substr(2),16).toString(2);return r.substr(0,r.length-i)},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&e.push(Dn.KEYUSAGE_NAME[n]);return e.join(",")},this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:n(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var r={},s=i(this.hex,t.vidx),o=e(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(r.kid=n(s,o[a]));return r},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var r=new Array,s=i(this.hex,t.vidx);if(""===s)return r;for(var o=e(s,0),a=0;a<o.length;a++)r.push(h(n(s,o[a])));return r},this.getExtSubjectAltName=function(){for(var t=this.getExtSubjectAltName2(),e=new Array,n=0;n<t.length;n++)"DNS"===t[n][0]&&e.push(t[n][1]);return e},this.getExtSubjectAltName2=function(){var t,r,s,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,h=i(this.hex,o.vidx),u=e(h,0),c=0;c<u.length;c++)s=h.substr(u[c],2),t=n(h,u[c]),"81"===s&&(r=ln(t),a.push(["MAIL",r])),"82"===s&&(r=ln(t),a.push(["DNS",r])),"84"===s&&(r=Dn.hex2dn(t,0),a.push(["DN",r])),"86"===s&&(r=ln(t),a.push(["URI",r])),"87"===s&&(r=Sn(t),a.push(["IP",r]));return a},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var n=new Array,i=e(this.hex,t.vidx),s=0;s<i.length;s++)try{var o=ln(r(this.hex,i[s],[0,0,0],"86"));n.push(o)}catch(t){}return n},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var n={ocsp:[],caissuer:[]},i=e(this.hex,t.vidx),s=0;s<i.length;s++){var o=r(this.hex,i[s],[0],"06"),a=r(this.hex,i[s],[1],"86");"2b06010505073001"===o&&n.ocsp.push(ln(a)),"2b06010505073002"===o&&n.caissuer.push(ln(a))}return n},this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var s=i(this.hex,t.vidx),o=[],a=e(s,0),u=0;u<a.length;u++){var c={},f=e(s,a[u]);if(c.id=h(n(s,f[0])),2===f.length)for(var l=e(s,f[1]),d=0;d<l.length;d++){var p=r(s,l[d],[0],"06");"2b06010505070201"===p?c.cps=ln(r(s,l[d],[1])):"2b06010505070202"===p&&(c.unotice=ln(r(s,l[d],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(c(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,n;if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+En(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+En(e.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){t+="X509v3 Extensions:\n";for(var i=0;i<n.length;i++){var r=n[i],s=tn.asn1.x509.OID.oid2name(r.oid);""===s&&(s=r.oid);var o="";if(!0===r.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n","basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var h=this.getExtAuthorityKeyIdentifier();void 0!==h.kid&&(t+="    kid="+h.kid+"\n")}else{if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var u=this.getExtAIAInfo();void 0!==u.ocsp&&(t+="    ocsp: "+u.ocsp.join(",")+"\n"),void 0!==u.caissuer&&(t+="    caissuer: "+u.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var c=this.getExtCertificatePolicies(),f=0;f<c.length;f++)void 0!==c[f].id&&(t+="    policy oid: "+c[f].id+"\n"),void 0!==c[f].cps&&(t+="    cps: "+c[f].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}An.compile("[^0-9a-f]","gi"),Je.prototype.sign=function(t,e){var n,i=(n=t,tn.crypto.Util.hashString(n,e));return this.signWithMessageHash(i,e)},Je.prototype.signWithMessageHash=function(t,e){var n=Ye(tn.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return Cn(this.doPrivate(n).toString(16),this.n.bitLength())},Je.prototype.signPSS=function(t,e,n){var i,r=(i=pn(t),tn.crypto.Util.hashHex(i,e));return void 0===n&&(n=-1),this.signWithMessageHashPSS(r,e,n)},Je.prototype.signWithMessageHashPSS=function(t,e,n){var i,r=dn(t),s=r.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),h=function(t){return tn.crypto.Util.hashHex(t,e)};if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw"invalid salt length";if(a<s+n+2)throw"data too long";var u="";n>0&&(u=new Array(n),(new ze).nextBytes(u),u=String.fromCharCode.apply(String,u));var c=dn(h(pn("\0\0\0\0\0\0\0\0"+r+u))),f=[];for(i=0;i<a-n-s-2;i+=1)f[i]=0;var l=String.fromCharCode.apply(String,f)+""+u,d=Tn(c,l.length,h),p=[];for(i=0;i<l.length;i+=1)p[i]=l.charCodeAt(i)^d.charCodeAt(i);var g=65280>>8*a-o&255;for(p[0]&=~g,i=0;i<s;i++)p.push(c.charCodeAt(i));return p.push(188),Cn(this.doPrivate(new pe(p)).toString(16),this.n.bitLength())},Je.prototype.verify=function(t,e){var n=Ye(e=(e=e.replace(An,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var i=Pn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;var r,s=i[0];return i[1]==(r=t,tn.crypto.Util.hashString(r,s))},Je.prototype.verifyWithMessageHash=function(t,e){var n=Ye(e=(e=e.replace(An,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var i=Pn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;i[0];return i[1]==t},Je.prototype.verifyPSS=function(t,e,n,i){var r,s=(r=pn(t),tn.crypto.Util.hashHex(r,n));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(s,e,n,i)},Je.prototype.verifyWithMessageHashPSS=function(t,e,n,i){var r=new pe(e,16);if(r.bitLength()>this.n.bitLength())return!1;var s,o=function(t){return tn.crypto.Util.hashHex(t,n)},a=dn(t),h=a.length,u=this.n.bitLength()-1,c=Math.ceil(u/8);if(-1===i||void 0===i)i=h;else if(-2===i)i=c-h-2;else if(i<-2)throw"invalid salt length";if(c<h+i+2)throw"data too long";var f=this.doPublic(r).toByteArray();for(s=0;s<f.length;s+=1)f[s]&=255;for(;f.length<c;)f.unshift(0);if(188!==f[c-1])throw"encoded message does not end in 0xbc";var l=(f=String.fromCharCode.apply(String,f)).substr(0,c-h-1),d=f.substr(l.length,h),p=65280>>8*c-u&255;if(0!=(l.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=Tn(d,l.length,o),y=[];for(s=0;s<l.length;s+=1)y[s]=l.charCodeAt(s)^g.charCodeAt(s);y[0]&=~p;var v=c-h-i-2;for(s=0;s<v;s+=1)if(0!==y[s])throw"leftmost octets not zero";if(1!==y[v])throw"0x01 marker not found";return d===dn(o(pn("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,y.slice(-i)))))},Je.SALT_LEN_HLEN=-1,Je.SALT_LEN_MAX=-2,Je.SALT_LEN_RECOVER=-2,Dn.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var n=new Array,i=rn.getChildIdx(t,e),r=0;r<i.length;r++)n.push(Dn.hex2rdn(t,i[r]));return"/"+(n=n.map(function(t){return t.replace("/","\\/")})).join("/")},Dn.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var n=new Array,i=rn.getChildIdx(t,e),r=0;r<i.length;r++)n.push(Dn.hex2attrTypeValue(t,i[r]));return(n=n.map(function(t){return t.replace("+","\\+")})).join("+")},Dn.hex2attrTypeValue=function(t,e){var n=rn,i=n.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var r=n.getChildIdx(t,e);2!==r.length||t.substr(r[0],2);var s=i(t,r[0]),o=tn.asn1.ASN1Util.oidHexToInt(s);return tn.asn1.x509.OID.oid2atype(o)+"="+dn(i(t,r[1]))},Dn.getPublicKeyFromCertHex=function(t){var e=new Dn;return e.readCertHex(t),e.getPublicKey()},Dn.getPublicKeyFromCertPEM=function(t){var e=new Dn;return e.readCertPEM(t),e.getPublicKey()},Dn.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,i=rn.getVbyList,r={};return r.algparam=null,(e=new Dn).readCertPEM(t),n=e.getPublicKeyHex(),r.keyhex=i(n,0,[1],"03").substr(2),r.algoid=i(n,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=i(n,0,[0,1],"06")),r},Dn.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==tn&&tn||(tn={}),void 0!==tn.jws&&tn.jws||(tn.jws={}),tn.jws.JWS=function(){var t=tn.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var i=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var r=i[1],s=i[2],o=i[3],a=r+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=r,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!n){var h=cn(o),u=Ye(h,16);this.parsedJWS.sigvalH=h,this.parsedJWS.sigvalBI=u}var c=nn(r),f=nn(s);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=f,!t(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},tn.jws.JWS.sign=function(t,e,n,i,r){var s,o,a,h=tn,u=h.jws.JWS,c=u.readSafeJSONString,f=u.isSafeJSONString,l=h.crypto,d=(l.ECDSA,l.Mac),p=l.Signature,g=JSON;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(o=e,s=g.stringify(o)),"string"==typeof e){if(!f(s=e))throw"JWS Head is not safe JSON string: "+s;o=c(s)}if(a=n,"object"==typeof n&&(a=g.stringify(n)),""!=t&&null!=t||void 0===o.alg||(t=o.alg),""!=t&&null!=t&&void 0===o.alg&&(o.alg=t,s=g.stringify(o)),t!==o.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+o.alg;var y=null;if(void 0===u.jwsalg2sigalg[t])throw"unsupported alg name: "+t;y=u.jwsalg2sigalg[t];var v=en(s)+"."+en(a),m="";if("Hmac"==y.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var w=new d({alg:y,prov:"cryptojs",pass:i});w.updateString(v),m=w.doFinal()}else if(-1!=y.indexOf("withECDSA")){(S=new p({alg:y})).init(i,r),S.updateString(v);var b=S.sign();m=tn.crypto.ECDSA.asn1SigToConcatSig(b)}else{var S;if("none"!=y)(S=new p({alg:y})).init(i,r),S.updateString(v),m=S.sign()}return v+"."+un(m)},tn.jws.JWS.verify=function(t,e,n){var i,r=tn,s=r.jws.JWS,o=s.readSafeJSONString,a=r.crypto,h=a.ECDSA,u=a.Mac,c=a.Signature;i=Je;var f=t.split(".");if(3!==f.length)return!1;var l=f[0]+"."+f[1],d=cn(f[2]),p=o(nn(f[0])),g=null,y=null;if(void 0===p.alg)throw"algorithm not specified in header";if((y=(g=p.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0)&&-1==(":"+n.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Fn.getKey(e)),!("RS"!=y&&"PS"!=y||e instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==y&&!(e instanceof h))throw"key shall be a ECDSA obj for ES* algs";var v=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+g;if("none"==(v=s.jwsalg2sigalg[g]))throw"not supported";if("Hmac"==v.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var m=new u({alg:v,pass:e});return m.updateString(l),d==m.doFinal()}if(-1!=v.indexOf("withECDSA")){var w,b=null;try{b=h.concatSigToASN1Sig(d)}catch(t){return!1}return(w=new c({alg:v})).init(e),w.updateString(l),w.verify(b)}return(w=new c({alg:v})).init(e),w.updateString(l),w.verify(d)},tn.jws.JWS.parse=function(t){var e,n,i,r=t.split("."),s={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=r[0],n=r[1],3==r.length&&(i=r[2]),s.headerObj=tn.jws.JWS.readSafeJSONString(nn(e)),s.payloadObj=tn.jws.JWS.readSafeJSONString(nn(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=nn(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==i&&(s.sigHex=cn(i)),s},tn.jws.JWS.verifyJWT=function(t,e,n){var i=tn.jws,r=i.JWS,s=r.readSafeJSONString,o=r.inArray,a=r.includedArray,h=t.split("."),u=h[0],c=h[1],f=(cn(h[2]),s(nn(u))),l=s(nn(c));if(void 0===f.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!o(f.alg,n.alg))return!1;if(void 0!==l.iss&&"object"==typeof n.iss&&!o(l.iss,n.iss))return!1;if(void 0!==l.sub&&"object"==typeof n.sub&&!o(l.sub,n.sub))return!1;if(void 0!==l.aud&&"object"==typeof n.aud)if("string"==typeof l.aud){if(!o(l.aud,n.aud))return!1}else if("object"==typeof l.aud&&!a(l.aud,n.aud))return!1;var d=i.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(d=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==l.exp&&"number"==typeof l.exp&&l.exp+n.gracePeriod<d)&&(!(void 0!==l.nbf&&"number"==typeof l.nbf&&d<l.nbf-n.gracePeriod)&&(!(void 0!==l.iat&&"number"==typeof l.iat&&d<l.iat-n.gracePeriod)&&((void 0===l.jti||void 0===n.jti||l.jti===n.jti)&&!!r.verify(t,e,n.alg))))},tn.jws.JWS.includedArray=function(t,e){var n=tn.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var i=0;i<t.length;i++)if(!n(t[i],e))return!1;return!0},tn.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},tn.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},tn.jws.JWS.isSafeJSONString=function(t,e,n){var i=null;try{return"object"!=typeof(i=Qe(t))?0:i.constructor===Array?0:(e&&(e[n]=i),1)}catch(t){return 0}},tn.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=Qe(t))?null:e.constructor===Array?null:e}catch(t){return null}},tn.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},tn.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=pn(e);return un(tn.crypto.Util.hashHex(n,"sha256"))},tn.jws.IntDate={},tn.jws.IntDate.get=function(t){var e=tn.jws.IntDate,n=e.getNow,i=e.getZulu;if("now"==t)return n();if("now + 1hour"==t)return n()+3600;if("now + 1day"==t)return n()+86400;if("now + 1month"==t)return n()+2592e3;if("now + 1year"==t)return n()+31536e3;if(t.match(/Z$/))return i(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},tn.jws.IntDate.getZulu=function(t){return mn(t)},tn.jws.IntDate.getNow=function(){return~~(new Date/1e3)},tn.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},tn.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},void 0!==tn&&tn||(tn={}),void 0!==tn.jws&&tn.jws||(tn.jws={}),tn.jws.JWSJS=function(){var t=tn.jws.JWS,e=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(t){this.init();var e=t.split(".");if(3!=e.length)throw"malformed input JWS";this.aHeader.push(e[0]),this.sPayload=e[1],this.aSignature.push(e[2])},this.addSignature=function(t,e,n,i){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var r=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=tn.jws.JWS.sign(t,e,this.sPayload,n,i).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(t){throw this.aHeader.length>r&&this.aHeader.pop(),this.aSignature.length>r&&this.aSignature.pop(),"addSignature failed: "+t}},this.verifyAll=function(t){if(this.aHeader.length!==t.length||this.aSignature.length!==t.length)return!1;for(var e=0;e<t.length;e++){var n=t[e];if(2!==n.length)return!1;if(!1===this.verifyNth(e,n[0],n[1]))return!1}return!0},this.verifyNth=function(e,n,i){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1;var r=this.aHeader[e],s=this.aSignature[e],o=r+"."+this.sPayload+"."+s,a=!1;try{a=t.verify(o,n,i)}catch(t){return!1}return a},this.readJWSJS=function(t){if("string"==typeof t){var n=e(t);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(t.headers.length>0))throw"malformed header";if(this.aHeader=t.headers,"string"!=typeof t.payload)throw"malformed signatures";if(this.sPayload=t.payload,!(t.signatures.length>0))throw"malformed signatures";this.aSignatures=t.signatures}catch(t){throw"malformed JWS-JS JSON object: "+t}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}};tn.crypto.ECDSA,tn.crypto.DSA,tn.crypto.Signature;var In=tn.crypto.MessageDigest,Rn=(tn.crypto.Mac,tn.crypto.Cipher,Fn),Bn=vn,Hn=(tn.crypto,tn.asn1),_n=tn.jws,Nn=(tn.lang,{apiRoot:"http://127.0.0.1:4944/api",request:function(t){t.headers=void 0!==t.headers?t.json:{"Content-Type":"application/json"},t.method="POST";var e=void 0!==t.uri?t.uri:this.apiRoot;return t.apiMethod&&(t.uri+="/"+t.apiMethod),t.apiIdType&&(t.uri+="/"+encodeURIComponent(t.apiIdType)),t.apiId&&(t.uri+="/"+encodeURIComponent(t.apiId)),t.apiAction&&(t.uri+="/"+t.apiAction),it(e,t)},getJwt:function(t,e){var n=Math.floor(Date.now()/1e3)+60;return e=nt({exp:n},e),_n.sign({header:{typ:"JWT",alg:"ES256"},payload:e,privateKey:t})}}),On=s.JSON||(s.JSON={stringify:JSON.stringify}),kn=function(t){return On.stringify.apply(On,arguments)},jn=n(i(function(t){t.exports={default:kn,__esModule:!0}})),Ln=n(i(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),Mn=b,Vn={},Kn=f?Object.defineProperties:function(t,e){u(t);for(var n,i=G(e),r=i.length,s=0;r>s;)m.f(t,n=i[s++],e[n]);return t},Un=r.document,qn=Un&&Un.documentElement,zn=q("IE_PROTO"),Yn=function(){},Wn=function(){var t,e=p("iframe"),n=J.length;for(e.style.display="none",qn.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),Wn=t.F;n--;)delete Wn.prototype[J[n]];return Wn()},Jn=Object.create||function(t,e){var n;return null!==t?(Yn.prototype=u(t),n=new Yn,Yn.prototype=null,n[zn]=t):n=Wn(),void 0===e?n:Kn(n,e)},Gn=i(function(t){var e=L("wks"),n=r.Symbol,i="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=i&&n[t]||(i?n:K)("Symbol."+t))}).store=e}),Xn=m.f,$n=Gn("toStringTag"),Zn=function(t,e,n){t&&!A(t=n?t:t.prototype,$n)&&Xn(t,$n,{configurable:!0,value:e})},Qn={};b(Qn,Gn("iterator"),function(){return this});var ti,ei=function(t,e,n){t.prototype=Jn(Qn,{next:w(1,n)}),Zn(t,e+" Iterator")},ni=q("IE_PROTO"),ii=Object.prototype,ri=Object.getPrototypeOf||function(t){return t=Z(t),A(t,ni)?t[ni]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ii:null},si=Gn("iterator"),oi=!([].keys&&"next"in[].keys()),ai=function(){return this},hi=function(t,e,n,i,r,s,o){ei(n,e,i);var a,h,u,c=function(t){if(!oi&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},f=e+" Iterator",l="values"==r,d=!1,p=t.prototype,g=p[si]||p["@@iterator"]||r&&p[r],y=!oi&&g||c(r),v=r?l?c("entries"):y:void 0,m="Array"==e&&p.entries||g;if(m&&(u=ri(m.call(new t)))!==Object.prototype&&u.next&&Zn(u,f,!0),l&&g&&"values"!==g.name&&(d=!0,y=function(){return g.call(this)}),o&&(oi||d||!p[si])&&b(p,si,y),Vn[e]=y,Vn[f]=ai,r)if(a={values:l?y:c("values"),keys:s?y:c("keys"),entries:v},o)for(h in a)h in p||Mn(p,h,a[h]);else E(E.P+E.F*(oi||d),e,a);return a},ui=(ti=!0,function(t,e){var n,i,r=String(D(t)),s=H(e),o=r.length;return s<0||s>=o?ti?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===o||(i=r.charCodeAt(s+1))<56320||i>57343?ti?r.charAt(s):n:ti?r.slice(s,s+2):i-56320+(n-55296<<10)+65536});hi(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ui(e,n),this._i+=t.length,{value:t,done:!1})});var ci=function(t,e){return{value:e,done:!!t}};hi(Array,"Array",function(t,e){this._t=I(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,ci(1)):ci(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Vn.Arguments=Vn.Array;for(var fi=Gn("toStringTag"),li="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),di=0;di<li.length;di++){var pi=li[di],gi=r[pi],yi=gi&&gi.prototype;yi&&!yi[fi]&&b(yi,fi,pi),Vn[pi]=Vn.Array}var vi={f:Gn},mi=vi.f("iterator"),wi=i(function(t){t.exports={default:mi,__esModule:!0}});n(wi);var bi=i(function(t){var e=K("meta"),n=m.f,i=0,r=Object.isExtensible||function(){return!0},s=!c(function(){return r(Object.preventExtensions({}))}),o=function(t){n(t,e,{value:{i:"O"+ ++i,w:{}}})},a=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!h(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!A(t,e)){if(!r(t))return"F";if(!n)return"E";o(t)}return t[e].i},getWeak:function(t,n){if(!A(t,e)){if(!r(t))return!0;if(!n)return!1;o(t)}return t[e].w},onFreeze:function(t){return s&&a.NEED&&r(t)&&!A(t,e)&&o(t),t}}}),Si=(bi.KEY,bi.NEED,bi.fastKey,bi.getWeak,bi.onFreeze,m.f),xi=function(t){var e=s.Symbol||(s.Symbol={});"_"==t.charAt(0)||t in e||Si(e,t,{value:vi.f(t)})},Ei=Array.isArray||function(t){return"Array"==T(t)},Fi=J.concat("length","prototype"),Ai={f:Object.getOwnPropertyNames||function(t){return W(t,Fi)}},Ci=Ai.f,Ti={}.toString,Pi="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Di={f:function(t){return Pi&&"[object Window]"==Ti.call(t)?function(t){try{return Ci(t)}catch(t){return Pi.slice()}}(t):Ci(I(t))}},Ii=Object.getOwnPropertyDescriptor,Ri={f:f?Ii:function(t,e){if(t=I(t),e=y(e,!0),g)try{return Ii(t,e)}catch(t){}if(A(t,e))return w(!$.f.call(t,e),t[e])}},Bi=bi.KEY,Hi=Ri.f,_i=m.f,Ni=Di.f,Oi=r.Symbol,ki=r.JSON,ji=ki&&ki.stringify,Li=Gn("_hidden"),Mi=Gn("toPrimitive"),Vi={}.propertyIsEnumerable,Ki=L("symbol-registry"),Ui=L("symbols"),qi=L("op-symbols"),zi=Object.prototype,Yi="function"==typeof Oi,Wi=r.QObject,Ji=!Wi||!Wi.prototype||!Wi.prototype.findChild,Gi=f&&c(function(){return 7!=Jn(_i({},"a",{get:function(){return _i(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=Hi(zi,e);i&&delete zi[e],_i(t,e,n),i&&t!==zi&&_i(zi,e,i)}:_i,Xi=function(t){var e=Ui[t]=Jn(Oi.prototype);return e._k=t,e},$i=Yi&&"symbol"==typeof Oi.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof Oi},Zi=function(t,e,n){return t===zi&&Zi(qi,e,n),u(t),e=y(e,!0),u(n),A(Ui,e)?(n.enumerable?(A(t,Li)&&t[Li][e]&&(t[Li][e]=!1),n=Jn(n,{enumerable:w(0,!1)})):(A(t,Li)||_i(t,Li,w(1,{})),t[Li][e]=!0),Gi(t,e,n)):_i(t,e,n)},Qi=function(t,e){u(t);for(var n,i=function(t){var e=G(t),n=X.f;if(n)for(var i,r=n(t),s=$.f,o=0;r.length>o;)s.call(t,i=r[o++])&&e.push(i);return e}(e=I(e)),r=0,s=i.length;s>r;)Zi(t,n=i[r++],e[n]);return t},tr=function(t){var e=Vi.call(this,t=y(t,!0));return!(this===zi&&A(Ui,t)&&!A(qi,t))&&(!(e||!A(this,t)||!A(Ui,t)||A(this,Li)&&this[Li][t])||e)},er=function(t,e){if(t=I(t),e=y(e,!0),t!==zi||!A(Ui,e)||A(qi,e)){var n=Hi(t,e);return!n||!A(Ui,e)||A(t,Li)&&t[Li][e]||(n.enumerable=!0),n}},nr=function(t){for(var e,n=Ni(I(t)),i=[],r=0;n.length>r;)A(Ui,e=n[r++])||e==Li||e==Bi||i.push(e);return i},ir=function(t){for(var e,n=t===zi,i=Ni(n?qi:I(t)),r=[],s=0;i.length>s;)!A(Ui,e=i[s++])||n&&!A(zi,e)||r.push(Ui[e]);return r};Yi||(Mn((Oi=function(){if(this instanceof Oi)throw TypeError("Symbol is not a constructor!");var t=K(arguments.length>0?arguments[0]:void 0),e=function(n){this===zi&&e.call(qi,n),A(this,Li)&&A(this[Li],t)&&(this[Li][t]=!1),Gi(this,t,w(1,n))};return f&&Ji&&Gi(zi,t,{configurable:!0,set:e}),Xi(t)}).prototype,"toString",function(){return this._k}),Ri.f=er,m.f=Zi,Ai.f=Di.f=nr,$.f=tr,X.f=ir,vi.f=function(t){return Xi(Gn(t))}),E(E.G+E.W+E.F*!Yi,{Symbol:Oi});for(var rr="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),sr=0;rr.length>sr;)Gn(rr[sr++]);for(var or=G(Gn.store),ar=0;or.length>ar;)xi(or[ar++]);E(E.S+E.F*!Yi,"Symbol",{for:function(t){return A(Ki,t+="")?Ki[t]:Ki[t]=Oi(t)},keyFor:function(t){if(!$i(t))throw TypeError(t+" is not a symbol!");for(var e in Ki)if(Ki[e]===t)return e},useSetter:function(){Ji=!0},useSimple:function(){Ji=!1}}),E(E.S+E.F*!Yi,"Object",{create:function(t,e){return void 0===e?Jn(t):Qi(Jn(t),e)},defineProperty:Zi,defineProperties:Qi,getOwnPropertyDescriptor:er,getOwnPropertyNames:nr,getOwnPropertySymbols:ir}),ki&&E(E.S+E.F*(!Yi||c(function(){var t=Oi();return"[null]"!=ji([t])||"{}"!=ji({a:t})||"{}"!=ji(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(h(e)||void 0!==t)&&!$i(t))return Ei(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!$i(e))return e}),i[1]=e,ji.apply(ki,i)}}),Oi.prototype[Mi]||b(Oi.prototype,Mi,Oi.prototype.valueOf),Zn(Oi,"Symbol"),Zn(Math,"Math",!0),Zn(r.JSON,"JSON",!0),xi("asyncIterator"),xi("observable");var hr=s.Symbol,ur=i(function(t){t.exports={default:hr,__esModule:!0}});n(ur);var cr=i(function(t,e){e.__esModule=!0;var n=s(wi),i=s(ur),r="function"==typeof i.default&&"symbol"==typeof n.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof i.default&&"symbol"===r(n.default)?function(t){return void 0===t?"undefined":r(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":r(t)}});n(cr);var fr=n(i(function(t,e){e.__esModule=!0;var n,i=(n=cr)&&n.__esModule?n:{default:n};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}})),lr=function(t,e){if(u(t),!h(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},dr={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=a(Function.call,Ri.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return lr(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:lr};E(E.S,"Object",{setPrototypeOf:dr.set});var pr=s.Object.setPrototypeOf,gr=i(function(t){t.exports={default:pr,__esModule:!0}});n(gr),E(E.S,"Object",{create:Jn});var yr=s.Object,vr=function(t,e){return yr.create(t,e)},mr=i(function(t){t.exports={default:vr,__esModule:!0}});n(mr);var wr,br,Sr,xr=n(i(function(t,e){e.__esModule=!0;var n=s(gr),i=s(mr),r=s(cr);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,r.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}})),Er=Gn("toStringTag"),Fr="Arguments"==T(function(){return arguments}()),Ar=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),Er))?n:Fr?T(e):"Object"==(i=T(e))&&"function"==typeof e.callee?"Arguments":i},Cr=function(t,e,n,i){try{return i?e(u(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&u(r.call(t)),e}},Tr=Gn("iterator"),Pr=Array.prototype,Dr=Gn("iterator"),Ir=s.getIteratorMethod=function(t){if(null!=t)return t[Dr]||t["@@iterator"]||Vn[Ar(t)]},Rr=i(function(t){var e={},n={},i=t.exports=function(t,i,r,s,o){var h,c,f,l,d,p=o?function(){return t}:Ir(t),g=a(r,s,i?2:1),y=0;if("function"!=typeof p)throw TypeError(t+" is not iterable!");if(void 0===(d=p)||Vn.Array!==d&&Pr[Tr]!==d){for(f=p.call(t);!(c=f.next()).done;)if((l=Cr(f,g,c.value,i))===e||l===n)return l}else for(h=N(t.length);h>y;y++)if((l=i?g(u(c=t[y])[0],c[1]):g(t[y]))===e||l===n)return l};i.BREAK=e,i.RETURN=n}),Br=Gn("species"),Hr=function(t,e){var n,i=u(t).constructor;return void 0===i||null==(n=u(i)[Br])?e:o(n)},_r=r.process,Nr=r.setImmediate,Or=r.clearImmediate,kr=r.MessageChannel,jr=r.Dispatch,Lr=0,Mr={},Vr=function(){var t=+this;if(Mr.hasOwnProperty(t)){var e=Mr[t];delete Mr[t],e()}},Kr=function(t){Vr.call(t.data)};Nr&&Or||(Nr=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return Mr[++Lr]=function(){!function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}t.apply(n,e)}("function"==typeof t?t:Function(t),e)},wr(Lr),Lr},Or=function(t){delete Mr[t]},"process"==T(_r)?wr=function(t){_r.nextTick(a(Vr,t,1))}:jr&&jr.now?wr=function(t){jr.now(a(Vr,t,1))}:kr?(Sr=(br=new kr).port2,br.port1.onmessage=Kr,wr=a(Sr.postMessage,Sr,1)):r.addEventListener&&"function"==typeof postMessage&&!r.importScripts?(wr=function(t){r.postMessage(t+"","*")},r.addEventListener("message",Kr,!1)):wr="onreadystatechange"in p("script")?function(t){qn.appendChild(p("script")).onreadystatechange=function(){qn.removeChild(this),Vr.call(t)}}:function(t){setTimeout(a(Vr,t,1),0)});var Ur={set:Nr,clear:Or},qr=Ur.set,zr=r.MutationObserver||r.WebKitMutationObserver,Yr=r.process,Wr=r.Promise,Jr="process"==T(Yr);function Gr(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=o(e),this.reject=o(n)}var Xr={f:function(t){return new Gr(t)}},$r=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Zr=function(t,e){if(u(t),h(e)&&e.constructor===t)return e;var n=Xr.f(t);return(0,n.resolve)(e),n.promise},Qr=Gn("species"),ts=Gn("iterator"),es=!1;try{[7][ts]().return=function(){es=!0}}catch(t){}var ns,is,rs,ss,os,as,hs=Ur.set,us=function(){var t,e,n,i=function(){var i,r;for(Jr&&(i=Yr.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(Jr)n=function(){Yr.nextTick(i)};else if(!zr||r.navigator&&r.navigator.standalone)if(Wr&&Wr.resolve){var s=Wr.resolve();n=function(){s.then(i)}}else n=function(){qr.call(r,i)};else{var o=!0,a=document.createTextNode("");new zr(i).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}(),cs=r.TypeError,fs=r.process,ls=r.Promise,ds="process"==Ar(fs),ps=function(){},gs=is=Xr.f,ys=!!function(){try{var t=ls.resolve(1),e=(t.constructor={})[Gn("species")]=function(t){t(ps,ps)};return(ds||"function"==typeof PromiseRejectionEvent)&&t.then(ps)instanceof e}catch(t){}}(),vs=function(t){var e;return!(!h(t)||"function"!=typeof(e=t.then))&&e},ms=function(t,e){if(!t._n){t._n=!0;var n=t._c;us(function(){for(var i=t._v,r=1==t._s,s=0,o=function(e){var n,s,o=r?e.ok:e.fail,a=e.resolve,h=e.reject,u=e.domain;try{o?(r||(2==t._h&&Ss(t),t._h=1),!0===o?n=i:(u&&u.enter(),n=o(i),u&&u.exit()),n===e.promise?h(cs("Promise-chain cycle")):(s=vs(n))?s.call(n,a,h):a(n)):h(i)}catch(t){h(t)}};n.length>s;)o(n[s++]);t._c=[],t._n=!1,e&&!t._h&&ws(t)})}},ws=function(t){hs.call(r,function(){var e,n,i,s=t._v,o=bs(t);if(o&&(e=$r(function(){ds?fs.emit("unhandledRejection",s,t):(n=r.onunhandledrejection)?n({promise:t,reason:s}):(i=r.console)&&i.error&&i.error("Unhandled promise rejection",s)}),t._h=ds||bs(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},bs=function(t){return 1!==t._h&&0===(t._a||t._c).length},Ss=function(t){hs.call(r,function(){var e;ds?fs.emit("rejectionHandled",t):(e=r.onrejectionhandled)&&e({promise:t,reason:t._v})})},xs=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),ms(e,!0))},Es=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw cs("Promise can't be resolved itself");(e=vs(t))?us(function(){var i={_w:n,_d:!1};try{e.call(t,a(Es,i,1),a(xs,i,1))}catch(t){xs.call(i,t)}}):(n._v=t,n._s=1,ms(n,!1))}catch(t){xs.call({_w:n,_d:!1},t)}}};ys||(ls=function(t){!function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!")}(this,ls,"Promise","_h"),o(t),ns.call(this);try{t(a(Es,this,1),a(xs,this,1))}catch(t){xs.call(this,t)}},(ns=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:b(t,i,e[i]);return t}(ls.prototype,{then:function(t,e){var n=gs(Hr(this,ls));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=ds?fs.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&ms(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),rs=function(){var t=new ns;this.promise=t,this.resolve=a(Es,t,1),this.reject=a(xs,t,1)},Xr.f=gs=function(t){return t===ls||t===ss?new rs(t):is(t)}),E(E.G+E.W+E.F*!ys,{Promise:ls}),Zn(ls,"Promise"),as="function"==typeof s[os="Promise"]?s[os]:r[os],f&&as&&!as[Qr]&&m.f(as,Qr,{configurable:!0,get:function(){return this}}),ss=s.Promise,E(E.S+E.F*!ys,"Promise",{reject:function(t){var e=gs(this);return(0,e.reject)(t),e.promise}}),E(E.S+!0*E.F,"Promise",{resolve:function(t){return Zr(this===ss?ls:this,t)}}),E(E.S+E.F*!(ys&&function(t,e){if(!e&&!es)return!1;var n=!1;try{var i=[7],r=i[ts]();r.next=function(){return{done:n=!0}},i[ts]=function(){return r},t(i)}catch(t){}return n}(function(t){ls.all(t).catch(ps)})),"Promise",{all:function(t){var e=this,n=gs(e),i=n.resolve,r=n.reject,s=$r(function(){var n=[],s=0,o=1;Rr(t,!1,function(t){var a=s++,h=!1;n.push(void 0),o++,e.resolve(t).then(function(t){h||(h=!0,n[a]=t,--o||i(n))},r)}),--o||i(n)});return s.e&&r(s.v),n.promise},race:function(t){var e=this,n=gs(e),i=n.reject,r=$r(function(){Rr(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}}),E(E.P+E.R,"Promise",{finally:function(t){var e=Hr(this,s.Promise||r.Promise),n="function"==typeof t;return this.then(n?function(n){return Zr(e,t()).then(function(){return n})}:t,n?function(n){return Zr(e,t()).then(function(){throw n})}:t)}}),E(E.S,"Promise",{try:function(t){var e=Xr.f(this),n=$r(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var Fs=s.Promise,As=n(i(function(t){t.exports={default:Fs,__esModule:!0}})),Cs=void 0,Ts=!1;try{Ts="[object process]"===Object.prototype.toString.call(rt.process)}catch(t){}var Ps={isNode:Ts,getPubKeyASN1:function(t){"P-256"===t.curveName&&(t.curveName="secp256r1");var e=Rn.getPEM(t);return Bn(e)},generateKeyPair:function(){return Rn.generateKeypair("EC","secp256r1")},jwkToPrvKey:function(t){var e=Rn.getKey(t);return e.pubKeyASN1=this.getPubKeyASN1(e),e.keyID=this.getHash(e.pubKeyASN1),e},generateKey:function(){var t=this.generateKeyPair();return t.prvKeyObj.pubKeyASN1=this.getPubKeyASN1(t.pubKeyObj),t.prvKeyObj.keyID=this.getHash(t.prvKeyObj.pubKeyASN1),t.prvKeyObj},prvKeyToJwk:function(t){return Rn.getJWKFromKey(t)},getHash:function(t){return new mt(new In({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},_generateAndSerializeKey:function(){return Cs=this.generateKey(),jn(this.prvKeyToJwk(Cs))},getDefaultKey:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";if(Cs)return Cs;if(Ts){var e=require("fs"),n=t+"/private.key";if(e.existsSync(n)){var i=e.readFileSync(n,"utf8"),r=JSON.parse(i);Cs=this.jwkToPrvKey(r)}else e.writeFileSync(n,this._generateAndSerializeKey()),e.chmodSync(n,400)}else{var s=window.localStorage.getItem("identifi.myKey");s?Cs=this.jwkToPrvKey(JSON.parse(s)):window.localStorage.setItem("identifi.myKey",this._generateAndSerializeKey())}return Cs},timeoutPromise:function(t,e){return As.race([t,new As(function(t){setTimeout(function(){t()},e)})])}};!function(t,e){var n=(s.Object||{})[t]||Object[t],i={};i[t]=e(n),E(E.S+E.F*c(function(){n(1)}),"Object",i)}("keys",function(){return function(t){return G(Z(t))}});var Ds=s.Object.keys,Is=n(i(function(t){t.exports={default:Ds,__esModule:!0}}));E(E.S,"Number",{isNaN:function(t){return t!=t}});var Rs=s.Number.isNaN,Bs=n(i(function(t){t.exports={default:Rs,__esModule:!0}})),Hs=i(function(t){!function(){function e(t,e){for(var n=2;n<arguments.length;n++)for(var i=0;i<arguments[n].length;i++)t[e++]=arguments[n].charAt(i)}function n(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function i(t){return String.fromCharCode(255&t,t>>8&255)}t.exports=function(t,r,s){this.width=t,this.height=r,this.depth=s,this.pix_size=r*(t+1),this.data_size=2+this.pix_size+5*Math.floor((65534+this.pix_size)/65535)+4,this.ihdr_offs=0,this.ihdr_size=25,this.plte_offs=this.ihdr_offs+this.ihdr_size,this.plte_size=8+3*s+4,this.trns_offs=this.plte_offs+this.plte_size,this.trns_size=8+s+4,this.idat_offs=this.trns_offs+this.trns_size,this.idat_size=8+this.data_size+4,this.iend_offs=this.idat_offs+this.idat_size,this.iend_size=12,this.buffer_size=this.iend_offs+this.iend_size,this.buffer=new Array,this.palette=new Object,this.pindex=0;for(var o=new Array,a=0;a<this.buffer_size;a++)this.buffer[a]="\0";e(this.buffer,this.ihdr_offs,n(this.ihdr_size-12),"IHDR",n(t),n(r),"\b"),e(this.buffer,this.plte_offs,n(this.plte_size-12),"PLTE"),e(this.buffer,this.trns_offs,n(this.trns_size-12),"tRNS"),e(this.buffer,this.idat_offs,n(this.idat_size-12),"IDAT"),e(this.buffer,this.iend_offs,n(this.iend_size-12),"IEND");var h,u=30912;u+=31-u%31,e(this.buffer,this.idat_offs+8,(h=u,String.fromCharCode(h>>8&255,255&h)));for(a=0;(a<<16)-1<this.pix_size;a++){var c,f;a+65535<this.pix_size?(c=65535,f="\0"):(c=this.pix_size-(a<<16)-a,f=""),e(this.buffer,this.idat_offs+8+2+(a<<16)+(a<<2),f,i(c),i(~c))}for(a=0;a<256;a++){for(var l=a,d=0;d<8;d++)l=1&l?-306674912^l>>1&2147483647:l>>1&2147483647;o[a]=l}this.index=function(t,e){var n=e*(this.width+1)+t+1;return this.idat_offs+8+2+5*Math.floor(n/65535+1)+n},this.color=function(t,e,n,i){var r=(((i=i>=0?i:255)<<8|t)<<8|e)<<8|n;if(void 0===this.palette[r]){if(this.pindex==this.depth)return"\0";var s=this.plte_offs+8+3*this.pindex;this.buffer[s+0]=String.fromCharCode(t),this.buffer[s+1]=String.fromCharCode(e),this.buffer[s+2]=String.fromCharCode(n),this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(i),this.palette[r]=String.fromCharCode(this.pindex++)}return this.palette[r]},this.getBase64=function(){var t,e,n,i,r,s,o,a=this.getDump(),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u=a.length,c=0,f="";do{i=(t=a.charCodeAt(c))>>2,r=(3&t)<<4|(e=a.charCodeAt(c+1))>>4,n=a.charCodeAt(c+2),s=u<c+2?64:(15&e)<<2|n>>6,o=u<c+3?64:63&n,f+=h.charAt(i)+h.charAt(r)+h.charAt(s)+h.charAt(o)}while((c+=3)<u);return f},this.getDump=function(){for(var t=1,i=0,r=5552,s=0;s<this.height;s++)for(var a=-1;a<this.width;a++)i+=t+=this.buffer[this.index(a,s)].charCodeAt(0),0==(r-=1)&&(t%=65521,i%=65521,r=5552);function h(t,i,r){for(var s=-1,a=4;a<r-4;a+=1)s=o[255&(s^t[i+a].charCodeAt(0))]^s>>8&16777215;e(t,i+r-4,n(-1^s))}return t%=65521,i%=65521,e(this.buffer,this.idat_offs+this.idat_size-8,n(i<<16|t)),h(this.buffer,this.ihdr_offs,this.ihdr_size),h(this.buffer,this.plte_offs,this.plte_size),h(this.buffer,this.trns_offs,this.trns_size),h(this.buffer,this.idat_offs,this.idat_size),h(this.buffer,this.iend_offs,this.iend_size),"PNG\r\n\n"+this.buffer.join("")}}}()}),_s=i(function(t){!function(){var e;e=Hs;var n=function(t,e){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof e?e:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var n=parseInt(this.hash.substr(-7),16)/268435455,i=this.options.saturation||this.defaults.saturation,r=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(n,i,r)};n.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new i(this.size,this.foreground,this.background):new e(this.size,this.size,256)},render:function(){var t,e,n=this.image(),i=this.size,r=Math.floor(i*this.margin),s=Math.floor((i-2*r)/5),o=Math.floor((i-5*s)/2),a=n.color.apply(n,this.background),h=n.color.apply(n,this.foreground);for(t=0;t<15;t++)e=parseInt(this.hash.charAt(t),16)%2?a:h,t<5?this.rectangle(2*s+o,t*s+o,s,s,e,n):t<10?(this.rectangle(1*s+o,(t-5)*s+o,s,s,e,n),this.rectangle(3*s+o,(t-5)*s+o,s,s,e,n)):t<15&&(this.rectangle(0*s+o,(t-10)*s+o,s,s,e,n),this.rectangle(4*s+o,(t-10)*s+o,s,s,e,n));return n},rectangle:function(t,e,n,i,r,s){var o,a;if(this.isSvg())s.rectangles.push({x:t,y:e,w:n,h:i,color:r});else for(o=t;o<t+n;o++)for(a=e;a<e+i;a++)s.buffer[s.index(o,a)]=r},hsl2rgb:function(t,e,n){return[255*(e=[n+=e*=n<.5?n:1-n,n-(t*=6)%1*e*2,n-=e*=2,n,n+t%1*e,n+e])[~~t%6],255*e[(16|t)%6],255*e[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var i=function(t,e,n){this.size=t,this.foreground=this.color.apply(this,e),this.background=this.color.apply(this,n),this.rectangles=[]};i.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,e,n,i){var r=[t,e,n].map(Math.round);return r.push(i>=0&&i<=255?i/255:1),"rgba("+r.join(",")+")"},getDump:function(){var t,e,n,i=this.foreground,r=this.background,s=.005*this.size;for(e="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+r+";'><g style='fill:"+i+"; stroke:"+i+"; stroke-width:"+s+";'>",t=0;t<this.rectangles.length;t++)(n=this.rectangles[t]).color!=r&&(e+="<rect  x='"+n.x+"' y='"+n.y+"' width='"+n.w+"' height='"+n.h+"'/>");return e+="</g></svg>"},getBase64:function(){if(btoa)return btoa(this.getDump());if(mt)return new mt(this.getDump(),"binary").toString("base64");throw"Cannot generate base64 output"}},t.exports=n}()}),Ns={email:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,bitcoin:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,bitcoin_address:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,ip:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/,ipv6:/^(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/,gpg_fingerprint:null,gpg_keyid:null,google_oauth2:null,tel:/^\d{7,}$/,phone:/^\d{7,}$/,keyID:null,url:/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,account:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i},Os=function(){function t(e){if(Ln(this,t),e.hasOwnProperty("val"))if(this.val=e.val,e.hasOwnProperty("name"))this.name=e.name;else{var n=t.guessTypeOf(this.val);if(!n)throw new Error("Type of attribute was omitted and could not be guessed");this.name=n}else{if(!Array.isArray(e))throw new Error("Invalid attribute data",e);if(2!==e.length)throw new Error("Invalid Attribute");this.name=e[0],this.val=e[1]}}return t.getUniqueIdValidators=function(){return Ns},t.isUniqueType=function(t){return Is(Ns).indexOf(t)>-1},t.guessTypeOf=function(t){for(var e in Ns)if(t.match(Ns[e]))return e},t.equals=function(e,n){return new t(e).equals(new t(n))},t.prototype.toArray=function(){return[this.name,this.val]},t.prototype.equals=function(t){return this.name===t.name&&this.val===t.val},t}(),ks=function(){function t(e){var n=this;if(Ln(this,t),this.data=e,this.profile={},this.mostVerifiedAttributes={},e.attrs.length){var i=e.attrs[0];void 0!==i.pos&&void 0!==i.neg&&void 0!==i.neut&&(this.data.receivedPositive=i.pos,this.data.receivedNegative=i.neg,this.data.receivedNeutral=i.neut)}this.data.receivedNegative|=0,this.data.receivedPositive|=0,this.data.receivedNeutral|=0,this.data.sentNegative|=0,this.data.sentPositive|=0,this.data.sentNeutral|=0,this.data.trustDistance=this.data.hasOwnProperty("trustDistance")?this.data.trustDistance:99,this.data.attrs.forEach(function(t){switch(!n.linkTo&&Os.isUniqueType(t.name)&&(n.linkTo=t),!Bs(parseInt(t.dist))&&t.dist>=0&&t.dist<n.data.trustDistance&&(n.data.trustDistance=parseInt(t.dist),Os.isUniqueType(t.name)&&(n.linkTo=t)),t.name){case"email":t.iconStyle="glyphicon glyphicon-envelope",t.btnStyle="btn-success",t.link="mailto:"+t.val,t.quickContact=!0;break;case"bitcoin_address":case"bitcoin":t.iconStyle="fa fa-bitcoin",t.btnStyle="btn-primary",t.link="https://blockchain.info/address/"+t.val,t.quickContact=!0;break;case"gpg_fingerprint":case"gpg_keyid":t.iconStyle="fa fa-key",t.btnStyle="btn-default",t.link="https://pgp.mit.edu/pks/lookup?op=get&search=0x"+t.val;break;case"account":t.iconStyle="fa fa-at";break;case"nickname":case"name":t.iconStyle="glyphicon glyphicon-font";break;case"tel":case"phone":t.iconStyle="glyphicon glyphicon-earphone",t.btnStyle="btn-success",t.link="tel:"+t.val,t.quickContact=!0;break;case"keyID":t.iconStyle="fa fa-key";break;case"url":t.link=t.val,t.val.indexOf("facebook.com/")>-1?(t.iconStyle="fa fa-facebook",t.btnStyle="btn-facebook",t.link=t.val,t.linkName=t.val.split("facebook.com/")[1],t.quickContact=!0):t.val.indexOf("twitter.com/")>-1?(t.iconStyle="fa fa-twitter",t.btnStyle="btn-twitter",t.link=t.val,t.linkName=t.val.split("twitter.com/")[1],t.quickContact=!0):t.val.indexOf("plus.google.com/")>-1?(t.iconStyle="fa fa-google-plus",t.btnStyle="btn-google-plus",t.link=t.val,t.linkName=t.val.split("plus.google.com/")[1],t.quickContact=!0):t.val.indexOf("linkedin.com/")>-1?(t.iconStyle="fa fa-linkedin",t.btnStyle="btn-linkedin",t.link=t.val,t.linkName=t.val.split("linkedin.com/")[1],t.quickContact=!0):t.val.indexOf("github.com/")>-1?(t.iconStyle="fa fa-github",t.btnStyle="btn-github",t.link=t.val,t.linkName=t.val.split("github.com/")[1],t.quickContact=!0):(t.iconStyle="glyphicon glyphicon-link",t.btnStyle="btn-default")}var e=Is(n.mostVerifiedAttributes).indexOf(t.name)>-1;2*t.conf>3*t.ref&&(!e||t.conf-t.ref>n.mostVerifiedAttributes[t.name].verificationScore)&&(n.mostVerifiedAttributes[t.name]={attribute:t,verificationScore:t.conf-t.ref})}),"keyID"!==this.linkTo.name&&this.mostVerifiedAttributes.keyID&&(this.linkTo=this.mostVerifiedAttributes.keyID.attribute),Is(this.mostVerifiedAttributes).forEach(function(t){["name","nickname","email","url","coverPhoto","profilePhoto"].indexOf(t)>-1&&(n.profile[t]=n.mostVerifiedAttributes[t].attribute.val)})}return t.prototype.verified=function(t){return this.mostVerifiedAttributes.hasOwnProperty(t)?this.mostVerifiedAttributes[t].attribute.val:void 0},t.prototype.profileCard=function(){var t=document.createElement("div");t.className="identifi-card";var e=this.identicon(60);e.style.order=1,e.style.flexShrink=0,e.style.marginRight="15px";var n=document.createElement("div");n.style.padding="5px",n.style.order=2,n.style.flexGrow=1;var i="https://identi.fi/#/identities/"+this.linkTo.name+"/"+this.linkTo.val;n.innerHTML='<a href="'+i+'">'+(this.profile.name||this.profile.nickname||this.linkTo.name+":"+this.linkTo.val)+"</a><br>",n.innerHTML+='<small>Received: <span class="identifi-pos">+'+(this.data.receivedPositive||0)+'</span> / <span class="identifi-neg">-'+(this.data.receivedNegative||0)+"</span></small><br>";var r=document.createElement("small");return this.data.attrs.forEach(function(t){t.link&&(r.innerHTML+=t.name+': <a href="'+t.link+'">'+t.val+"</a> ")}),n.appendChild(r),t.appendChild(e),t.appendChild(n),t},t.appendSearchWidget=function(t,e){var n=document.createElement("form"),i=document.createElement("input");i.type="text",i.placeholder="Search",i.id="identifiSearchInput",n.innerHTML+='<div id="identifiSearchResults"></div>';var r=document.createElement("div");t.appendChild(n),n.appendChild(i),n.appendChild(r),i.addEventListener("keyup",async function(){var t=await e.search(i.value);r.innerHTML="",t.sort(function(t,e){return t.trustDistance-e.trustDistance}),t.forEach(function(t){r.appendChild(t.profileCard())})})},t._ordinal=function(t){var e=["th","st","nd","rd"],n=t%100;return t+(e[(n-20)%10]||e[n]||e[0])},t._injectCss=function(){if(!document.getElementById("identifiStyle")){var t=document.createElement("style");t.id="identifiStyle",t.innerHTML="\n      .identifi-identicon * {\n        box-sizing: border-box;\n      }\n\n      .identifi-identicon {\n        vertical-align: middle;\n        margin: auto;\n        border-radius: 50%;\n        text-align: center;\n        display: inline-block;\n        position: relative;\n        margin: auto;\n        max-width: 100%;\n      }\n\n      .identifi-distance {\n        z-index: 2;\n        position: absolute;\n        left:0%;\n        top:2px;\n        width: 100%;\n        text-align: right;\n        color: #fff;\n        text-shadow: 0 0 1px #000;\n        font-size: 75%;\n        line-height: 75%;\n        font-weight: bold;\n      }\n\n      .identifi-pie {\n        border-radius: 50%;\n        position: absolute;\n        top: 0;\n        left: 0;\n        box-shadow: 0px 0px 0px 0px #82FF84;\n        padding-bottom: 100%;\n        max-width: 100%;\n        -webkit-transition: all 0.2s ease-in-out;\n        -moz-transition: all 0.2s ease-in-out;\n        transition: all 0.2s ease-in-out;\n      }\n\n      .identifi-card {\n        padding: 10px;\n        background-color: #f7f7f7;\n        color: #777;\n        border: 1px solid #ddd;\n        display: flex;\n        flex-direction: row;\n        overflow: hidden;\n      }\n\n      .identifi-card a {\n        -webkit-transition: color 150ms;\n        transition: color 150ms;\n        text-decoration: none;\n        color: #337ab7;\n      }\n\n      .identifi-card a:hover, .identifi-card a:active {\n        text-decoration: underline;\n        color: #23527c;\n      }\n\n      .identifi-pos {\n        color: #3c763d;\n      }\n\n      .identifi-neg {\n        color: #a94442;\n      }\n\n      .identifi-identicon img {\n        position: absolute;\n        top: 0;\n        left: 0;\n        max-width: 100%;\n        border-radius: 50%;\n        border-color: transparent;\n        border-style: solid;\n      }",document.body.appendChild(t)}},t.prototype.identicon=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t._injectCss();var r=document.createElement("div");r.className="identifi-identicon",r.style.width=e+"px",r.style.height=e+"px";var s="rgba(0,0,0,0.2)",o="none",a="",h="0px 0px 0px 0px #82FF84";this.data.receivedPositive>20*this.data.receivedNegative?h="0px 0px "+n*this.data.receivedPositive/50+"px 0px #82FF84":this.data.receivedPositive<3*this.data.receivedNegative&&(h="0px 0px "+n*this.data.receivedNegative/10+"px 0px #BF0400"),this.data.receivedPositive+this.data.receivedNegative>0&&(this.data.receivedPositive>this.data.receivedNegative?(a="rotate("+(-this.data.receivedPositive/(this.data.receivedPositive+this.data.receivedNegative)*360-180)/2+"deg)",s="#A94442",o="linear-gradient("+this.data.receivedPositive/(this.data.receivedPositive+this.data.receivedNegative)*360+"deg, transparent 50%, #3C763D 50%), linear-gradient(0deg, #3C763D 50%, transparent 50%)"):(a="rotate("+((-this.data.receivedNegative/(this.data.receivedPositive+this.data.receivedNegative)*360-180)/2+180)+"deg)",s="#3C763D",o="linear-gradient("+this.data.receivedNegative/(this.data.receivedPositive+this.data.receivedNegative)*360+"deg, transparent 50%, #A94442 50%), linear-gradient(0deg, #A94442 50%, transparent 50%)"));var u=document.createElement("div");u.className="identifi-pie",u.style.backgroundColor=s,u.style.backgroundImage=o,u.style.width=e+"px",u.style.boxShadow=h,u.style.opacity=(this.data.receivedPositive+this.data.receivedNegative)/10*.5+.35,u.style.transform=a;var c=new In({alg:"md5",prov:"cryptojs"}).digestString(jn(this.linkTo)),f=new _s(c,{width:e,format:"svg"}),l=document.createElement("img");if(l.src="data:image/svg+xml;base64,"+f.toString(),l.alt="",l.width=e,l.style.borderWidth=n+"px",i){var d=document.createElement("span");d.textContent=this.data.trustDistance<1e3?t._ordinal(this.data.trustDistance):"–",d.className="identifi-distance",d.style.fontSize=e>50?e/4+"px":"10px",r.appendChild(d)}return r.appendChild(u),r.appendChild(l),r},t}(),js="Invalid Identifi message:",Ls=function(t){function e(){return Ln(this,e),fr(this,t.apply(this,arguments))}return xr(e,t),e}(Error),Ms=function(){function t(e){Ln(this,t),this.signedData=e,this.validate()}return t.prototype.getSignerKeyID=function(){return Ps.getHash(this.jwsHeader.key||this.jwsHeader.kid)},t.prototype.validate=function(){if(!this.signedData)throw new Ls(js+" Missing signedData");if("object"!=typeof this.signedData)throw new Ls(js+" signedData must be an object");var t=this.signedData;if(!t.type)throw new Ls(js+" Missing type definition");if(!t.author)throw new Ls(js+" Missing author");if(!t.author.length)throw new Ls(js+" Author empty");var e=void 0,n=void 0;for(this.jwsHeader&&(this.signerKeyHash=this.getSignerKeyID()),e=0;e<t.author.length;e++){if(2!==t.author[e].length)throw new Ls(js+" Invalid author: "+t.author[e].toString());if("keyID"===t.author[e][0]){if(n)throw new Ls(js+" Author may have only one keyID");if(n=t.author[e][1],this.signerKeyHash&&n!==this.signerKeyHash)throw new Ls(js+" If message has a keyID author, it must be signed by the same key")}}if(!t.recipient)throw new Ls(js+" Missing recipient");if(!t.recipient.length)throw new Ls(js+" Author empty");for(e=0;e<t.recipient.length;e++)if(2!==t.recipient[e].length)throw new Ls(js+" Invalid recipient: "+t.recipient[e].toString());if(!t.timestamp)throw new Ls(js+" Missing timestamp");if(!Date.parse(t.timestamp))throw new Ls(js+" Invalid timestamp");if("rating"===t.type){if(isNaN(t.rating))throw new Ls(js+" Invalid rating");if(isNaN(t.maxRating))throw new Ls(js+" Invalid maxRating");if(isNaN(t.minRating))throw new Ls(js+" Invalid minRating");if(t.rating>t.maxRating)throw new Ls(js+" Rating is above maxRating");if(t.rating<t.minRating)throw new Ls(js+" Rating is below minRating");if("string"!=typeof t.context||!t.context.length)throw new Ls(js+" Rating messages must have a context field")}if(("verify_identity"===t.type||"unverify_identity"===t.type)&&t.recipient.length<2)throw new Ls(js+" At least 2 recipient attributes are needed for a connection / disconnection");return!0},t.prototype.isPositive=function(){return"rating"===this.signedData.type&&this.signedData.rating>(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNegative=function(){return"rating"===this.signedData.type&&this.signedData.rating<(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNeutral=function(){return"rating"===this.signedData.type&&this.signedData.rating===(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.sign=function(e,n){return this.jwsHeader={alg:"ES256",key:e.pubKeyASN1},this.jws=_n.JWS.sign(this.jwsHeader.alg,jn(this.jwsHeader),jn(this.signedData),e),n||t.validateJws(this.jws),this.getHash(),this},t.create=function(e,n){!e.author&&n&&(e.author=[["keyID",n.keyID]]),e.timestamp=e.timestamp||(new Date).toISOString(),e.context=e.context||"identifi";var i=new t(e);return n&&i.sign(n),i},t.createVerification=function(e,n){return e.type="verification",t.create(e,n)},t.createRating=function(e,n){return e.type="rating",e.maxRating=e.maxRating||10,e.minRating=e.minRating||-10,t.create(e,n)},t.fromJws=function(e){t.validateJws(e);var n=_n.JWS.parse(e),i=new t(n.payloadObj);return i.hash=t.getHash(e),i.jwsHeader=n.headerObj,i.jws=e,i},t.prototype.getAuthor=function(t){if(!t){var e=[];this.signedData.author.forEach(function(t){e.push({name:t[0],val:t[1]})});var n=new ks({attrs:e});return this.hasOwnProperty("authorPos")&&this.hasOwnProperty("authorNeg")&&(n.data.receivedPositive=this.authorPos,n.data.receivedNegative=this.authorNeg),this.hasOwnProperty("authorTrustDistance")&&(n.data.trustDistance=this.authorTrustDistance),this.authorName&&(n.profile.name=this.authorName),n}},t.prototype.getRecipient=function(t){if(!t){var e=[];this.signedData.recipient.forEach(function(t){e.push({name:t[0],val:t[1]})});var n=new ks({attrs:e});return this.hasOwnProperty("recipientPos")&&this.hasOwnProperty("recipientNeg")&&(n.data.receivedPositive=this.recipientPos,n.data.receivedNegative=this.recipientNeg),this.hasOwnProperty("recipientTrustDistance")&&(n.data.trustDistance=this.recipientTrustDistance),this.recipientName&&(n.profile.name=this.recipientName),n}},t.prototype.getHash=function(){return this.jws&&!this.hash&&(this.hash=t.getHash(this.jws)),this.hash},t.getHash=function(t){return new mt(new In({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},t.prototype.verify=function(){var e=this.jwsHeader.key||this.jwsHeader.kid,n=Hn.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY"),i=Rn.getKey(n);if(!_n.JWS.verify(this.jws,i,[this.jwsHeader.alg]))throw new Ls(js+" Invalid signature");if(this.hash){if(this.hash!==t.getHash(this.jws))throw new Ls(js+" Invalid message hash")}else this.getHash();return!0},t.validateJws=function(t){if("string"!=typeof t)throw new Ls(js+" Message JWS must be a string");if(t.length>1e4)throw new Ls(js+" Message JWS max length is 10000");return!0},t}(),Vs="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff",Ks="["+Vs+"]",Us=RegExp("^"+Ks+Ks+"*"),qs=RegExp(Ks+Ks+"*$"),zs=function(t,e,n){var i={},r=c(function(){return!!Vs[t]()||"​"!="​"[t]()}),s=i[t]=r?e(Ys):Vs[t];n&&(i[n]=s),E(E.P+E.F*r,"String",i)},Ys=zs.trim=function(t,e){return t=String(D(t)),1&e&&(t=t.replace(Us,"")),2&e&&(t=t.replace(qs,"")),t},Ws=zs,Js=r.parseInt,Gs=Ws.trim,Xs=/^[-+]?0[xX]/,$s=8!==Js(Vs+"08")||22!==Js(Vs+"0x16")?function(t,e){var n=Gs(String(t),3);return Js(n,e>>>0||(Xs.test(n)?16:10))}:Js;E(E.S+E.F*(Number.parseInt!=$s),"Number",{parseInt:$s});var Zs,Qs=parseInt,to=n(i(function(t){t.exports={default:Qs,__esModule:!0}})),eo=$.f,no=(Zs=!1,function(t){for(var e,n=I(t),i=G(n),r=i.length,s=0,o=[];r>s;)eo.call(n,e=i[s++])&&o.push(Zs?[e,n[e]]:n[e]);return o});E(E.S,"Object",{values:function(t){return no(t)}});var io=s.Object.values,ro=n(i(function(t){t.exports={default:io,__esModule:!0}})),so={},oo=Object.freeze({default:so});function ao(){throw new Error("setTimeout has not been defined")}function ho(){throw new Error("clearTimeout has not been defined")}var uo=ao,co=ho;function fo(t){if(uo===setTimeout)return setTimeout(t,0);if((uo===ao||!uo)&&setTimeout)return uo=setTimeout,setTimeout(t,0);try{return uo(t,0)}catch(e){try{return uo.call(null,t,0)}catch(e){return uo.call(this,t,0)}}}"function"==typeof rt.setTimeout&&(uo=setTimeout),"function"==typeof rt.clearTimeout&&(co=clearTimeout);var lo,po=[],go=!1,yo=-1;function vo(){go&&lo&&(go=!1,lo.length?po=lo.concat(po):yo=-1,po.length&&mo())}function mo(){if(!go){var t=fo(vo);go=!0;for(var e=po.length;e;){for(lo=po,po=[];++yo<e;)lo&&lo[yo].run();yo=-1,e=po.length}lo=null,go=!1,function(t){if(co===clearTimeout)return clearTimeout(t);if((co===ho||!co)&&clearTimeout)return co=clearTimeout,clearTimeout(t);try{co(t)}catch(e){try{return co.call(null,t)}catch(e){return co.call(this,t)}}}(t)}}function wo(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];po.push(new bo(t,e)),1!==po.length||go||fo(mo)}function bo(t,e){this.fun=t,this.array=e}bo.prototype.run=function(){this.fun.apply(null,this.array)};function So(){}var xo=So,Eo=So,Fo=So,Ao=So,Co=So,To=So,Po=So;var Do=rt.performance||{},Io=Do.now||Do.mozNow||Do.msNow||Do.oNow||Do.webkitNow||function(){return(new Date).getTime()};var Ro=new Date;var Bo,Ho,_o={nextTick:wo,title:"browser",browser:!0,env:{},argv:[],version:"",versions:{},on:xo,addListener:Eo,once:Fo,off:Ao,removeListener:Co,removeAllListeners:To,emit:Po,binding:function(t){throw new Error("process.binding is not supported")},cwd:function(){return"/"},chdir:function(t){throw new Error("process.chdir is not supported")},umask:function(){return 0},hrtime:function(t){var e=.001*Io.call(Do),n=Math.floor(e),i=Math.floor(e%1*1e9);return t&&(n-=t[0],(i-=t[1])<0&&(n--,i+=1e9)),[n,i]},platform:"browser",release:{},config:{},uptime:function(){return(new Date-Ro)/1e3}},No=qo(rt.fetch)&&qo(rt.ReadableStream);function Oo(t){Ho||(Ho=new rt.XMLHttpRequest).open("GET",rt.location.host?"/":"https://example.com");try{return Ho.responseType=t,Ho.responseType===t}catch(t){return!1}}var ko=void 0!==rt.ArrayBuffer,jo=ko&&qo(rt.ArrayBuffer.prototype.slice),Lo=ko&&Oo("arraybuffer"),Mo=!No&&jo&&Oo("ms-stream"),Vo=!No&&ko&&Oo("moz-chunked-arraybuffer"),Ko=qo(Ho.overrideMimeType),Uo=qo(rt.VBArray);function qo(t){return"function"==typeof t}Ho=null;var zo="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},Yo=/%[sdj%]/g;var Wo,Jo={};function Go(t,e){var n={seen:[],stylize:$o};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),ea(e)?n.showHidden=e:e&&function(t,e){if(!e||!oa(e))return t;var n=Object.keys(e),i=n.length;for(;i--;)t[n[i]]=e[n[i]]}(n,e),ra(n.showHidden)&&(n.showHidden=!1),ra(n.depth)&&(n.depth=2),ra(n.colors)&&(n.colors=!1),ra(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Xo),Zo(n,t,n.depth)}function Xo(t,e){var n=Go.styles[e];return n?"["+Go.colors[n][0]+"m"+t+"["+Go.colors[n][1]+"m":t}function $o(t,e){return t}function Zo(t,e,n){if(t.customInspect&&e&&ua(e.inspect)&&e.inspect!==Go&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(n,t);return ia(i)||(i=Zo(t,i,n)),i}var r=function(t,e){if(ra(e))return t.stylize("undefined","undefined");if(ia(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(i=e,"number"==typeof i)return t.stylize(""+e,"number");var i;if(ea(e))return t.stylize(""+e,"boolean");if(na(e))return t.stylize("null","null")}(t,e);if(r)return r;var s=Object.keys(e),o=function(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),ha(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return Qo(e);if(0===s.length){if(ua(e)){var a=e.name?": "+e.name:"";return t.stylize("[Function"+a+"]","special")}if(sa(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(aa(e))return t.stylize(Date.prototype.toString.call(e),"date");if(ha(e))return Qo(e)}var h,u,c="",f=!1,l=["{","}"];(h=e,Array.isArray(h)&&(f=!0,l=["[","]"]),ua(e))&&(c=" [Function"+(e.name?": "+e.name:"")+"]");return sa(e)&&(c=" "+RegExp.prototype.toString.call(e)),aa(e)&&(c=" "+Date.prototype.toUTCString.call(e)),ha(e)&&(c=" "+Qo(e)),0!==s.length||f&&0!=e.length?n<0?sa(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special"):(t.seen.push(e),u=f?function(t,e,n,i,r){for(var s=[],o=0,a=e.length;o<a;++o)fa(e,String(o))?s.push(ta(t,e,n,i,String(o),!0)):s.push("");return r.forEach(function(r){r.match(/^\d+$/)||s.push(ta(t,e,n,i,r,!0))}),s}(t,e,n,o,s):s.map(function(i){return ta(t,e,n,o,i,f)}),t.seen.pop(),function(t,e,n){if(t.reduce(function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,c,l)):l[0]+c+l[1]}function Qo(t){return"["+Error.prototype.toString.call(t)+"]"}function ta(t,e,n,i,r,s){var o,a,h;if((h=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?a=h.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):h.set&&(a=t.stylize("[Setter]","special")),fa(i,r)||(o="["+r+"]"),a||(t.seen.indexOf(h.value)<0?(a=na(n)?Zo(t,h.value,null):Zo(t,h.value,n-1)).indexOf("\n")>-1&&(a=s?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n")):a=t.stylize("[Circular]","special")),ra(o)){if(s&&r.match(/^\d+$/))return a;(o=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(o=o.substr(1,o.length-2),o=t.stylize(o,"name")):(o=o.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),o=t.stylize(o,"string"))}return o+": "+a}function ea(t){return"boolean"==typeof t}function na(t){return null===t}function ia(t){return"string"==typeof t}function ra(t){return void 0===t}function sa(t){return oa(t)&&"[object RegExp]"===ca(t)}function oa(t){return"object"==typeof t&&null!==t}function aa(t){return oa(t)&&"[object Date]"===ca(t)}function ha(t){return oa(t)&&("[object Error]"===ca(t)||t instanceof Error)}function ua(t){return"function"==typeof t}function ca(t){return Object.prototype.toString.call(t)}function fa(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function la(){}function da(){da.init.call(this)}function pa(t){return void 0===t._maxListeners?da.defaultMaxListeners:t._maxListeners}function ga(t,e,n,i){var r,s,o,a;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((s=t._events)?(s.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),o=s[e]):(s=t._events=new la,t._eventsCount=0),o){if("function"==typeof o?o=s[e]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),!o.warned&&(r=pa(t))&&r>0&&o.length>r){o.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+e+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=t,h.type=e,h.count=o.length,a=h,"function"==typeof console.warn?console.warn(a):console.log(a)}}else o=s[e]=n,++t._eventsCount;return t}function ya(t,e,n){var i=!1;function r(){t.removeListener(e,r),i||(i=!0,n.apply(t,arguments))}return r.listener=n,r}function va(t){var e=this._events;if(e){var n=e[t];if("function"==typeof n)return 1;if(n)return n.length}return 0}function ma(t,e){for(var n=new Array(e);e--;)n[e]=t[e];return n}function wa(){this.head=null,this.tail=null,this.length=0}Go.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},Go.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},la.prototype=Object.create(null),da.EventEmitter=da,da.usingDomains=!1,da.prototype.domain=void 0,da.prototype._events=void 0,da.prototype._maxListeners=void 0,da.defaultMaxListeners=10,da.init=function(){this.domain=null,da.usingDomains&&(void 0).active,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new la,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},da.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this},da.prototype.getMaxListeners=function(){return pa(this)},da.prototype.emit=function(t){var e,n,i,r,s,o,a,h="error"===t;if(o=this._events)h=h&&null==o.error;else if(!h)return!1;if(a=this.domain,h){if(e=arguments[1],!a){if(e instanceof Error)throw e;var u=new Error('Uncaught, unspecified "error" event. ('+e+")");throw u.context=e,u}return e||(e=new Error('Uncaught, unspecified "error" event')),e.domainEmitter=this,e.domain=a,e.domainThrown=!1,a.emit("error",e),!1}if(!(n=o[t]))return!1;var c="function"==typeof n;switch(i=arguments.length){case 1:!function(t,e,n){if(e)t.call(n);else for(var i=t.length,r=ma(t,i),s=0;s<i;++s)r[s].call(n)}(n,c,this);break;case 2:!function(t,e,n,i){if(e)t.call(n,i);else for(var r=t.length,s=ma(t,r),o=0;o<r;++o)s[o].call(n,i)}(n,c,this,arguments[1]);break;case 3:!function(t,e,n,i,r){if(e)t.call(n,i,r);else for(var s=t.length,o=ma(t,s),a=0;a<s;++a)o[a].call(n,i,r)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(t,e,n,i,r,s){if(e)t.call(n,i,r,s);else for(var o=t.length,a=ma(t,o),h=0;h<o;++h)a[h].call(n,i,r,s)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(r=new Array(i-1),s=1;s<i;s++)r[s-1]=arguments[s];!function(t,e,n,i){if(e)t.apply(n,i);else for(var r=t.length,s=ma(t,r),o=0;o<r;++o)s[o].apply(n,i)}(n,c,this,r)}return!0},da.prototype.addListener=function(t,e){return ga(this,t,e,!1)},da.prototype.on=da.prototype.addListener,da.prototype.prependListener=function(t,e){return ga(this,t,e,!0)},da.prototype.once=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.on(t,ya(this,t,e)),this},da.prototype.prependOnceListener=function(t,e){if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');return this.prependListener(t,ya(this,t,e)),this},da.prototype.removeListener=function(t,e){var n,i,r,s,o;if("function"!=typeof e)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[t]))return this;if(n===e||n.listener&&n.listener===e)0==--this._eventsCount?this._events=new la:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(r=-1,s=n.length;s-- >0;)if(n[s]===e||n[s].listener&&n[s].listener===e){o=n[s].listener,r=s;break}if(r<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new la,this;delete i[t]}else!function(t,e){for(var n=e,i=n+1,r=t.length;i<r;n+=1,i+=1)t[n]=t[i];t.pop()}(n,r);i.removeListener&&this.emit("removeListener",t,o||e)}return this},da.prototype.removeAllListeners=function(t){var e,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new la,this._eventsCount=0):n[t]&&(0==--this._eventsCount?this._events=new la:delete n[t]),this;if(0===arguments.length){for(var i,r=Object.keys(n),s=0;s<r.length;++s)"removeListener"!==(i=r[s])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=new la,this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(e)do{this.removeListener(t,e[e.length-1])}while(e[0]);return this},da.prototype.listeners=function(t){var e,n=this._events;return n&&(e=n[t])?"function"==typeof e?[e.listener||e]:function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(e):[]},da.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):va.call(t,e)},da.prototype.listenerCount=va,da.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]},wa.prototype.push=function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length},wa.prototype.unshift=function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length},wa.prototype.shift=function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}},wa.prototype.clear=function(){this.head=this.tail=null,this.length=0},wa.prototype.join=function(t){if(0===this.length)return"";for(var e=this.head,n=""+e.data;e=e.next;)n+=t+e.data;return n},wa.prototype.concat=function(t){if(0===this.length)return mt.alloc(0);if(1===this.length)return this.head.data;for(var e=mt.allocUnsafe(t>>>0),n=this.head,i=0;n;)n.data.copy(e,i),i+=n.data.length,n=n.next;return e};var ba=mt.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function Sa(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),function(t){if(t&&!ba(t))throw new Error("Unknown encoding: "+t)}(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=Ea;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=Fa;break;default:return void(this.write=xa)}this.charBuffer=new mt(6),this.charReceived=0,this.charLength=0}function xa(t){return t.toString(this.encoding)}function Ea(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function Fa(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}Sa.prototype.write=function(t){for(var e="";this.charLength;){var n=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(t=t.slice(n,t.length),!((r=(e=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(e.length-1))>=55296&&r<=56319)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived);var r;i=(e+=t.toString(this.encoding,0,i)).length-1;if((r=e.charCodeAt(i))>=55296&&r<=56319){var s=this.surrogateSize;return this.charLength+=s,this.charReceived+=s,this.charBuffer.copy(this.charBuffer,s,0,s),t.copy(this.charBuffer,0,0,s),e.substring(0,i)}return e},Sa.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(e<=2&&n>>4==14){this.charLength=3;break}if(e<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=e},Sa.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,i=this.charBuffer,r=this.encoding;e+=i.slice(0,n).toString(r)}return e},Ta.ReadableState=Ca;var Aa=function(t){ra(Wo)&&(Wo=_o.env.NODE_DEBUG||""),t=t.toUpperCase(),Jo[t]||(new RegExp("\\b"+t+"\\b","i").test(Wo)?Jo[t]=function(){var e=function(t){if(!ia(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(Go(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,r=i.length,s=String(t).replace(Yo,function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}}),o=i[n];n<r;o=i[++n])na(o)||!oa(o)?s+=" "+o:s+=" "+Go(o);return s}.apply(null,arguments);console.error("%s %d: %s",t,0,e)}:Jo[t]=function(){});return Jo[t]}("stream");function Ca(t,e){t=t||{},this.objectMode=!!t.objectMode,e instanceof eh&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=~~this.highWaterMark,this.buffer=new wa,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(this.decoder=new Sa(t.encoding),this.encoding=t.encoding)}function Ta(t){if(!(this instanceof Ta))return new Ta(t);this._readableState=new Ca(t,this),this.readable=!0,t&&"function"==typeof t.read&&(this._read=t.read),da.call(this)}function Pa(t,e,n,i,r){var s=function(t,e){var n=null;te(e)||"string"==typeof e||null==e||t.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));return n}(e,n);if(s)t.emit("error",s);else if(null===n)e.reading=!1,function(t,e){if(e.ended)return;if(e.decoder){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,Ra(t)}(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!r){var o=new Error("stream.push() after EOF");t.emit("error",o)}else if(e.endEmitted&&r){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else{var h;!e.decoder||r||i||(n=e.decoder.write(n),h=!e.objectMode&&0===n.length),r||(e.reading=!1),h||(e.flowing&&0===e.length&&!e.sync?(t.emit("data",n),t.read(0)):(e.length+=e.objectMode?1:n.length,r?e.buffer.unshift(n):e.buffer.push(n),e.needReadable&&Ra(t))),function(t,e){e.readingMore||(e.readingMore=!0,wo(Ha,t,e))}(t,e)}else r||(e.reading=!1);return function(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}(e)}zo(Ta,da),Ta.prototype.push=function(t,e){var n=this._readableState;return n.objectMode||"string"!=typeof t||(e=e||n.defaultEncoding)!==n.encoding&&(t=mt.from(t,e),e=""),Pa(this,n,t,e,!1)},Ta.prototype.unshift=function(t){return Pa(this,this._readableState,t,"",!0)},Ta.prototype.isPaused=function(){return!1===this._readableState.flowing},Ta.prototype.setEncoding=function(t){return this._readableState.decoder=new Sa(t),this._readableState.encoding=t,this};var Da=8388608;function Ia(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!=t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=function(t){return t>=Da?t=Da:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function Ra(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(Aa("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?wo(Ba,t):Ba(t))}function Ba(t){Aa("emit readable"),t.emit("readable"),Oa(t)}function Ha(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(Aa("maybeReadMore read 0"),t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function _a(t){Aa("readable nexttick read 0"),t.read(0)}function Na(t,e){e.reading||(Aa("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),Oa(t),e.flowing&&!e.reading&&t.read(0)}function Oa(t){var e=t._readableState;for(Aa("flow",e.flowing);e.flowing&&null!==t.read(););}function ka(t,e){return 0===e.length?null:(e.objectMode?n=e.buffer.shift():!t||t>=e.length?(n=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.head.data:e.buffer.concat(e.length),e.buffer.clear()):n=function(t,e,n){var i;t<e.head.data.length?(i=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):i=t===e.head.data.length?e.shift():n?function(t,e){var n=e.head,i=1,r=n.data;t-=r.length;for(;n=n.next;){var s=n.data,o=t>s.length?s.length:t;if(o===s.length?r+=s:r+=s.slice(0,t),0===(t-=o)){o===s.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=s.slice(o));break}++i}return e.length-=i,r}(t,e):function(t,e){var n=mt.allocUnsafe(t),i=e.head,r=1;i.data.copy(n),t-=i.data.length;for(;i=i.next;){var s=i.data,o=t>s.length?s.length:t;if(s.copy(n,n.length-t,0,o),0===(t-=o)){o===s.length?(++r,i.next?e.head=i.next:e.head=e.tail=null):(e.head=i,i.data=s.slice(o));break}++r}return e.length-=r,n}(t,e);return i}(t,e.buffer,e.decoder),n);var n}function ja(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,wo(La,e,t))}function La(t,e){t.endEmitted||0!==t.length||(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function Ma(t,e){for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n;return-1}function Va(){}function Ka(t,e,n){this.chunk=t,this.encoding=e,this.callback=n,this.next=null}function Ua(t,e){Object.defineProperty(this,"buffer",{get:function t(e,n){if(ra(rt.process))return function(){return t(e,n).apply(this,arguments)};var i=!1;return function(){return i||(console.error(n),i=!0),e.apply(this,arguments)}}(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),t=t||{},this.objectMode=!!t.objectMode,e instanceof eh&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=!1===t.decodeStrings;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){!function(t,e){var n=t._writableState,i=n.sync,r=n.writecb;if(function(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}(n),e)!function(t,e,n,i,r){--e.pendingcb,n?wo(r,i):r(i);t._writableState.errorEmitted=!0,t.emit("error",i)}(t,n,i,e,r);else{var s=Ja(n);s||n.corked||n.bufferProcessing||!n.bufferedRequest||Wa(t,n),i?wo(Ya,t,n,s,r):Ya(t,n,s,r)}}(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new $a(this)}function qa(t){if(!(this instanceof qa||this instanceof eh))return new qa(t);this._writableState=new Ua(t,this),this.writable=!0,t&&("function"==typeof t.write&&(this._write=t.write),"function"==typeof t.writev&&(this._writev=t.writev)),da.call(this)}function za(t,e,n,i,r,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,n?t._writev(r,e.onwrite):t._write(r,s,e.onwrite),e.sync=!1}function Ya(t,e,n,i){n||function(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}(t,e),e.pendingcb--,i(),Xa(t,e)}function Wa(t,e){e.bufferProcessing=!0;var n=e.bufferedRequest;if(t._writev&&n&&n.next){var i=e.bufferedRequestCount,r=new Array(i),s=e.corkedRequestsFree;s.entry=n;for(var o=0;n;)r[o]=n,n=n.next,o+=1;za(t,e,!0,e.length,r,"",s.finish),e.pendingcb++,e.lastBufferedRequest=null,s.next?(e.corkedRequestsFree=s.next,s.next=null):e.corkedRequestsFree=new $a(e)}else{for(;n;){var a=n.chunk,h=n.encoding,u=n.callback;if(za(t,e,!1,e.objectMode?1:a.length,a,h,u),n=n.next,e.writing)break}null===n&&(e.lastBufferedRequest=null)}e.bufferedRequestCount=0,e.bufferedRequest=n,e.bufferProcessing=!1}function Ja(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function Ga(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function Xa(t,e){var n=Ja(e);return n&&(0===e.pendingcb?(Ga(t,e),e.finished=!0,t.emit("finish")):Ga(t,e)),n}function $a(t){var e=this;this.next=null,this.entry=null,this.finish=function(n){var i=e.entry;for(e.entry=null;i;){var r=i.callback;t.pendingcb--,r(n),i=i.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}}Ta.prototype.read=function(t){Aa("read",t),t=parseInt(t,10);var e=this._readableState,n=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return Aa("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?ja(this):Ra(this),null;if(0===(t=Ia(t,e))&&e.ended)return 0===e.length&&ja(this),null;var i,r=e.needReadable;return Aa("need readable",r),(0===e.length||e.length-t<e.highWaterMark)&&Aa("length less than watermark",r=!0),e.ended||e.reading?Aa("reading or ended",r=!1):r&&(Aa("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=Ia(n,e))),null===(i=t>0?ka(t,e):null)?(e.needReadable=!0,t=0):e.length-=t,0===e.length&&(e.ended||(e.needReadable=!0),n!==t&&e.ended&&ja(this)),null!==i&&this.emit("data",i),i},Ta.prototype._read=function(t){this.emit("error",new Error("not implemented"))},Ta.prototype.pipe=function(t,e){var n=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t)}i.pipesCount+=1,Aa("pipe count=%d opts=%j",i.pipesCount,e);var r=!e||!1!==e.end?o:u;function s(t){Aa("onunpipe"),t===n&&u()}function o(){Aa("onend"),t.end()}i.endEmitted?wo(r):n.once("end",r),t.on("unpipe",s);var a=function(t){return function(){var e=t._readableState;Aa("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&t.listeners("data").length&&(e.flowing=!0,Oa(t))}}(n);t.on("drain",a);var h=!1;function u(){Aa("cleanup"),t.removeListener("close",d),t.removeListener("finish",p),t.removeListener("drain",a),t.removeListener("error",l),t.removeListener("unpipe",s),n.removeListener("end",o),n.removeListener("end",u),n.removeListener("data",f),h=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||a()}var c=!1;function f(e){Aa("ondata"),c=!1,!1!==t.write(e)||c||((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==Ma(i.pipes,t))&&!h&&(Aa("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,c=!0),n.pause())}function l(e){var n;Aa("onerror",e),g(),t.removeListener("error",l),0===(n="error",t.listeners(n).length)&&t.emit("error",e)}function d(){t.removeListener("finish",p),g()}function p(){Aa("onfinish"),t.removeListener("close",d),g()}function g(){Aa("unpipe"),n.unpipe(t)}return n.on("data",f),function(t,e,n){if("function"==typeof t.prependListener)return t.prependListener(e,n);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(n):t._events[e]=[n,t._events[e]]:t.on(e,n)}(t,"error",l),t.once("close",d),t.once("finish",p),t.emit("pipe",n),i.flowing||(Aa("pipe resume"),n.resume()),t},Ta.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var r=0;r<i;r++)n[r].emit("unpipe",this);return this}var s=Ma(e.pipes,t);return-1===s?this:(e.pipes.splice(s,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},Ta.prototype.on=function(t,e){var n=da.prototype.on.call(this,t,e);if("data"===t)!1!==this._readableState.flowing&&this.resume();else if("readable"===t){var i=this._readableState;i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.emittedReadable=!1,i.reading?i.length&&Ra(this):wo(_a,this))}return n},Ta.prototype.addListener=Ta.prototype.on,Ta.prototype.resume=function(){var t=this._readableState;return t.flowing||(Aa("resume"),t.flowing=!0,function(t,e){e.resumeScheduled||(e.resumeScheduled=!0,wo(Na,t,e))}(this,t)),this},Ta.prototype.pause=function(){return Aa("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(Aa("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Ta.prototype.wrap=function(t){var e=this._readableState,n=!1,i=this;for(var r in t.on("end",function(){if(Aa("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&i.push(t)}i.push(null)}),t.on("data",function(r){(Aa("wrapped data"),e.decoder&&(r=e.decoder.write(r)),e.objectMode&&null==r)||(e.objectMode||r&&r.length)&&(i.push(r)||(n=!0,t.pause()))}),t)void 0===this[r]&&"function"==typeof t[r]&&(this[r]=function(e){return function(){return t[e].apply(t,arguments)}}(r));return function(t,e){for(var n=0,i=t.length;n<i;n++)e(t[n],n)}(["error","close","destroy","pause","resume"],function(e){t.on(e,i.emit.bind(i,e))}),i._read=function(e){Aa("wrapped _read",e),n&&(n=!1,t.resume())},i},Ta._fromList=ka,qa.WritableState=Ua,zo(qa,da),Ua.prototype.getBuffer=function(){for(var t=this.bufferedRequest,e=[];t;)e.push(t),t=t.next;return e},qa.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},qa.prototype.write=function(t,e,n){var i=this._writableState,r=!1;return"function"==typeof e&&(n=e,e=null),mt.isBuffer(t)?e="buffer":e||(e=i.defaultEncoding),"function"!=typeof n&&(n=Va),i.ended?function(t,e){var n=new Error("write after end");t.emit("error",n),wo(e,n)}(this,n):function(t,e,n,i){var r=!0,s=!1;return null===n?s=new TypeError("May not write null values to stream"):mt.isBuffer(n)||"string"==typeof n||void 0===n||e.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s&&(t.emit("error",s),wo(i,s),r=!1),r}(this,i,t,n)&&(i.pendingcb++,r=function(t,e,n,i,r){n=function(t,e,n){return t.objectMode||!1===t.decodeStrings||"string"!=typeof e||(e=mt.from(e,n)),e}(e,n,i),mt.isBuffer(n)&&(i="buffer");var s=e.objectMode?1:n.length;e.length+=s;var o=e.length<e.highWaterMark;o||(e.needDrain=!0);if(e.writing||e.corked){var a=e.lastBufferedRequest;e.lastBufferedRequest=new Ka(n,i,r),a?a.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else za(t,e,!1,s,n,i,r);return o}(this,i,t,e,n)),r},qa.prototype.cork=function(){this._writableState.corked++},qa.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.bufferedRequest||Wa(this,t))},qa.prototype.setDefaultEncoding=function(t){if("string"==typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);return this._writableState.defaultEncoding=t,this},qa.prototype._write=function(t,e,n){n(new Error("not implemented"))},qa.prototype._writev=null,qa.prototype.end=function(t,e,n){var i=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),null!=t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(t,e,n){e.ending=!0,Xa(t,e),n&&(e.finished?wo(n):t.once("finish",n));e.ended=!0,t.writable=!1}(this,i,n)},zo(eh,Ta);for(var Za=Object.keys(qa.prototype),Qa=0;Qa<Za.length;Qa++){var th=Za[Qa];eh.prototype[th]||(eh.prototype[th]=qa.prototype[th])}function eh(t){if(!(this instanceof eh))return new eh(t);Ta.call(this,t),qa.call(this,t),t&&!1===t.readable&&(this.readable=!1),t&&!1===t.writable&&(this.writable=!1),this.allowHalfOpen=!0,t&&!1===t.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",nh)}function nh(){this.allowHalfOpen||this._writableState.ended||wo(ih,this)}function ih(t){t.end()}function rh(t){this.afterTransform=function(e,n){return function(t,e,n){var i=t._transformState;i.transforming=!1;var r=i.writecb;if(!r)return t.emit("error",new Error("no writecb in Transform class"));i.writechunk=null,i.writecb=null,null!=n&&t.push(n);r(e);var s=t._readableState;s.reading=!1,(s.needReadable||s.length<s.highWaterMark)&&t._read(s.highWaterMark)}(t,e,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function sh(t){if(!(this instanceof sh))return new sh(t);eh.call(this,t),this._transformState=new rh(this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"==typeof t.transform&&(this._transform=t.transform),"function"==typeof t.flush&&(this._flush=t.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(t){oh(e,t)}):oh(e)})}function oh(t,e){if(e)return t.emit("error",e);var n=t._writableState,i=t._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}function ah(t){if(!(this instanceof ah))return new ah(t);sh.call(this,t)}function hh(){da.call(this)}zo(sh,eh),sh.prototype.push=function(t,e){return this._transformState.needTransform=!1,eh.prototype.push.call(this,t,e)},sh.prototype._transform=function(t,e,n){throw new Error("Not implemented")},sh.prototype._write=function(t,e,n){var i=this._transformState;if(i.writecb=n,i.writechunk=t,i.writeencoding=e,!i.transforming){var r=this._readableState;(i.needTransform||r.needReadable||r.length<r.highWaterMark)&&this._read(r.highWaterMark)}},sh.prototype._read=function(t){var e=this._transformState;null!==e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0},zo(ah,sh),ah.prototype._transform=function(t,e,n){n(null,t)},zo(hh,da),hh.Readable=Ta,hh.Writable=qa,hh.Duplex=eh,hh.Transform=sh,hh.PassThrough=ah,hh.Stream=hh,hh.prototype.pipe=function(t,e){var n=this;function i(e){t.writable&&!1===t.write(e)&&n.pause&&n.pause()}function r(){n.readable&&n.resume&&n.resume()}n.on("data",i),t.on("drain",r),t._isStdio||e&&!1===e.end||(n.on("end",o),n.on("close",a));var s=!1;function o(){s||(s=!0,t.end())}function a(){s||(s=!0,"function"==typeof t.destroy&&t.destroy())}function h(t){if(u(),0===da.listenerCount(this,"error"))throw t}function u(){n.removeListener("data",i),t.removeListener("drain",r),n.removeListener("end",o),n.removeListener("close",a),n.removeListener("error",h),t.removeListener("error",h),n.removeListener("end",u),n.removeListener("close",u),t.removeListener("close",u)}return n.on("error",h),t.on("error",h),n.on("end",u),n.on("close",u),t.on("close",u),t.emit("pipe",n),t};var uh=3,ch=4;function fh(t,e,n){var i,r=this;if(Ta.call(r),r._mode=n,r.headers={},r.rawHeaders=[],r.trailers={},r.rawTrailers=[],r.on("end",function(){wo(function(){r.emit("close")})}),"fetch"===n){r._fetchResponse=e,r.url=e.url,r.statusCode=e.status,r.statusMessage=e.statusText;for(var s,o,a=e.headers[Symbol.iterator]();s=(o=a.next()).value,!o.done;)r.headers[s[0].toLowerCase()]=s[1],r.rawHeaders.push(s[0],s[1]);var h=e.body.getReader();(i=function(){h.read().then(function(t){r._destroyed||(t.done?r.push(null):(r.push(new mt(t.value)),i()))})})()}else{if(r._xhr=t,r._pos=0,r.url=t.responseURL,r.statusCode=t.status,r.statusMessage=t.statusText,t.getAllResponseHeaders().split(/\r?\n/).forEach(function(t){var e=t.match(/^([^:]+):\s*(.*)/);if(e){var n=e[1].toLowerCase();"set-cookie"===n?(void 0===r.headers[n]&&(r.headers[n]=[]),r.headers[n].push(e[2])):void 0!==r.headers[n]?r.headers[n]+=", "+e[2]:r.headers[n]=e[2],r.rawHeaders.push(e[1],e[2])}}),r._charset="x-user-defined",!Ko){var u=r.rawHeaders["mime-type"];if(u){var c=u.match(/;\s*charset=([^;])(;|$)/);c&&(r._charset=c[1].toLowerCase())}r._charset||(r._charset="utf-8")}}}function lh(t){var e,n=this;qa.call(n),n._opts=t,n._body=[],n._headers={},t.auth&&n.setHeader("Authorization","Basic "+new mt(t.auth).toString("base64")),Object.keys(t.headers).forEach(function(e){n.setHeader(e,t.headers[e])});var i=!0;if("disable-fetch"===t.mode)i=!1,e=!0;else if("prefer-streaming"===t.mode)e=!1;else if("allow-wrong-content-type"===t.mode)e=!Ko;else{if(t.mode&&"default"!==t.mode&&"prefer-fast"!==t.mode)throw new Error("Invalid value for opts.mode");e=!0}n._mode=function(t,e){return No&&e?"fetch":Vo?"moz-chunked-arraybuffer":Mo?"ms-stream":Lo&&t?"arraybuffer":Uo&&t?"text:vbarray":"text"}(e,i),n.on("finish",function(){n._onFinish()})}zo(fh,Ta),fh.prototype._read=function(){},fh.prototype._onXHRProgress=function(){var t=this,e=t._xhr,n=null;switch(t._mode){case"text:vbarray":if(e.readyState!==ch)break;try{n=new rt.VBArray(e.responseBody).toArray()}catch(t){}if(null!==n){t.push(new mt(n));break}case"text":try{n=e.responseText}catch(e){t._mode="text:vbarray";break}if(n.length>t._pos){var i=n.substr(t._pos);if("x-user-defined"===t._charset){for(var r=new mt(i.length),s=0;s<i.length;s++)r[s]=255&i.charCodeAt(s);t.push(r)}else t.push(i,t._charset);t._pos=n.length}break;case"arraybuffer":if(e.readyState!==ch||!e.response)break;n=e.response,t.push(new mt(new Uint8Array(n)));break;case"moz-chunked-arraybuffer":if(n=e.response,e.readyState!==uh||!n)break;t.push(new mt(new Uint8Array(n)));break;case"ms-stream":if(n=e.response,e.readyState!==uh)break;var o=new rt.MSStreamReader;o.onprogress=function(){o.result.byteLength>t._pos&&(t.push(new mt(new Uint8Array(o.result.slice(t._pos)))),t._pos=o.result.byteLength)},o.onload=function(){t.push(null)},o.readAsArrayBuffer(n)}t._xhr.readyState===ch&&"ms-stream"!==t._mode&&t.push(null)},zo(lh,qa);var dh=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];lh.prototype.setHeader=function(t,e){var n=t.toLowerCase();-1===dh.indexOf(n)&&(this._headers[n]={name:t,value:e})},lh.prototype.getHeader=function(t){return this._headers[t.toLowerCase()].value},lh.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},lh.prototype._onFinish=function(){var t=this;if(!t._destroyed){var e,n=t._opts,i=t._headers;if("POST"!==n.method&&"PUT"!==n.method&&"PATCH"!==n.method||(e=function(){if(void 0!==Bo)return Bo;try{new rt.Blob([new ArrayBuffer(1)]),Bo=!0}catch(t){Bo=!1}return Bo}()?new rt.Blob(t._body.map(function(t){return function(t){if(t instanceof Uint8Array){if(0===t.byteOffset&&t.byteLength===t.buffer.byteLength)return t.buffer;if("function"==typeof t.buffer.slice)return t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}if(te(t)){for(var e=new Uint8Array(t.length),n=t.length,i=0;i<n;i++)e[i]=t[i];return e.buffer}throw new Error("Argument must be a Buffer")}(t)}),{type:(i["content-type"]||{}).value||""}):mt.concat(t._body).toString()),"fetch"===t._mode){var r=Object.keys(i).map(function(t){return[i[t].name,i[t].value]});rt.fetch(t._opts.url,{method:t._opts.method,headers:r,body:e,mode:"cors",credentials:n.withCredentials?"include":"same-origin"}).then(function(e){t._fetchResponse=e,t._connect()},function(e){t.emit("error",e)})}else{var s=t._xhr=new rt.XMLHttpRequest;try{s.open(t._opts.method,t._opts.url,!0)}catch(e){return void wo(function(){t.emit("error",e)})}"responseType"in s&&(s.responseType=t._mode.split(":")[0]),"withCredentials"in s&&(s.withCredentials=!!n.withCredentials),"text"===t._mode&&"overrideMimeType"in s&&s.overrideMimeType("text/plain; charset=x-user-defined"),Object.keys(i).forEach(function(t){s.setRequestHeader(i[t].name,i[t].value)}),t._response=null,s.onreadystatechange=function(){switch(s.readyState){case uh:case ch:t._onXHRProgress()}},"moz-chunked-arraybuffer"===t._mode&&(s.onprogress=function(){t._onXHRProgress()}),s.onerror=function(){t._destroyed||t.emit("error",new Error("XHR error"))};try{s.send(e)}catch(e){return void wo(function(){t.emit("error",e)})}}}},lh.prototype._onXHRProgress=function(){(function(t){try{var e=t.status;return null!==e&&0!==e}catch(t){return!1}})(this._xhr)&&!this._destroyed&&(this._response||this._connect(),this._response._onXHRProgress())},lh.prototype._connect=function(){this._destroyed||(this._response=new fh(this._xhr,this._fetchResponse,this._mode),this.emit("response",this._response))},lh.prototype._write=function(t,e,n){this._body.push(t),n()},lh.prototype.abort=lh.prototype.destroy=function(){this._destroyed=!0,this._response&&(this._response._destroyed=!0),this._xhr&&this._xhr.abort()},lh.prototype.end=function(t,e,n){"function"==typeof t&&(n=t,t=void 0),qa.prototype.end.call(this,t,e,n)},lh.prototype.flushHeaders=function(){},lh.prototype.setTimeout=function(){},lh.prototype.setNoDelay=function(){},lh.prototype.setSocketKeepAlive=function(){};var ph=2147483647,gh=36,yh=1,vh=26,mh=38,wh=700,bh=72,Sh=128,xh="-",Eh=/[^\x20-\x7E]/,Fh=/[\x2E\u3002\uFF0E\uFF61]/g,Ah={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},Ch=gh-yh,Th=Math.floor,Ph=String.fromCharCode;function Dh(t){throw new RangeError(Ah[t])}function Ih(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function Rh(t,e,n){var i=0;for(t=n?Th(t/wh):t>>1,t+=Th(t/e);t>Ch*vh>>1;i+=gh)t=Th(t/Ch);return Th(i+(Ch+1)*t/(t+mh))}function Bh(t){return function(t,e){var n=t.split("@"),i="";n.length>1&&(i=n[0]+"@",t=n[1]);var r=function(t,e){for(var n=t.length,i=[];n--;)i[n]=e(t[n]);return i}((t=t.replace(Fh,".")).split("."),e).join(".");return i+r}(t,function(t){return Eh.test(t)?"xn--"+function(t){var e,n,i,r,s,o,a,h,u,c,f,l,d,p,g,y=[];for(l=(t=function(t){for(var e,n,i=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(n=t.charCodeAt(r++)))?i.push(((1023&e)<<10)+(1023&n)+65536):(i.push(e),r--):i.push(e);return i}(t)).length,e=Sh,n=0,s=bh,o=0;o<l;++o)(f=t[o])<128&&y.push(Ph(f));for(i=r=y.length,r&&y.push(xh);i<l;){for(a=ph,o=0;o<l;++o)(f=t[o])>=e&&f<a&&(a=f);for(a-e>Th((ph-n)/(d=i+1))&&Dh("overflow"),n+=(a-e)*d,e=a,o=0;o<l;++o)if((f=t[o])<e&&++n>ph&&Dh("overflow"),f==e){for(h=n,u=gh;!(h<(c=u<=s?yh:u>=s+vh?vh:u-s));u+=gh)g=h-c,p=gh-c,y.push(Ph(Ih(c+g%p,0))),h=Th(g/p);y.push(Ph(Ih(h,0))),s=Rh(n,d,i==r),n=0,++i}++n,++e}return y.join("")}(t):t})}function Hh(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var _h=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function Nh(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}}function Oh(t,e){if(t.map)return t.map(e);for(var n=[],i=0;i<t.length;i++)n.push(e(t[i],i));return n}var kh=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e};function jh(t,e,n,i){e=e||"&",n=n||"=";var r={};if("string"!=typeof t||0===t.length)return r;var s=/\+/g;t=t.split(e);var o=1e3;i&&"number"==typeof i.maxKeys&&(o=i.maxKeys);var a=t.length;o>0&&a>o&&(a=o);for(var h=0;h<a;++h){var u,c,f,l,d=t[h].replace(s,"%20"),p=d.indexOf(n);p>=0?(u=d.substr(0,p),c=d.substr(p+1)):(u=d,c=""),f=decodeURIComponent(u),l=decodeURIComponent(c),Hh(r,f)?_h(r[f])?r[f].push(l):r[f]=[r[f],l]:r[f]=l}return r}function Lh(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var Mh=/^([a-z0-9.+-]+:)/i,Vh=/:[0-9]*$/,Kh=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,Uh=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),qh=["'"].concat(Uh),zh=["%","/","?",";","#"].concat(qh),Yh=["/","?","#"],Wh=255,Jh=/^[+a-z0-9A-Z_-]{0,63}$/,Gh=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Xh={javascript:!0,"javascript:":!0},$h={javascript:!0,"javascript:":!0},Zh={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function Qh(t,e,n){if(t&&oa(t)&&t instanceof Lh)return t;var i=new Lh;return i.parse(t,e,n),i}function tu(t){var e=t.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var n,i,r,s,o=t.protocol||"",a=t.pathname||"",h=t.hash||"",u=!1,c="";t.host?u=e+t.host:t.hostname&&(u=e+(-1===t.hostname.indexOf(":")?t.hostname:"["+this.hostname+"]"),t.port&&(u+=":"+t.port)),t.query&&oa(t.query)&&Object.keys(t.query).length&&(n=t.query,i=i||"&",r=r||"=",null===n&&(n=void 0),c="object"==typeof n?Oh(kh(n),function(t){var e=encodeURIComponent(Nh(t))+r;return _h(n[t])?Oh(n[t],function(t){return e+encodeURIComponent(Nh(t))}).join(i):e+encodeURIComponent(Nh(n[t]))}).join(i):s?encodeURIComponent(Nh(s))+r+encodeURIComponent(Nh(n)):"");var f=t.search||c&&"?"+c||"";return o&&":"!==o.substr(-1)&&(o+=":"),t.slashes||(!o||Zh[o])&&!1!==u?(u="//"+(u||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):u||(u=""),h&&"#"!==h.charAt(0)&&(h="#"+h),f&&"?"!==f.charAt(0)&&(f="?"+f),o+u+(a=a.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(f=f.replace("#","%23"))+h}function eu(t){var e=t.host,n=Vh.exec(e);n&&(":"!==(n=n[0])&&(t.port=n.substr(1)),e=e.substr(0,e.length-n.length)),e&&(t.hostname=e)}function nu(t,e){"string"==typeof t&&(t=Qh(t));var n=-1===rt.location.protocol.search(/^https?:$/)?"http:":"",i=t.protocol||n,r=t.hostname||t.host,s=t.port,o=t.path||"/";r&&-1!==r.indexOf(":")&&(r="["+r+"]"),t.url=(r?i+"//"+r:"")+(s?":"+s:"")+o,t.method=(t.method||"GET").toUpperCase(),t.headers=t.headers||{};var a=new lh(t);return e&&a.on("response",e),a}function iu(t,e){var n=nu(t,e);return n.end(),n}function ru(){}Lh.prototype.parse=function(t,e,n){return function(t,e,n,i){if(!ia(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var r=e.indexOf("?"),s=-1!==r&&r<e.indexOf("#")?"?":"#",o=e.split(s);o[0]=o[0].replace(/\\/g,"/");var a=e=o.join(s);if(a=a.trim(),!i&&1===e.split("#").length){var h=Kh.exec(a);if(h)return t.path=a,t.href=a,t.pathname=h[1],h[2]?(t.search=h[2],t.query=n?jh(t.search.substr(1)):t.search.substr(1)):n&&(t.search="",t.query={}),t}var u,c,f,l,d=Mh.exec(a);if(d){var p=(d=d[0]).toLowerCase();t.protocol=p,a=a.substr(d.length)}if(i||d||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===a.substr(0,2);!g||d&&$h[d]||(a=a.substr(2),t.slashes=!0)}if(!$h[d]&&(g||d&&!Zh[d])){var y,v,m=-1;for(u=0;u<Yh.length;u++)-1!==(c=a.indexOf(Yh[u]))&&(-1===m||c<m)&&(m=c);for(-1!==(v=-1===m?a.lastIndexOf("@"):a.lastIndexOf("@",m))&&(y=a.slice(0,v),a=a.slice(v+1),t.auth=decodeURIComponent(y)),m=-1,u=0;u<zh.length;u++)-1!==(c=a.indexOf(zh[u]))&&(-1===m||c<m)&&(m=c);-1===m&&(m=a.length),t.host=a.slice(0,m),a=a.slice(m),eu(t),t.hostname=t.hostname||"";var w="["===t.hostname[0]&&"]"===t.hostname[t.hostname.length-1];if(!w){var b=t.hostname.split(/\./);for(u=0,f=b.length;u<f;u++){var S=b[u];if(S&&!S.match(Jh)){for(var x="",E=0,F=S.length;E<F;E++)S.charCodeAt(E)>127?x+="x":x+=S[E];if(!x.match(Jh)){var A=b.slice(0,u),C=b.slice(u+1),T=S.match(Gh);T&&(A.push(T[1]),C.unshift(T[2])),C.length&&(a="/"+C.join(".")+a),t.hostname=A.join(".");break}}}}t.hostname.length>Wh?t.hostname="":t.hostname=t.hostname.toLowerCase(),w||(t.hostname=Bh(t.hostname)),l=t.port?":"+t.port:"";var P=t.hostname||"";t.host=P+l,t.href+=t.host,w&&(t.hostname=t.hostname.substr(1,t.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!Xh[p])for(u=0,f=qh.length;u<f;u++){var D=qh[u];if(-1!==a.indexOf(D)){var I=encodeURIComponent(D);I===D&&(I=escape(D)),a=a.split(D).join(I)}}var R=a.indexOf("#");-1!==R&&(t.hash=a.substr(R),a=a.slice(0,R));var B=a.indexOf("?");-1!==B?(t.search=a.substr(B),t.query=a.substr(B+1),n&&(t.query=jh(t.query)),a=a.slice(0,B)):n&&(t.search="",t.query={});a&&(t.pathname=a);Zh[p]&&t.hostname&&!t.pathname&&(t.pathname="/");if(t.pathname||t.search){l=t.pathname||"";var H=t.search||"";t.path=l+H}return t.href=tu(t),t}(this,t,e,n)},Lh.prototype.format=function(){return tu(this)},Lh.prototype.resolve=function(t){return this.resolveObject(Qh(t,!1,!0)).format()},Lh.prototype.resolveObject=function(t){if(ia(t)){var e=new Lh;e.parse(t,!1,!0),t=e}for(var n,i=new Lh,r=Object.keys(this),s=0;s<r.length;s++){var o=r[s];i[o]=this[o]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var a=Object.keys(t),h=0;h<a.length;h++){var u=a[h];"protocol"!==u&&(i[u]=t[u])}return Zh[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!Zh[t.protocol]){for(var c=Object.keys(t),f=0;f<c.length;f++){var l=c[f];i[l]=t[l]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||$h[t.protocol])i.pathname=t.pathname;else{for(n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),n.length<2&&n.unshift(""),i.pathname=n.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var d=i.pathname||"",p=i.search||"";i.path=d+p}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var g,y=i.pathname&&"/"===i.pathname.charAt(0),v=t.host||t.pathname&&"/"===t.pathname.charAt(0),m=v||y||i.host&&t.pathname,w=m,b=i.pathname&&i.pathname.split("/")||[],S=i.protocol&&!Zh[i.protocol];if(n=t.pathname&&t.pathname.split("/")||[],S&&(i.hostname="",i.port=null,i.host&&(""===b[0]?b[0]=i.host:b.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),t.host=null),m=m&&(""===n[0]||""===b[0])),v)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,b=n;else if(n.length)b||(b=[]),b.pop(),b=b.concat(n),i.search=t.search,i.query=t.query;else if(null!=t.search)return S&&(i.hostname=i.host=b.shift(),(g=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=g.shift(),i.host=i.hostname=g.shift())),i.search=t.search,i.query=t.query,na(i.pathname)&&na(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!b.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var x=b.slice(-1)[0],E=(i.host||t.host||b.length>1)&&("."===x||".."===x)||""===x,F=0,A=b.length;A>=0;A--)"."===(x=b[A])?b.splice(A,1):".."===x?(b.splice(A,1),F++):F&&(b.splice(A,1),F--);if(!m&&!w)for(;F--;F)b.unshift("..");!m||""===b[0]||b[0]&&"/"===b[0].charAt(0)||b.unshift(""),E&&"/"!==b.join("/").substr(-1)&&b.push("");var C=""===b[0]||b[0]&&"/"===b[0].charAt(0);return S&&(i.hostname=i.host=C?"":b.length?b.shift():"",(g=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=g.shift(),i.host=i.hostname=g.shift())),(m=m||i.host&&b.length)&&!C&&b.unshift(""),b.length?i.pathname=b.join("/"):(i.pathname=null,i.path=null),na(i.pathname)&&na(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},Lh.prototype.parseHost=function(){return eu(this)},ru.defaultMaxSockets=4;var su=["CHECKOUT","CONNECT","COPY","DELETE","GET","HEAD","LOCK","M-SEARCH","MERGE","MKACTIVITY","MKCOL","MOVE","NOTIFY","OPTIONS","PATCH","POST","PROPFIND","PROPPATCH","PURGE","PUT","REPORT","SEARCH","SUBSCRIBE","TRACE","UNLOCK","UNSUBSCRIBE"],ou={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"},au={request:nu,get:iu,Agent:ru,METHODS:su,STATUS_CODES:ou},hu=Object.freeze({request:nu,get:iu,Agent:ru,METHODS:su,STATUS_CODES:ou,default:au}),uu=oo&&so||oo,cu=hu&&au||hu,fu=i(function(n,i){n.exports=function(n){function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){return t<e}function s(t,e){return t<=e}function o(t,e){return t>e}function a(t,e){return t>=e}function h(){return!0}function u(t,e){return t.substring(0,e.length)===e}var c=function t(e,n,r){i(this,t),this.key=e,this.value=n,this.targetHash=r},f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=arguments[2];i(this,t),this.hash=r,this.leftChildHash=e,this.keys=n;var s=new c("",null,e);this.keys.length&&!this.keys[0].key.length||this.keys.unshift(s)}return t.prototype.get=function(e,n){for(var i=this.keys[0],r=this.keys,s=Array.isArray(r),o=0,r=s?r:r[Symbol.iterator]();;){var a;if(s){if(o>=r.length)break;a=r[o++]}else{if((o=r.next()).done)break;a=o.value}var h=a;if(e<h.key)break;i=h}return i.targetHash?n.get(i.targetHash).then(function(r){return t.deserialize(r,i.targetHash).get(e,n)}):i.key===e?Promise.resolve(i.value):Promise.resolve(null)},t.prototype.searchText=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=arguments[2],i=arguments[3],r=arguments[4],s=n||t,o=void 0,a=!n,h=!0;return i&&(s=t,o=n||void 0,a=!0,h=!n),this.searchRange(s,o,t,e,a,h,i,r)},t.prototype.searchRange=function(e,n,i,c){var f=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],d=arguments[6],p=arguments[7],g=[],y=this,v=void 0,m=void 0;return v=e?f?a:o:h,m=n?l?s:r:h,function r(s){if(s<0||s>=y.keys.length)return Promise.resolve(g);if(c&&g.length>=c)return g=g.slice(0,c+1),Promise.resolve(g);var o=d?s-1:s+1,a=y.keys[s];if(o>=0&&o<y.keys.length){if(!d&&e>=y.keys[o].key)return r(o);if(d&&n<y.keys[o].key)return r(o)}if(d&&s+1<y.keys.length&&!v(y.keys[s+1].key,e))return Promise.resolve(g);if(!d&&!m(a.key,n))return Promise.resolve(g);if(a.targetHash)return p.get(a.targetHash).then(function(r){var s=c?c-g.length:void 0;return t.deserialize(r,a.targetHash).searchRange(e,n,i,s,f,l,d,p)}).then(function(t){if(t){if(g.length&&!t.length)return Promise.resolve(g);if(i&&!t.length)return Promise.resolve(g);Array.prototype.push.apply(g,t)}return r(o)});if(a.key.length&&a.value){if(i&&g.length&&!u(a.key,i))return Promise.resolve(g);v(a.key,e)&&m(a.key,n)&&(i&&!u(a.key,i)||g.push({key:a.key,value:a.value}))}return r(o)}(d?this.keys.length-1:0)},t.prototype._getLeafInsertIndex=function(t){var e=this._getNextSmallestIndex(t),n=e.index,i=e.exists,r=n+1;return t>this.keys[this.keys.length-1].key&&(r=this.keys.length),{leafInsertIndex:r,exists:i}},t.prototype._getNextSmallestIndex=function(t){for(var e=0,n=void 0,i=1;i<this.keys.length;i++){if(t===this.keys[i].key){n=!0;break}if(t<this.keys[i].key)break;e=i}return{index:e,exists:n}},t.prototype._splitNode=function(e){var n=Math.floor(this.keys.length/2),i=this.keys[n],r=new t(null,this.keys.slice(0,n)),s=e.put(r.serialize()),o=this.keys.slice(n,this.keys.length);this.keys[0].targetHash&&o.shift();var a=new t(this.keys[n].targetHash,o),h=e.put(a.serialize()),u=e.remove(this.hash);return Promise.all([s,h,u]).then(function(e){var n=e[0],r=e[1],s=new c(i.key,null,r);return new t(n,[s])})},t.prototype._saveToLeafNode=function(e,n,i,r){var s=this,o=new c(e,n,null),a=this._getLeafInsertIndex(e),h=a.leafInsertIndex,u=a.exists;return u?(this.keys[h]=o,i.remove(this.hash).then(function(){return i.put(s.serialize())}).then(function(e){return new t(s.leftChildHash,s.keys,e)})):(this.keys.splice(h,0,o),this.keys.length<r?i.remove(this.hash).then(function(){return i.put(s.serialize())}).then(function(e){return new t(s.leftChildHash,s.keys,e)}):this._splitNode(i))},t.prototype._saveToBranchNode=function(e,n,i,r){var s=this,o=this._getNextSmallestIndex(e),a=o.index,h=this.keys[a];return i.get(h.targetHash).then(function(s){return t.deserialize(s,h.targetHash).put(e,n,i,r)}).then(function(e){return e.hash?(s.keys[a]=new c(s.keys[a].key,null,e.hash),i.remove(s.hash),i.put(s.serialize()).then(function(e){return new t(s.leftChildHash,s.keys,e)})):(s.keys[a]=new c(h.key,null,e.keys[0].targetHash),s.keys.splice(a+1,0,e.keys[e.keys.length-1]),s.keys.length<r?(i.remove(s.hash),i.put(s.serialize()).then(function(e){return new t(s.leftChildHash,s.keys,e)})):s._splitNode(i))})},t.prototype.put=function(t,e,n,i){return this.keys[0].targetHash?this._saveToBranchNode(t,e,n,i):this._saveToLeafNode(t,e,n,i)},t.prototype.delete=function(e,n){var i=this,r=this.keys[0],s=void 0;for(s=0;s<this.keys.length;s++){if(e<this.keys[s].key){s=Math.max(s-1,0);break}r=this.keys[s]}var o=Promise.resolve();return r.targetHash?o=o.then(function(){return n.get(r.targetHash).then(function(i){return t.deserialize(i,r.targetHash).delete(e,n)}).then(function(t){var e=r.targetHash;return r.targetHash=t.hash,n.remove(e)})}):r.key===e&&this.keys.splice(s,1),o.then(function(){return n.put(i.serialize())}).then(function(e){return new t(i.leftChildHash,i.keys,e)})},t.prototype.size=function(e){return this.keys.reduce(function(n,i){return n.then(function(n){return i.targetHash?e.get(i.targetHash).then(function(n){return t.deserialize(n).size(e)}).then(function(t){return t+n}):n})},Promise.resolve(this.keys.length))},t.prototype.smallestKey=function(){return this.keys.length?this.keys[0]:null},t.prototype.smallestNonZeroKey=function(){return this.keys.length>1?this.keys[1]:null},t.prototype.rebalance=function(){},t.prototype.print=function(e){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i="node: "+this.hash+"\n",r="",s=0;s<=n;s++)r+="- ";return this.keys.forEach(function(t){i+=r,i+="key: "+t.key,t.targetHash&&(i+=" link: "+t.targetHash),t.value&&(i+="\n"+r+"   value: "+JSON.stringify(t.value)),i+="\n"}),this.keys.forEach(function(s){s.targetHash&&e.get(s.targetHash).then(function(o){var a=t.deserialize(o,s.targetHash);i+="\n",i+=r,i+=a.print(e,n+1)})}),i},t.prototype.serialize=function(){return JSON.stringify({leftChildHash:this.leftChildHash,keys:this.keys})},t.deserialize=function(e,n){return new t((e=JSON.parse(e)).leftChildHash,e.keys,n)},t.fromSortedList=function(e,n,i){if(e.length>n)return function r(s){if(e.length){var o=e.splice(0,n);return i.put(new t(o[0].targetHash,o).serialize()).then(function(t){return s.push({key:o[1].key,targetHash:t,value:null}),r(s)})}return s.length&&s[0].targetHash&&(s[0].key=""),t.fromSortedList(s,n,i)}([]);var r=e.length?e[0].targetHash:null,s=new t(r,e);return i.put(s.serialize()).then(function(t){return s.hash=t,s})},t}(),l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new f;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.rootNode=i,this.storage=e,this.maxChildren=Math.max(n,2)}return t.prototype.get=function(t){return this.rootNode.get(t,this.storage)},t.prototype.searchText=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.rootNode.searchText(t,e,n,i,this.storage)},t.prototype.searchRange=function(t,e,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return this.rootNode.searchRange(t,e,!1,n,i,r,s,this.storage)},t.prototype.put=function(t,e){var n=this;return this.rootNode.put(t,e,this.storage,this.maxChildren).then(function(t){return n.rootNode=t,n.rootNode.hash})},t.prototype.delete=function(t){var e=this;return this.rootNode.delete(t,this.storage,this.maxChildren).then(function(t){return e.rootNode=t,e.rootNode.hash})},t.prototype.print=function(){return this.rootNode.print(this.storage)},t.prototype.size=function(){return this.rootNode.size(this.storage)},t.getByHash=function(e,n,i){return n.get(e).then(function(e){var r=f.deserialize(e);return new t(n,i,r)})},t.fromSortedList=function(e,n,i){return f.fromSortedList(e,n,i).then(function(e){return new t(i,n,e)})},t}(),d=void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},p=[],g=[],y="undefined"!=typeof Uint8Array?Uint8Array:Array,v=!1;function m(){v=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)p[e]=t[e],g[t.charCodeAt(e)]=e;g["-".charCodeAt(0)]=62,g["_".charCodeAt(0)]=63}function w(t,e,n){for(var i,r,s=[],o=e;o<n;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(p[(r=i)>>18&63]+p[r>>12&63]+p[r>>6&63]+p[63&r]);return s.join("")}function b(t){var e;v||m();for(var n=t.length,i=n%3,r="",s=[],o=0,a=n-i;o<a;o+=16383)s.push(w(t,o,o+16383>a?a:o+16383));return 1===i?(e=t[n-1],r+=p[e>>2],r+=p[e<<4&63],r+="=="):2===i&&(e=(t[n-2]<<8)+t[n-1],r+=p[e>>10],r+=p[e>>4&63],r+=p[e<<2&63],r+="="),s.push(r),s.join("")}function S(t,e,n,i,r){var s,o,a=8*r-i-1,h=(1<<a)-1,u=h>>1,c=-7,f=n?r-1:0,l=n?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-u;else{if(s===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=u}return(d?-1:1)*o*Math.pow(2,s-i)}function x(t,e,n,i,r,s){var o,a,h,u=8*s-r-1,c=(1<<u)-1,f=c>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-o))<1&&(o--,h*=2),(e+=o+f>=1?l/h:l*Math.pow(2,1-f))*h>=2&&(o++,h/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*h-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[n+d]=255&a,d+=p,a/=256,r-=8);for(o=o<<r|a,u+=r;u>0;t[n+d]=255&o,d+=p,o/=256,u-=8);t[n+d-p]|=128*g}var E={}.toString,F=Array.isArray||function(t){return"[object Array]"==E.call(t)};function A(){return T.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function C(t,e){if(A()<e)throw new RangeError("Invalid typed array length");return T.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=T.prototype:(null===t&&(t=new T(e)),t.length=e),t}function T(t,e,n){if(!(T.TYPED_ARRAY_SUPPORT||this instanceof T))return new T(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return I(this,t)}return P(this,t,e,n)}function P(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i),T.TYPED_ARRAY_SUPPORT?(t=e).__proto__=T.prototype:t=R(t,e),t}(t,e,n,i):"string"==typeof e?function(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!T.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|_(e,n),r=(t=C(t,i)).write(e,n);return r!==i&&(t=t.slice(0,r)),t}(t,e,n):function(t,e){if(H(e)){var n=0|B(e.length);return 0===(t=C(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?C(t,0):R(t,e);if("Buffer"===e.type&&F(e.data))return R(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function D(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function I(t,e){if(D(e),t=C(t,e<0?0:0|B(e)),!T.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function R(t,e){var n=e.length<0?0:0|B(e.length);t=C(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function B(t){if(t>=A())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+A().toString(16)+" bytes");return 0|t}function H(t){return!(null==t||!t._isBuffer)}function _(t,e){if(H(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return st(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return ot(t).length;default:if(i)return st(t).length;e=(""+e).toLowerCase(),i=!0}}function N(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function O(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=T.from(e,i)),H(e))return 0===e.length?-1:k(t,e,n,i,r);if("number"==typeof e)return e&=255,T.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):k(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function k(t,e,n,i,r){var s,o=1,a=t.length,h=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,h/=2,n/=2}function u(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=n;s<a;s++)if(u(t,s)===u(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===h)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+h>a&&(n=a-h),s=n;s>=0;s--){for(var f=!0,l=0;l<h;l++)if(u(t,s+l)!==u(e,l)){f=!1;break}if(f)return s}return-1}function j(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function L(t,e,n,i){return at(st(e,t.length-n),t,n,i)}function M(t,e,n,i){return at(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function V(t,e,n,i){return M(t,e,n,i)}function K(t,e,n,i){return at(ot(e),t,n,i)}function U(t,e,n,i){return at(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function q(t,e,n){return 0===e&&n===t.length?b(t):b(t.slice(e,n))}function z(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,h,u=t[r],c=null,f=u>239?4:u>223?3:u>191?2:1;if(r+f<=n)switch(f){case 1:u<128&&(c=u);break;case 2:128==(192&(s=t[r+1]))&&(h=(31&u)<<6|63&s)>127&&(c=h);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(h=(15&u)<<12|(63&s)<<6|63&o)>2047&&(h<55296||h>57343)&&(c=h);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(h=(15&u)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(c=h)}null===c?(c=65533,f=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=f}return function(t){var e=t.length;if(e<=Y)return String.fromCharCode.apply(String,t);for(var n="",i=0;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=Y));return n}(i)}T.TYPED_ARRAY_SUPPORT=void 0===d.TYPED_ARRAY_SUPPORT||d.TYPED_ARRAY_SUPPORT,T.poolSize=8192,T._augment=function(t){return t.__proto__=T.prototype,t},T.from=function(t,e,n){return P(null,t,e,n)},T.TYPED_ARRAY_SUPPORT&&(T.prototype.__proto__=Uint8Array.prototype,T.__proto__=Uint8Array),T.alloc=function(t,e,n){return function(t,e,n,i){return D(e),e<=0?C(t,e):void 0!==n?"string"==typeof i?C(t,e).fill(n,i):C(t,e).fill(n):C(t,e)}(null,t,e,n)},T.allocUnsafe=function(t){return I(null,t)},T.allocUnsafeSlow=function(t){return I(null,t)},T.isBuffer=function(t){return null!=t&&(!!t._isBuffer||ht(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&ht(t.slice(0,0))}(t))},T.compare=function(t,e){if(!H(t)||!H(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},T.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},T.concat=function(t,e){if(!F(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return T.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=T.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var s=t[n];if(!H(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},T.byteLength=_,T.prototype._isBuffer=!0,T.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)N(this,e,e+1);return this},T.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)N(this,e,e+3),N(this,e+1,e+2);return this},T.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)N(this,e,e+7),N(this,e+1,e+6),N(this,e+2,e+5),N(this,e+3,e+4);return this},T.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?z(this,0,t):function(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return G(this,e,n);case"utf8":case"utf-8":return z(this,e,n);case"ascii":return W(this,e,n);case"latin1":case"binary":return J(this,e,n);case"base64":return q(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},T.prototype.equals=function(t){if(!H(t))throw new TypeError("Argument must be a Buffer");return this===t||0===T.compare(this,t)},T.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},T.prototype.compare=function(t,e,n,i,r){if(!H(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(e>>>=0,n>>>=0,i>>>=0,r>>>=0,this===t)return 0;for(var s=r-i,o=n-e,a=Math.min(s,o),h=this.slice(i,r),u=t.slice(e,n),c=0;c<a;++c)if(h[c]!==u[c]){s=h[c],o=u[c];break}return s<o?-1:o<s?1:0},T.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},T.prototype.indexOf=function(t,e,n){return O(this,t,e,n,!0)},T.prototype.lastIndexOf=function(t,e,n){return O(this,t,e,n,!1)},T.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return j(this,t,e,n);case"utf8":case"utf-8":return L(this,t,e,n);case"ascii":return M(this,t,e,n);case"latin1":case"binary":return V(this,t,e,n);case"base64":return K(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},T.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Y=4096;function W(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function J(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function G(t,e,n){var i,r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var s="",o=e;o<n;++o)s+=(i=t[o])<16?"0"+i.toString(16):i.toString(16);return s}function X(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function $(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Z(t,e,n,i,r,s){if(!H(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function Q(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function tt(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function et(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function nt(t,e,n,i,r){return r||et(t,0,n,4),x(t,e,n,i,23,4),n+4}function it(t,e,n,i,r){return r||et(t,0,n,8),x(t,e,n,i,52,8),n+8}T.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),T.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=T.prototype;else{var r=e-t;n=new T(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},T.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},T.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},T.prototype.readUInt8=function(t,e){return e||$(t,1,this.length),this[t]},T.prototype.readUInt16LE=function(t,e){return e||$(t,2,this.length),this[t]|this[t+1]<<8},T.prototype.readUInt16BE=function(t,e){return e||$(t,2,this.length),this[t]<<8|this[t+1]},T.prototype.readUInt32LE=function(t,e){return e||$(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},T.prototype.readUInt32BE=function(t,e){return e||$(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},T.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},T.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||$(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},T.prototype.readInt8=function(t,e){return e||$(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},T.prototype.readInt16LE=function(t,e){e||$(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},T.prototype.readInt16BE=function(t,e){e||$(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},T.prototype.readInt32LE=function(t,e){return e||$(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},T.prototype.readInt32BE=function(t,e){return e||$(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},T.prototype.readFloatLE=function(t,e){return e||$(t,4,this.length),S(this,t,!0,23,4)},T.prototype.readFloatBE=function(t,e){return e||$(t,4,this.length),S(this,t,!1,23,4)},T.prototype.readDoubleLE=function(t,e){return e||$(t,8,this.length),S(this,t,!0,52,8)},T.prototype.readDoubleBE=function(t,e){return e||$(t,8,this.length),S(this,t,!1,52,8)},T.prototype.writeUIntLE=function(t,e,n,i){if(t=+t,e|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;Z(this,t,e,n,r,0)}var s=1,o=0;for(this[e]=255&t;++o<n&&(s*=256);)this[e+o]=t/s&255;return e+n},T.prototype.writeUIntBE=function(t,e,n,i){if(t=+t,e|=0,n|=0,!i){var r=Math.pow(2,8*n)-1;Z(this,t,e,n,r,0)}var s=n-1,o=1;for(this[e+s]=255&t;--s>=0&&(o*=256);)this[e+s]=t/o&255;return e+n},T.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,1,255,0),T.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},T.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,65535,0),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Q(this,t,e,!0),e+2},T.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,65535,0),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Q(this,t,e,!1),e+2},T.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,4294967295,0),T.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):tt(this,t,e,!0),e+4},T.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,4294967295,0),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):tt(this,t,e,!1),e+4},T.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Z(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},T.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Z(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},T.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,1,127,-128),T.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},T.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,32767,-32768),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Q(this,t,e,!0),e+2},T.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,2,32767,-32768),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Q(this,t,e,!1),e+2},T.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,2147483647,-2147483648),T.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):tt(this,t,e,!0),e+4},T.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),T.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):tt(this,t,e,!1),e+4},T.prototype.writeFloatLE=function(t,e,n){return nt(this,t,e,!0,n)},T.prototype.writeFloatBE=function(t,e,n){return nt(this,t,e,!1,n)},T.prototype.writeDoubleLE=function(t,e,n){return it(this,t,e,!0,n)},T.prototype.writeDoubleBE=function(t,e,n){return it(this,t,e,!1,n)},T.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!T.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},T.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!T.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=H(t)?t:st(new T(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var rt=/[^+\/0-9A-Za-z-_]/g;function st(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function ot(t){return function(t){v||m();var e,n,i,r,s,o,a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new y(3*a/4-s),i=s>0?a-4:a;var h=0;for(e=0,n=0;e<i;e+=4,n+=3)r=g[t.charCodeAt(e)]<<18|g[t.charCodeAt(e+1)]<<12|g[t.charCodeAt(e+2)]<<6|g[t.charCodeAt(e+3)],o[h++]=r>>16&255,o[h++]=r>>8&255,o[h++]=255&r;return 2===s?(r=g[t.charCodeAt(e)]<<2|g[t.charCodeAt(e+1)]>>4,o[h++]=255&r):1===s&&(r=g[t.charCodeAt(e)]<<10|g[t.charCodeAt(e+1)]<<4|g[t.charCodeAt(e+2)]>>2,o[h++]=r>>8&255,o[h++]=255&r),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(rt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function at(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function ht(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var ut=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.ipfs=e}return t.prototype.put=function(t){return this.ipfs.files.add(new T(t,"utf8")).then(function(t){return t[0].hash})},t.prototype.get=function(t){return this.ipfs.files.cat(t).then(function(t){return t.toString("utf8")})},t.prototype.remove=function(t){return Promise.resolve(t)},t.prototype.clear=function(){return Promise.resolve()},t}(),ct=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage={}}return t.prototype.put=function(t){var e=this;return new Promise(function(i){var r=n.createHash("sha256");r.update(t);var s=r.digest("base64");e.storage[s]=t,i(s)})},t.prototype.get=function(t){var e=this;return new Promise(function(n){n(e.storage[t])})},t.prototype.remove=function(t){var e=this;return new Promise(function(n){delete e.storage[t],n()})},t.prototype.clear=function(){var t=this;return new Promise(function(e){t.storage={},e()})},t}(),ft=!1;try{ft="[object process]"===Object.prototype.toString.call(d.process)}catch(t){}function lt(t){return ft&&e.resolve("http")&&e.resolve("https")?function(t){return new Promise(function(e,n){var i=(t.startsWith("https"),cu),r=i.get(t,function(t){(t.statusCode<200||t.statusCode>299)&&n(new Error("Failed to load page, status code: "+t.statusCode));var i=[];t.on("data",function(t){return i.push(t)}),t.on("end",function(){return e(i.join(""))})});r.on("error",function(t){return n(t)})})}(t):function(t){return new Promise(function(e,n){var i=new XMLHttpRequest;i.onreadystatechange=function(){4===i.readyState&&(i.status>=200&&i.status<300?e(i.responseText):n(i.responseText))},i.open("GET",t,!0),i.send(null)})}(t)}var dt=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.apiRoot=e}return t.prototype.get=function(t){return t.match(/^\/ip(fs|ns)\//)||(t="/ipfs/"+t),lt(this.apiRoot+t)},t.prototype.remove=function(){return Promise.resolve()},t.prototype.put=function(){return Promise.resolve()},t}();return{MerkleBTree:l,TreeNode:f,RAMStorage:ct,IPFSStorage:ut,IPFSGatewayStorage:dt}}(uu)}),lu=["https://identi.fi","https://ipfs.io","https://ipfs.infura.io","https://www.eternum.io"],du=200,pu=function(){function t(e,n){var i=this;if(Ln(this,t),e){this.ipfs=e,this.storage=new fu.IPFSStorage(e),this.identitiesBySearchKey=new fu.MerkleBTree(this.storage,du),this.identitiesByTrustDistance=new fu.MerkleBTree(this.storage,du),this.messagesByTimestamp=new fu.MerkleBTree(this.storage,du),this.messagesByDistance=new fu.MerkleBTree(this.storage,du),this.viewpoint=n?new Os(n):{name:"keyID",val:Ps.getDefaultKey().keyID,conf:1,ref:0};var r=new ks({attrs:[this.viewpoint],trustDistance:0});this.ready=new As(async function(t,e){try{await i._setSentRcvdIndexes(r),await i._addIdentityToIndexes(r),t()}catch(t){e(t)}})}}return t.create=async function(e,n){var i=new t(e,n);return await i.ready,i},t.getMsgIndexKey=function(t){var e=parseInt(t.distance);return(e=("00"+(e=Bs(e)?99:e)).substring(e.toString().length))+":"+Math.floor(Date.parse(t.timestamp||t.signedData.timestamp)/1e3)+":"+(t.ipfs_hash||t.hash).substr(0,9)},t.getIdentityIndexKeys=function(t,e){for(var n=[],i=t.data.attrs,r=0;r<i.length;r+=1){var s=t.data.hasOwnProperty("trustDistance")?t.data.trustDistance:parseInt(i[r].dist);s=("00"+(s=Bs(s)?99:s)).substring(s.toString().length);var o=i[r].val||i[r][1],a=i[r].name||i[r][0],h=encodeURIComponent(o),u=encodeURIComponent(o.toLowerCase()),c=encodeURIComponent(a),f=s+":"+h+":"+c,l=s+":"+u+":"+c;if(Os.isUniqueType(a)||(f=f+":"+e.substr(0,9),l=l+":"+e.substr(0,9)),n.push(f),f!==l&&n.push(l),o.indexOf(" ")>-1)for(var d=o.toLowerCase().split(" "),p=0;p<d.length;p+=1){var g=s+":"+encodeURIComponent(d[p])+":"+c;Os.isUniqueType(a)||(g=g+":"+e.substr(0,9)),n.push(g)}if(f.match(/^http(s)?:\/\/.+\/[a-zA-Z0-9_]+$/)){var y=f.split("/");n.push(y[y.length-1])}}return n},t.load=async function(e,n){var i=new t;return await i.init(e,n),i},t.prototype.init=async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lu,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e4,i=!1;if(void 0===t&&(i=!0,t="/ipns/Qmbb1DRwd75rZk5TotTXJYzDSJL6BaNT1DAQ6VbKcKLhbs"),"string"==typeof e)this.storage=new fu.IPFSGatewayStorage(e);else if(Array.isArray(e)){for(var r=void 0,s=0;s<e.length;s++){var o=void 0,a=""+e[s]+t;try{(o=await Ps.timeoutPromise(it(a,{timeout:n}).catch(function(){}),n))||console.log("fetching "+a+" timed out")}catch(t){console.log("fetching "+a+" failed:",t)}if((!o||!o.ok||200!==o.status)&&i){a=e[s]+"/ipfs/QmPxLM631zJQ12tUDWs55LkGqqroFZKHeLjAZ2XwL9Miu3";try{(o=await Ps.timeoutPromise(it(a,{timeout:n}).catch(function(){}),n))?t="/ipfs/QmPxLM631zJQ12tUDWs55LkGqqroFZKHeLjAZ2XwL9Miu3":console.log("fetching "+a+" timed out")}catch(t){console.log("fetching "+a+" failed:",t)}}if(o&&o.ok&&200===o.status){r=e[s];break}}if(!r)throw"Could not load index via given ipfs gateways";this.storage=new fu.IPFSGatewayStorage(r)}else{if("object"!=typeof e)throw"ipfs param must be a gateway url, array of urls or a js-ipfs object";this.storage=new fu.IPFSStorage(e),this.ipfs=e}var h=await this.storage.get(t),u=void 0;try{u=JSON.parse(h)}catch(t){console.log("Old format index root")}if(u?(this.identitiesByTrustDistance=await fu.MerkleBTree.getByHash(u.identitiesByTrustDistance,this.storage,du),this.identitiesBySearchKey=await fu.MerkleBTree.getByHash(u.identitiesBySearchKey,this.storage,du),this.messagesByTimestamp=await fu.MerkleBTree.getByHash(u.messagesByTimestamp,this.storage,du),this.messagesByDistance=await fu.MerkleBTree.getByHash(u.messagesByDistance,this.storage,du),this.viewpoint=u.viewpoint):(this.identitiesByTrustDistance=await fu.MerkleBTree.getByHash(t+"/identities_by_distance",this.storage,du),this.identitiesBySearchKey=await fu.MerkleBTree.getByHash(t+"/identities_by_searchkey",this.storage,du),this.messagesByTimestamp=await fu.MerkleBTree.getByHash(t+"/messages_by_timestamp",this.storage,du),this.messagesByDistance=await fu.MerkleBTree.getByHash(t+"/messages_by_distance",this.storage,du)),!this.viewpoint){var c=await this.getViewpoint();this.viewpoint=c.mostVerifiedAttributes.keyID.attribute.val}return!0},t.prototype.save=async function(){try{for(var t=await this.ipfs.files.add([{path:"messagesByDistance",content:new mt(this.messagesByDistance.rootNode.serialize(),"utf8")},{path:"messagesByTimestamp",content:new mt(this.messagesByTimestamp.rootNode.serialize(),"utf8")},{path:"identitiesBySearchKey",content:new mt(this.identitiesBySearchKey.rootNode.serialize(),"utf8")},{path:"identitiesByTrustDistance",content:new mt(this.identitiesByTrustDistance.rootNode.serialize(),"utf8")}]),e={viewpoint:this.viewpoint},n=0;n<t.length;n+=1)e[t[n].path]=t[n].hash;var i=(t=await this.ipfs.files.add(new mt(jn(e),"utf8")))[0].hash;if(this.ipfs.name){console.log("publishing index",i);var r=await this.ipfs.name.publish(i,{});console.log("published index",r)}return i}catch(t){console.log("error publishing index",t)}},t.prototype._setSentRcvdIndexes=async function(t){t.sentIndex||(t.data.sent?t.sentIndex=await fu.MerkleBTree.getByHash(t.data.sent,this.storage,du):t.sentIndex=new fu.MerkleBTree(this.storage,du)),t.receivedIndex||(t.data.received?t.receivedIndex=await fu.MerkleBTree.getByHash(t.data.received,this.storage,du):t.receivedIndex=new fu.MerkleBTree(this.storage,du))},t.prototype.getViewpoint=async function(){var t=await this.identitiesByTrustDistance.searchText("00",1);if(t.length){var e=await this.storage.get(t[0].value),n=new ks(JSON.parse(e));return await this._setSentRcvdIndexes(n),n}},t.prototype.get=async function(t,e){if(void 0===t)throw"Value is undefined";void 0===e&&(e=Os.guessTypeOf(t));var n=await this.identitiesBySearchKey.get(encodeURIComponent(t)+":"+encodeURIComponent(e));if(n){var i=await this.storage.get(n),r=new ks(JSON.parse(i));return r.ipfsHash=n,await this._setSentRcvdIndexes(r),r}},t.prototype._getMsgs=async function(t,e,n){var i=await t.searchText("",e,n,!0),r=[];return i.forEach(function(t){var e=Ms.fromJws(t.value.jws);e.cursor=t.key,e.authorPos=t.value.author_pos,e.authorNeg=t.value.author_neg,e.recipientPos=t.value.recipient_pos,e.recipientNeg=t.value.recipient_neg,e.authorTrustDistance=t.value.distance,e.authorName=t.value.author_name,e.recipientName=t.value.recipient_name,r.push(e)}),r},t.prototype._saveIdentityToIpfs=async function(t){var e=new this.ipfs.types.Buffer(jn(t.data)),n=await this.ipfs.files.add(e),i=n.length?n[0].hash:"";return t.ipfsHash=i,i},t.prototype._removeIdentityFromIndexes=async function(e){var n=e.ipfsHash;n||(n=await this._saveIdentityToIpfs(e));for(var i=t.getIdentityIndexKeys(e,n.substr(2)),r=0;r<i.length;r++){var s=i[r];console.log("deleting key "+s),await this.identitiesByTrustDistance.delete(s),await this.identitiesBySearchKey.delete(s.substr(s.indexOf(":")+1))}},t.prototype._addIdentityToIndexes=async function(e){if(e.sentIndex&&e.receivedIndex)if(e.sentIndex.rootNode.hash&&e.receivedIndex.rootNode.hash)e.data.sent=e.sentIndex.rootNode.hash,e.data.received=e.receivedIndex.rootNode.hash;else{var n=await this.ipfs.files.add(new mt(e.sentIndex.rootNode.serialize(),"utf8"));e.data.sent=n[0].hash;var i=await this.ipfs.files.add(new mt(e.receivedIndex.rootNode.serialize(),"utf8"));e.data.received=i[0].hash}for(var r=await this._saveIdentityToIpfs(e),s=t.getIdentityIndexKeys(e,r.substr(2)),o=0;o<s.length;o++){var a=s[o];console.log("adding key "+a),await this.identitiesByTrustDistance.put(a,r),await this.identitiesBySearchKey.put(a.substr(a.indexOf(":")+1),r)}return{hash:r}},t.prototype.getSentMsgs=async function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.sentIndex||(t.sentIndex=await fu.MerkleBTree.getByHash(t.data.sent,this.storage,du)),this._getMsgs(t.sentIndex,e,n)},t.prototype.getReceivedMsgs=async function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return t.receivedIndex||(t.receivedIndex=await fu.MerkleBTree.getByHash(t.data.received,this.storage,du)),this._getMsgs(t.receivedIndex,e,n)},t.prototype.getAttributeTrustDistance=async function(t){if(Os.isUniqueType(t.name)){var e=await this.get(t.val,t.name);return e&&e.data&&e.data.trustDistance}},t.prototype.getMsgTrustDistance=async function(t){var e=1e3;if(await this.get(t.getSignerKeyID(),"keyID")){for(var n=0;n<t.signedData.author.length;n++){var i=new Os(t.signedData.author[n]);if(Os.equals(i,this.viewpoint))return 0;var r=await this.getAttributeTrustDistance(i);r<e&&(e=r)}return e<1e3?e:void 0}},t.prototype._updateIdentityIndexesByMsg=async function(e){for(var n=this,i={},r={},s=0;s<e.signedData.author.length;s++){var o=e.signedData.author[s],a=await this.get(o[1],o[0]);a&&(r[a.ipfsHash]=a)}if(Is(r).length){for(var h=0;h<e.signedData.recipient.length;h++){var u=e.signedData.recipient[h],c=await this.get(u[1],u[0]);c&&(i[c.ipfsHash]=c)}if(!Is(i).length){var f=[];e.signedData.recipient.forEach(function(t){f.push({name:t[0],val:t[1],conf:1,ref:0})});var l=new ks({attrs:f});l.sentIndex=new fu.MerkleBTree(this.storage,du),l.receivedIndex=new fu.MerkleBTree(this.storage,du),await this._saveIdentityToIpfs(l),i[l.ipfsHash]=l}var d=t.getMsgIndexKey(e);d=d.substr(d.indexOf(":")+1);for(var p=ro(nt({},r,i)),g=async function(t){var s=p[t];await n._removeIdentityFromIndexes(s),i.hasOwnProperty(s.ipfsHash)&&(e.signedData.recipient.forEach(function(t){for(var e=!1,n=0;n<s.data.attrs.length;n++)if(Os.equals(t,s.data.attrs[n])){s.data.attrs[n].conf|=0,s.data.attrs[n].conf+=1,e=!0;break}e||s.data.attrs.push({name:t[0],val:t[1],conf:1,ref:0})}),"rating"===e.signedData.type&&(e.isPositive()?(e.distance+1<s.data.trustDistance&&(s.data.trustDistance=e.distance+1),s.data.receivedPositive++):e.isNegative()?s.data.receivedNegative++:s.data.receivedNeutral++),await s.receivedIndex.put(d,e)),r.hasOwnProperty(s.ipfsHash)&&("rating"===e.signedData.type&&(e.isPositive()?s.data.sentPositive++:e.isNegative()?s.data.sentNegative++:s.data.sentNeutral++),await s.sentIndex.put(d,e)),await n._addIdentityToIndexes(s)},y=0;y<p.length;y++)await g(y)}},t.prototype.addMessages=async function(t){var e=void 0;if(Array.isArray(t)){console.log("sorting "+t.length+" messages onto a search tree..."),e=new fu.MerkleBTree(new fu.RAMStorage,1e3);for(var n=0;n<t.length;n++)for(var i=0;i<t[n].signedData.author.length;i++){var r=t[n].signedData.author[i];if(Os.isUniqueType(r[0])){var s=encodeURIComponent(r[1])+":"+encodeURIComponent(r[0])+":"+t[n].getHash();await e.put(s,t[n])}}console.log("...done")}else{if(!(t instanceof fu.MerkleBTree))throw"msgs param must be an array or MerkleBTree";e=t}var o=void 0,a=void 0;do{o=await e.size();for(var h=void 0,u=void 0,c=await this.identitiesBySearchKey.searchText("",1,h),f=await e.searchText("",1,u);c.length&&f.length;)if(h=c[0].key,u=f[0].key,0===f[0].key.indexOf(c[0].key)){console.log("adding msg by",f[0].key);try{await this.addMessage(Ms.fromJws(f[0].value.jws))}catch(t){console.log("adding failed:",t)}await e.delete(u),c=await this.identitiesBySearchKey.searchText("",1,h),f=await e.searchText("",1,u)}else c[0].key<f[0].key?c=await this.identitiesBySearchKey.searchText("",1,h):f=await e.searchText("",1,u);a=await e.size()}while(a!==o);return!0},t.prototype.addMessage=async function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.ipfs){if(e.distance=await this.getMsgTrustDistance(e),void 0===e.distance)return;var i=t.getMsgIndexKey(e);await this.messagesByDistance.put(i,e),i=i.substr(i.indexOf(":")+1);var r=await this.messagesByTimestamp.put(i,e);return n&&await this._updateIdentityIndexesByMsg(e),r}},t.prototype.publishMessage=async function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={};if(this.ipfs){var i=await this.ipfs.files.add(new mt(t.jws,"utf8"));n.hash=i,await this.ipfs.pubsub.publish("identifi",new mt(i,"utf8")),e&&(n.indexUri=await this.addMessage(t))}else{var r=jn({jws:t.jws,hash:t.getHash()}),s=await it("https://identi.fi/api/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:r});if(s.status&&201===s.status){var o=JSON.parse(await s.text());n.hash=o.ipfs_hash}}return n},t.prototype.search=async function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5,i=arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:20,s={},o=i?to(i.substring(0,i.indexOf(":"))):0,a=o;a<=r;a++)for(var h=a===o,u=("00"+a).substring(a.toString().length),c=await this.identitiesByTrustDistance.searchText(u+":"+encodeURIComponent(t),n,h?i:void 0);c&&c.length&&Is(s).length<n;){for(var f=0;f<c.length&&Is(s).length<n;f++)if(c[f].value&&!s.hasOwnProperty(c[f].value))try{var l=JSON.parse(await this.storage.get("/ipfs/"+c[f].value)),d=new ks(l);d.ipfsHash=c[f].value,d.cursor=c[f].key,s[c[f].value]=d}catch(t){console.error(t)}c=await this.identitiesBySearchKey.searchText(u+":"+encodeURIComponent(t),n,c[c.length-1].key)}return ro(s)},t}();return{VERSION:"0.0.62",APIClient:Nn,Message:Ms,Identity:ks,Attribute:Os,Index:pu,util:Ps}});
