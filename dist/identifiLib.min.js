!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.identifiLib=e()}(this,function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function n(t,e){return t(e={exports:{}},e.exports),e.exports}var i=n(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),r=n(function(t){var e=t.exports={version:"2.5.7"};"number"==typeof __e&&(__e=e)}),s=(r.version,function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}),o=function(t,e,n){if(s(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,i){return t.call(e,n,i)};case 3:return function(n,i,r){return t.call(e,n,i,r)}}return function(){return t.apply(e,arguments)}},a=function(t){return"object"==typeof t?null!==t:"function"==typeof t},u=function(t){if(!a(t))throw TypeError(t+" is not an object!");return t},h=function(t){try{return!!t()}catch(t){return!0}},c=!h(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),f=i.document,l=a(f)&&a(f.createElement),d=function(t){return l?f.createElement(t):{}},p=!c&&!h(function(){return 7!=Object.defineProperty(d("div"),"a",{get:function(){return 7}}).a}),g=function(t,e){if(!a(t))return t;var n,i;if(e&&"function"==typeof(n=t.toString)&&!a(i=n.call(t)))return i;if("function"==typeof(n=t.valueOf)&&!a(i=n.call(t)))return i;if(!e&&"function"==typeof(n=t.toString)&&!a(i=n.call(t)))return i;throw TypeError("Can't convert object to primitive value")},v=Object.defineProperty,y={f:c?Object.defineProperty:function(t,e,n){if(u(t),e=g(e,!0),u(n),p)try{return v(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t}},m=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},b=c?function(t,e,n){return y.f(t,e,m(1,n))}:function(t,e,n){return t[e]=n,t},S={}.hasOwnProperty,w=function(t,e){return S.call(t,e)},x=function(t,e,n){var s,a,u,h=t&x.F,c=t&x.G,f=t&x.S,l=t&x.P,d=t&x.B,p=t&x.W,g=c?r:r[e]||(r[e]={}),v=g.prototype,y=c?i:f?i[e]:(i[e]||{}).prototype;for(s in c&&(n=e),n)(a=!h&&y&&void 0!==y[s])&&w(g,s)||(u=a?y[s]:n[s],g[s]=c&&"function"!=typeof y[s]?n[s]:d&&a?o(u,i):p&&y[s]==u?function(t){var e=function(e,n,i){if(this instanceof t){switch(arguments.length){case 0:return new t;case 1:return new t(e);case 2:return new t(e,n)}return new t(e,n,i)}return t.apply(this,arguments)};return e.prototype=t.prototype,e}(u):l&&"function"==typeof u?o(Function.call,u):u,l&&((g.virtual||(g.virtual={}))[s]=u,t&x.R&&v&&!v[s]&&b(v,s,u)))};x.F=1,x.G=2,x.S=4,x.P=8,x.B=16,x.W=32,x.U=64,x.R=128;var F,E=x,A={}.toString,D=function(t){return A.call(t).slice(8,-1)},C=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==D(t)?t.split(""):Object(t)},I=function(t){if(null==t)throw TypeError("Can't call method on  "+t);return t},T=function(t){return C(I(t))},P=Math.ceil,j=Math.floor,H=function(t){return isNaN(t=+t)?0:(t>0?j:P)(t)},_=Math.min,R=function(t){return t>0?_(H(t),9007199254740991):0},k=Math.max,B=Math.min,N=n(function(t){var e=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(t.exports=function(t,n){return e[t]||(e[t]=void 0!==n?n:{})})("versions",[]).push({version:r.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),O=0,V=Math.random(),L=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++O+V).toString(36))},M=N("keys"),K=function(t){return M[t]||(M[t]=L(t))},U=(F=!1,function(t,e,n){var i,r=T(t),s=R(r.length),o=function(t,e){return(t=H(t))<0?k(t+e,0):B(t,e)}(n,s);if(F&&e!=e){for(;s>o;)if((i=r[o++])!=i)return!0}else for(;s>o;o++)if((F||o in r)&&r[o]===e)return F||o||0;return!F&&-1}),q=K("IE_PROTO"),$=function(t,e){var n,i=T(t),r=0,s=[];for(n in i)n!=q&&w(i,n)&&s.push(n);for(;e.length>r;)w(i,n=e[r++])&&(~U(s,n)||s.push(n));return s},z="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),G=Object.keys||function(t){return $(t,z)},J={f:Object.getOwnPropertySymbols},W={f:{}.propertyIsEnumerable},Y=function(t){return Object(I(t))},X=Object.assign,Z=!X||h(function(){var t={},e={},n=Symbol(),i="abcdefghijklmnopqrst";return t[n]=7,i.split("").forEach(function(t){e[t]=t}),7!=X({},t)[n]||Object.keys(X({},e)).join("")!=i})?function(t,e){for(var n=Y(t),i=arguments.length,r=1,s=J.f,o=W.f;i>r;)for(var a,u=C(arguments[r++]),h=s?G(u).concat(s(u)):G(u),c=h.length,f=0;c>f;)o.call(u,a=h[f++])&&(n[a]=u[a]);return n}:X;E(E.S+E.F,"Object",{assign:Z});var Q=r.Object.assign,tt=e(n(function(t){t.exports={default:Q,__esModule:!0}})),et=n(function(t,e){t.exports=e=self.fetch,e.default=self.fetch.bind(self),e.Headers=self.Headers,e.Request=self.Request,e.Response=self.Response}),nt=(et.Headers,et.Request,et.Response,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),it=[],rt=[],st="undefined"!=typeof Uint8Array?Uint8Array:Array,ot=!1;function at(){ot=!0;for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=0,n=t.length;e<n;++e)it[e]=t[e],rt[t.charCodeAt(e)]=e;rt["-".charCodeAt(0)]=62,rt["_".charCodeAt(0)]=63}function ut(t,e,n){for(var i,r,s=[],o=e;o<n;o+=3)i=(t[o]<<16)+(t[o+1]<<8)+t[o+2],s.push(it[(r=i)>>18&63]+it[r>>12&63]+it[r>>6&63]+it[63&r]);return s.join("")}function ht(t){var e;ot||at();for(var n=t.length,i=n%3,r="",s=[],o=0,a=n-i;o<a;o+=16383)s.push(ut(t,o,o+16383>a?a:o+16383));return 1===i?(e=t[n-1],r+=it[e>>2],r+=it[e<<4&63],r+="=="):2===i&&(e=(t[n-2]<<8)+t[n-1],r+=it[e>>10],r+=it[e>>4&63],r+=it[e<<2&63],r+="="),s.push(r),s.join("")}function ct(t,e,n,i,r){var s,o,a=8*r-i-1,u=(1<<a)-1,h=u>>1,c=-7,f=n?r-1:0,l=n?-1:1,d=t[e+f];for(f+=l,s=d&(1<<-c)-1,d>>=-c,c+=a;c>0;s=256*s+t[e+f],f+=l,c-=8);for(o=s&(1<<-c)-1,s>>=-c,c+=i;c>0;o=256*o+t[e+f],f+=l,c-=8);if(0===s)s=1-h;else{if(s===u)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=h}return(d?-1:1)*o*Math.pow(2,s-i)}function ft(t,e,n,i,r,s){var o,a,u,h=8*s-r-1,c=(1<<h)-1,f=c>>1,l=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=c):(o=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-o))<1&&(o--,u*=2),(e+=o+f>=1?l/u:l*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=c?(a=0,o=c):o+f>=1?(a=(e*u-1)*Math.pow(2,r),o+=f):(a=e*Math.pow(2,f-1)*Math.pow(2,r),o=0));r>=8;t[n+d]=255&a,d+=p,a/=256,r-=8);for(o=o<<r|a,h+=r;h>0;t[n+d]=255&o,d+=p,o/=256,h-=8);t[n+d-p]|=128*g}var lt={}.toString,dt=Array.isArray||function(t){return"[object Array]"==lt.call(t)};function pt(){return vt.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function gt(t,e){if(pt()<e)throw new RangeError("Invalid typed array length");return vt.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=vt.prototype:(null===t&&(t=new vt(e)),t.length=e),t}function vt(t,e,n){if(!(vt.TYPED_ARRAY_SUPPORT||this instanceof vt))return new vt(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return bt(this,t)}return yt(this,t,e,n)}function yt(t,e,n,i){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,i){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");e=void 0===n&&void 0===i?new Uint8Array(e):void 0===i?new Uint8Array(e,n):new Uint8Array(e,n,i);vt.TYPED_ARRAY_SUPPORT?(t=e).__proto__=vt.prototype:t=St(t,e);return t}(t,e,n,i):"string"==typeof e?function(t,e,n){"string"==typeof n&&""!==n||(n="utf8");if(!vt.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|Ft(e,n),r=(t=gt(t,i)).write(e,n);r!==i&&(t=t.slice(0,r));return t}(t,e,n):function(t,e){if(xt(e)){var n=0|wt(e.length);return 0===(t=gt(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?gt(t,0):St(t,e);if("Buffer"===e.type&&dt(e.data))return St(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function mt(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function bt(t,e){if(mt(e),t=gt(t,e<0?0:0|wt(e)),!vt.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function St(t,e){var n=e.length<0?0:0|wt(e.length);t=gt(t,n);for(var i=0;i<n;i+=1)t[i]=255&e[i];return t}function wt(t){if(t>=pt())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+pt().toString(16)+" bytes");return 0|t}function xt(t){return!(null==t||!t._isBuffer)}function Ft(t,e){if(xt(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Wt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Yt(t).length;default:if(i)return Wt(t).length;e=(""+e).toLowerCase(),i=!0}}function Et(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function At(t,e,n,i,r){if(0===t.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=vt.from(e,i)),xt(e))return 0===e.length?-1:Dt(t,e,n,i,r);if("number"==typeof e)return e&=255,vt.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):Dt(t,[e],n,i,r);throw new TypeError("val must be string, number or Buffer")}function Dt(t,e,n,i,r){var s,o=1,a=t.length,u=e.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,u/=2,n/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var c=-1;for(s=n;s<a;s++)if(h(t,s)===h(e,-1===c?0:s-c)){if(-1===c&&(c=s),s-c+1===u)return c*o}else-1!==c&&(s-=s-c),c=-1}else for(n+u>a&&(n=a-u),s=n;s>=0;s--){for(var f=!0,l=0;l<u;l++)if(h(t,s+l)!==h(e,l)){f=!1;break}if(f)return s}return-1}function Ct(t,e,n,i){n=Number(n)||0;var r=t.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=e.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(isNaN(a))return o;t[n+o]=a}return o}function It(t,e,n,i){return Xt(Wt(e,t.length-n),t,n,i)}function Tt(t,e,n,i){return Xt(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,i)}function Pt(t,e,n,i){return Tt(t,e,n,i)}function jt(t,e,n,i){return Xt(Yt(e),t,n,i)}function Ht(t,e,n,i){return Xt(function(t,e){for(var n,i,r,s=[],o=0;o<t.length&&!((e-=2)<0);++o)n=t.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(e,t.length-n),t,n,i)}function _t(t,e,n){return 0===e&&n===t.length?ht(t):ht(t.slice(e,n))}function Rt(t,e,n){n=Math.min(t.length,n);for(var i=[],r=e;r<n;){var s,o,a,u,h=t[r],c=null,f=h>239?4:h>223?3:h>191?2:1;if(r+f<=n)switch(f){case 1:h<128&&(c=h);break;case 2:128==(192&(s=t[r+1]))&&(u=(31&h)<<6|63&s)>127&&(c=u);break;case 3:s=t[r+1],o=t[r+2],128==(192&s)&&128==(192&o)&&(u=(15&h)<<12|(63&s)<<6|63&o)>2047&&(u<55296||u>57343)&&(c=u);break;case 4:s=t[r+1],o=t[r+2],a=t[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(u=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&u<1114112&&(c=u)}null===c?(c=65533,f=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),r+=f}return function(t){var e=t.length;if(e<=kt)return String.fromCharCode.apply(String,t);var n="",i=0;for(;i<e;)n+=String.fromCharCode.apply(String,t.slice(i,i+=kt));return n}(i)}vt.TYPED_ARRAY_SUPPORT=void 0===nt.TYPED_ARRAY_SUPPORT||nt.TYPED_ARRAY_SUPPORT,vt.poolSize=8192,vt._augment=function(t){return t.__proto__=vt.prototype,t},vt.from=function(t,e,n){return yt(null,t,e,n)},vt.TYPED_ARRAY_SUPPORT&&(vt.prototype.__proto__=Uint8Array.prototype,vt.__proto__=Uint8Array),vt.alloc=function(t,e,n){return function(t,e,n,i){return mt(e),e<=0?gt(t,e):void 0!==n?"string"==typeof i?gt(t,e).fill(n,i):gt(t,e).fill(n):gt(t,e)}(null,t,e,n)},vt.allocUnsafe=function(t){return bt(null,t)},vt.allocUnsafeSlow=function(t){return bt(null,t)},vt.isBuffer=function(t){return null!=t&&(!!t._isBuffer||Zt(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&Zt(t.slice(0,0))}(t))},vt.compare=function(t,e){if(!xt(t)||!xt(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,i=e.length,r=0,s=Math.min(n,i);r<s;++r)if(t[r]!==e[r]){n=t[r],i=e[r];break}return n<i?-1:i<n?1:0},vt.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},vt.concat=function(t,e){if(!dt(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return vt.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=vt.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var s=t[n];if(!xt(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,r),r+=s.length}return i},vt.byteLength=Ft,vt.prototype._isBuffer=!0,vt.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)Et(this,e,e+1);return this},vt.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)Et(this,e,e+3),Et(this,e+1,e+2);return this},vt.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)Et(this,e,e+7),Et(this,e+1,e+6),Et(this,e+2,e+5),Et(this,e+3,e+4);return this},vt.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?Rt(this,0,t):function(t,e,n){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Ot(this,e,n);case"utf8":case"utf-8":return Rt(this,e,n);case"ascii":return Bt(this,e,n);case"latin1":case"binary":return Nt(this,e,n);case"base64":return _t(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Vt(this,e,n);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}.apply(this,arguments)},vt.prototype.equals=function(t){if(!xt(t))throw new TypeError("Argument must be a Buffer");return this===t||0===vt.compare(this,t)},vt.prototype.inspect=function(){var t="";return this.length>0&&(t=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(t+=" ... ")),"<Buffer "+t+">"},vt.prototype.compare=function(t,e,n,i,r){if(!xt(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),e<0||n>t.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&e>=n)return 0;if(i>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(e>>>=0),a=Math.min(s,o),u=this.slice(i,r),h=t.slice(e,n),c=0;c<a;++c)if(u[c]!==h[c]){s=u[c],o=h[c];break}return s<o?-1:o<s?1:0},vt.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},vt.prototype.indexOf=function(t,e,n){return At(this,t,e,n,!0)},vt.prototype.lastIndexOf=function(t,e,n){return At(this,t,e,n,!1)},vt.prototype.write=function(t,e,n,i){if(void 0===e)i="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)i=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return Ct(this,t,e,n);case"utf8":case"utf-8":return It(this,t,e,n);case"ascii":return Tt(this,t,e,n);case"latin1":case"binary":return Pt(this,t,e,n);case"base64":return jt(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ht(this,t,e,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},vt.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var kt=4096;function Bt(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(127&t[r]);return i}function Nt(t,e,n){var i="";n=Math.min(t.length,n);for(var r=e;r<n;++r)i+=String.fromCharCode(t[r]);return i}function Ot(t,e,n){var i=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=e;s<n;++s)r+=Jt(t[s]);return r}function Vt(t,e,n){for(var i=t.slice(e,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function Lt(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Mt(t,e,n,i,r,s){if(!xt(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<s)throw new RangeError('"value" argument is out of bounds');if(n+i>t.length)throw new RangeError("Index out of range")}function Kt(t,e,n,i){e<0&&(e=65535+e+1);for(var r=0,s=Math.min(t.length-n,2);r<s;++r)t[n+r]=(e&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function Ut(t,e,n,i){e<0&&(e=4294967295+e+1);for(var r=0,s=Math.min(t.length-n,4);r<s;++r)t[n+r]=e>>>8*(i?r:3-r)&255}function qt(t,e,n,i,r,s){if(n+i>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function $t(t,e,n,i,r){return r||qt(t,0,n,4),ft(t,e,n,i,23,4),n+4}function zt(t,e,n,i,r){return r||qt(t,0,n,8),ft(t,e,n,i,52,8),n+8}vt.prototype.slice=function(t,e){var n,i=this.length;if((t=~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),(e=void 0===e?i:~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),e<t&&(e=t),vt.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=vt.prototype;else{var r=e-t;n=new vt(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+t]}return n},vt.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||Lt(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i},vt.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||Lt(t,e,this.length);for(var i=this[t+--e],r=1;e>0&&(r*=256);)i+=this[t+--e]*r;return i},vt.prototype.readUInt8=function(t,e){return e||Lt(t,1,this.length),this[t]},vt.prototype.readUInt16LE=function(t,e){return e||Lt(t,2,this.length),this[t]|this[t+1]<<8},vt.prototype.readUInt16BE=function(t,e){return e||Lt(t,2,this.length),this[t]<<8|this[t+1]},vt.prototype.readUInt32LE=function(t,e){return e||Lt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},vt.prototype.readUInt32BE=function(t,e){return e||Lt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},vt.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||Lt(t,e,this.length);for(var i=this[t],r=1,s=0;++s<e&&(r*=256);)i+=this[t+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},vt.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||Lt(t,e,this.length);for(var i=e,r=1,s=this[t+--i];i>0&&(r*=256);)s+=this[t+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*e)),s},vt.prototype.readInt8=function(t,e){return e||Lt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},vt.prototype.readInt16LE=function(t,e){e||Lt(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},vt.prototype.readInt16BE=function(t,e){e||Lt(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},vt.prototype.readInt32LE=function(t,e){return e||Lt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},vt.prototype.readInt32BE=function(t,e){return e||Lt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},vt.prototype.readFloatLE=function(t,e){return e||Lt(t,4,this.length),ct(this,t,!0,23,4)},vt.prototype.readFloatBE=function(t,e){return e||Lt(t,4,this.length),ct(this,t,!1,23,4)},vt.prototype.readDoubleLE=function(t,e){return e||Lt(t,8,this.length),ct(this,t,!0,52,8)},vt.prototype.readDoubleBE=function(t,e){return e||Lt(t,8,this.length),ct(this,t,!1,52,8)},vt.prototype.writeUIntLE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||Mt(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[e]=255&t;++s<n&&(r*=256);)this[e+s]=t/r&255;return e+n},vt.prototype.writeUIntBE=function(t,e,n,i){(t=+t,e|=0,n|=0,i)||Mt(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[e+r]=255&t;--r>=0&&(s*=256);)this[e+r]=t/s&255;return e+n},vt.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,1,255,0),vt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},vt.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,65535,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Kt(this,t,e,!0),e+2},vt.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,65535,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Kt(this,t,e,!1),e+2},vt.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,4294967295,0),vt.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):Ut(this,t,e,!0),e+4},vt.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,4294967295,0),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ut(this,t,e,!1),e+4},vt.prototype.writeIntLE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Mt(this,t,e,n,r-1,-r)}var s=0,o=1,a=0;for(this[e]=255&t;++s<n&&(o*=256);)t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},vt.prototype.writeIntBE=function(t,e,n,i){if(t=+t,e|=0,!i){var r=Math.pow(2,8*n-1);Mt(this,t,e,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[e+s]=255&t;--s>=0&&(o*=256);)t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o>>0)-a&255;return e+n},vt.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,1,127,-128),vt.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},vt.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,32767,-32768),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):Kt(this,t,e,!0),e+2},vt.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,2,32767,-32768),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):Kt(this,t,e,!1),e+2},vt.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,2147483647,-2147483648),vt.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):Ut(this,t,e,!0),e+4},vt.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||Mt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),vt.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):Ut(this,t,e,!1),e+4},vt.prototype.writeFloatLE=function(t,e,n){return $t(this,t,e,!0,n)},vt.prototype.writeFloatBE=function(t,e,n){return $t(this,t,e,!1,n)},vt.prototype.writeDoubleLE=function(t,e,n){return zt(this,t,e,!0,n)},vt.prototype.writeDoubleBE=function(t,e,n){return zt(this,t,e,!1,n)},vt.prototype.copy=function(t,e,n,i){if(n||(n=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var r,s=i-n;if(this===t&&n<e&&e<i)for(r=s-1;r>=0;--r)t[r+e]=this[r+n];else if(s<1e3||!vt.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)t[r+e]=this[r+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},vt.prototype.fill=function(t,e,n,i){if("string"==typeof t){if("string"==typeof e?(i=e,e=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!vt.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var s;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(s=e;s<n;++s)this[s]=t;else{var o=xt(t)?t:Wt(new vt(t,i).toString()),a=o.length;for(s=0;s<n-e;++s)this[s+e]=o[s%a]}return this};var Gt=/[^+\/0-9A-Za-z-_]/g;function Jt(t){return t<16?"0"+t.toString(16):t.toString(16)}function Wt(t,e){var n;e=e||1/0;for(var i=t.length,r=null,s=[],o=0;o<i;++o){if((n=t.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;s.push(n)}else if(n<2048){if((e-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function Yt(t){return function(t){var e,n,i,r,s,o;ot||at();var a=t.length;if(a%4>0)throw new Error("Invalid string. Length must be a multiple of 4");s="="===t[a-2]?2:"="===t[a-1]?1:0,o=new st(3*a/4-s),i=s>0?a-4:a;var u=0;for(e=0,n=0;e<i;e+=4,n+=3)r=rt[t.charCodeAt(e)]<<18|rt[t.charCodeAt(e+1)]<<12|rt[t.charCodeAt(e+2)]<<6|rt[t.charCodeAt(e+3)],o[u++]=r>>16&255,o[u++]=r>>8&255,o[u++]=255&r;return 2===s?(r=rt[t.charCodeAt(e)]<<2|rt[t.charCodeAt(e+1)]>>4,o[u++]=255&r):1===s&&(r=rt[t.charCodeAt(e)]<<10|rt[t.charCodeAt(e+1)]<<4|rt[t.charCodeAt(e+2)]>>2,o[u++]=r>>8&255,o[u++]=255&r),o}(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(Gt,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Xt(t,e,n,i){for(var r=0;r<i&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function Zt(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}var Qt={userAgent:!1},te={};if(void 0===ee)var ee={};ee.lang={extend:function(t,e,n){if(!e||!t)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var i=function(){};if(i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e),n){var r;for(r in n)t.prototype[r]=n[r];var s=function(){},o=["toString","valueOf"];try{/MSIE/.test(Qt.userAgent)&&(s=function(t,e){for(r=0;r<o.length;r+=1){var n=o[r],i=e[n];"function"==typeof i&&i!=Object.prototype[n]&&(t[n]=i)}})}catch(t){}s(t.prototype,n)}}};var ne,ie,re,se,oe=oe||function(t,e){var n={},i=n.lib={},r=i.Base=function(){function t(){}return{extend:function(e){t.prototype=this;var n=new t;return e&&n.mixIn(e),n.hasOwnProperty("init")||(n.init=function(){n.$super.init.apply(this,arguments)}),n.init.prototype=n,n.$super=this,n},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),s=i.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes,r=t.sigBytes;if(this.clamp(),i%4)for(var s=0;s<r;s++){var o=n[s>>>2]>>>24-s%4*8&255;e[i+s>>>2]|=o<<24-(i+s)%4*8}else for(s=0;s<r;s+=4)e[i+s>>>2]=n[s>>>2];return this.sigBytes+=r,this},clamp:function(){var e=this.words,n=this.sigBytes;e[n>>>2]&=4294967295<<32-n%4*8,e.length=t.ceil(n/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(e){for(var n=[],i=0;i<e;i+=4)n.push(4294967296*t.random()|0);return new s.init(n,e)}}),o=n.enc={},a=o.Hex={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push((s>>>4).toString(16)),i.push((15&s).toString(16))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new s.init(n,e/2)}},u=o.Latin1={stringify:function(t){for(var e=t.words,n=t.sigBytes,i=[],r=0;r<n;r++){var s=e[r>>>2]>>>24-r%4*8&255;i.push(String.fromCharCode(s))}return i.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new s.init(n,e)}},h=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(u.stringify(t)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(t){return u.parse(unescape(encodeURIComponent(t)))}},c=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=h.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(e){var n=this._data,i=n.words,r=n.sigBytes,o=this.blockSize,a=r/(4*o),u=(a=e?t.ceil(a):t.max((0|a)-this._minBufferSize,0))*o,h=t.min(4*u,r);if(u){for(var c=0;c<u;c+=o)this._doProcessBlock(i,c);var f=i.splice(0,u);n.sigBytes-=h}return new s.init(f,h)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0}),f=(i.Hasher=c.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){c.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(t){return function(e,n){return new t.init(n).finalize(e)}},_createHmacHelper:function(t){return function(e,n){return new f.HMAC.init(t,n).finalize(e)}}}),n.algo={});return n}(Math);!function(t){var e,n=(e=oe).lib,i=n.Base,r=n.WordArray;(e=e.x64={}).Word=i.extend({init:function(t,e){this.high=t,this.low=e}}),e.WordArray=i.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:8*t.length},toX32:function(){for(var t=this.words,e=t.length,n=[],i=0;i<e;i++){var s=t[i];n.push(s.high),n.push(s.low)}return r.create(n,this.sigBytes)},clone:function(){for(var t=i.clone.call(this),e=t.words=this.words.slice(0),n=e.length,r=0;r<n;r++)e[r]=e[r].clone();return t}})}(),oe.lib.Cipher||function(t){var e=(d=oe).lib,n=e.Base,i=e.WordArray,r=e.BufferedBlockAlgorithm,s=d.enc.Base64,o=d.algo.EvpKDF,a=e.Cipher=r.extend({cfg:n.extend(),createEncryptor:function(t,e){return this.create(this._ENC_XFORM_MODE,t,e)},createDecryptor:function(t,e){return this.create(this._DEC_XFORM_MODE,t,e)},init:function(t,e,n){this.cfg=this.cfg.extend(n),this._xformMode=t,this._key=e,this.reset()},reset:function(){r.reset.call(this),this._doReset()},process:function(t){return this._append(t),this._process()},finalize:function(t){return t&&this._append(t),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(e,n,i){return("string"==typeof n?p:l).encrypt(t,e,n,i)},decrypt:function(e,n,i){return("string"==typeof n?p:l).decrypt(t,e,n,i)}}}});e.StreamCipher=a.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var u=d.mode={},h=function(t,e,n){var i=this._iv;i?this._iv=void 0:i=this._prevBlock;for(var r=0;r<n;r++)t[e+r]^=i[r]},c=(e.BlockCipherMode=n.extend({createEncryptor:function(t,e){return this.Encryptor.create(t,e)},createDecryptor:function(t,e){return this.Decryptor.create(t,e)},init:function(t,e){this._cipher=t,this._iv=e}})).extend();c.Encryptor=c.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize;h.call(this,t,e,i),n.encryptBlock(t,e),this._prevBlock=t.slice(e,e+i)}}),c.Decryptor=c.extend({processBlock:function(t,e){var n=this._cipher,i=n.blockSize,r=t.slice(e,e+i);n.decryptBlock(t,e),h.call(this,t,e,i),this._prevBlock=r}}),u=u.CBC=c,c=(d.pad={}).Pkcs7={pad:function(t,e){for(var n,r=(n=(n=4*e)-t.sigBytes%n)<<24|n<<16|n<<8|n,s=[],o=0;o<n;o+=4)s.push(r);n=i.create(s,n),t.concat(n)},unpad:function(t){t.sigBytes-=255&t.words[t.sigBytes-1>>>2]}},e.BlockCipher=a.extend({cfg:a.cfg.extend({mode:u,padding:c}),reset:function(){a.reset.call(this);var t=(e=this.cfg).iv,e=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var n=e.createEncryptor;else n=e.createDecryptor,this._minBufferSize=1;this._mode=n.call(e,this,t&&t.words)},_doProcessBlock:function(t,e){this._mode.processBlock(t,e)},_doFinalize:function(){var t=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){t.pad(this._data,this.blockSize);var e=this._process(!0)}else e=this._process(!0),t.unpad(e);return e},blockSize:4});var f=e.CipherParams=n.extend({init:function(t){this.mixIn(t)},toString:function(t){return(t||this.formatter).stringify(this)}}),l=(u=(d.format={}).OpenSSL={stringify:function(t){var e=t.ciphertext;return((t=t.salt)?i.create([1398893684,1701076831]).concat(t).concat(e):e).toString(s)},parse:function(t){var e=(t=s.parse(t)).words;if(1398893684==e[0]&&1701076831==e[1]){var n=i.create(e.slice(2,4));e.splice(0,4),t.sigBytes-=16}return f.create({ciphertext:t,salt:n})}},e.SerializableCipher=n.extend({cfg:n.extend({format:u}),encrypt:function(t,e,n,i){i=this.cfg.extend(i);var r=t.createEncryptor(n,i);return e=r.finalize(e),r=r.cfg,f.create({ciphertext:e,key:n,iv:r.iv,algorithm:t,mode:r.mode,padding:r.padding,blockSize:t.blockSize,formatter:i.format})},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),t.createDecryptor(n,i).finalize(e.ciphertext)},_parse:function(t,e){return"string"==typeof t?e.parse(t,this):t}})),d=(d.kdf={}).OpenSSL={execute:function(t,e,n,r){return r||(r=i.random(8)),t=o.create({keySize:e+n}).compute(t,r),n=i.create(t.words.slice(e),4*n),t.sigBytes=4*e,f.create({key:t,iv:n,salt:r})}},p=e.PasswordBasedCipher=l.extend({cfg:l.cfg.extend({kdf:d}),encrypt:function(t,e,n,i){return n=(i=this.cfg.extend(i)).kdf.execute(n,t.keySize,t.ivSize),i.iv=n.iv,(t=l.encrypt.call(this,t,e,n.key,i)).mixIn(n),t},decrypt:function(t,e,n,i){return i=this.cfg.extend(i),e=this._parse(e,i.format),n=i.kdf.execute(n,t.keySize,t.ivSize,e.salt),i.iv=n.iv,l.decrypt.call(this,t,e,n.key,i)}})}(),function(){for(var t=oe,e=t.lib.BlockCipher,n=t.algo,i=[],r=[],s=[],o=[],a=[],u=[],h=[],c=[],f=[],l=[],d=[],p=0;256>p;p++)d[p]=128>p?p<<1:p<<1^283;var g=0,v=0;for(p=0;256>p;p++){var y=(y=v^v<<1^v<<2^v<<3^v<<4)>>>8^255&y^99;i[g]=y,r[y]=g;var m=d[g],b=d[m],S=d[b],w=257*d[y]^16843008*y;s[g]=w<<24|w>>>8,o[g]=w<<16|w>>>16,a[g]=w<<8|w>>>24,u[g]=w,w=16843009*S^65537*b^257*m^16843008*g,h[y]=w<<24|w>>>8,c[y]=w<<16|w>>>16,f[y]=w<<8|w>>>24,l[y]=w,g?(g=m^d[d[d[S^m]]],v^=d[d[v]]):g=v=1}var x=[0,1,2,4,8,16,32,64,128,27,54];n=n.AES=e.extend({_doReset:function(){for(var t=(n=this._key).words,e=n.sigBytes/4,n=4*((this._nRounds=e+6)+1),r=this._keySchedule=[],s=0;s<n;s++)if(s<e)r[s]=t[s];else{var o=r[s-1];s%e?6<e&&4==s%e&&(o=i[o>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o]):(o=i[(o=o<<8|o>>>24)>>>24]<<24|i[o>>>16&255]<<16|i[o>>>8&255]<<8|i[255&o],o^=x[s/e|0]<<24),r[s]=r[s-e]^o}for(t=this._invKeySchedule=[],e=0;e<n;e++)s=n-e,o=e%4?r[s]:r[s-4],t[e]=4>e||4>=s?o:h[i[o>>>24]]^c[i[o>>>16&255]]^f[i[o>>>8&255]]^l[i[255&o]]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._keySchedule,s,o,a,u,i)},decryptBlock:function(t,e){var n=t[e+1];t[e+1]=t[e+3],t[e+3]=n,this._doCryptBlock(t,e,this._invKeySchedule,h,c,f,l,r),n=t[e+1],t[e+1]=t[e+3],t[e+3]=n},_doCryptBlock:function(t,e,n,i,r,s,o,a){for(var u=this._nRounds,h=t[e]^n[0],c=t[e+1]^n[1],f=t[e+2]^n[2],l=t[e+3]^n[3],d=4,p=1;p<u;p++){var g=i[h>>>24]^r[c>>>16&255]^s[f>>>8&255]^o[255&l]^n[d++],v=i[c>>>24]^r[f>>>16&255]^s[l>>>8&255]^o[255&h]^n[d++],y=i[f>>>24]^r[l>>>16&255]^s[h>>>8&255]^o[255&c]^n[d++];l=i[l>>>24]^r[h>>>16&255]^s[c>>>8&255]^o[255&f]^n[d++],h=g,c=v,f=y}g=(a[h>>>24]<<24|a[c>>>16&255]<<16|a[f>>>8&255]<<8|a[255&l])^n[d++],v=(a[c>>>24]<<24|a[f>>>16&255]<<16|a[l>>>8&255]<<8|a[255&h])^n[d++],y=(a[f>>>24]<<24|a[l>>>16&255]<<16|a[h>>>8&255]<<8|a[255&c])^n[d++],l=(a[l>>>24]<<24|a[h>>>16&255]<<16|a[c>>>8&255]<<8|a[255&f])^n[d++],t[e]=g,t[e+1]=v,t[e+2]=y,t[e+3]=l},keySize:8});t.AES=e._createHelper(n)}(),function(){function t(t,e){var n=(this._lBlock>>>t^this._rBlock)&e;this._rBlock^=n,this._lBlock^=n<<t}function e(t,e){var n=(this._rBlock>>>t^this._lBlock)&e;this._lBlock^=n,this._rBlock^=n<<t}var n=oe,i=(r=n.lib).WordArray,r=r.BlockCipher,s=n.algo,o=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],a=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],u=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],h=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],c=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],f=s.DES=r.extend({_doReset:function(){for(var t=this._key.words,e=[],n=0;56>n;n++){var i=o[n]-1;e[n]=t[i>>>5]>>>31-i%32&1}for(t=this._subKeys=[],i=0;16>i;i++){var r=t[i]=[],s=u[i];for(n=0;24>n;n++)r[n/6|0]|=e[(a[n]-1+s)%28]<<31-n%6,r[4+(n/6|0)]|=e[28+(a[n+24]-1+s)%28]<<31-n%6;for(r[0]=r[0]<<1|r[0]>>>31,n=1;7>n;n++)r[n]>>>=4*(n-1)+3;r[7]=r[7]<<5|r[7]>>>27}for(e=this._invSubKeys=[],n=0;16>n;n++)e[n]=t[15-n]},encryptBlock:function(t,e){this._doCryptBlock(t,e,this._subKeys)},decryptBlock:function(t,e){this._doCryptBlock(t,e,this._invSubKeys)},_doCryptBlock:function(n,i,r){this._lBlock=n[i],this._rBlock=n[i+1],t.call(this,4,252645135),t.call(this,16,65535),e.call(this,2,858993459),e.call(this,8,16711935),t.call(this,1,1431655765);for(var s=0;16>s;s++){for(var o=r[s],a=this._lBlock,u=this._rBlock,f=0,l=0;8>l;l++)f|=h[l][((u^o[l])&c[l])>>>0];this._lBlock=u,this._rBlock=a^f}r=this._lBlock,this._lBlock=this._rBlock,this._rBlock=r,t.call(this,1,1431655765),e.call(this,8,16711935),e.call(this,2,858993459),t.call(this,16,65535),t.call(this,4,252645135),n[i]=this._lBlock,n[i+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});n.DES=r._createHelper(f),s=s.TripleDES=r.extend({_doReset:function(){var t=this._key.words;this._des1=f.createEncryptor(i.create(t.slice(0,2))),this._des2=f.createEncryptor(i.create(t.slice(2,4))),this._des3=f.createEncryptor(i.create(t.slice(4,6)))},encryptBlock:function(t,e){this._des1.encryptBlock(t,e),this._des2.decryptBlock(t,e),this._des3.encryptBlock(t,e)},decryptBlock:function(t,e){this._des3.decryptBlock(t,e),this._des2.encryptBlock(t,e),this._des1.decryptBlock(t,e)},keySize:6,ivSize:2,blockSize:2}),n.TripleDES=r._createHelper(s)}(),function(){var t=oe,e=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp(),t=[];for(var r=0;r<n;r+=3)for(var s=(e[r>>>2]>>>24-r%4*8&255)<<16|(e[r+1>>>2]>>>24-(r+1)%4*8&255)<<8|e[r+2>>>2]>>>24-(r+2)%4*8&255,o=0;4>o&&r+.75*o<n;o++)t.push(i.charAt(s>>>6*(3-o)&63));if(e=i.charAt(64))for(;t.length%4;)t.push(e);return t.join("")},parse:function(t){var n=t.length,i=this._map;(r=i.charAt(64))&&(-1!=(r=t.indexOf(r))&&(n=r));for(var r=[],s=0,o=0;o<n;o++)if(o%4){var a=i.indexOf(t.charAt(o-1))<<o%4*2,u=i.indexOf(t.charAt(o))>>>6-o%4*2;r[s>>>2]|=(a|u)<<24-s%4*8,s++}return e.create(r,s)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(t){function e(t,e,n,i,r,s,o){return((t=t+(e&n|~e&i)+r+o)<<s|t>>>32-s)+e}function n(t,e,n,i,r,s,o){return((t=t+(e&i|n&~i)+r+o)<<s|t>>>32-s)+e}function i(t,e,n,i,r,s,o){return((t=t+(e^n^i)+r+o)<<s|t>>>32-s)+e}function r(t,e,n,i,r,s,o){return((t=t+(n^(e|~i))+r+o)<<s|t>>>32-s)+e}for(var s=oe,o=(u=s.lib).WordArray,a=u.Hasher,u=s.algo,h=[],c=0;64>c;c++)h[c]=4294967296*t.abs(t.sin(c+1))|0;u=u.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(t,s){for(var o=0;16>o;o++){var a=t[u=s+o];t[u]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}o=this._hash.words;var u=t[s+0],c=(a=t[s+1],t[s+2]),f=t[s+3],l=t[s+4],d=t[s+5],p=t[s+6],g=t[s+7],v=t[s+8],y=t[s+9],m=t[s+10],b=t[s+11],S=t[s+12],w=t[s+13],x=t[s+14],F=t[s+15],E=e(E=o[0],C=o[1],D=o[2],A=o[3],u,7,h[0]),A=e(A,E,C,D,a,12,h[1]),D=e(D,A,E,C,c,17,h[2]),C=e(C,D,A,E,f,22,h[3]);E=e(E,C,D,A,l,7,h[4]),A=e(A,E,C,D,d,12,h[5]),D=e(D,A,E,C,p,17,h[6]),C=e(C,D,A,E,g,22,h[7]),E=e(E,C,D,A,v,7,h[8]),A=e(A,E,C,D,y,12,h[9]),D=e(D,A,E,C,m,17,h[10]),C=e(C,D,A,E,b,22,h[11]),E=e(E,C,D,A,S,7,h[12]),A=e(A,E,C,D,w,12,h[13]),D=e(D,A,E,C,x,17,h[14]),E=n(E,C=e(C,D,A,E,F,22,h[15]),D,A,a,5,h[16]),A=n(A,E,C,D,p,9,h[17]),D=n(D,A,E,C,b,14,h[18]),C=n(C,D,A,E,u,20,h[19]),E=n(E,C,D,A,d,5,h[20]),A=n(A,E,C,D,m,9,h[21]),D=n(D,A,E,C,F,14,h[22]),C=n(C,D,A,E,l,20,h[23]),E=n(E,C,D,A,y,5,h[24]),A=n(A,E,C,D,x,9,h[25]),D=n(D,A,E,C,f,14,h[26]),C=n(C,D,A,E,v,20,h[27]),E=n(E,C,D,A,w,5,h[28]),A=n(A,E,C,D,c,9,h[29]),D=n(D,A,E,C,g,14,h[30]),E=i(E,C=n(C,D,A,E,S,20,h[31]),D,A,d,4,h[32]),A=i(A,E,C,D,v,11,h[33]),D=i(D,A,E,C,b,16,h[34]),C=i(C,D,A,E,x,23,h[35]),E=i(E,C,D,A,a,4,h[36]),A=i(A,E,C,D,l,11,h[37]),D=i(D,A,E,C,g,16,h[38]),C=i(C,D,A,E,m,23,h[39]),E=i(E,C,D,A,w,4,h[40]),A=i(A,E,C,D,u,11,h[41]),D=i(D,A,E,C,f,16,h[42]),C=i(C,D,A,E,p,23,h[43]),E=i(E,C,D,A,y,4,h[44]),A=i(A,E,C,D,S,11,h[45]),D=i(D,A,E,C,F,16,h[46]),E=r(E,C=i(C,D,A,E,c,23,h[47]),D,A,u,6,h[48]),A=r(A,E,C,D,g,10,h[49]),D=r(D,A,E,C,x,15,h[50]),C=r(C,D,A,E,d,21,h[51]),E=r(E,C,D,A,S,6,h[52]),A=r(A,E,C,D,f,10,h[53]),D=r(D,A,E,C,m,15,h[54]),C=r(C,D,A,E,a,21,h[55]),E=r(E,C,D,A,v,6,h[56]),A=r(A,E,C,D,F,10,h[57]),D=r(D,A,E,C,p,15,h[58]),C=r(C,D,A,E,w,21,h[59]),E=r(E,C,D,A,l,6,h[60]),A=r(A,E,C,D,b,10,h[61]),D=r(D,A,E,C,c,15,h[62]),C=r(C,D,A,E,y,21,h[63]);o[0]=o[0]+E|0,o[1]=o[1]+C|0,o[2]=o[2]+D|0,o[3]=o[3]+A|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;n[r>>>5]|=128<<24-r%32;var s=t.floor(i/4294967296);for(n[15+(r+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),n[14+(r+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),e.sigBytes=4*(n.length+1),this._process(),n=(e=this._hash).words,i=0;4>i;i++)r=n[i],n[i]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8);return e},clone:function(){var t=a.clone.call(this);return t._hash=this._hash.clone(),t}}),s.MD5=a._createHelper(u),s.HmacMD5=a._createHmacHelper(u)}(Math),function(){var t=oe,e=(r=t.lib).WordArray,n=r.Hasher,i=[],r=t.algo.SHA1=n.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,r=n[0],s=n[1],o=n[2],a=n[3],u=n[4],h=0;80>h;h++){if(16>h)i[h]=0|t[e+h];else{var c=i[h-3]^i[h-8]^i[h-14]^i[h-16];i[h]=c<<1|c>>>31}c=(r<<5|r>>>27)+u+i[h],c=20>h?c+(1518500249+(s&o|~s&a)):40>h?c+(1859775393+(s^o^a)):60>h?c+((s&o|s&a|o&a)-1894007588):c+((s^o^a)-899497514),u=a,a=o,o=s<<30|s>>>2,s=r,r=c}n[0]=n[0]+r|0,n[1]=n[1]+s|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=Math.floor(n/4294967296),e[15+(i+64>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(r),t.HmacSHA1=n._createHmacHelper(r)}(),function(t){for(var e=oe,n=(r=e.lib).WordArray,i=r.Hasher,r=e.algo,s=[],o=[],a=function(t){return 4294967296*(t-(0|t))|0},u=2,h=0;64>h;){var c;t:{c=u;for(var f=t.sqrt(c),l=2;l<=f;l++)if(!(c%l)){c=!1;break t}c=!0}c&&(8>h&&(s[h]=a(t.pow(u,.5))),o[h]=a(t.pow(u,1/3)),h++),u++}var d=[];r=r.SHA256=i.extend({_doReset:function(){this._hash=new n.init(s.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],s=n[2],a=n[3],u=n[4],h=n[5],c=n[6],f=n[7],l=0;64>l;l++){if(16>l)d[l]=0|t[e+l];else{var p=d[l-15],g=d[l-2];d[l]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+d[l-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+d[l-16]}p=f+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&h^~u&c)+o[l]+d[l],g=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&s^r&s),f=c,c=h,h=u,u=a+p|0,a=s,s=r,r=i,i=p+g|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+s|0,n[3]=n[3]+a|0,n[4]=n[4]+u|0,n[5]=n[5]+h|0,n[6]=n[6]+c|0,n[7]=n[7]+f|0},_doFinalize:function(){var e=this._data,n=e.words,i=8*this._nDataBytes,r=8*e.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=t.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,e.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(r),e.HmacSHA256=i._createHmacHelper(r)}(Math),ie=(ne=oe).lib.WordArray,re=(se=ne.algo).SHA256,se=se.SHA224=re.extend({_doReset:function(){this._hash=new ie.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var t=re._doFinalize.call(this);return t.sigBytes-=4,t}}),ne.SHA224=re._createHelper(se),ne.HmacSHA224=re._createHmacHelper(se),function(){function t(){return i.create.apply(i,arguments)}for(var e=oe,n=e.lib.Hasher,i=(s=e.x64).Word,r=s.WordArray,s=e.algo,o=[t(1116352408,3609767458),t(1899447441,602891725),t(3049323471,3964484399),t(3921009573,2173295548),t(961987163,4081628472),t(1508970993,3053834265),t(2453635748,2937671579),t(2870763221,3664609560),t(3624381080,2734883394),t(310598401,1164996542),t(607225278,1323610764),t(1426881987,3590304994),t(1925078388,4068182383),t(2162078206,991336113),t(2614888103,633803317),t(3248222580,3479774868),t(3835390401,2666613458),t(4022224774,944711139),t(264347078,2341262773),t(604807628,2007800933),t(770255983,1495990901),t(1249150122,1856431235),t(1555081692,3175218132),t(1996064986,2198950837),t(2554220882,3999719339),t(2821834349,766784016),t(2952996808,2566594879),t(3210313671,3203337956),t(3336571891,1034457026),t(3584528711,2466948901),t(113926993,3758326383),t(338241895,168717936),t(666307205,1188179964),t(773529912,1546045734),t(1294757372,1522805485),t(1396182291,2643833823),t(1695183700,2343527390),t(1986661051,1014477480),t(2177026350,1206759142),t(2456956037,344077627),t(2730485921,1290863460),t(2820302411,3158454273),t(3259730800,3505952657),t(3345764771,106217008),t(3516065817,3606008344),t(3600352804,1432725776),t(4094571909,1467031594),t(275423344,851169720),t(430227734,3100823752),t(506948616,1363258195),t(659060556,3750685593),t(883997877,3785050280),t(958139571,3318307427),t(1322822218,3812723403),t(1537002063,2003034995),t(1747873779,3602036899),t(1955562222,1575990012),t(2024104815,1125592928),t(2227730452,2716904306),t(2361852424,442776044),t(2428436474,593698344),t(2756734187,3733110249),t(3204031479,2999351573),t(3329325298,3815920427),t(3391569614,3928383900),t(3515267271,566280711),t(3940187606,3454069534),t(4118630271,4000239992),t(116418474,1914138554),t(174292421,2731055270),t(289380356,3203993006),t(460393269,320620315),t(685471733,587496836),t(852142971,1086792851),t(1017036298,365543100),t(1126000580,2618297676),t(1288033470,3409855158),t(1501505948,4234509866),t(1607167915,987167468),t(1816402316,1246189591)],a=[],u=0;80>u;u++)a[u]=t();s=s.SHA512=n.extend({_doReset:function(){this._hash=new r.init([new i.init(1779033703,4089235720),new i.init(3144134277,2227873595),new i.init(1013904242,4271175723),new i.init(2773480762,1595750129),new i.init(1359893119,2917565137),new i.init(2600822924,725511199),new i.init(528734635,4215389547),new i.init(1541459225,327033209)])},_doProcessBlock:function(t,e){for(var n=(f=this._hash.words)[0],i=f[1],r=f[2],s=f[3],u=f[4],h=f[5],c=f[6],f=f[7],l=n.high,d=n.low,p=i.high,g=i.low,v=r.high,y=r.low,m=s.high,b=s.low,S=u.high,w=u.low,x=h.high,F=h.low,E=c.high,A=c.low,D=f.high,C=f.low,I=l,T=d,P=p,j=g,H=v,_=y,R=m,k=b,B=S,N=w,O=x,V=F,L=E,M=A,K=D,U=C,q=0;80>q;q++){var $=a[q];if(16>q)var z=$.high=0|t[e+2*q],G=$.low=0|t[e+2*q+1];else{z=((G=(z=a[q-15]).high)>>>1|(J=z.low)<<31)^(G>>>8|J<<24)^G>>>7;var J=(J>>>1|G<<31)^(J>>>8|G<<24)^(J>>>7|G<<25),W=((G=(W=a[q-2]).high)>>>19|(Y=W.low)<<13)^(G<<3|Y>>>29)^G>>>6,Y=(Y>>>19|G<<13)^(Y<<3|G>>>29)^(Y>>>6|G<<26),X=(G=a[q-7]).high,Z=(Q=a[q-16]).high,Q=Q.low;z=(z=(z=z+X+((G=J+G.low)>>>0<J>>>0?1:0))+W+((G=G+Y)>>>0<Y>>>0?1:0))+Z+((G=G+Q)>>>0<Q>>>0?1:0);$.high=z,$.low=G}X=B&O^~B&L,Q=N&V^~N&M,$=I&P^I&H^P&H;var tt=T&j^T&_^j&_,et=(J=(I>>>28|T<<4)^(I<<30|T>>>2)^(I<<25|T>>>7),W=(T>>>28|I<<4)^(T<<30|I>>>2)^(T<<25|I>>>7),(Y=o[q]).high),nt=Y.low;Z=K+((B>>>14|N<<18)^(B>>>18|N<<14)^(B<<23|N>>>9))+((Y=U+((N>>>14|B<<18)^(N>>>18|B<<14)^(N<<23|B>>>9)))>>>0<U>>>0?1:0),K=L,U=M,L=O,M=V,O=B,V=N,B=R+(Z=(Z=(Z=Z+X+((Y=Y+Q)>>>0<Q>>>0?1:0))+et+((Y=Y+nt)>>>0<nt>>>0?1:0))+z+((Y=Y+G)>>>0<G>>>0?1:0))+((N=k+Y|0)>>>0<k>>>0?1:0)|0,R=H,k=_,H=P,_=j,P=I,j=T,I=Z+($=J+$+((G=W+tt)>>>0<W>>>0?1:0))+((T=Y+G|0)>>>0<Y>>>0?1:0)|0}d=n.low=d+T,n.high=l+I+(d>>>0<T>>>0?1:0),g=i.low=g+j,i.high=p+P+(g>>>0<j>>>0?1:0),y=r.low=y+_,r.high=v+H+(y>>>0<_>>>0?1:0),b=s.low=b+k,s.high=m+R+(b>>>0<k>>>0?1:0),w=u.low=w+N,u.high=S+B+(w>>>0<N>>>0?1:0),F=h.low=F+V,h.high=x+O+(F>>>0<V>>>0?1:0),A=c.low=A+M,c.high=E+L+(A>>>0<M>>>0?1:0),C=f.low=C+U,f.high=D+K+(C>>>0<U>>>0?1:0)},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[30+(i+128>>>10<<5)]=Math.floor(n/4294967296),e[31+(i+128>>>10<<5)]=n,t.sigBytes=4*e.length,this._process(),this._hash.toX32()},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t},blockSize:32}),e.SHA512=n._createHelper(s),e.HmacSHA512=n._createHmacHelper(s)}(),function(){var t=oe,e=(r=t.x64).Word,n=r.WordArray,i=(r=t.algo).SHA512,r=r.SHA384=i.extend({_doReset:function(){this._hash=new n.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var t=i._doFinalize.call(this);return t.sigBytes-=16,t}});t.SHA384=i._createHelper(r),t.HmacSHA384=i._createHmacHelper(r)}(),function(){var t=oe,e=(i=t.lib).WordArray,n=i.Hasher,i=t.algo,r=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),o=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),a=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=e.create([0,1518500249,1859775393,2400959708,2840853838]),h=e.create([1352829926,1548603684,1836072691,2053994217,0]);i=i.RIPEMD160=n.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=0;16>n;n++){var i=t[S=e+n];t[S]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8)}var c,f,l,d,p,g,v,y,m,b,S=this._hash.words,w=(i=u.words,h.words),x=r.words,F=s.words,E=o.words,A=a.words;g=c=S[0],v=f=S[1],y=l=S[2],m=d=S[3],b=p=S[4];var D;for(n=0;80>n;n+=1)D=c+t[e+x[n]]|0,D=16>n?D+((f^l^d)+i[0]):32>n?D+((f&l|~f&d)+i[1]):48>n?D+(((f|~l)^d)+i[2]):64>n?D+((f&d|l&~d)+i[3]):D+((f^(l|~d))+i[4]),D=(D=(D|=0)<<E[n]|D>>>32-E[n])+p|0,c=p,p=d,d=l<<10|l>>>22,l=f,f=D,D=g+t[e+F[n]]|0,D=16>n?D+((v^(y|~m))+w[0]):32>n?D+((v&m|y&~m)+w[1]):48>n?D+(((v|~y)^m)+w[2]):64>n?D+((v&y|~v&m)+w[3]):D+((v^y^m)+w[4]),D=(D=(D|=0)<<A[n]|D>>>32-A[n])+b|0,g=b,b=m,m=y<<10|y>>>22,y=v,v=D;D=S[1]+l+m|0,S[1]=S[2]+d+b|0,S[2]=S[3]+p+g|0,S[3]=S[4]+c+v|0,S[4]=S[0]+f+y|0,S[0]=D},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;for(e[i>>>5]|=128<<24-i%32,e[14+(i+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),t.sigBytes=4*(e.length+1),this._process(),e=(t=this._hash).words,n=0;5>n;n++)i=e[n],e[n]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8);return t},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.RIPEMD160=n._createHelper(i),t.HmacRIPEMD160=n._createHmacHelper(i)}(Math),function(){var t=oe,e=t.enc.Utf8;t.algo.HMAC=t.lib.Base.extend({init:function(t,n){t=this._hasher=new t.init,"string"==typeof n&&(n=e.parse(n));var i=t.blockSize,r=4*i;n.sigBytes>r&&(n=t.finalize(n)),n.clamp();for(var s=this._oKey=n.clone(),o=this._iKey=n.clone(),a=s.words,u=o.words,h=0;h<i;h++)a[h]^=1549556828,u[h]^=909522486;s.sigBytes=o.sigBytes=r,this.reset()},reset:function(){var t=this._hasher;t.reset(),t.update(this._iKey)},update:function(t){return this._hasher.update(t),this},finalize:function(t){var e=this._hasher;return t=e.finalize(t),e.reset(),e.finalize(this._oKey.clone().concat(t))}})}(),function(){var t,e=oe,n=(t=e.lib).Base,i=t.WordArray,r=(t=e.algo).HMAC,s=t.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:t.SHA1,iterations:1}),init:function(t){this.cfg=this.cfg.extend(t)},compute:function(t,e){var n=this.cfg,s=r.create(n.hasher,t),o=i.create(),a=i.create([1]),u=o.words,h=a.words,c=n.keySize;for(n=n.iterations;u.length<c;){var f=s.update(e).finalize(a);s.reset();for(var l=f.words,d=l.length,p=f,g=1;g<n;g++){p=s.finalize(p),s.reset();for(var v=p.words,y=0;y<d;y++)l[y]^=v[y]}o.concat(f),h[0]++}return o.sigBytes=4*c,o}});e.PBKDF2=function(t,e,n){return s.create(n).compute(t,e)}}();var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ue="=";function he(t){var e,n,i="";for(e=0;e+3<=t.length;e+=3)n=parseInt(t.substring(e,e+3),16),i+=ae.charAt(n>>6)+ae.charAt(63&n);for(e+1==t.length?(n=parseInt(t.substring(e,e+1),16),i+=ae.charAt(n<<2)):e+2==t.length&&(n=parseInt(t.substring(e,e+2),16),i+=ae.charAt(n>>2)+ae.charAt((3&n)<<4));(3&i.length)>0;)i+=ue;return i}function ce(t){var e,n,i,r="",s=0;for(e=0;e<t.length&&t.charAt(e)!=ue;++e)(i=ae.indexOf(t.charAt(e)))<0||(0==s?(r+=ye(i>>2),n=3&i,s=1):1==s?(r+=ye(n<<2|i>>4),n=15&i,s=2):2==s?(r+=ye(n),r+=ye(i>>2),n=3&i,s=3):(r+=ye(n<<2|i>>4),r+=ye(15&i),s=0));return 1==s&&(r+=ye(n<<2)),r}function fe(t,e,n){null!=t&&("number"==typeof t?this.fromNumber(t,e,n):null==e&&"string"!=typeof t?this.fromString(t,256):this.fromString(t,e))}function le(){return new fe(null)}fe.prototype.am=function(t,e,n,i,r,s){for(;--s>=0;){var o=e*this[t++]+n[i]+r;r=Math.floor(o/67108864),n[i++]=67108863&o}return r},fe.prototype.DB=26,fe.prototype.DM=67108863,fe.prototype.DV=1<<26;fe.prototype.FV=Math.pow(2,52),fe.prototype.F1=26,fe.prototype.F2=0;var de,pe,ge="0123456789abcdefghijklmnopqrstuvwxyz",ve=new Array;for(de="0".charCodeAt(0),pe=0;pe<=9;++pe)ve[de++]=pe;for(de="a".charCodeAt(0),pe=10;pe<36;++pe)ve[de++]=pe;for(de="A".charCodeAt(0),pe=10;pe<36;++pe)ve[de++]=pe;function ye(t){return ge.charAt(t)}function me(t,e){var n=ve[t.charCodeAt(e)];return null==n?-1:n}function be(t){var e=le();return e.fromInt(t),e}function Se(t){var e,n=1;return 0!=(e=t>>>16)&&(t=e,n+=16),0!=(e=t>>8)&&(t=e,n+=8),0!=(e=t>>4)&&(t=e,n+=4),0!=(e=t>>2)&&(t=e,n+=2),0!=(e=t>>1)&&(t=e,n+=1),n}function we(t){this.m=t}function xe(t){this.m=t,this.mp=t.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function Fe(t,e){return t&e}function Ee(t,e){return t|e}function Ae(t,e){return t^e}function De(t,e){return t&~e}function Ce(t){if(0==t)return-1;var e=0;return 0==(65535&t)&&(t>>=16,e+=16),0==(255&t)&&(t>>=8,e+=8),0==(15&t)&&(t>>=4,e+=4),0==(3&t)&&(t>>=2,e+=2),0==(1&t)&&++e,e}function Ie(t){for(var e=0;0!=t;)t&=t-1,++e;return e}function Te(){}function Pe(t){return t}function je(t){this.r2=le(),this.q3=le(),fe.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}we.prototype.convert=function(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t},we.prototype.revert=function(t){return t},we.prototype.reduce=function(t){t.divRemTo(this.m,null,t)},we.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},we.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},xe.prototype.convert=function(t){var e=le();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(fe.ZERO)>0&&this.m.subTo(e,e),e},xe.prototype.revert=function(t){var e=le();return t.copyTo(e),this.reduce(e),e},xe.prototype.reduce=function(t){for(;t.t<=this.mt2;)t[t.t++]=0;for(var e=0;e<this.m.t;++e){var n=32767&t[e],i=n*this.mpl+((n*this.mph+(t[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(t[n=e+this.m.t]+=this.m.am(0,i,t,e,0,this.m.t);t[n]>=t.DV;)t[n]-=t.DV,t[++n]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)},xe.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},xe.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)},fe.prototype.copyTo=function(t){for(var e=this.t-1;e>=0;--e)t[e]=this[e];t.t=this.t,t.s=this.s},fe.prototype.fromInt=function(t){this.t=1,this.s=t<0?-1:0,t>0?this[0]=t:t<-1?this[0]=t+this.DV:this.t=0},fe.prototype.fromString=function(t,e){var n;if(16==e)n=4;else if(8==e)n=3;else if(256==e)n=8;else if(2==e)n=1;else if(32==e)n=5;else{if(4!=e)return void this.fromRadix(t,e);n=2}this.t=0,this.s=0;for(var i=t.length,r=!1,s=0;--i>=0;){var o=8==n?255&t[i]:me(t,i);o<0?"-"==t.charAt(i)&&(r=!0):(r=!1,0==s?this[this.t++]=o:s+n>this.DB?(this[this.t-1]|=(o&(1<<this.DB-s)-1)<<s,this[this.t++]=o>>this.DB-s):this[this.t-1]|=o<<s,(s+=n)>=this.DB&&(s-=this.DB))}8==n&&0!=(128&t[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),r&&fe.ZERO.subTo(this,this)},fe.prototype.clamp=function(){for(var t=this.s&this.DM;this.t>0&&this[this.t-1]==t;)--this.t},fe.prototype.dlShiftTo=function(t,e){var n;for(n=this.t-1;n>=0;--n)e[n+t]=this[n];for(n=t-1;n>=0;--n)e[n]=0;e.t=this.t+t,e.s=this.s},fe.prototype.drShiftTo=function(t,e){for(var n=t;n<this.t;++n)e[n-t]=this[n];e.t=Math.max(this.t-t,0),e.s=this.s},fe.prototype.lShiftTo=function(t,e){var n,i=t%this.DB,r=this.DB-i,s=(1<<r)-1,o=Math.floor(t/this.DB),a=this.s<<i&this.DM;for(n=this.t-1;n>=0;--n)e[n+o+1]=this[n]>>r|a,a=(this[n]&s)<<i;for(n=o-1;n>=0;--n)e[n]=0;e[o]=a,e.t=this.t+o+1,e.s=this.s,e.clamp()},fe.prototype.rShiftTo=function(t,e){e.s=this.s;var n=Math.floor(t/this.DB);if(n>=this.t)e.t=0;else{var i=t%this.DB,r=this.DB-i,s=(1<<i)-1;e[0]=this[n]>>i;for(var o=n+1;o<this.t;++o)e[o-n-1]|=(this[o]&s)<<r,e[o-n]=this[o]>>i;i>0&&(e[this.t-n-1]|=(this.s&s)<<r),e.t=this.t-n,e.clamp()}},fe.prototype.subTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]-t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i-=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i-=t[n],e[n++]=i&this.DM,i>>=this.DB;i-=t.s}e.s=i<0?-1:0,i<-1?e[n++]=this.DV+i:i>0&&(e[n++]=i),e.t=n,e.clamp()},fe.prototype.multiplyTo=function(t,e){var n=this.abs(),i=t.abs(),r=n.t;for(e.t=r+i.t;--r>=0;)e[r]=0;for(r=0;r<i.t;++r)e[r+n.t]=n.am(0,i[r],e,r,0,n.t);e.s=0,e.clamp(),this.s!=t.s&&fe.ZERO.subTo(e,e)},fe.prototype.squareTo=function(t){for(var e=this.abs(),n=t.t=2*e.t;--n>=0;)t[n]=0;for(n=0;n<e.t-1;++n){var i=e.am(n,e[n],t,2*n,0,1);(t[n+e.t]+=e.am(n+1,2*e[n],t,2*n+1,i,e.t-n-1))>=e.DV&&(t[n+e.t]-=e.DV,t[n+e.t+1]=1)}t.t>0&&(t[t.t-1]+=e.am(n,e[n],t,2*n,0,1)),t.s=0,t.clamp()},fe.prototype.divRemTo=function(t,e,n){var i=t.abs();if(!(i.t<=0)){var r=this.abs();if(r.t<i.t)return null!=e&&e.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=le());var s=le(),o=this.s,a=t.s,u=this.DB-Se(i[i.t-1]);u>0?(i.lShiftTo(u,s),r.lShiftTo(u,n)):(i.copyTo(s),r.copyTo(n));var h=s.t,c=s[h-1];if(0!=c){var f=c*(1<<this.F1)+(h>1?s[h-2]>>this.F2:0),l=this.FV/f,d=(1<<this.F1)/f,p=1<<this.F2,g=n.t,v=g-h,y=null==e?le():e;for(s.dlShiftTo(v,y),n.compareTo(y)>=0&&(n[n.t++]=1,n.subTo(y,n)),fe.ONE.dlShiftTo(h,y),y.subTo(s,s);s.t<h;)s[s.t++]=0;for(;--v>=0;){var m=n[--g]==c?this.DM:Math.floor(n[g]*l+(n[g-1]+p)*d);if((n[g]+=s.am(0,m,n,v,0,h))<m)for(s.dlShiftTo(v,y),n.subTo(y,n);n[g]<--m;)n.subTo(y,n)}null!=e&&(n.drShiftTo(h,e),o!=a&&fe.ZERO.subTo(e,e)),n.t=h,n.clamp(),u>0&&n.rShiftTo(u,n),o<0&&fe.ZERO.subTo(n,n)}}},fe.prototype.invDigit=function(){if(this.t<1)return 0;var t=this[0];if(0==(1&t))return 0;var e=3&t;return(e=(e=(e=(e=e*(2-(15&t)*e)&15)*(2-(255&t)*e)&255)*(2-((65535&t)*e&65535))&65535)*(2-t*e%this.DV)%this.DV)>0?this.DV-e:-e},fe.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},fe.prototype.exp=function(t,e){if(t>4294967295||t<1)return fe.ONE;var n=le(),i=le(),r=e.convert(this),s=Se(t)-1;for(r.copyTo(n);--s>=0;)if(e.sqrTo(n,i),(t&1<<s)>0)e.mulTo(i,r,n);else{var o=n;n=i,i=o}return e.revert(n)},fe.prototype.toString=function(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(16==t)e=4;else if(8==t)e=3;else if(2==t)e=1;else if(32==t)e=5;else{if(4!=t)return this.toRadix(t);e=2}var n,i=(1<<e)-1,r=!1,s="",o=this.t,a=this.DB-o*this.DB%e;if(o-- >0)for(a<this.DB&&(n=this[o]>>a)>0&&(r=!0,s=ye(n));o>=0;)a<e?(n=(this[o]&(1<<a)-1)<<e-a,n|=this[--o]>>(a+=this.DB-e)):(n=this[o]>>(a-=e)&i,a<=0&&(a+=this.DB,--o)),n>0&&(r=!0),r&&(s+=ye(n));return r?s:"0"},fe.prototype.negate=function(){var t=le();return fe.ZERO.subTo(this,t),t},fe.prototype.abs=function(){return this.s<0?this.negate():this},fe.prototype.compareTo=function(t){var e=this.s-t.s;if(0!=e)return e;var n=this.t;if(0!=(e=n-t.t))return this.s<0?-e:e;for(;--n>=0;)if(0!=(e=this[n]-t[n]))return e;return 0},fe.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+Se(this[this.t-1]^this.s&this.DM)},fe.prototype.mod=function(t){var e=le();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(fe.ZERO)>0&&t.subTo(e,e),e},fe.prototype.modPowInt=function(t,e){var n;return n=t<256||e.isEven()?new we(e):new xe(e),this.exp(t,n)},fe.ZERO=be(0),fe.ONE=be(1),Te.prototype.convert=Pe,Te.prototype.revert=Pe,Te.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n)},Te.prototype.sqrTo=function(t,e){t.squareTo(e)},je.prototype.convert=function(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=le();return t.copyTo(e),this.reduce(e),e},je.prototype.revert=function(t){return t},je.prototype.reduce=function(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)},je.prototype.mulTo=function(t,e,n){t.multiplyTo(e,n),this.reduce(n)},je.prototype.sqrTo=function(t,e){t.squareTo(e),this.reduce(e)};var He=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],_e=(1<<26)/He[He.length-1];function Re(){this.i=0,this.j=0,this.S=new Array}fe.prototype.chunkSize=function(t){return Math.floor(Math.LN2*this.DB/Math.log(t))},fe.prototype.toRadix=function(t){if(null==t&&(t=10),0==this.signum()||t<2||t>36)return"0";var e=this.chunkSize(t),n=Math.pow(t,e),i=be(n),r=le(),s=le(),o="";for(this.divRemTo(i,r,s);r.signum()>0;)o=(n+s.intValue()).toString(t).substr(1)+o,r.divRemTo(i,r,s);return s.intValue().toString(t)+o},fe.prototype.fromRadix=function(t,e){this.fromInt(0),null==e&&(e=10);for(var n=this.chunkSize(e),i=Math.pow(e,n),r=!1,s=0,o=0,a=0;a<t.length;++a){var u=me(t,a);u<0?"-"==t.charAt(a)&&0==this.signum()&&(r=!0):(o=e*o+u,++s>=n&&(this.dMultiply(i),this.dAddOffset(o,0),s=0,o=0))}s>0&&(this.dMultiply(Math.pow(e,s)),this.dAddOffset(o,0)),r&&fe.ZERO.subTo(this,this)},fe.prototype.fromNumber=function(t,e,n){if("number"==typeof e)if(t<2)this.fromInt(1);else for(this.fromNumber(t,n),this.testBit(t-1)||this.bitwiseTo(fe.ONE.shiftLeft(t-1),Ee,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(fe.ONE.shiftLeft(t-1),this);else{var i=new Array,r=7&t;i.length=1+(t>>3),e.nextBytes(i),r>0?i[0]&=(1<<r)-1:i[0]=0,this.fromString(i,256)}},fe.prototype.bitwiseTo=function(t,e,n){var i,r,s=Math.min(t.t,this.t);for(i=0;i<s;++i)n[i]=e(this[i],t[i]);if(t.t<this.t){for(r=t.s&this.DM,i=s;i<this.t;++i)n[i]=e(this[i],r);n.t=this.t}else{for(r=this.s&this.DM,i=s;i<t.t;++i)n[i]=e(r,t[i]);n.t=t.t}n.s=e(this.s,t.s),n.clamp()},fe.prototype.changeBit=function(t,e){var n=fe.ONE.shiftLeft(t);return this.bitwiseTo(n,e,n),n},fe.prototype.addTo=function(t,e){for(var n=0,i=0,r=Math.min(t.t,this.t);n<r;)i+=this[n]+t[n],e[n++]=i&this.DM,i>>=this.DB;if(t.t<this.t){for(i+=t.s;n<this.t;)i+=this[n],e[n++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;n<t.t;)i+=t[n],e[n++]=i&this.DM,i>>=this.DB;i+=t.s}e.s=i<0?-1:0,i>0?e[n++]=i:i<-1&&(e[n++]=this.DV+i),e.t=n,e.clamp()},fe.prototype.dMultiply=function(t){this[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()},fe.prototype.dAddOffset=function(t,e){if(0!=t){for(;this.t<=e;)this[this.t++]=0;for(this[e]+=t;this[e]>=this.DV;)this[e]-=this.DV,++e>=this.t&&(this[this.t++]=0),++this[e]}},fe.prototype.multiplyLowerTo=function(t,e,n){var i,r=Math.min(this.t+t.t,e);for(n.s=0,n.t=r;r>0;)n[--r]=0;for(i=n.t-this.t;r<i;++r)n[r+this.t]=this.am(0,t[r],n,r,0,this.t);for(i=Math.min(t.t,e);r<i;++r)this.am(0,t[r],n,r,0,e-r);n.clamp()},fe.prototype.multiplyUpperTo=function(t,e,n){--e;var i=n.t=this.t+t.t-e;for(n.s=0;--i>=0;)n[i]=0;for(i=Math.max(e-this.t,0);i<t.t;++i)n[this.t+i-e]=this.am(e-i,t[i],n,0,0,this.t+i-e);n.clamp(),n.drShiftTo(1,n)},fe.prototype.modInt=function(t){if(t<=0)return 0;var e=this.DV%t,n=this.s<0?t-1:0;if(this.t>0)if(0==e)n=this[0]%t;else for(var i=this.t-1;i>=0;--i)n=(e*n+this[i])%t;return n},fe.prototype.millerRabin=function(t){var e=this.subtract(fe.ONE),n=e.getLowestSetBit();if(n<=0)return!1;var i=e.shiftRight(n);(t=t+1>>1)>He.length&&(t=He.length);for(var r=le(),s=0;s<t;++s){r.fromInt(He[Math.floor(Math.random()*He.length)]);var o=r.modPow(i,this);if(0!=o.compareTo(fe.ONE)&&0!=o.compareTo(e)){for(var a=1;a++<n&&0!=o.compareTo(e);)if(0==(o=o.modPowInt(2,this)).compareTo(fe.ONE))return!1;if(0!=o.compareTo(e))return!1}}return!0},fe.prototype.clone=function(){var t=le();return this.copyTo(t),t},fe.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},fe.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},fe.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},fe.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},fe.prototype.toByteArray=function(){var t=this.t,e=new Array;e[0]=this.s;var n,i=this.DB-t*this.DB%8,r=0;if(t-- >0)for(i<this.DB&&(n=this[t]>>i)!=(this.s&this.DM)>>i&&(e[r++]=n|this.s<<this.DB-i);t>=0;)i<8?(n=(this[t]&(1<<i)-1)<<8-i,n|=this[--t]>>(i+=this.DB-8)):(n=this[t]>>(i-=8)&255,i<=0&&(i+=this.DB,--t)),0!=(128&n)&&(n|=-256),0==r&&(128&this.s)!=(128&n)&&++r,(r>0||n!=this.s)&&(e[r++]=n);return e},fe.prototype.equals=function(t){return 0==this.compareTo(t)},fe.prototype.min=function(t){return this.compareTo(t)<0?this:t},fe.prototype.max=function(t){return this.compareTo(t)>0?this:t},fe.prototype.and=function(t){var e=le();return this.bitwiseTo(t,Fe,e),e},fe.prototype.or=function(t){var e=le();return this.bitwiseTo(t,Ee,e),e},fe.prototype.xor=function(t){var e=le();return this.bitwiseTo(t,Ae,e),e},fe.prototype.andNot=function(t){var e=le();return this.bitwiseTo(t,De,e),e},fe.prototype.not=function(){for(var t=le(),e=0;e<this.t;++e)t[e]=this.DM&~this[e];return t.t=this.t,t.s=~this.s,t},fe.prototype.shiftLeft=function(t){var e=le();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e},fe.prototype.shiftRight=function(t){var e=le();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e},fe.prototype.getLowestSetBit=function(){for(var t=0;t<this.t;++t)if(0!=this[t])return t*this.DB+Ce(this[t]);return this.s<0?this.t*this.DB:-1},fe.prototype.bitCount=function(){for(var t=0,e=this.s&this.DM,n=0;n<this.t;++n)t+=Ie(this[n]^e);return t},fe.prototype.testBit=function(t){var e=Math.floor(t/this.DB);return e>=this.t?0!=this.s:0!=(this[e]&1<<t%this.DB)},fe.prototype.setBit=function(t){return this.changeBit(t,Ee)},fe.prototype.clearBit=function(t){return this.changeBit(t,De)},fe.prototype.flipBit=function(t){return this.changeBit(t,Ae)},fe.prototype.add=function(t){var e=le();return this.addTo(t,e),e},fe.prototype.subtract=function(t){var e=le();return this.subTo(t,e),e},fe.prototype.multiply=function(t){var e=le();return this.multiplyTo(t,e),e},fe.prototype.divide=function(t){var e=le();return this.divRemTo(t,e,null),e},fe.prototype.remainder=function(t){var e=le();return this.divRemTo(t,null,e),e},fe.prototype.divideAndRemainder=function(t){var e=le(),n=le();return this.divRemTo(t,e,n),new Array(e,n)},fe.prototype.modPow=function(t,e){var n,i,r=t.bitLength(),s=be(1);if(r<=0)return s;n=r<18?1:r<48?3:r<144?4:r<768?5:6,i=r<8?new we(e):e.isEven()?new je(e):new xe(e);var o=new Array,a=3,u=n-1,h=(1<<n)-1;if(o[1]=i.convert(this),n>1){var c=le();for(i.sqrTo(o[1],c);a<=h;)o[a]=le(),i.mulTo(c,o[a-2],o[a]),a+=2}var f,l,d=t.t-1,p=!0,g=le();for(r=Se(t[d])-1;d>=0;){for(r>=u?f=t[d]>>r-u&h:(f=(t[d]&(1<<r+1)-1)<<u-r,d>0&&(f|=t[d-1]>>this.DB+r-u)),a=n;0==(1&f);)f>>=1,--a;if((r-=a)<0&&(r+=this.DB,--d),p)o[f].copyTo(s),p=!1;else{for(;a>1;)i.sqrTo(s,g),i.sqrTo(g,s),a-=2;a>0?i.sqrTo(s,g):(l=s,s=g,g=l),i.mulTo(g,o[f],s)}for(;d>=0&&0==(t[d]&1<<r);)i.sqrTo(s,g),l=s,s=g,g=l,--r<0&&(r=this.DB-1,--d)}return i.revert(s)},fe.prototype.modInverse=function(t){var e=t.isEven();if(this.isEven()&&e||0==t.signum())return fe.ZERO;for(var n=t.clone(),i=this.clone(),r=be(1),s=be(0),o=be(0),a=be(1);0!=n.signum();){for(;n.isEven();)n.rShiftTo(1,n),e?(r.isEven()&&s.isEven()||(r.addTo(this,r),s.subTo(t,s)),r.rShiftTo(1,r)):s.isEven()||s.subTo(t,s),s.rShiftTo(1,s);for(;i.isEven();)i.rShiftTo(1,i),e?(o.isEven()&&a.isEven()||(o.addTo(this,o),a.subTo(t,a)),o.rShiftTo(1,o)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);n.compareTo(i)>=0?(n.subTo(i,n),e&&r.subTo(o,r),s.subTo(a,s)):(i.subTo(n,i),e&&o.subTo(r,o),a.subTo(s,a))}return 0!=i.compareTo(fe.ONE)?fe.ZERO:a.compareTo(t)>=0?a.subtract(t):a.signum()<0?(a.addTo(t,a),a.signum()<0?a.add(t):a):a},fe.prototype.pow=function(t){return this.exp(t,new Te)},fe.prototype.gcd=function(t){var e=this.s<0?this.negate():this.clone(),n=t.s<0?t.negate():t.clone();if(e.compareTo(n)<0){var i=e;e=n,n=i}var r=e.getLowestSetBit(),s=n.getLowestSetBit();if(s<0)return e;for(r<s&&(s=r),s>0&&(e.rShiftTo(s,e),n.rShiftTo(s,n));e.signum()>0;)(r=e.getLowestSetBit())>0&&e.rShiftTo(r,e),(r=n.getLowestSetBit())>0&&n.rShiftTo(r,n),e.compareTo(n)>=0?(e.subTo(n,e),e.rShiftTo(1,e)):(n.subTo(e,n),n.rShiftTo(1,n));return s>0&&n.lShiftTo(s,n),n},fe.prototype.isProbablePrime=function(t){var e,n=this.abs();if(1==n.t&&n[0]<=He[He.length-1]){for(e=0;e<He.length;++e)if(n[0]==He[e])return!0;return!1}if(n.isEven())return!1;for(e=1;e<He.length;){for(var i=He[e],r=e+1;r<He.length&&i<_e;)i*=He[r++];for(i=n.modInt(i);e<r;)if(i%He[e++]==0)return!1}return n.millerRabin(t)},fe.prototype.square=function(){var t=le();return this.squareTo(t),t},Re.prototype.init=function(t){var e,n,i;for(e=0;e<256;++e)this.S[e]=e;for(n=0,e=0;e<256;++e)n=n+this.S[e]+t[e%t.length]&255,i=this.S[e],this.S[e]=this.S[n],this.S[n]=i;this.i=0,this.j=0},Re.prototype.next=function(){var t;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t,this.S[t+this.S[this.i]&255]};var ke,Be,Ne,Oe=256;function Ve(){var t;t=(new Date).getTime(),Be[Ne++]^=255&t,Be[Ne++]^=t>>8&255,Be[Ne++]^=t>>16&255,Be[Ne++]^=t>>24&255,Ne>=Oe&&(Ne-=Oe)}if(null==Be){var Le;if(Be=new Array,Ne=0,void 0!==te&&void 0!==te.msCrypto){var Me=te.msCrypto;if(Me.getRandomValues){var Ke=new Uint8Array(32);for(Me.getRandomValues(Ke),Le=0;Le<32;++Le)Be[Ne++]=Ke[Le]}}for(;Ne<Oe;)Le=Math.floor(65536*Math.random()),Be[Ne++]=Le>>>8,Be[Ne++]=255&Le;Ne=0,Ve()}function Ue(){if(null==ke){for(Ve(),(ke=new Re).init(Be),Ne=0;Ne<Be.length;++Ne)Be[Ne]=0;Ne=0}return ke.next()}function qe(){}function $e(t,e){return new fe(t,e)}function ze(t,e,n){for(var i="",r=0;i.length<e;)i+=n(String.fromCharCode.apply(String,t.concat([(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r]))),r+=1;return i}function Ge(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function Je(t,e,n){for(var i="",r=0;i.length<e;)i+=n(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])),r+=1;return i}function We(t,e){this.x=e,this.q=t}function Ye(t,e,n,i){this.curve=t,this.x=e,this.y=n,this.z=null==i?fe.ONE:i,this.zinv=null}function Xe(t,e,n){this.q=t,this.a=this.fromBigInteger(e),this.b=this.fromBigInteger(n),this.infinity=new Ye(this,null,null)}qe.prototype.nextBytes=function(t){var e;for(e=0;e<t.length;++e)t[e]=Ue()},Ge.prototype.doPublic=function(t){return t.modPowInt(this.e,this.n)},Ge.prototype.setPublic=function(t,e){if(this.isPublic=!0,this.isPrivate=!1,"string"!=typeof t)this.n=t,this.e=e;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA public key";this.n=$e(t,16),this.e=parseInt(e,16)}},Ge.prototype.encrypt=function(t){var e=function(t,e){if(e<t.length+11)throw"Message too long for RSA";for(var n=new Array,i=t.length-1;i>=0&&e>0;){var r=t.charCodeAt(i--);r<128?n[--e]=r:r>127&&r<2048?(n[--e]=63&r|128,n[--e]=r>>6|192):(n[--e]=63&r|128,n[--e]=r>>6&63|128,n[--e]=r>>12|224)}n[--e]=0;for(var s=new qe,o=new Array;e>2;){for(o[0]=0;0==o[0];)s.nextBytes(o);n[--e]=o[0]}return n[--e]=2,n[--e]=0,new fe(n)}(t,this.n.bitLength()+7>>3);if(null==e)return null;var n=this.doPublic(e);if(null==n)return null;var i=n.toString(16);return 0==(1&i.length)?i:"0"+i},Ge.prototype.encryptOAEP=function(t,e,n){var i=function(t,e,n,i){var r=Qe.crypto.MessageDigest,s=Qe.crypto.Util,o=null;if(n||(n="sha1"),"string"==typeof n&&(o=r.getCanonicalAlgName(n),i=r.getHashLength(o),n=function(t){return ln(s.hashHex(dn(t),o))}),t.length+2*i+2>e)throw"Message too long for RSA";var a,u="";for(a=0;a<e-t.length-2*i-2;a+=1)u+="\0";var h=n("")+u+""+t,c=new Array(i);(new qe).nextBytes(c);var f=ze(c,h.length,n),l=[];for(a=0;a<h.length;a+=1)l[a]=h.charCodeAt(a)^f.charCodeAt(a);var d=ze(l,c.length,n),p=[0];for(a=0;a<c.length;a+=1)p[a+1]=c[a]^d.charCodeAt(a);return new fe(p.concat(l))}(t,this.n.bitLength()+7>>3,e,n);if(null==i)return null;var r=this.doPublic(i);if(null==r)return null;var s=r.toString(16);return 0==(1&s.length)?s:"0"+s},Ge.prototype.type="RSA",Ge.prototype.doPrivate=function(t){if(null==this.p||null==this.q)return t.modPow(this.d,this.n);for(var e=t.mod(this.p).modPow(this.dmp1,this.p),n=t.mod(this.q).modPow(this.dmq1,this.q);e.compareTo(n)<0;)e=e.add(this.p);return e.subtract(n).multiply(this.coeff).mod(this.p).multiply(this.q).add(n)},Ge.prototype.setPrivate=function(t,e,n){if(this.isPrivate=!0,"string"!=typeof t)this.n=t,this.e=e,this.d=n;else{if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key";this.n=$e(t,16),this.e=parseInt(e,16),this.d=$e(n,16)}},Ge.prototype.setPrivateEx=function(t,e,n,i,r,s,o,a){if(this.isPrivate=!0,this.isPublic=!1,null==t)throw"RSASetPrivateEx N == null";if(null==e)throw"RSASetPrivateEx E == null";if(0==t.length)throw"RSASetPrivateEx N.length == 0";if(0==e.length)throw"RSASetPrivateEx E.length == 0";if(!(null!=t&&null!=e&&t.length>0&&e.length>0))throw"Invalid RSA private key in RSASetPrivateEx";this.n=$e(t,16),this.e=parseInt(e,16),this.d=$e(n,16),this.p=$e(i,16),this.q=$e(r,16),this.dmp1=$e(s,16),this.dmq1=$e(o,16),this.coeff=$e(a,16)},Ge.prototype.generate=function(t,e){var n=new qe,i=t>>1;this.e=parseInt(e,16);for(var r=new fe(e,16);;){for(;this.p=new fe(t-i,1,n),0!=this.p.subtract(fe.ONE).gcd(r).compareTo(fe.ONE)||!this.p.isProbablePrime(10););for(;this.q=new fe(i,1,n),0!=this.q.subtract(fe.ONE).gcd(r).compareTo(fe.ONE)||!this.q.isProbablePrime(10););if(this.p.compareTo(this.q)<=0){var s=this.p;this.p=this.q,this.q=s}var o=this.p.subtract(fe.ONE),a=this.q.subtract(fe.ONE),u=o.multiply(a);if(0==u.gcd(r).compareTo(fe.ONE)){this.n=this.p.multiply(this.q),this.d=r.modInverse(u),this.dmp1=this.d.mod(o),this.dmq1=this.d.mod(a),this.coeff=this.q.modInverse(this.p);break}}this.isPrivate=!0},Ge.prototype.decrypt=function(t){var e=$e(t,16),n=this.doPrivate(e);return null==n?null:function(t,e){for(var n=t.toByteArray(),i=0;i<n.length&&0==n[i];)++i;if(n.length-i!=e-1||2!=n[i])return null;for(++i;0!=n[i];)if(++i>=n.length)return null;for(var r="";++i<n.length;){var s=255&n[i];s<128?r+=String.fromCharCode(s):s>191&&s<224?(r+=String.fromCharCode((31&s)<<6|63&n[i+1]),++i):(r+=String.fromCharCode((15&s)<<12|(63&n[i+1])<<6|63&n[i+2]),i+=2)}return r}(n,this.n.bitLength()+7>>3)},Ge.prototype.decryptOAEP=function(t,e,n){var i=$e(t,16),r=this.doPrivate(i);return null==r?null:function(t,e,n,i){var r=Qe.crypto.MessageDigest,s=Qe.crypto.Util,o=null;for(n||(n="sha1"),"string"==typeof n&&(o=r.getCanonicalAlgName(n),i=r.getHashLength(o),n=function(t){return ln(s.hashHex(dn(t),o))}),t=t.toByteArray(),a=0;a<t.length;a+=1)t[a]&=255;for(;t.length<e;)t.unshift(0);if((t=String.fromCharCode.apply(String,t)).length<2*i+2)throw"Cipher too short";var a,u=t.substr(1,i),h=t.substr(i+1),c=Je(h,i,n),f=[];for(a=0;a<u.length;a+=1)f[a]=u.charCodeAt(a)^c.charCodeAt(a);var l=Je(String.fromCharCode.apply(String,f),t.length-i,n),d=[];for(a=0;a<h.length;a+=1)d[a]=h.charCodeAt(a)^l.charCodeAt(a);if((d=String.fromCharCode.apply(String,d)).substr(0,i)!==n(""))throw"Hash mismatch";var p=(d=d.substr(i)).indexOf("");if((-1!=p?d.substr(0,p).lastIndexOf("\0"):-1)+1!=p)throw"Malformed data";return d.substr(p+1)}(r,this.n.bitLength()+7>>3,e,n)},We.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.x.equals(t.x)},We.prototype.toBigInteger=function(){return this.x},We.prototype.negate=function(){return new We(this.q,this.x.negate().mod(this.q))},We.prototype.add=function(t){return new We(this.q,this.x.add(t.toBigInteger()).mod(this.q))},We.prototype.subtract=function(t){return new We(this.q,this.x.subtract(t.toBigInteger()).mod(this.q))},We.prototype.multiply=function(t){return new We(this.q,this.x.multiply(t.toBigInteger()).mod(this.q))},We.prototype.square=function(){return new We(this.q,this.x.square().mod(this.q))},We.prototype.divide=function(t){return new We(this.q,this.x.multiply(t.toBigInteger().modInverse(this.q)).mod(this.q))},Ye.prototype.getX=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ye.prototype.getY=function(){return null==this.zinv&&(this.zinv=this.z.modInverse(this.curve.q)),this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))},Ye.prototype.equals=function(t){return t==this||(this.isInfinity()?t.isInfinity():t.isInfinity()?this.isInfinity():!!t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(fe.ZERO)&&t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q).equals(fe.ZERO))},Ye.prototype.isInfinity=function(){return null==this.x&&null==this.y||this.z.equals(fe.ZERO)&&!this.y.toBigInteger().equals(fe.ZERO)},Ye.prototype.negate=function(){return new Ye(this.curve,this.x,this.y.negate(),this.z)},Ye.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(t.z)).mod(this.curve.q),n=t.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(t.z)).mod(this.curve.q);if(fe.ZERO.equals(n))return fe.ZERO.equals(e)?this.twice():this.curve.getInfinity();var i=new fe("3"),r=this.x.toBigInteger(),s=this.y.toBigInteger(),o=(t.x.toBigInteger(),t.y.toBigInteger(),n.square()),a=o.multiply(n),u=r.multiply(o),h=e.square().multiply(this.z),c=h.subtract(u.shiftLeft(1)).multiply(t.z).subtract(a).multiply(n).mod(this.curve.q),f=u.multiply(i).multiply(e).subtract(s.multiply(a)).subtract(h.multiply(e)).multiply(t.z).add(e.multiply(a)).mod(this.curve.q),l=a.multiply(this.z).multiply(t.z).mod(this.curve.q);return new Ye(this.curve,this.curve.fromBigInteger(c),this.curve.fromBigInteger(f),l)},Ye.prototype.twice=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=new fe("3"),e=this.x.toBigInteger(),n=this.y.toBigInteger(),i=n.multiply(this.z),r=i.multiply(n).mod(this.curve.q),s=this.curve.a.toBigInteger(),o=e.square().multiply(t);fe.ZERO.equals(s)||(o=o.add(this.z.square().multiply(s)));var a=(o=o.mod(this.curve.q)).square().subtract(e.shiftLeft(3).multiply(r)).shiftLeft(1).multiply(i).mod(this.curve.q),u=o.multiply(t).multiply(e).subtract(r.shiftLeft(1)).shiftLeft(2).multiply(r).subtract(o.square().multiply(o)).mod(this.curve.q),h=i.square().multiply(i).shiftLeft(3).mod(this.curve.q);return new Ye(this.curve,this.curve.fromBigInteger(a),this.curve.fromBigInteger(u),h)},Ye.prototype.multiply=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new fe("3")),r=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=n.testBit(e)&&(s=s.add(o?this:r))}return s},Ye.prototype.multiplyTwo=function(t,e,n){var i;i=t.bitLength()>n.bitLength()?t.bitLength()-1:n.bitLength()-1;for(var r=this.curve.getInfinity(),s=this.add(e);i>=0;)r=r.twice(),t.testBit(i)?r=n.testBit(i)?r.add(s):r.add(this):n.testBit(i)&&(r=r.add(e)),--i;return r},Xe.prototype.getQ=function(){return this.q},Xe.prototype.getA=function(){return this.a},Xe.prototype.getB=function(){return this.b},Xe.prototype.equals=function(t){return t==this||this.q.equals(t.q)&&this.a.equals(t.a)&&this.b.equals(t.b)},Xe.prototype.getInfinity=function(){return this.infinity},Xe.prototype.fromBigInteger=function(t){return new We(this.q,t)},Xe.prototype.decodePointHex=function(t){switch(parseInt(t.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var e=(t.length-2)/2,n=t.substr(2,e),i=t.substr(e+2,e);return new Ye(this,this.fromBigInteger(new fe(n,16)),this.fromBigInteger(new fe(i,16)));default:return null}},We.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)},Ye.prototype.getEncoded=function(t){var e=function(t,e){var n=t.toByteArrayUnsigned();if(e<n.length)n=n.slice(n.length-e);else for(;e>n.length;)n.unshift(0);return n},n=this.getX().toBigInteger(),i=this.getY().toBigInteger(),r=e(n,32);return t?i.isEven()?r.unshift(2):r.unshift(3):(r.unshift(4),r=r.concat(e(i,32))),r},Ye.decodeFrom=function(t,e){e[0];var n=e.length-1,i=e.slice(1,1+n/2),r=e.slice(1+n/2,1+n);i.unshift(0),r.unshift(0);var s=new fe(i),o=new fe(r);return new Ye(t,t.fromBigInteger(s),t.fromBigInteger(o))},Ye.decodeFromHex=function(t,e){e.substr(0,2);var n=e.length-2,i=e.substr(2,n/2),r=e.substr(2+n/2,n/2),s=new fe(i,16),o=new fe(r,16);return new Ye(t,t.fromBigInteger(s),t.fromBigInteger(o))},Ye.prototype.add2D=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;if(this.x.equals(t.x))return this.y.equals(t.y)?this.twice():this.curve.getInfinity();var e=t.x.subtract(this.x),n=t.y.subtract(this.y).divide(e),i=n.square().subtract(this.x).subtract(t.x),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new Ye(this.curve,i,r)},Ye.prototype.twice2D=function(){if(this.isInfinity())return this;if(0==this.y.toBigInteger().signum())return this.curve.getInfinity();var t=this.curve.fromBigInteger(fe.valueOf(2)),e=this.curve.fromBigInteger(fe.valueOf(3)),n=this.x.square().multiply(e).add(this.curve.a).divide(this.y.multiply(t)),i=n.square().subtract(this.x.multiply(t)),r=n.multiply(this.x.subtract(i)).subtract(this.y);return new Ye(this.curve,i,r)},Ye.prototype.multiply2D=function(t){if(this.isInfinity())return this;if(0==t.signum())return this.curve.getInfinity();var e,n=t,i=n.multiply(new fe("3")),r=this.negate(),s=this;for(e=i.bitLength()-2;e>0;--e){s=s.twice();var o=i.testBit(e);o!=n.testBit(e)&&(s=s.add2D(o?this:r))}return s},Ye.prototype.isOnCurve=function(){var t=this.getX().toBigInteger(),e=this.getY().toBigInteger(),n=this.curve.getA().toBigInteger(),i=this.curve.getB().toBigInteger(),r=this.curve.getQ(),s=e.multiply(e).mod(r),o=t.multiply(t).multiply(t).add(n.multiply(t)).add(i).mod(r);return s.equals(o)},Ye.prototype.toString=function(){return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"},Ye.prototype.validate=function(){var t=this.curve.getQ();if(this.isInfinity())throw new Error("Point is at infinity.");var e=this.getX().toBigInteger(),n=this.getY().toBigInteger();if(e.compareTo(fe.ONE)<0||e.compareTo(t.subtract(fe.ONE))>0)throw new Error("x coordinate out of bounds");if(n.compareTo(fe.ONE)<0||n.compareTo(t.subtract(fe.ONE))>0)throw new Error("y coordinate out of bounds");if(!this.isOnCurve())throw new Error("Point is not on the curve.");if(this.multiply(t).isInfinity())throw new Error("Point is not a scalar multiple of G.");return!0};var Ze=function(){var t=new RegExp('(?:false|true|null|[\\{\\}\\[\\]]|(?:-?\\b(?:0|[1-9][0-9]*)(?:\\.[0-9]+)?(?:[eE][+-]?[0-9]+)?\\b)|(?:"(?:[^\\0-\\x08\\x0a-\\x1f"\\\\]|\\\\(?:["/\\\\bfnrt]|u[0-9A-Fa-f]{4}))*"))',"g"),e=new RegExp("\\\\(?:([^u])|u(.{4}))","g"),n={'"':'"',"/":"/","\\":"\\",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"};function i(t,e,i){return e?n[e]:String.fromCharCode(parseInt(i,16))}var r=new String(""),s=Object.hasOwnProperty;return function(n,o){var a,u,h=n.match(t),c=h[0],f=!1;"{"===c?a={}:"["===c?a=[]:(a=[],f=!0);for(var l=[a],d=1-f,p=h.length;d<p;++d){var g;switch((c=h[d]).charCodeAt(0)){default:(g=l[0])[u||g.length]=+c,u=void 0;break;case 34:if(-1!==(c=c.substring(1,c.length-1)).indexOf("\\")&&(c=c.replace(e,i)),g=l[0],!u){if(!(g instanceof Array)){u=c||r;break}u=g.length}g[u]=c,u=void 0;break;case 91:g=l[0],l.unshift(g[u||g.length]=[]),u=void 0;break;case 93:l.shift();break;case 102:(g=l[0])[u||g.length]=!1,u=void 0;break;case 110:(g=l[0])[u||g.length]=null,u=void 0;break;case 116:(g=l[0])[u||g.length]=!0,u=void 0;break;case 123:g=l[0],l.unshift(g[u||g.length]={}),u=void 0;break;case 125:l.shift()}}if(f){if(1!==l.length)throw new Error;a=a[0]}else if(l.length)throw new Error;if(o){var v=function(t,e){var n=t[e];if(n&&"object"==typeof n){var i=null;for(var r in n)if(s.call(n,r)&&n!==t){var a=v(n,r);void 0!==a?n[r]=a:(i||(i=[]),i.push(r))}if(i)for(var u=i.length;--u>=0;)delete n[i[u]]}return o.call(t,e,n)};a=v({"":a},"")}return a}}();void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),Qe.asn1.ASN1Util=new function(){this.integerToByteHex=function(t){var e=t.toString(16);return e.length%2==1&&(e="0"+e),e},this.bigIntToMinTwosComplementsHex=function(t){var e=t.toString(16);if("-"!=e.substr(0,1))e.length%2==1?e="0"+e:e.match(/^[0-7]/)||(e="00"+e);else{var n=e.substr(1).length;n%2==1?n+=1:e.match(/^[0-7]/)||(n+=2);for(var i="",r=0;r<n;r++)i+="f";e=new fe(i,16).xor(t).add(fe.ONE).toString(16).replace(/^-/,"")}return e},this.getPEMStringFromHex=function(t,e){return gn(t,e)},this.newObject=function(t){var e=Qe.asn1,n=e.DERBoolean,i=e.DERInteger,r=e.DERBitString,s=e.DEROctetString,o=e.DERNull,a=e.DERObjectIdentifier,u=e.DEREnumerated,h=e.DERUTF8String,c=e.DERNumericString,f=e.DERPrintableString,l=e.DERTeletexString,d=e.DERIA5String,p=e.DERUTCTime,g=e.DERGeneralizedTime,v=e.DERSequence,y=e.DERSet,m=e.DERTaggedObject,b=e.ASN1Util.newObject,S=Object.keys(t);if(1!=S.length)throw"key of param shall be only one.";var w=S[0];if(-1==":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+w+":"))throw"undefined key: "+w;if("bool"==w)return new n(t[w]);if("int"==w)return new i(t[w]);if("bitstr"==w)return new r(t[w]);if("octstr"==w)return new s(t[w]);if("null"==w)return new o(t[w]);if("oid"==w)return new a(t[w]);if("enum"==w)return new u(t[w]);if("utf8str"==w)return new h(t[w]);if("numstr"==w)return new c(t[w]);if("prnstr"==w)return new f(t[w]);if("telstr"==w)return new l(t[w]);if("ia5str"==w)return new d(t[w]);if("utctime"==w)return new p(t[w]);if("gentime"==w)return new g(t[w]);if("seq"==w){for(var x=t[w],F=[],E=0;E<x.length;E++){var A=b(x[E]);F.push(A)}return new v({array:F})}if("set"==w){for(x=t[w],F=[],E=0;E<x.length;E++){A=b(x[E]);F.push(A)}return new y({array:F})}if("tag"==w){var D=t[w];if("[object Array]"===Object.prototype.toString.call(D)&&3==D.length){var C=b(D[2]);return new m({tag:D[0],explicit:D[1],obj:C})}var I={};if(void 0!==D.explicit&&(I.explicit=D.explicit),void 0!==D.tag&&(I.tag=D.tag),void 0===D.obj)throw"obj shall be specified for 'tag'.";return I.obj=b(D.obj),new m(I)}},this.jsonToASN1HEX=function(t){return this.newObject(t).getEncodedHex()}},Qe.asn1.ASN1Util.oidHexToInt=function(t){for(var e="",n=parseInt(t.substr(0,2),16),i=(e=Math.floor(n/40)+"."+n%40,""),r=2;r<t.length;r+=2){var s=("00000000"+parseInt(t.substr(r,2),16).toString(2)).slice(-8);if(i+=s.substr(1,7),"0"==s.substr(0,1))e=e+"."+new fe(i,2).toString(10),i=""}return e},Qe.asn1.ASN1Util.oidIntToHex=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=new fe(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);return i},Qe.asn1.ASN1Object=function(){this.getLengthHexFromValue=function(){if(void 0===this.hV||null==this.hV)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+"".length+",v="+this.hV;var t=this.hV.length/2,e=t.toString(16);if(e.length%2==1&&(e="0"+e),t<128)return e;var n=e.length/2;if(n>15)throw"ASN.1 length too long to represent by 8x: n = "+t.toString(16);return(128+n).toString(16)+e},this.getEncodedHex=function(){return(null==this.hTLV||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},Qe.asn1.DERAbstractString=function(t){Qe.asn1.DERAbstractString.superclass.constructor.call(this),this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=cn(this.s).toLowerCase()},this.setStringHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?this.setString(t):void 0!==t.str?this.setString(t.str):void 0!==t.hex&&this.setStringHex(t.hex))},ee.lang.extend(Qe.asn1.DERAbstractString,Qe.asn1.ASN1Object),Qe.asn1.DERAbstractTime=function(t){Qe.asn1.DERAbstractTime.superclass.constructor.call(this),this.localDateToUTC=function(t){return utc=t.getTime()+6e4*t.getTimezoneOffset(),new Date(utc)},this.formatDate=function(t,e,n){var i=this.zeroPadding,r=this.localDateToUTC(t),s=String(r.getFullYear());"utc"==e&&(s=s.substr(2,2));var o=s+i(String(r.getMonth()+1),2)+i(String(r.getDate()),2)+i(String(r.getHours()),2)+i(String(r.getMinutes()),2)+i(String(r.getSeconds()),2);if(!0===n){var a=r.getMilliseconds();if(0!=a){var u=i(String(a),3);o=o+"."+(u=u.replace(/[0]+$/,""))}}return o+"Z"},this.zeroPadding=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},this.getString=function(){return this.s},this.setString=function(t){this.hTLV=null,this.isModified=!0,this.s=t,this.hV=sn(t)},this.setByDateValue=function(t,e,n,i,r,s){var o=new Date(Date.UTC(t,e-1,n,i,r,s,0));this.setByDate(o)},this.getFreshValueHex=function(){return this.hV}},ee.lang.extend(Qe.asn1.DERAbstractTime,Qe.asn1.ASN1Object),Qe.asn1.DERAbstractStructured=function(t){Qe.asn1.DERAbstractString.superclass.constructor.call(this),this.setByASN1ObjectArray=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array=t},this.appendASN1Object=function(t){this.hTLV=null,this.isModified=!0,this.asn1Array.push(t)},this.asn1Array=new Array,void 0!==t&&void 0!==t.array&&(this.asn1Array=t.array)},ee.lang.extend(Qe.asn1.DERAbstractStructured,Qe.asn1.ASN1Object),Qe.asn1.DERBoolean=function(){Qe.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},ee.lang.extend(Qe.asn1.DERBoolean,Qe.asn1.ASN1Object),Qe.asn1.DERInteger=function(t){Qe.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=Qe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new fe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.bigint?this.setByBigInteger(t.bigint):void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ee.lang.extend(Qe.asn1.DERInteger,Qe.asn1.ASN1Object),Qe.asn1.DERBitString=function(t){if(void 0!==t&&void 0!==t.obj){var e=Qe.asn1.ASN1Util.newObject(t.obj);t.hex="00"+e.getEncodedHex()}Qe.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(t){this.hTLV=null,this.isModified=!0,this.hV=t},this.setUnusedBitsAndHexValue=function(t,e){if(t<0||7<t)throw"unused bits shall be from 0 to 7: u = "+t;var n="0"+t;this.hTLV=null,this.isModified=!0,this.hV=n+e},this.setByBinaryString=function(t){var e=8-(t=t.replace(/0+$/,"")).length%8;8==e&&(e=0);for(var n=0;n<=e;n++)t+="0";var i="";for(n=0;n<t.length-1;n+=8){var r=t.substr(n,8),s=parseInt(r,2).toString(16);1==s.length&&(s="0"+s),i+=s}this.hTLV=null,this.isModified=!0,this.hV="0"+e+i},this.setByBooleanArray=function(t){for(var e="",n=0;n<t.length;n++)1==t[n]?e+="1":e+="0";this.setByBinaryString(e)},this.newFalseArray=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=!1;return e},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t&&t.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(t):void 0!==t.hex?this.setHexValueIncludingUnusedBits(t.hex):void 0!==t.bin?this.setByBinaryString(t.bin):void 0!==t.array&&this.setByBooleanArray(t.array))},ee.lang.extend(Qe.asn1.DERBitString,Qe.asn1.ASN1Object),Qe.asn1.DEROctetString=function(t){if(void 0!==t&&void 0!==t.obj){var e=Qe.asn1.ASN1Util.newObject(t.obj);t.hex=e.getEncodedHex()}Qe.asn1.DEROctetString.superclass.constructor.call(this,t),this.hT="04"},ee.lang.extend(Qe.asn1.DEROctetString,Qe.asn1.DERAbstractString),Qe.asn1.DERNull=function(){Qe.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},ee.lang.extend(Qe.asn1.DERNull,Qe.asn1.ASN1Object),Qe.asn1.DERObjectIdentifier=function(t){var e=function(t){var e=t.toString(16);return 1==e.length&&(e="0"+e),e},n=function(t){var n="",i=new fe(t,10).toString(2),r=7-i.length%7;7==r&&(r=0);for(var s="",o=0;o<r;o++)s+="0";i=s+i;for(o=0;o<i.length-1;o+=7){var a=i.substr(o,7);o!=i.length-7&&(a="1"+a),n+=e(parseInt(a,2))}return n};Qe.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(t){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=t},this.setValueOidString=function(t){if(!t.match(/^[0-9.]+$/))throw"malformed oid string: "+t;var i="",r=t.split("."),s=40*parseInt(r[0])+parseInt(r[1]);i+=e(s),r.splice(0,2);for(var o=0;o<r.length;o++)i+=n(r[o]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=i},this.setValueName=function(t){var e=Qe.asn1.x509.OID.name2oid(t);if(""===e)throw"DERObjectIdentifier oidName undefined: "+t;this.setValueOidString(e)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&("string"==typeof t?t.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(t):this.setValueName(t):void 0!==t.oid?this.setValueOidString(t.oid):void 0!==t.hex?this.setValueHex(t.hex):void 0!==t.name&&this.setValueName(t.name))},ee.lang.extend(Qe.asn1.DERObjectIdentifier,Qe.asn1.ASN1Object),Qe.asn1.DEREnumerated=function(t){Qe.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(t){this.hTLV=null,this.isModified=!0,this.hV=Qe.asn1.ASN1Util.bigIntToMinTwosComplementsHex(t)},this.setByInteger=function(t){var e=new fe(String(t),10);this.setByBigInteger(e)},this.setValueHex=function(t){this.hV=t},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.int?this.setByInteger(t.int):"number"==typeof t?this.setByInteger(t):void 0!==t.hex&&this.setValueHex(t.hex))},ee.lang.extend(Qe.asn1.DEREnumerated,Qe.asn1.ASN1Object),Qe.asn1.DERUTF8String=function(t){Qe.asn1.DERUTF8String.superclass.constructor.call(this,t),this.hT="0c"},ee.lang.extend(Qe.asn1.DERUTF8String,Qe.asn1.DERAbstractString),Qe.asn1.DERNumericString=function(t){Qe.asn1.DERNumericString.superclass.constructor.call(this,t),this.hT="12"},ee.lang.extend(Qe.asn1.DERNumericString,Qe.asn1.DERAbstractString),Qe.asn1.DERPrintableString=function(t){Qe.asn1.DERPrintableString.superclass.constructor.call(this,t),this.hT="13"},ee.lang.extend(Qe.asn1.DERPrintableString,Qe.asn1.DERAbstractString),Qe.asn1.DERTeletexString=function(t){Qe.asn1.DERTeletexString.superclass.constructor.call(this,t),this.hT="14"},ee.lang.extend(Qe.asn1.DERTeletexString,Qe.asn1.DERAbstractString),Qe.asn1.DERIA5String=function(t){Qe.asn1.DERIA5String.superclass.constructor.call(this,t),this.hT="16"},ee.lang.extend(Qe.asn1.DERIA5String,Qe.asn1.DERAbstractString),Qe.asn1.DERUTCTime=function(t){Qe.asn1.DERUTCTime.superclass.constructor.call(this,t),this.hT="17",this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"utc"),this.hV=sn(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=sn(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{12}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date))},ee.lang.extend(Qe.asn1.DERUTCTime,Qe.asn1.DERAbstractTime),Qe.asn1.DERGeneralizedTime=function(t){Qe.asn1.DERGeneralizedTime.superclass.constructor.call(this,t),this.hT="18",this.withMillis=!1,this.setByDate=function(t){this.hTLV=null,this.isModified=!0,this.date=t,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=sn(this.s)},this.getFreshValueHex=function(){return void 0===this.date&&void 0===this.s&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=sn(this.s)),this.hV},void 0!==t&&(void 0!==t.str?this.setString(t.str):"string"==typeof t&&t.match(/^[0-9]{14}Z$/)?this.setString(t):void 0!==t.hex?this.setStringHex(t.hex):void 0!==t.date&&this.setByDate(t.date),!0===t.millis&&(this.withMillis=!0))},ee.lang.extend(Qe.asn1.DERGeneralizedTime,Qe.asn1.DERAbstractTime),Qe.asn1.DERSequence=function(t){Qe.asn1.DERSequence.superclass.constructor.call(this,t),this.hT="30",this.getFreshValueHex=function(){for(var t="",e=0;e<this.asn1Array.length;e++){t+=this.asn1Array[e].getEncodedHex()}return this.hV=t,this.hV}},ee.lang.extend(Qe.asn1.DERSequence,Qe.asn1.DERAbstractStructured),Qe.asn1.DERSet=function(t){Qe.asn1.DERSet.superclass.constructor.call(this,t),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var t=new Array,e=0;e<this.asn1Array.length;e++){var n=this.asn1Array[e];t.push(n.getEncodedHex())}return 1==this.sortFlag&&t.sort(),this.hV=t.join(""),this.hV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ee.lang.extend(Qe.asn1.DERSet,Qe.asn1.DERAbstractStructured),Qe.asn1.DERTaggedObject=function(t){Qe.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(t,e,n){this.hT=e,this.isExplicit=t,this.asn1Object=n,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=n.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,e),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},void 0!==t&&(void 0!==t.tag&&(this.hT=t.tag),void 0!==t.explicit&&(this.isExplicit=t.explicit),void 0!==t.obj&&(this.asn1Object=t.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},ee.lang.extend(Qe.asn1.DERTaggedObject,Qe.asn1.ASN1Object);var Qe,tn,en,nn=new function(){};function rn(t){for(var e="",n=0;n<t.length;n++){var i=t[n].toString(16);1==i.length&&(i="0"+i),e+=i}return e}function sn(t){return rn(function(t){for(var e=new Array,n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(t))}function on(t){return t=(t=(t=t.replace(/\=/g,"")).replace(/\+/g,"-")).replace(/\//g,"_")}function an(t){return t.length%4==2?t+="==":t.length%4==3&&(t+="="),t=(t=t.replace(/-/g,"+")).replace(/_/g,"/")}function un(t){return t.length%2==1&&(t="0"+t),on(he(t))}function hn(t){return ce(an(t))}function cn(t){return mn(wn(t))}function fn(t){return decodeURIComponent(bn(t))}function ln(t){for(var e="",n=0;n<t.length-1;n+=2)e+=String.fromCharCode(parseInt(t.substr(n,2),16));return e}function dn(t){for(var e="",n=0;n<t.length;n++)e+=("0"+t.charCodeAt(n).toString(16)).slice(-2);return e}function pn(t){var e=function(t){return he(t)}(t).replace(/(.{64})/g,"$1\r\n");return e=e.replace(/\r\n$/,"")}function gn(t,e){return"-----BEGIN "+e+"-----\r\n"+pn(t)+"\r\n-----END "+e+"-----\r\n"}function vn(t,e){if(-1==t.indexOf("-----BEGIN "))throw"can't find PEM header: "+e;return function(t){return ce(t.replace(/[^0-9A-Za-z\/+=]*/g,""))}(t=void 0!==e?(t=t.replace("-----BEGIN "+e+"-----","")).replace("-----END "+e+"-----",""):(t=t.replace(/-----BEGIN [^-]+-----/,"")).replace(/-----END [^-]+-----/,""))}function yn(t){return~~(function(t){var e,n,i,r,s,o,a,u,h,c,f;if(f=t.match(/^(\d{2}|\d{4})(\d\d)(\d\d)(\d\d)(\d\d)(\d\d)(|\.\d+)Z$/))return u=f[1],e=parseInt(u),2===u.length&&(50<=e&&e<100?e=1900+e:0<=e&&e<50&&(e=2e3+e)),n=parseInt(f[2])-1,i=parseInt(f[3]),r=parseInt(f[4]),s=parseInt(f[5]),o=parseInt(f[6]),a=0,""!==(h=f[7])&&(c=(h.substr(1)+"00").substr(0,3),a=parseInt(c)),Date.UTC(e,n,i,r,s,o,a);throw"unsupported zulu format: "+t}(t)/1e3)}function mn(t){return t.replace(/%/g,"")}function bn(t){return t.replace(/(..)/g,"%$1")}function Sn(t){var e="malformed hex value";if(!t.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw e;if(8!=t.length)return 32==t.length?function(t){if(!t.match(/^[0-9A-Fa-f]{32}$/))throw"malformed IPv6 address octet";for(var e=(t=t.toLowerCase()).match(/.{1,4}/g),n=0;n<8;n++)e[n]=e[n].replace(/^0+/,""),""==e[n]&&(e[n]="0");var i=(t=":"+e.join(":")+":").match(/:(0:){2,}/g);if(null===i)return t.slice(1,-1);var r="";for(n=0;n<i.length;n++)i[n].length>r.length&&(r=i[n]);return(t=t.replace(r,"::")).slice(1,-1)}(t):t;try{return parseInt(t.substr(0,2),16)+"."+parseInt(t.substr(2,2),16)+"."+parseInt(t.substr(4,2),16)+"."+parseInt(t.substr(6,2),16)}catch(t){throw e}}function wn(t){for(var e=encodeURIComponent(t),n="",i=0;i<e.length;i++)"%"==e[i]?(n+=e.substr(i,3),i+=2):n=n+"%"+sn(e[i]);return n}function xn(t){return t.length%2==1?"0"+t:t.substr(0,1)>"7"?"00"+t:t}nn.getLblen=function(t,e){if("8"!=t.substr(e+2,1))return 1;var n=parseInt(t.substr(e+3,1));return 0==n?-1:0<n&&n<10?n+1:-2},nn.getL=function(t,e){var n=nn.getLblen(t,e);return n<1?"":t.substr(e+2,2*n)},nn.getVblen=function(t,e){var n;return""==(n=nn.getL(t,e))?-1:("8"===n.substr(0,1)?new fe(n.substr(2),16):new fe(n,16)).intValue()},nn.getVidx=function(t,e){var n=nn.getLblen(t,e);return n<0?n:e+2*(n+1)},nn.getV=function(t,e){var n=nn.getVidx(t,e),i=nn.getVblen(t,e);return t.substr(n,2*i)},nn.getTLV=function(t,e){return t.substr(e,2)+nn.getL(t,e)+nn.getV(t,e)},nn.getNextSiblingIdx=function(t,e){return nn.getVidx(t,e)+2*nn.getVblen(t,e)},nn.getChildIdx=function(t,e){var n=nn,i=new Array,r=n.getVidx(t,e);"03"==t.substr(e,2)?i.push(r+2):i.push(r);for(var s=n.getVblen(t,e),o=r,a=0;;){var u=n.getNextSiblingIdx(t,o);if(null==u||u-r>=2*s)break;if(a>=200)break;i.push(u),o=u,a++}return i},nn.getNthChildIdx=function(t,e,n){return nn.getChildIdx(t,e)[n]},nn.getIdxbyList=function(t,e,n,i){var r,s,o=nn;if(0==n.length){if(void 0!==i&&t.substr(e,2)!==i)throw"checking tag doesn't match: "+t.substr(e,2)+"!="+i;return e}return r=n.shift(),s=o.getChildIdx(t,e),o.getIdxbyList(t,s[r],n,i)},nn.getTLVbyList=function(t,e,n,i){var r=nn,s=r.getIdxbyList(t,e,n);if(void 0===s)throw"can't find nthList object";if(void 0!==i&&t.substr(s,2)!=i)throw"checking tag doesn't match: "+t.substr(s,2)+"!="+i;return r.getTLV(t,s)},nn.getVbyList=function(t,e,n,i,r){var s,o,a=nn;if(void 0===(s=a.getIdxbyList(t,e,n,i)))throw"can't find nthList object";return o=a.getV(t,s),!0===r&&(o=o.substr(2)),o},nn.hextooidstr=function(t){var e=function(t,e){return t.length>=e?t:new Array(e-t.length+1).join("0")+t},n=[],i=t.substr(0,2),r=parseInt(i,16);n[0]=new String(Math.floor(r/40)),n[1]=new String(r%40);for(var s=t.substr(2),o=[],a=0;a<s.length/2;a++)o.push(parseInt(s.substr(2*a,2),16));var u=[],h="";for(a=0;a<o.length;a++)128&o[a]?h+=e((127&o[a]).toString(2),7):(h+=e((127&o[a]).toString(2),7),u.push(new String(parseInt(h,2))),h="");var c=n.join(".");return u.length>0&&(c=c+"."+u.join(".")),c},nn.dump=function(t,e,n,i){var r=nn,s=r.getV,o=r.dump,a=r.getChildIdx,u=t;t instanceof Qe.asn1.ASN1Object&&(u=t.getEncodedHex());var h=function(t,e){return t.length<=2*e?t:t.substr(0,e)+"..(total "+t.length/2+"bytes).."+t.substr(t.length-e,e)};void 0===e&&(e={ommit_long_octet:32}),void 0===n&&(n=0),void 0===i&&(i="");var c=e.ommit_long_octet;if("01"==u.substr(n,2))return"00"==(f=s(u,n))?i+"BOOLEAN FALSE\n":i+"BOOLEAN TRUE\n";if("02"==u.substr(n,2))return i+"INTEGER "+h(f=s(u,n),c)+"\n";if("03"==u.substr(n,2))return i+"BITSTRING "+h(f=s(u,n),c)+"\n";if("04"==u.substr(n,2)){var f=s(u,n);if(r.isASN1HEX(f)){var l=i+"OCTETSTRING, encapsulates\n";return l+=o(f,e,0,i+"  ")}return i+"OCTETSTRING "+h(f,c)+"\n"}if("05"==u.substr(n,2))return i+"NULL\n";if("06"==u.substr(n,2)){var d=s(u,n),p=Qe.asn1.ASN1Util.oidHexToInt(d),g=Qe.asn1.x509.OID.oid2name(p),v=p.replace(/\./g," ");return""!=g?i+"ObjectIdentifier "+g+" ("+v+")\n":i+"ObjectIdentifier ("+v+")\n"}if("0c"==u.substr(n,2))return i+"UTF8String '"+fn(s(u,n))+"'\n";if("13"==u.substr(n,2))return i+"PrintableString '"+fn(s(u,n))+"'\n";if("14"==u.substr(n,2))return i+"TeletexString '"+fn(s(u,n))+"'\n";if("16"==u.substr(n,2))return i+"IA5String '"+fn(s(u,n))+"'\n";if("17"==u.substr(n,2))return i+"UTCTime "+fn(s(u,n))+"\n";if("18"==u.substr(n,2))return i+"GeneralizedTime "+fn(s(u,n))+"\n";if("30"==u.substr(n,2)){if("3000"==u.substr(n,4))return i+"SEQUENCE {}\n";l=i+"SEQUENCE\n";var y=e;if((2==(S=a(u,n)).length||3==S.length)&&"06"==u.substr(S[0],2)&&"04"==u.substr(S[S.length-1],2)){g=r.oidname(s(u,S[0]));var m=JSON.parse(JSON.stringify(e));m.x509ExtName=g,y=m}for(var b=0;b<S.length;b++)l+=o(u,y,S[b],i+"  ");return l}if("31"==u.substr(n,2)){l=i+"SET\n";var S=a(u,n);for(b=0;b<S.length;b++)l+=o(u,e,S[b],i+"  ");return l}var w=parseInt(u.substr(n,2),16);if(0!=(128&w)){var x=31&w;if(0!=(32&w)){var l=i+"["+x+"]\n";for(S=a(u,n),b=0;b<S.length;b++)l+=o(u,e,S[b],i+"  ");return l}return"68747470"==(f=s(u,n)).substr(0,8)&&(f=fn(f)),"subjectAltName"===e.x509ExtName&&2==x&&(f=fn(f)),l=i+"["+x+"] "+f+"\n"}return i+"UNKNOWN("+u.substr(n,2)+") "+s(u,n)+"\n"},nn.isASN1HEX=function(t){var e=nn;if(t.length%2==1)return!1;var n=e.getVblen(t,0),i=t.substr(0,2),r=e.getL(t,0);return t.length-i.length-r.length==2*n},nn.oidname=function(t){var e=Qe.asn1;Qe.lang.String.isHex(t)&&(t=e.ASN1Util.oidHexToInt(t));var n=e.x509.OID.oid2name(t);return""===n&&(n=t),n},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.x509&&Qe.asn1.x509||(Qe.asn1.x509={}),Qe.asn1.x509.Certificate=function(t){Qe.asn1.x509.Certificate.superclass.constructor.call(this);var e=Qe,n=(e.crypto,e.asn1),i=n.DERSequence,r=n.DERBitString;this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg;var t=new Qe.crypto.Signature({alg:this.asn1SignatureAlg.nameAlg});t.init(this.prvKey),t.updateHex(this.asn1TBSCert.getEncodedHex()),this.hexSig=t.sign(),this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.setSignatureHex=function(t){this.asn1SignatureAlg=this.asn1TBSCert.asn1SignatureAlg,this.hexSig=t,this.asn1Sig=new r({hex:"00"+this.hexSig});var e=new i({array:[this.asn1TBSCert,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=e.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN CERTIFICATE-----\r\n"+pn(this.getEncodedHex())+"\r\n-----END CERTIFICATE-----\r\n"},void 0!==t&&(void 0!==t.tbscertobj&&(this.asn1TBSCert=t.tbscertobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ee.lang.extend(Qe.asn1.x509.Certificate,Qe.asn1.ASN1Object),Qe.asn1.x509.TBSCertificate=function(t){Qe.asn1.x509.TBSCertificate.superclass.constructor.call(this);var e=Qe.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERTaggedObject,s=e.x509,o=s.Time,a=s.X500Name,u=s.SubjectPublicKeyInfo;this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new r({obj:new i({int:2})}),this.asn1SerialNumber=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1NotBefore=null,this.asn1NotAfter=null,this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSerialNumberByParam=function(t){this.asn1SerialNumber=new i(t)},this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new s.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new a(t)},this.setNotBeforeByParam=function(t){this.asn1NotBefore=new o(t)},this.setNotAfterByParam=function(t){this.asn1NotAfter=new o(t)},this.setSubjectByParam=function(t){this.asn1Subject=new a(t)},this.setSubjectPublicKey=function(t){this.asn1SubjPKey=new u(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=Fn.getKey(t);this.asn1SubjPKey=new u(e)},this.appendExtension=function(t){this.extensionsArray.push(t)},this.appendExtensionByName=function(t,e){Qe.asn1.x509.Extension.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(null==this.asn1NotBefore||null==this.asn1NotAfter)throw"notBefore and/or notAfter not set";var t=new n({array:[this.asn1NotBefore,this.asn1NotAfter]});if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SerialNumber),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(t),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var e=new n({array:this.extensionsArray}),i=new r({explicit:!0,tag:"a3",obj:e});this.asn1Array.push(i)}var s=new n({array:this.asn1Array});return this.hTLV=s.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ee.lang.extend(Qe.asn1.x509.TBSCertificate,Qe.asn1.ASN1Object),Qe.asn1.x509.Extension=function(t){Qe.asn1.x509.Extension.superclass.constructor.call(this);var e=Qe.asn1,n=e.DERObjectIdentifier,i=e.DEROctetString,r=(e.DERBitString,e.DERBoolean),s=e.DERSequence;this.getEncodedHex=function(){var t=new n({oid:this.oid}),e=new i({hex:this.getExtnValueHex()}),o=new Array;return o.push(t),this.critical&&o.push(new r),o.push(e),new s({array:o}).getEncodedHex()},this.critical=!1,void 0!==t&&void 0!==t.critical&&(this.critical=t.critical)},ee.lang.extend(Qe.asn1.x509.Extension,Qe.asn1.ASN1Object),Qe.asn1.x509.Extension.appendByNameToArray=function(t,e,n){var i=t.toLowerCase(),r=Qe.asn1.x509;if("basicconstraints"==i){var s=new r.BasicConstraints(e);n.push(s)}else if("keyusage"==i){s=new r.KeyUsage(e);n.push(s)}else if("crldistributionpoints"==i){s=new r.CRLDistributionPoints(e);n.push(s)}else if("extkeyusage"==i){s=new r.ExtKeyUsage(e);n.push(s)}else if("authoritykeyidentifier"==i){s=new r.AuthorityKeyIdentifier(e);n.push(s)}else if("authorityinfoaccess"==i){s=new r.AuthorityInfoAccess(e);n.push(s)}else if("subjectaltname"==i){s=new r.SubjectAltName(e);n.push(s)}else{if("issueraltname"!=i)throw"unsupported extension name: "+t;s=new r.IssuerAltName(e);n.push(s)}},Qe.asn1.x509.KeyUsage=function(t){Qe.asn1.x509.KeyUsage.superclass.constructor.call(this,t);var e=In.KEYUSAGE_NAME;if(this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.15",void 0!==t&&(void 0!==t.bin&&(this.asn1ExtnValue=new Qe.asn1.DERBitString(t)),void 0!==t.names&&void 0!==t.names.length)){for(var n=t.names,i="000000000",r=0;r<n.length;r++)for(var s=0;s<e.length;s++)n[r]===e[s]&&(i=i.substring(0,s)+"1"+i.substring(s+1,i.length));this.asn1ExtnValue=new Qe.asn1.DERBitString({bin:i})}},ee.lang.extend(Qe.asn1.x509.KeyUsage,Qe.asn1.x509.Extension),Qe.asn1.x509.BasicConstraints=function(t){Qe.asn1.x509.BasicConstraints.superclass.constructor.call(this,t),this.getExtnValueHex=function(){var t=new Array;this.cA&&t.push(new Qe.asn1.DERBoolean),this.pathLen>-1&&t.push(new Qe.asn1.DERInteger({int:this.pathLen}));var e=new Qe.asn1.DERSequence({array:t});return this.asn1ExtnValue=e,this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.19",this.cA=!1,this.pathLen=-1,void 0!==t&&(void 0!==t.cA&&(this.cA=t.cA),void 0!==t.pathLen&&(this.pathLen=t.pathLen))},ee.lang.extend(Qe.asn1.x509.BasicConstraints,Qe.asn1.x509.Extension),Qe.asn1.x509.CRLDistributionPoints=function(t){Qe.asn1.x509.CRLDistributionPoints.superclass.constructor.call(this,t);var e=Qe.asn1,n=e.x509;this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.setByDPArray=function(t){this.asn1ExtnValue=new e.DERSequence({array:t})},this.setByOneURI=function(t){var e=new n.GeneralNames([{uri:t}]),i=new n.DistributionPointName(e),r=new n.DistributionPoint({dpobj:i});this.setByDPArray([r])},this.oid="2.5.29.31",void 0!==t&&(void 0!==t.array?this.setByDPArray(t.array):void 0!==t.uri&&this.setByOneURI(t.uri))},ee.lang.extend(Qe.asn1.x509.CRLDistributionPoints,Qe.asn1.x509.Extension),Qe.asn1.x509.ExtKeyUsage=function(t){Qe.asn1.x509.ExtKeyUsage.superclass.constructor.call(this,t);var e=Qe.asn1;this.setPurposeArray=function(t){this.asn1ExtnValue=new e.DERSequence;for(var n=0;n<t.length;n++){var i=new e.DERObjectIdentifier(t[n]);this.asn1ExtnValue.appendASN1Object(i)}},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.37",void 0!==t&&void 0!==t.array&&this.setPurposeArray(t.array)},ee.lang.extend(Qe.asn1.x509.ExtKeyUsage,Qe.asn1.x509.Extension),Qe.asn1.x509.AuthorityKeyIdentifier=function(t){Qe.asn1.x509.AuthorityKeyIdentifier.superclass.constructor.call(this,t);var e=Qe.asn1,n=e.DERTaggedObject;this.asn1KID=null,this.asn1CertIssuer=null,this.asn1CertSN=null,this.getExtnValueHex=function(){var t=new Array;this.asn1KID&&t.push(new n({explicit:!1,tag:"80",obj:this.asn1KID})),this.asn1CertIssuer&&t.push(new n({explicit:!1,tag:"a1",obj:this.asn1CertIssuer})),this.asn1CertSN&&t.push(new n({explicit:!1,tag:"82",obj:this.asn1CertSN}));var i=new e.DERSequence({array:t});return this.asn1ExtnValue=i,this.asn1ExtnValue.getEncodedHex()},this.setKIDByParam=function(t){this.asn1KID=new Qe.asn1.DEROctetString(t)},this.setCertIssuerByParam=function(t){this.asn1CertIssuer=new Qe.asn1.x509.X500Name(t)},this.setCertSNByParam=function(t){this.asn1CertSN=new Qe.asn1.DERInteger(t)},this.oid="2.5.29.35",void 0!==t&&(void 0!==t.kid&&this.setKIDByParam(t.kid),void 0!==t.issuer&&this.setCertIssuerByParam(t.issuer),void 0!==t.sn&&this.setCertSNByParam(t.sn))},ee.lang.extend(Qe.asn1.x509.AuthorityKeyIdentifier,Qe.asn1.x509.Extension),Qe.asn1.x509.AuthorityInfoAccess=function(t){Qe.asn1.x509.AuthorityInfoAccess.superclass.constructor.call(this,t),this.setAccessDescriptionArray=function(t){for(var e=new Array,n=Qe.asn1,i=n.DERSequence,r=0;r<t.length;r++){var s=new i({array:[new n.DERObjectIdentifier(t[r].accessMethod),new n.x509.GeneralName(t[r].accessLocation)]});e.push(s)}this.asn1ExtnValue=new i({array:e})},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="1.3.6.1.5.5.7.1.1",void 0!==t&&void 0!==t.array&&this.setAccessDescriptionArray(t.array)},ee.lang.extend(Qe.asn1.x509.AuthorityInfoAccess,Qe.asn1.x509.Extension),Qe.asn1.x509.SubjectAltName=function(t){Qe.asn1.x509.SubjectAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new Qe.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.17",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ee.lang.extend(Qe.asn1.x509.SubjectAltName,Qe.asn1.x509.Extension),Qe.asn1.x509.IssuerAltName=function(t){Qe.asn1.x509.IssuerAltName.superclass.constructor.call(this,t),this.setNameArray=function(t){this.asn1ExtnValue=new Qe.asn1.x509.GeneralNames(t)},this.getExtnValueHex=function(){return this.asn1ExtnValue.getEncodedHex()},this.oid="2.5.29.18",void 0!==t&&void 0!==t.array&&this.setNameArray(t.array)},ee.lang.extend(Qe.asn1.x509.IssuerAltName,Qe.asn1.x509.Extension),Qe.asn1.x509.CRL=function(t){Qe.asn1.x509.CRL.superclass.constructor.call(this),this.sign=function(){this.asn1SignatureAlg=this.asn1TBSCertList.asn1SignatureAlg,sig=new Qe.crypto.Signature({alg:"SHA1withRSA",prov:"cryptojs/jsrsa"}),sig.init(this.prvKey),sig.updateHex(this.asn1TBSCertList.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new Qe.asn1.DERBitString({hex:"00"+this.hexSig});var t=new Qe.asn1.DERSequence({array:[this.asn1TBSCertList,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=t.getEncodedHex(),this.isModified=!1},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},this.getPEMString=function(){return"-----BEGIN X509 CRL-----\r\n"+pn(this.getEncodedHex())+"\r\n-----END X509 CRL-----\r\n"},void 0!==t&&(void 0!==t.tbsobj&&(this.asn1TBSCertList=t.tbsobj),void 0!==t.prvkeyobj&&(this.prvKey=t.prvkeyobj))},ee.lang.extend(Qe.asn1.x509.CRL,Qe.asn1.ASN1Object),Qe.asn1.x509.TBSCertList=function(t){Qe.asn1.x509.TBSCertList.superclass.constructor.call(this);var e=Qe.asn1,n=e.DERSequence,i=e.x509,r=i.Time;this.setSignatureAlgByParam=function(t){this.asn1SignatureAlg=new i.AlgorithmIdentifier(t)},this.setIssuerByParam=function(t){this.asn1Issuer=new i.X500Name(t)},this.setThisUpdateByParam=function(t){this.asn1ThisUpdate=new r(t)},this.setNextUpdateByParam=function(t){this.asn1NextUpdate=new r(t)},this.addRevokedCert=function(t,e){var n={};null!=t&&null!=t&&(n.sn=t),null!=e&&null!=e&&(n.time=e);var r=new i.CRLEntry(n);this.aRevokedCert.push(r)},this.getEncodedHex=function(){if(this.asn1Array=new Array,null!=this.asn1Version&&this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1SignatureAlg),this.asn1Array.push(this.asn1Issuer),this.asn1Array.push(this.asn1ThisUpdate),null!=this.asn1NextUpdate&&this.asn1Array.push(this.asn1NextUpdate),this.aRevokedCert.length>0){var t=new n({array:this.aRevokedCert});this.asn1Array.push(t)}var e=new n({array:this.asn1Array});return this.hTLV=e.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize=function(){this.asn1Version=null,this.asn1SignatureAlg=null,this.asn1Issuer=null,this.asn1ThisUpdate=null,this.asn1NextUpdate=null,this.aRevokedCert=new Array},this._initialize()},ee.lang.extend(Qe.asn1.x509.TBSCertList,Qe.asn1.ASN1Object),Qe.asn1.x509.CRLEntry=function(t){Qe.asn1.x509.CRLEntry.superclass.constructor.call(this);var e=Qe.asn1;this.setCertSerial=function(t){this.sn=new e.DERInteger(t)},this.setRevocationDate=function(t){this.time=new e.x509.Time(t)},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.sn,this.time]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&(void 0!==t.time&&this.setRevocationDate(t.time),void 0!==t.sn&&this.setCertSerial(t.sn))},ee.lang.extend(Qe.asn1.x509.CRLEntry,Qe.asn1.ASN1Object),Qe.asn1.x509.X500Name=function(t){Qe.asn1.x509.X500Name.superclass.constructor.call(this),this.asn1Array=new Array;var e=Qe.asn1,n=e.x509,i=vn;if(this.setByString=function(t){var e=t.split("/");e.shift();for(var i=[],r=0;r<e.length;r++)if(e[r].match(/^[^=]+=.+$/))i.push(e[r]);else{var s=i.length-1;i[s]=i[s]+"/"+e[r]}for(r=0;r<i.length;r++)this.asn1Array.push(new n.RDN({str:i[r]}))},this.setByLdapString=function(t){var e=n.X500Name.ldapToOneline(t);this.setByString(e)},this.setByObject=function(t){for(var e in t)if(t.hasOwnProperty(e)){var n=new Qe.asn1.x509.RDN({str:e+"="+t[e]});this.asn1Array?this.asn1Array.push(n):this.asn1Array=[n]}},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSequence({array:this.asn1Array});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t){var r;if(void 0!==t.str?this.setByString(t.str):void 0!==t.ldapstr?this.setByLdapString(t.ldapstr):"object"==typeof t&&this.setByObject(t),void 0!==t.certissuer)(r=new In).hex=i(t.certissuer),this.hTLV=r.getIssuerHex();if(void 0!==t.certsubject)(r=new In).hex=i(t.certsubject),this.hTLV=r.getSubjectHex()}},ee.lang.extend(Qe.asn1.x509.X500Name,Qe.asn1.ASN1Object),Qe.asn1.x509.X500Name.onelineToLDAP=function(t){if("/"!==t.substr(0,1))throw"malformed input";var e=(t=t.substr(1)).split("/");return e.reverse(),(e=e.map(function(t){return t.replace(/,/,"\\,")})).join(",")},Qe.asn1.x509.X500Name.ldapToOneline=function(t){for(var e=t.split(","),n=!1,i=[],r=0;e.length>0;r++){var s=e.shift();if(!0===n){var o=(i.pop()+","+s).replace(/\\,/g,",");i.push(o),n=!1}else i.push(s);"\\"===s.substr(-1,1)&&(n=!0)}return(i=i.map(function(t){return t.replace("/","\\/")})).reverse(),"/"+i.join("/")},Qe.asn1.x509.RDN=function(t){Qe.asn1.x509.RDN.superclass.constructor.call(this),this.asn1Array=new Array,this.addByString=function(t){this.asn1Array.push(new Qe.asn1.x509.AttributeTypeAndValue({str:t}))},this.addByMultiValuedString=function(t){for(var e=Qe.asn1.x509.RDN.parseString(t),n=0;n<e.length;n++)this.addByString(e[n])},this.getEncodedHex=function(){var t=new Qe.asn1.DERSet({array:this.asn1Array});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.addByMultiValuedString(t.str)},ee.lang.extend(Qe.asn1.x509.RDN,Qe.asn1.ASN1Object),Qe.asn1.x509.RDN.parseString=function(t){for(var e=t.split(/\+/),n=!1,i=[],r=0;e.length>0;r++){var s=e.shift();if(!0===n){var o=(i.pop()+"+"+s).replace(/\\\+/g,"+");i.push(o),n=!1}else i.push(s);"\\"===s.substr(-1,1)&&(n=!0)}var a=!1,u=[];for(r=0;i.length>0;r++){s=i.shift();if(!0===a){var h=u.pop();if(s.match(/"$/)){o=(h+"+"+s).replace(/^([^=]+)="(.*)"$/,"$1=$2");u.push(o),a=!1}else u.push(h+"+"+s)}else u.push(s);s.match(/^[^=]+="/)&&(a=!0)}return u},Qe.asn1.x509.AttributeTypeAndValue=function(t){Qe.asn1.x509.AttributeTypeAndValue.superclass.constructor.call(this);var e=Qe.asn1;this.setByString=function(t){var e=t.match(/^([^=]+)=(.+)$/);if(!e)throw"malformed attrTypeAndValueStr: "+t;this.setByAttrTypeAndValueStr(e[1],e[2])},this.setByAttrTypeAndValueStr=function(t,e){this.typeObj=Qe.asn1.x509.OID.atype2obj(t);var n="utf8";"C"==t&&(n="prn"),this.valueObj=this.getValueObj(n,e)},this.getValueObj=function(t,n){if("utf8"==t)return new e.DERUTF8String({str:n});if("prn"==t)return new e.DERPrintableString({str:n});if("tel"==t)return new e.DERTeletexString({str:n});if("ia5"==t)return new e.DERIA5String({str:n});throw"unsupported directory string type: type="+t+" value="+n},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.typeObj,this.valueObj]});return this.TLV=t.getEncodedHex(),this.TLV},void 0!==t&&void 0!==t.str&&this.setByString(t.str)},ee.lang.extend(Qe.asn1.x509.AttributeTypeAndValue,Qe.asn1.ASN1Object),Qe.asn1.x509.SubjectPublicKeyInfo=function(t){Qe.asn1.x509.SubjectPublicKeyInfo.superclass.constructor.call(this);var e=Qe,n=e.asn1,i=n.DERInteger,r=n.DERBitString,s=n.DERObjectIdentifier,o=n.DERSequence,a=n.ASN1Util.newObject,u=n.x509.AlgorithmIdentifier,h=e.crypto;h.ECDSA,h.DSA;this.getASN1Object=function(){if(null==this.asn1AlgId||null==this.asn1SubjPKey)throw"algId and/or subjPubKey not set";return new o({array:[this.asn1AlgId,this.asn1SubjPKey]})},this.getEncodedHex=function(){var t=this.getASN1Object();return this.hTLV=t.getEncodedHex(),this.hTLV},this.setPubKey=function(t){try{if(t instanceof Ge){var e=a({seq:[{int:{bigint:t.n}},{int:{int:t.e}}]}).getEncodedHex();this.asn1AlgId=new u({name:"rsaEncryption"}),this.asn1SubjPKey=new r({hex:"00"+e})}}catch(t){}try{if(t instanceof Qe.crypto.ECDSA){var n=new s({name:t.curveName});this.asn1AlgId=new u({name:"ecPublicKey",asn1params:n}),this.asn1SubjPKey=new r({hex:"00"+t.pubKeyHex})}}catch(t){}try{if(t instanceof Qe.crypto.DSA){n=new a({seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]});this.asn1AlgId=new u({name:"dsa",asn1params:n});var o=new i({bigint:t.y});this.asn1SubjPKey=new r({hex:"00"+o.getEncodedHex()})}}catch(t){}},void 0!==t&&this.setPubKey(t)},ee.lang.extend(Qe.asn1.x509.SubjectPublicKeyInfo,Qe.asn1.ASN1Object),Qe.asn1.x509.Time=function(t){Qe.asn1.x509.Time.superclass.constructor.call(this);var e=Qe.asn1,n=e.DERUTCTime,i=e.DERGeneralizedTime;this.setTimeParams=function(t){this.timeParams=t},this.getEncodedHex=function(){var t=null;return t=null!=this.timeParams?"utc"==this.type?new n(this.timeParams):new i(this.timeParams):"utc"==this.type?new n:new i,this.TLV=t.getEncodedHex(),this.TLV},this.type="utc",void 0!==t&&(void 0!==t.type?this.type=t.type:void 0!==t.str&&(t.str.match(/^[0-9]{12}Z$/)&&(this.type="utc"),t.str.match(/^[0-9]{14}Z$/)&&(this.type="gen")),this.timeParams=t)},ee.lang.extend(Qe.asn1.x509.Time,Qe.asn1.ASN1Object),Qe.asn1.x509.AlgorithmIdentifier=function(t){Qe.asn1.x509.AlgorithmIdentifier.superclass.constructor.call(this),this.nameAlg=null,this.asn1Alg=null,this.asn1Params=null,this.paramEmpty=!1;var e=Qe.asn1;if(this.getEncodedHex=function(){if(null===this.nameAlg&&null===this.asn1Alg)throw"algorithm not specified";null!==this.nameAlg&&null===this.asn1Alg&&(this.asn1Alg=e.x509.OID.name2obj(this.nameAlg));var t=[this.asn1Alg];null!==this.asn1Params&&t.push(this.asn1Params);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&(void 0!==t.name&&(this.nameAlg=t.name),void 0!==t.asn1params&&(this.asn1Params=t.asn1params),void 0!==t.paramempty&&(this.paramEmpty=t.paramempty)),null===this.asn1Params&&!1===this.paramEmpty&&null!==this.nameAlg){var n=this.nameAlg.toLowerCase();"withdsa"!==n.substr(-7,7)&&"withecdsa"!==n.substr(-9,9)&&(this.asn1Params=new e.DERNull)}},ee.lang.extend(Qe.asn1.x509.AlgorithmIdentifier,Qe.asn1.ASN1Object),Qe.asn1.x509.GeneralName=function(t){Qe.asn1.x509.GeneralName.superclass.constructor.call(this);var e={rfc822:"81",dns:"82",dn:"a4",uri:"86",ip:"87"},n=Qe.asn1,i=(n.DERSequence,n.DEROctetString),r=n.DERIA5String,s=n.DERTaggedObject,o=n.ASN1Object,a=n.x509.X500Name,u=vn;this.explicit=!1,this.setByParam=function(t){var n=null;if(void 0!==t){if(void 0!==t.rfc822&&(this.type="rfc822",n=new r({str:t[this.type]})),void 0!==t.dns&&(this.type="dns",n=new r({str:t[this.type]})),void 0!==t.uri&&(this.type="uri",n=new r({str:t[this.type]})),void 0!==t.dn&&(this.type="dn",this.explicit=!0,n=new a({str:t.dn})),void 0!==t.ldapdn&&(this.type="dn",this.explicit=!0,n=new a({ldapstr:t.ldapdn})),void 0!==t.certissuer){this.type="dn",this.explicit=!0;var h=null;if((f=t.certissuer).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(h=u(f)),null==h)throw"certissuer param not cert";(l=new In).hex=h;var c=l.getIssuerHex();(n=new o).hTLV=c}if(void 0!==t.certsubj){this.type="dn",this.explicit=!0;var f,l;h=null;if((f=t.certsubj).match(/^[0-9A-Fa-f]+$/),-1!=f.indexOf("-----BEGIN ")&&(h=u(f)),null==h)throw"certsubj param not cert";(l=new In).hex=h;c=l.getSubjectHex();(n=new o).hTLV=c}if(void 0!==t.ip){this.type="ip",this.explicit=!1;var d,p=t.ip,g="malformed IP address";if(p.match(/^[0-9.]+[.][0-9.]+$/)){if(8!==(d=function(t){t=(t=(t=t.replace(/^\s*\[\s*/,"")).replace(/\s*\]\s*$/,"")).replace(/\s*/g,"");try{var e=t.split(/,/).map(function(t,e,n){var i=parseInt(t);if(i<0||255<i)throw"integer not in range 0-255";var r=("00"+i.toString(16)).slice(-2);return r}).join("");return e}catch(t){throw"malformed integer array string: "+t}}("["+p.split(".").join(",")+"]")).length)throw g}else if(p.match(/^[0-9A-Fa-f:]+:[0-9A-Fa-f:]+$/))d=function(t){var e="malformed IPv6 address";if(!t.match(/^[0-9A-Fa-f:]+$/))throw e;var n=(t=t.toLowerCase()).split(":").length-1;if(n<2)throw e;var i=":".repeat(7-n+2),r=(t=t.replace("::",i)).split(":");if(8!=r.length)throw e;for(var s=0;s<8;s++)r[s]=("0000"+r[s]).slice(-4);return r.join("")}(p);else{if(!p.match(/^([0-9A-Fa-f][0-9A-Fa-f]){1,}$/))throw g;d=p}n=new i({hex:d})}if(null==this.type)throw"unsupported type in params="+t;this.asn1Obj=new s({explicit:this.explicit,tag:e[this.type],obj:n})}},this.getEncodedHex=function(){return this.asn1Obj.getEncodedHex()},void 0!==t&&this.setByParam(t)},ee.lang.extend(Qe.asn1.x509.GeneralName,Qe.asn1.ASN1Object),Qe.asn1.x509.GeneralNames=function(t){Qe.asn1.x509.GeneralNames.superclass.constructor.call(this);var e=Qe.asn1;this.setByParamArray=function(t){for(var n=0;n<t.length;n++){var i=new e.x509.GeneralName(t[n]);this.asn1Array.push(i)}},this.getEncodedHex=function(){return new e.DERSequence({array:this.asn1Array}).getEncodedHex()},this.asn1Array=new Array,void 0!==t&&this.setByParamArray(t)},ee.lang.extend(Qe.asn1.x509.GeneralNames,Qe.asn1.ASN1Object),Qe.asn1.x509.DistributionPointName=function(t){Qe.asn1.x509.DistributionPointName.superclass.constructor.call(this);var e=Qe.asn1,n=e.DERTaggedObject;if(this.getEncodedHex=function(){if("full"!=this.type)throw"currently type shall be 'full': "+this.type;return this.asn1Obj=new n({explicit:!1,tag:this.tag,obj:this.asn1V}),this.hTLV=this.asn1Obj.getEncodedHex(),this.hTLV},void 0!==t){if(!e.x509.GeneralNames.prototype.isPrototypeOf(t))throw"This class supports GeneralNames only as argument";this.type="full",this.tag="a0",this.asn1V=t}},ee.lang.extend(Qe.asn1.x509.DistributionPointName,Qe.asn1.ASN1Object),Qe.asn1.x509.DistributionPoint=function(t){Qe.asn1.x509.DistributionPoint.superclass.constructor.call(this);var e=Qe.asn1;this.getEncodedHex=function(){var t=new e.DERSequence;if(null!=this.asn1DP){var n=new e.DERTaggedObject({explicit:!0,tag:"a0",obj:this.asn1DP});t.appendASN1Object(n)}return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.dpobj&&(this.asn1DP=t.dpobj)},ee.lang.extend(Qe.asn1.x509.DistributionPoint,Qe.asn1.ASN1Object),Qe.asn1.x509.OID=new function(t){this.atype2oidList={CN:"2.5.4.3",L:"2.5.4.7",ST:"2.5.4.8",O:"2.5.4.10",OU:"2.5.4.11",C:"2.5.4.6",STREET:"2.5.4.9",DC:"0.9.2342.19200300.100.1.25",UID:"0.9.2342.19200300.100.1.1",SN:"2.5.4.4",T:"2.5.4.12",DN:"2.5.4.49",E:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",serialNumber:"2.5.4.5",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3"},this.name2oidList={sha1:"1.3.14.3.2.26",sha256:"2.16.840.1.101.3.4.2.1",sha384:"2.16.840.1.101.3.4.2.2",sha512:"2.16.840.1.101.3.4.2.3",sha224:"2.16.840.1.101.3.4.2.4",md5:"1.2.840.113549.2.5",md2:"1.3.14.7.2.2.1",ripemd160:"1.3.36.3.2.1",MD2withRSA:"1.2.840.113549.1.1.2",MD4withRSA:"1.2.840.113549.1.1.3",MD5withRSA:"1.2.840.113549.1.1.4",SHA1withRSA:"1.2.840.113549.1.1.5",SHA224withRSA:"1.2.840.113549.1.1.14",SHA256withRSA:"1.2.840.113549.1.1.11",SHA384withRSA:"1.2.840.113549.1.1.12",SHA512withRSA:"1.2.840.113549.1.1.13",SHA1withECDSA:"1.2.840.10045.4.1",SHA224withECDSA:"1.2.840.10045.4.3.1",SHA256withECDSA:"1.2.840.10045.4.3.2",SHA384withECDSA:"1.2.840.10045.4.3.3",SHA512withECDSA:"1.2.840.10045.4.3.4",dsa:"1.2.840.10040.4.1",SHA1withDSA:"1.2.840.10040.4.3",SHA224withDSA:"2.16.840.1.101.3.4.3.1",SHA256withDSA:"2.16.840.1.101.3.4.3.2",rsaEncryption:"1.2.840.113549.1.1.1",commonName:"2.5.4.3",countryName:"2.5.4.6",localityName:"2.5.4.7",stateOrProvinceName:"2.5.4.8",streetAddress:"2.5.4.9",organizationName:"2.5.4.10",organizationalUnitName:"2.5.4.11",domainComponent:"0.9.2342.19200300.100.1.25",userId:"0.9.2342.19200300.100.1.1",surname:"2.5.4.4",title:"2.5.4.12",distinguishedName:"2.5.4.49",emailAddress:"1.2.840.113549.1.9.1",description:"2.5.4.13",businessCategory:"2.5.4.15",postalCode:"2.5.4.17",uniqueIdentifier:"2.5.4.45",organizationIdentifier:"2.5.4.97",jurisdictionOfIncorporationL:"1.3.6.1.4.1.311.60.2.1.1",jurisdictionOfIncorporationSP:"1.3.6.1.4.1.311.60.2.1.2",jurisdictionOfIncorporationC:"1.3.6.1.4.1.311.60.2.1.3",subjectKeyIdentifier:"2.5.29.14",keyUsage:"2.5.29.15",subjectAltName:"2.5.29.17",issuerAltName:"2.5.29.18",basicConstraints:"2.5.29.19",nameConstraints:"2.5.29.30",cRLDistributionPoints:"2.5.29.31",certificatePolicies:"2.5.29.32",authorityKeyIdentifier:"2.5.29.35",policyConstraints:"2.5.29.36",extKeyUsage:"2.5.29.37",authorityInfoAccess:"1.3.6.1.5.5.7.1.1",ocsp:"1.3.6.1.5.5.7.48.1",caIssuers:"1.3.6.1.5.5.7.48.2",anyExtendedKeyUsage:"2.5.29.37.0",serverAuth:"1.3.6.1.5.5.7.3.1",clientAuth:"1.3.6.1.5.5.7.3.2",codeSigning:"1.3.6.1.5.5.7.3.3",emailProtection:"1.3.6.1.5.5.7.3.4",timeStamping:"1.3.6.1.5.5.7.3.8",ocspSigning:"1.3.6.1.5.5.7.3.9",ecPublicKey:"1.2.840.10045.2.1",secp256r1:"1.2.840.10045.3.1.7",secp256k1:"1.3.132.0.10",secp384r1:"1.3.132.0.34",pkcs5PBES2:"1.2.840.113549.1.5.13",pkcs5PBKDF2:"1.2.840.113549.1.5.12","des-EDE3-CBC":"1.2.840.113549.3.7",data:"1.2.840.113549.1.7.1","signed-data":"1.2.840.113549.1.7.2","enveloped-data":"1.2.840.113549.1.7.3","digested-data":"1.2.840.113549.1.7.5","encrypted-data":"1.2.840.113549.1.7.6","authenticated-data":"1.2.840.113549.1.9.16.1.2",tstinfo:"1.2.840.113549.1.9.16.1.4",extensionRequest:"1.2.840.113549.1.9.14"},this.objCache={},this.name2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.name2oidList[t])throw"Name of ObjectIdentifier not defined: "+t;var e=this.name2oidList[t],n=new Qe.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n},this.atype2obj=function(t){if(void 0!==this.objCache[t])return this.objCache[t];if(void 0===this.atype2oidList[t])throw"AttributeType name undefined: "+t;var e=this.atype2oidList[t],n=new Qe.asn1.DERObjectIdentifier({oid:e});return this.objCache[t]=n,n}},Qe.asn1.x509.OID.oid2name=function(t){var e=Qe.asn1.x509.OID.name2oidList;for(var n in e)if(e[n]==t)return n;return""},Qe.asn1.x509.OID.oid2atype=function(t){var e=Qe.asn1.x509.OID.atype2oidList;for(var n in e)if(e[n]==t)return n;return t},Qe.asn1.x509.OID.name2oid=function(t){var e=Qe.asn1.x509.OID.name2oidList;return void 0===e[t]?"":e[t]},Qe.asn1.x509.X509Util={},Qe.asn1.x509.X509Util.newCertPEM=function(t){var e=Qe.asn1.x509,n=e.TBSCertificate,i=e.Certificate,r=new n;if(void 0===t.serial)throw"serial number undefined.";if(r.setSerialNumberByParam(t.serial),"string"!=typeof t.sigalg.name)throw"unproper signature algorithm name";if(r.setSignatureAlgByParam(t.sigalg),void 0===t.issuer)throw"issuer name undefined.";if(r.setIssuerByParam(t.issuer),void 0===t.notbefore)throw"notbefore undefined.";if(r.setNotBeforeByParam(t.notbefore),void 0===t.notafter)throw"notafter undefined.";if(r.setNotAfterByParam(t.notafter),void 0===t.subject)throw"subject name undefined.";if(r.setSubjectByParam(t.subject),void 0===t.sbjpubkey)throw"subject public key undefined.";if(r.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var s=0;s<t.ext.length;s++)for(key in t.ext[s])r.appendExtensionByName(key,t.ext[s][key]);if(void 0===t.cakey&&void 0===t.sighex)throw"param cakey and sighex undefined.";var o=null;return t.cakey&&(o=new i({tbscertobj:r,prvkeyobj:!0===t.cakey.isPrivate?t.cakey:Fn.getKey.apply(null,t.cakey)})).sign(),t.sighex&&(o=new i({tbscertobj:r})).setSignatureHex(t.sighex),o.getPEMString()},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.cms&&Qe.asn1.cms||(Qe.asn1.cms={}),Qe.asn1.cms.Attribute=function(t){var e=Qe.asn1;e.cms.Attribute.superclass.constructor.call(this),this.getEncodedHex=function(){var t,n,i;t=new e.DERObjectIdentifier({oid:this.attrTypeOid}),n=new e.DERSet({array:this.valueList});try{n.getEncodedHex()}catch(t){throw"fail valueSet.getEncodedHex in Attribute(1)/"+t}i=new e.DERSequence({array:[t,n]});try{this.hTLV=i.getEncodedHex()}catch(t){throw"failed seq.getEncodedHex in Attribute(2)/"+t}return this.hTLV}},ee.lang.extend(Qe.asn1.cms.Attribute,Qe.asn1.ASN1Object),Qe.asn1.cms.ContentType=function(t){var e=Qe.asn1;e.cms.ContentType.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.3";var n=null;if(void 0!==t){n=new e.DERObjectIdentifier(t);this.valueList=[n]}},ee.lang.extend(Qe.asn1.cms.ContentType,Qe.asn1.cms.Attribute),Qe.asn1.cms.MessageDigest=function(t){var e=Qe,n=e.asn1,i=n.DEROctetString,r=n.cms;if(r.MessageDigest.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.4",void 0!==t)if(t.eciObj instanceof r.EncapsulatedContentInfo&&"string"==typeof t.hashAlg){var s=t.eciObj.eContentValueHex,o=t.hashAlg;(a=new i({hex:e.crypto.Util.hashHex(s,o)})).getEncodedHex(),this.valueList=[a]}else{var a;(a=new i(t)).getEncodedHex(),this.valueList=[a]}},ee.lang.extend(Qe.asn1.cms.MessageDigest,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningTime=function(t){var e=Qe.asn1;if(e.cms.SigningTime.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.5",void 0!==t){var n=new e.x509.Time(t);try{n.getEncodedHex()}catch(t){throw"SigningTime.getEncodedHex() failed/"+t}this.valueList=[n]}},ee.lang.extend(Qe.asn1.cms.SigningTime,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningCertificate=function(t){var e=Qe,n=e.asn1,i=n.DERSequence,r=n.cms;e.crypto;r.SigningCertificate.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.12",this.setCerts=function(t){for(var s=[],o=0;o<t.length;o++){var a=vn(t[o]),u=e.crypto.Util.hashHex(a,"sha1"),h=new n.DEROctetString({hex:u});h.getEncodedHex();var c=new r.IssuerAndSerialNumber({cert:t[o]});c.getEncodedHex();var f=new i({array:[h,c]});f.getEncodedHex(),s.push(f)}var l=new i({array:s});l.getEncodedHex(),this.valueList=[l]},void 0!==t&&"object"==typeof t.array&&this.setCerts(t.array)},ee.lang.extend(Qe.asn1.cms.SigningCertificate,Qe.asn1.cms.Attribute),Qe.asn1.cms.SigningCertificateV2=function(t){var e=Qe,n=e.asn1,i=n.DERSequence,r=n.x509,s=n.cms,o=e.crypto;if(s.SigningCertificateV2.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.47",this.setCerts=function(t,e){for(var a=[],u=0;u<t.length;u++){var h=vn(t[u]),c=[];"sha256"!==e&&c.push(new r.AlgorithmIdentifier({name:e}));var f=o.Util.hashHex(h,e),l=new n.DEROctetString({hex:f});l.getEncodedHex(),c.push(l);var d=new s.IssuerAndSerialNumber({cert:t[u]});d.getEncodedHex(),c.push(d);var p=new i({array:c});p.getEncodedHex(),a.push(p)}var g=new i({array:a});g.getEncodedHex(),this.valueList=[g]},void 0!==t&&"object"==typeof t.array){var a="sha256";"string"==typeof t.hashAlg&&(a=t.hashAlg),this.setCerts(t.array,a)}},ee.lang.extend(Qe.asn1.cms.SigningCertificateV2,Qe.asn1.cms.Attribute),Qe.asn1.cms.IssuerAndSerialNumber=function(t){var e=Qe.asn1,n=e.DERInteger,i=e.cms,r=e.x509.X500Name,s=In;i.IssuerAndSerialNumber.superclass.constructor.call(this),this.setByCertPEM=function(t){var e=vn(t),i=new s;i.hex=e;var o=i.getIssuerHex();this.dIssuer=new r,this.dIssuer.hTLV=o;var a=i.getSerialNumberHex();this.dSerial=new n({hex:a})},this.getEncodedHex=function(){var t=new e.DERSequence({array:[this.dIssuer,this.dSerial]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),t.issuer&&t.serial&&(t.issuer instanceof r?this.dIssuer=t.issuer:this.dIssuer=new r(t.issuer),t.serial instanceof n?this.dSerial=t.serial:this.dSerial=new n(t.serial)),"string"==typeof t.cert&&this.setByCertPEM(t.cert))},ee.lang.extend(Qe.asn1.cms.IssuerAndSerialNumber,Qe.asn1.ASN1Object),Qe.asn1.cms.AttributeList=function(t){var e=Qe.asn1,n=e.cms;n.AttributeList.superclass.constructor.call(this),this.list=new Array,this.sortFlag=!0,this.add=function(t){t instanceof n.Attribute&&this.list.push(t)},this.length=function(){return this.list.length},this.clear=function(){this.list=new Array,this.hTLV=null,this.hV=null},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;var t=new e.DERSet({array:this.list,sortflag:this.sortFlag});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.sortflag&&0==t.sortflag&&(this.sortFlag=!1)},ee.lang.extend(Qe.asn1.cms.AttributeList,Qe.asn1.ASN1Object),Qe.asn1.cms.SignerInfo=function(t){var e=Qe,n=e.asn1,i=n.DERTaggedObject,r=n.cms,s=r.AttributeList,o=r.ContentType,a=r.EncapsulatedContentInfo,u=r.MessageDigest,h=r.SignedData,c=n.x509.AlgorithmIdentifier,f=e.crypto,l=Fn;r.SignerInfo.superclass.constructor.call(this),this.dCMSVersion=new n.DERInteger({int:1}),this.dSignerIdentifier=null,this.dDigestAlgorithm=null,this.dSignedAttrs=new s,this.dSigAlg=null,this.dSig=null,this.dUnsignedAttrs=new s,this.setSignerIdentifier=function(t){"string"==typeof t&&-1!=t.indexOf("CERTIFICATE")&&-1!=t.indexOf("BEGIN")&&-1!=t.indexOf("END")&&(this.dSignerIdentifier=new r.IssuerAndSerialNumber({cert:t}))},this.setForContentAndHash=function(t){void 0!==t&&(t.eciObj instanceof a&&(this.dSignedAttrs.add(new o({oid:"1.2.840.113549.1.7.1"})),this.dSignedAttrs.add(new u({eciObj:t.eciObj,hashAlg:t.hashAlg}))),void 0!==t.sdObj&&t.sdObj instanceof h&&-1==t.sdObj.digestAlgNameList.join(":").indexOf(t.hashAlg)&&t.sdObj.digestAlgNameList.push(t.hashAlg),"string"==typeof t.hashAlg&&(this.dDigestAlgorithm=new c({name:t.hashAlg})))},this.sign=function(t,e){this.dSigAlg=new c({name:e});var i=this.dSignedAttrs.getEncodedHex(),r=l.getKey(t),s=new f.Signature({alg:e});s.init(r),s.updateHex(i);var o=s.sign();this.dSig=new n.DEROctetString({hex:o})},this.addUnsigned=function(t){this.hTLV=null,this.dUnsignedAttrs.hTLV=null,this.dUnsignedAttrs.add(t)},this.getEncodedHex=function(){if(this.dSignedAttrs instanceof s&&0==this.dSignedAttrs.length())throw"SignedAttrs length = 0 (empty)";var t=new i({obj:this.dSignedAttrs,tag:"a0",explicit:!1}),e=null;this.dUnsignedAttrs.length()>0&&(e=new i({obj:this.dUnsignedAttrs,tag:"a1",explicit:!1}));var r=[this.dCMSVersion,this.dSignerIdentifier,this.dDigestAlgorithm,t,this.dSigAlg,this.dSig];null!=e&&r.push(e);var o=new n.DERSequence({array:r});return this.hTLV=o.getEncodedHex(),this.hTLV}},ee.lang.extend(Qe.asn1.cms.SignerInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.EncapsulatedContentInfo=function(t){var e=Qe.asn1,n=e.DERTaggedObject,i=e.DERSequence,r=e.DERObjectIdentifier,s=e.DEROctetString;e.cms.EncapsulatedContentInfo.superclass.constructor.call(this),this.dEContentType=new r({name:"data"}),this.dEContent=null,this.isDetached=!1,this.eContentValueHex=null,this.setContentType=function(t){t.match(/^[0-2][.][0-9.]+$/)?this.dEContentType=new r({oid:t}):this.dEContentType=new r({name:t})},this.setContentValue=function(t){void 0!==t&&("string"==typeof t.hex?this.eContentValueHex=t.hex:"string"==typeof t.str&&(this.eContentValueHex=cn(t.str)))},this.setContentValueHex=function(t){this.eContentValueHex=t},this.setContentValueStr=function(t){this.eContentValueHex=cn(t)},this.getEncodedHex=function(){if("string"!=typeof this.eContentValueHex)throw"eContentValue not yet set";var t=new s({hex:this.eContentValueHex});this.dEContent=new n({obj:t,tag:"a0",explicit:!0});var e=[this.dEContentType];this.isDetached||e.push(this.dEContent);var r=new i({array:e});return this.hTLV=r.getEncodedHex(),this.hTLV}},ee.lang.extend(Qe.asn1.cms.EncapsulatedContentInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.ContentInfo=function(t){var e=Qe.asn1,n=e.DERTaggedObject,i=e.DERSequence,r=e.x509;Qe.asn1.cms.ContentInfo.superclass.constructor.call(this),this.dContentType=null,this.dContent=null,this.setContentType=function(t){"string"==typeof t&&(this.dContentType=r.OID.name2obj(t))},this.getEncodedHex=function(){var t=new n({obj:this.dContent,tag:"a0",explicit:!0}),e=new i({array:[this.dContentType,t]});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&(t.type&&this.setContentType(t.type),t.obj&&t.obj instanceof e.ASN1Object&&(this.dContent=t.obj))},ee.lang.extend(Qe.asn1.cms.ContentInfo,Qe.asn1.ASN1Object),Qe.asn1.cms.SignedData=function(t){var e=Qe.asn1,n=e.ASN1Object,i=e.DERInteger,r=e.DERSet,s=e.DERSequence,o=e.DERTaggedObject,a=e.cms,u=a.EncapsulatedContentInfo,h=a.SignerInfo,c=a.ContentInfo,f=e.x509.AlgorithmIdentifier;Qe.asn1.cms.SignedData.superclass.constructor.call(this),this.dCMSVersion=new i({int:1}),this.dDigestAlgs=null,this.digestAlgNameList=[],this.dEncapContentInfo=new u,this.dCerts=null,this.certificateList=[],this.crlList=[],this.signerInfoList=[new h],this.addCertificatesByPEM=function(t){var e=vn(t),i=new n;i.hTLV=e,this.certificateList.push(i)},this.getEncodedHex=function(){if("string"==typeof this.hTLV)return this.hTLV;if(null==this.dDigestAlgs){for(var t=[],e=0;e<this.digestAlgNameList.length;e++){var n=this.digestAlgNameList[e],i=new f({name:n});t.push(i)}this.dDigestAlgs=new r({array:t})}var a=[this.dCMSVersion,this.dDigestAlgs,this.dEncapContentInfo];if(null==this.dCerts&&this.certificateList.length>0){var u=new r({array:this.certificateList});this.dCerts=new o({obj:u,tag:"a0",explicit:!1})}null!=this.dCerts&&a.push(this.dCerts);var h=new r({array:this.signerInfoList});a.push(h);var c=new s({array:a});return this.hTLV=c.getEncodedHex(),this.hTLV},this.getContentInfo=function(){return this.getEncodedHex(),new c({type:"signed-data",obj:this})},this.getContentInfoEncodedHex=function(){return this.getContentInfo().getEncodedHex()},this.getPEM=function(){return gn(this.getContentInfoEncodedHex(),"CMS")}},ee.lang.extend(Qe.asn1.cms.SignedData,Qe.asn1.ASN1Object),Qe.asn1.cms.CMSUtil=new function(){},Qe.asn1.cms.CMSUtil.newSignedData=function(t){var e=Qe.asn1,n=e.cms,i=n.SignerInfo,r=n.SignedData,s=n.SigningTime,o=n.SigningCertificate,a=n.SigningCertificateV2,u=e.cades.SignaturePolicyIdentifier,h=new r;if(h.dEncapContentInfo.setContentValue(t.content),"object"==typeof t.certs)for(var c=0;c<t.certs.length;c++)h.addCertificatesByPEM(t.certs[c]);h.signerInfoList=[];for(c=0;c<t.signerInfos.length;c++){var f=t.signerInfos[c],l=new i;for(attrName in l.setSignerIdentifier(f.signerCert),l.setForContentAndHash({sdObj:h,eciObj:h.dEncapContentInfo,hashAlg:f.hashAlg}),f.sAttr){var d=f.sAttr[attrName];if("SigningTime"==attrName){var p=new s(d);l.dSignedAttrs.add(p)}if("SigningCertificate"==attrName){p=new o(d);l.dSignedAttrs.add(p)}if("SigningCertificateV2"==attrName){p=new a(d);l.dSignedAttrs.add(p)}if("SignaturePolicyIdentifier"==attrName){p=new u(d);l.dSignedAttrs.add(p)}}l.sign(f.signerPrvKey,f.sigAlg),h.signerInfoList.push(l)}return h},Qe.asn1.cms.CMSUtil.verifySignedData=function(t){var e=Qe,n=e.asn1,i=n.cms,r=(i.SignerInfo,i.SignedData,i.SigningTime,i.SigningCertificate,i.SigningCertificateV2,n.cades.SignaturePolicyIdentifier,e.lang.String.isHex),s=nn,o=s.getVbyList,a=s.getTLVbyList,u=s.getIdxbyList,h=s.getChildIdx,c=s.getTLV,f=s.oidname,l=e.crypto.Util.hashHex;void 0===t.cms&&r(t.cms);var d=t.cms,p=function(t,e){var n=e.idx;e.signerid_issuer1=a(t,n,[1,0],"30"),e.signerid_serial1=o(t,n,[1,1],"02"),e.hashalg=f(o(t,n,[2,0],"06"));var i=u(t,n,[3],"a0");e.idxSignedAttrs=i,g(t,e,i);var r=h(t,n).length;if(r<6)throw"malformed SignerInfo";e.sigalg=f(o(t,n,[r-2,0],"06")),e.sigval=o(t,n,[r-1],"04")},g=function(t,e,n){var i=h(t,n);e.signedAttrIdxList=i;for(var r=0;r<i.length;r++){var s,a=i[r],u=o(t,a,[0],"06");"2a864886f70d010905"===u?(s=fn(o(t,a,[1,0])),e.saSigningTime=s):"2a864886f70d010904"===u&&(s=o(t,a,[1,0],"04"),e.saMessageDigest=s)}},v=function(t,e,n,i){n.verifyDetail={};var r=n.verifyDetail,s=e.parse.econtent,o=n.hashalg,a=n.saMessageDigest;r.validMessageDigest=!1,l(s,o)===a&&(r.validMessageDigest=!0),function(t,e,n,i){var r,s=e.parse.certsIdx;if(void 0===e.certs){r=[],e.certkeys=[];for(var o=h(t,s),a=0;a<o.length;a++){var u=c(t,o[a]),f=new In;f.readCertHex(u),r[a]=f,e.certkeys[a]=f.getPublicKey()}e.certs=r}else r=e.certs;e.cccc=r.length,e.cccci=o.length;for(a=0;a<r.length;a++){var l=f.getIssuerHex(),d=f.getSerialNumberHex();n.signerid_issuer1===l&&n.signerid_serial1===d&&(n.certkey_idx=a)}}(t,e,n),r.validSignatureValue=!1;var u=n.sigalg,f="31"+c(t,n.idxSignedAttrs).substr(2);n.signedattrshex=f;var d=e.certs[n.certkey_idx].getPublicKey(),p=new Qe.crypto.Signature({alg:u});p.init(d),p.updateHex(f);var g=p.verify(n.sigval);r.validSignatureValue_isValid=g,!0===g&&(r.validSignatureValue=!0),n.isValid=!1,r.validMessageDigest&&r.validSignatureValue&&(n.isValid=!0)},y={isValid:!1,parse:{}};return function(t,e){if("2a864886f70d010702"!==o(t,0,[0],"06"))return e;e.cmsType="signedData",e.econtent=o(t,0,[1,0,2,1,0]),function(t,e){for(var n,i=3;i<6;i++)if(void 0!==(n=u(t,0,[1,0,i]))){var r=t.substr(n,2);"a0"===r&&(e.certsIdx=n),"a1"===r&&(e.revinfosIdx=n),"31"===r&&(e.signerinfosIdx=n)}}(t,e),e.signerInfos=[],function(t,e){var n=e.signerinfosIdx;if(void 0!==n){var i=h(t,n);e.signerInfoIdxList=i;for(var r=0;r<i.length;r++){var s={idx:i[r]};p(t,s),e.signerInfos.push(s)}}}(t,e)}(d,y.parse),function(t,e){for(var n=e.parse.signerInfos,i=n.length,r=!0,s=0;s<i;s++){var o=n[s];v(t,e,o,s),o.isValid||(r=!1)}e.isValid=r}(d,y),y},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.tsp&&Qe.asn1.tsp||(Qe.asn1.tsp={}),Qe.asn1.tsp.Accuracy=function(t){var e=Qe.asn1,n=e.DERInteger,i=e.DERSequence,r=e.DERTaggedObject;e.tsp.Accuracy.superclass.constructor.call(this),this.seconds=null,this.millis=null,this.micros=null,this.getEncodedHex=function(){var t=null,e=null,s=null,o=[];if(null!=this.seconds&&(t=new n({int:this.seconds}),o.push(t)),null!=this.millis){var a=new n({int:this.millis});e=new r({obj:a,tag:"80",explicit:!1}),o.push(e)}if(null!=this.micros){var u=new n({int:this.micros});s=new r({obj:u,tag:"81",explicit:!1}),o.push(s)}var h=new i({array:o});return this.hTLV=h.getEncodedHex(),this.hTLV},void 0!==t&&("number"==typeof t.seconds&&(this.seconds=t.seconds),"number"==typeof t.millis&&(this.millis=t.millis),"number"==typeof t.micros&&(this.micros=t.micros))},ee.lang.extend(Qe.asn1.tsp.Accuracy,Qe.asn1.ASN1Object),Qe.asn1.tsp.MessageImprint=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.tsp.MessageImprint.superclass.constructor.call(this),this.dHashAlg=null,this.dHashValue=null,this.getEncodedHex=function(){return"string"==typeof this.hTLV?this.hTLV:new n({array:[this.dHashAlg,this.dHashValue]}).getEncodedHex()},void 0!==t&&("string"==typeof t.hashAlg&&(this.dHashAlg=new r({name:t.hashAlg})),"string"==typeof t.hashValue&&(this.dHashValue=new i({hex:t.hashValue})))},ee.lang.extend(Qe.asn1.tsp.MessageImprint,Qe.asn1.ASN1Object),Qe.asn1.tsp.TimeStampReq=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERBoolean,s=e.DERObjectIdentifier,o=e.tsp,a=o.MessageImprint;o.TimeStampReq.superclass.constructor.call(this),this.dVersion=new i({int:1}),this.dMessageImprint=null,this.dPolicy=null,this.dNonce=null,this.certReq=!0,this.setMessageImprint=function(t){t instanceof a?this.dMessageImprint=t:"object"==typeof t&&(this.dMessageImprint=new a(t))},this.getEncodedHex=function(){if(null==this.dMessageImprint)throw"messageImprint shall be specified";var t=[this.dVersion,this.dMessageImprint];null!=this.dPolicy&&t.push(this.dPolicy),null!=this.dNonce&&t.push(this.dNonce),this.certReq&&t.push(new r);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.mi&&this.setMessageImprint(t.mi),"object"==typeof t.policy&&(this.dPolicy=new s(t.policy)),"object"==typeof t.nonce&&(this.dNonce=new i(t.nonce)),"boolean"==typeof t.certreq&&(this.certReq=t.certreq))},ee.lang.extend(Qe.asn1.tsp.TimeStampReq,Qe.asn1.ASN1Object),Qe.asn1.tsp.TSTInfo=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.DERInteger,r=e.DERBoolean,s=e.DERGeneralizedTime,o=e.DERObjectIdentifier,a=e.tsp,u=a.MessageImprint,h=a.Accuracy,c=e.x509.X500Name;if(a.TSTInfo.superclass.constructor.call(this),this.dVersion=new i({int:1}),this.dPolicy=null,this.dMessageImprint=null,this.dSerialNumber=null,this.dGenTime=null,this.dAccuracy=null,this.dOrdering=null,this.dNonce=null,this.dTsa=null,this.getEncodedHex=function(){var t=[this.dVersion];if(null==this.dPolicy)throw"policy shall be specified.";if(t.push(this.dPolicy),null==this.dMessageImprint)throw"messageImprint shall be specified.";if(t.push(this.dMessageImprint),null==this.dSerialNumber)throw"serialNumber shall be specified.";if(t.push(this.dSerialNumber),null==this.dGenTime)throw"genTime shall be specified.";t.push(this.dGenTime),null!=this.dAccuracy&&t.push(this.dAccuracy),null!=this.dOrdering&&t.push(this.dOrdering),null!=this.dNonce&&t.push(this.dNonce),null!=this.dTsa&&t.push(this.dTsa);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){if("string"==typeof t.policy){if(!t.policy.match(/^[0-9.]+$/))throw"policy shall be oid like 0.1.4.134";this.dPolicy=new o({oid:t.policy})}void 0!==t.messageImprint&&(this.dMessageImprint=new u(t.messageImprint)),void 0!==t.serialNumber&&(this.dSerialNumber=new i(t.serialNumber)),void 0!==t.genTime&&(this.dGenTime=new s(t.genTime)),void 0!==t.accuracy&&(this.dAccuracy=new h(t.accuracy)),void 0!==t.ordering&&1==t.ordering&&(this.dOrdering=new r),void 0!==t.nonce&&(this.dNonce=new i(t.nonce)),void 0!==t.tsa&&(this.dTsa=new c(t.tsa))}},ee.lang.extend(Qe.asn1.tsp.TSTInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.TimeStampResp=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.ASN1Object,r=e.tsp,s=r.PKIStatusInfo;r.TimeStampResp.superclass.constructor.call(this),this.dStatus=null,this.dTST=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dTST&&t.push(this.dTST);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new s(t.status)),void 0!==t.tst&&t.tst instanceof i&&(this.dTST=t.tst.getContentInfo()))},ee.lang.extend(Qe.asn1.tsp.TimeStampResp,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatusInfo=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.tsp,r=i.PKIStatus,s=i.PKIFreeText,o=i.PKIFailureInfo;i.PKIStatusInfo.superclass.constructor.call(this),this.dStatus=null,this.dStatusString=null,this.dFailureInfo=null,this.getEncodedHex=function(){if(null==this.dStatus)throw"status shall be specified";var t=[this.dStatus];null!=this.dStatusString&&t.push(this.dStatusString),null!=this.dFailureInfo&&t.push(this.dFailureInfo);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&("object"==typeof t.status&&(this.dStatus=new r(t.status)),"object"==typeof t.statstr&&(this.dStatusString=new s({array:t.statstr})),"object"==typeof t.failinfo&&(this.dFailureInfo=new o(t.failinfo)))},ee.lang.extend(Qe.asn1.tsp.PKIStatusInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatus=function(t){var e=Qe.asn1,n=e.DERInteger,i=e.tsp,r=i.PKIStatus;if(i.PKIStatus.superclass.constructor.call(this),this.getEncodedHex=function(){return this.hTLV=this.dStatus.getEncodedHex(),this.hTLV},void 0!==t)if(void 0!==t.name){var s=r.valueList;if(void 0===s[t.name])throw"name undefined: "+t.name;this.dStatus=new n({int:s[t.name]})}else this.dStatus=new n(t)},ee.lang.extend(Qe.asn1.tsp.PKIStatus,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIStatus.valueList={granted:0,grantedWithMods:1,rejection:2,waiting:3,revocationWarning:4,revocationNotification:5},Qe.asn1.tsp.PKIFreeText=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.DERUTF8String;e.tsp.PKIFreeText.superclass.constructor.call(this),this.textList=[],this.getEncodedHex=function(){for(var t=[],e=0;e<this.textList.length;e++)t.push(new i({str:this.textList[e]}));var r=new n({array:t});return this.hTLV=r.getEncodedHex(),this.hTLV},void 0!==t&&"object"==typeof t.array&&(this.textList=t.array)},ee.lang.extend(Qe.asn1.tsp.PKIFreeText,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIFailureInfo=function(t){var e=Qe.asn1,n=e.DERBitString,i=e.tsp.PKIFailureInfo;if(i.superclass.constructor.call(this),this.value=null,this.getEncodedHex=function(){if(null==this.value)throw"value shall be specified";var t=new Number(this.value).toString(2),e=new n;return e.setByBinaryString(t),this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t)if("string"==typeof t.name){var r=i.valueList;if(void 0===r[t.name])throw"name undefined: "+t.name;this.value=r[t.name]}else"number"==typeof t.int&&(this.value=t.int)},ee.lang.extend(Qe.asn1.tsp.PKIFailureInfo,Qe.asn1.ASN1Object),Qe.asn1.tsp.PKIFailureInfo.valueList={badAlg:0,badRequest:2,badDataFormat:5,timeNotAvailable:14,unacceptedPolicy:15,unacceptedExtension:16,addInfoNotAvailable:17,systemFailure:25},Qe.asn1.tsp.AbstractTSAAdapter=function(t){this.getTSTHex=function(t,e){throw"not implemented yet"}},Qe.asn1.tsp.SimpleTSAAdapter=function(t){var e=Qe,n=e.asn1.tsp,i=e.crypto.Util.hashHex;n.SimpleTSAAdapter.superclass.constructor.call(this),this.params=null,this.serial=0,this.getTSTHex=function(t,e){var r=i(t,e);this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},this.params.tstInfo.serialNumber={int:this.serial++};var s=Math.floor(1e9*Math.random());return this.params.tstInfo.nonce={int:s},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ee.lang.extend(Qe.asn1.tsp.SimpleTSAAdapter,Qe.asn1.tsp.AbstractTSAAdapter),Qe.asn1.tsp.FixedTSAAdapter=function(t){var e=Qe,n=e.asn1.tsp,i=e.crypto.Util.hashHex;n.FixedTSAAdapter.superclass.constructor.call(this),this.params=null,this.getTSTHex=function(t,e){var r=i(t,e);return this.params.tstInfo.messageImprint={hashAlg:e,hashValue:r},n.TSPUtil.newTimeStampToken(this.params).getContentInfoEncodedHex()},void 0!==t&&(this.params=t)},ee.lang.extend(Qe.asn1.tsp.FixedTSAAdapter,Qe.asn1.tsp.AbstractTSAAdapter),Qe.asn1.tsp.TSPUtil=new function(){},Qe.asn1.tsp.TSPUtil.newTimeStampToken=function(t){var e=Qe.asn1,n=e.cms,i=(e.tsp,e.tsp.TSTInfo),r=new n.SignedData,s=new i(t.tstInfo).getEncodedHex();if(r.dEncapContentInfo.setContentValue({hex:s}),r.dEncapContentInfo.setContentType("tstinfo"),"object"==typeof t.certs)for(var o=0;o<t.certs.length;o++)r.addCertificatesByPEM(t.certs[o]);var a=r.signerInfoList[0];a.setSignerIdentifier(t.signerCert),a.setForContentAndHash({sdObj:r,eciObj:r.dEncapContentInfo,hashAlg:t.hashAlg});var u=new n.SigningCertificate({array:[t.signerCert]});return a.dSignedAttrs.add(u),a.sign(t.signerPrvKey,t.sigAlg),r},Qe.asn1.tsp.TSPUtil.parseTimeStampReq=function(t){var e=nn,n=e.getChildIdx,i=e.getV,r=e.getTLV,s={certreq:!1},o=n(t,0);if(o.length<2)throw"TimeStampReq must have at least 2 items";var a=r(t,o[1]);s.mi=Qe.asn1.tsp.TSPUtil.parseMessageImprint(a);for(var u=2;u<o.length;u++){var h=o[u],c=t.substr(h,2);if("06"==c){var f=i(t,h);s.policy=e.hextooidstr(f)}"02"==c&&(s.nonce=i(t,h)),"01"==c&&(s.certreq=!0)}return s},Qe.asn1.tsp.TSPUtil.parseMessageImprint=function(t){var e=nn,n=e.getChildIdx,i=e.getV,r=e.getIdxbyList,s={};if("30"!=t.substr(0,2))throw"head of messageImprint hex shall be '30'";n(t,0);var o=i(t,r(t,0,[0,0])),a=e.hextooidstr(o),u=Qe.asn1.x509.OID.oid2name(a);if(""==u)throw"hashAlg name undefined: "+a;var h=u,c=r(t,0,[1]);return s.hashAlg=h,s.hashValue=i(t,c),s},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.cades&&Qe.asn1.cades||(Qe.asn1.cades={}),Qe.asn1.cades.SignaturePolicyIdentifier=function(t){var e=Qe.asn1,n=e.DERObjectIdentifier,i=e.DERSequence,r=e.cades,s=r.OtherHashAlgAndValue;if(r.SignaturePolicyIdentifier.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.15",void 0!==t&&"string"==typeof t.oid&&"object"==typeof t.hash){var o=new i({array:[new n({oid:t.oid}),new s(t.hash)]});this.valueList=[o]}},ee.lang.extend(Qe.asn1.cades.SignaturePolicyIdentifier,Qe.asn1.cms.Attribute),Qe.asn1.cades.OtherHashAlgAndValue=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.DEROctetString,r=e.x509.AlgorithmIdentifier;e.cades.OtherHashAlgAndValue.superclass.constructor.call(this),this.dAlg=null,this.dHash=null,this.getEncodedHex=function(){var t=new n({array:[this.dAlg,this.dHash]});return this.hTLV=t.getEncodedHex(),this.hTLV},void 0!==t&&"string"==typeof t.alg&&"string"==typeof t.hash&&(this.dAlg=new r({name:t.alg}),this.dHash=new i({hex:t.hash}))},ee.lang.extend(Qe.asn1.cades.OtherHashAlgAndValue,Qe.asn1.ASN1Object),Qe.asn1.cades.SignatureTimeStamp=function(t){var e=Qe.asn1,n=e.ASN1Object;e.x509;if(e.cades.SignatureTimeStamp.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.14",this.tstHex=null,void 0!==t){if(void 0!==t.res)if("string"==typeof t.res&&t.res.match(/^[0-9A-Fa-f]+$/));else if(!(t.res instanceof n))throw"res param shall be ASN1Object or hex string";if(void 0!==t.tst)if("string"==typeof t.tst&&t.tst.match(/^[0-9A-Fa-f]+$/)){var i=new n;this.tstHex=t.tst,i.hTLV=this.tstHex,i.getEncodedHex(),this.valueList=[i]}else if(!(t.tst instanceof n))throw"tst param shall be ASN1Object or hex string"}},ee.lang.extend(Qe.asn1.cades.SignatureTimeStamp,Qe.asn1.cms.Attribute),Qe.asn1.cades.CompleteCertificateRefs=function(t){var e=Qe.asn1.cades;e.CompleteCertificateRefs.superclass.constructor.call(this),this.attrTypeOid="1.2.840.113549.1.9.16.2.21",this.setByArray=function(t){this.valueList=[];for(var n=0;n<t.length;n++){var i=new e.OtherCertID(t[n]);this.valueList.push(i)}},void 0!==t&&"object"==typeof t&&"number"==typeof t.length&&this.setByArray(t)},ee.lang.extend(Qe.asn1.cades.CompleteCertificateRefs,Qe.asn1.cms.Attribute),Qe.asn1.cades.OtherCertID=function(t){var e=Qe.asn1,n=e.cms,i=e.cades;i.OtherCertID.superclass.constructor.call(this),this.hasIssuerSerial=!0,this.dOtherCertHash=null,this.dIssuerSerial=null,this.setByCertPEM=function(t){this.dOtherCertHash=new i.OtherHash(t),this.hasIssuerSerial&&(this.dIssuerSerial=new n.IssuerAndSerialNumber(t))},this.getEncodedHex=function(){if(null!=this.hTLV)return this.hTLV;if(null==this.dOtherCertHash)throw"otherCertHash not set";var t=[this.dOtherCertHash];null!=this.dIssuerSerial&&t.push(this.dIssuerSerial);var n=new e.DERSequence({array:t});return this.hTLV=n.getEncodedHex(),this.hTLV},void 0!==t&&("string"==typeof t&&-1!=t.indexOf("-----BEGIN ")&&this.setByCertPEM(t),"object"==typeof t&&(!1===t.hasis&&(this.hasIssuerSerial=!1),"string"==typeof t.cert&&this.setByCertPEM(t.cert)))},ee.lang.extend(Qe.asn1.cades.OtherCertID,Qe.asn1.ASN1Object),Qe.asn1.cades.OtherHash=function(t){var e=Qe,n=e.asn1,i=(n.cms,n.cades),r=i.OtherHashAlgAndValue,s=e.crypto.Util.hashHex;if(i.OtherHash.superclass.constructor.call(this),this.alg="sha256",this.dOtherHash=null,this.setByCertPEM=function(t){if(-1==t.indexOf("-----BEGIN "))throw"certPEM not to seem PEM format";var e=vn(t),n=s(e,this.alg);this.dOtherHash=new r({alg:this.alg,hash:n})},this.getEncodedHex=function(){if(null==this.dOtherHash)throw"OtherHash not set";return this.dOtherHash.getEncodedHex()},void 0!==t)if("string"==typeof t)if(-1!=t.indexOf("-----BEGIN "))this.setByCertPEM(t);else{if(!t.match(/^[0-9A-Fa-f]+$/))throw"unsupported string value for params";this.dOtherHash=new n.DEROctetString({hex:t})}else"object"==typeof t&&("string"==typeof t.cert?("string"==typeof t.alg&&(this.alg=t.alg),this.setByCertPEM(t.cert)):this.dOtherHash=new r(t))},ee.lang.extend(Qe.asn1.cades.OtherHash,Qe.asn1.ASN1Object),Qe.asn1.cades.CAdESUtil=new function(){},Qe.asn1.cades.CAdESUtil.addSigTS=function(t,e,n){},Qe.asn1.cades.CAdESUtil.parseSignedDataForAddingUnsigned=function(t){var e=nn,n=e.getChildIdx,i=e.getTLV,r=e.getTLVbyList,s=e.getIdxbyList,o=Qe.asn1,a=o.ASN1Object,u=o.cms.SignedData,h=o.cades.CAdESUtil,c={};if("06092a864886f70d010702"!=r(t,0,[0]))throw"hex is not CMS SignedData";var f=n(t,s(t,0,[1,0]));if(f.length<4)throw"num of SignedData elem shall be 4 at least";var l=f.shift();c.version=i(t,l);var d=f.shift();c.algs=i(t,d);var p=f.shift();c.encapcontent=i(t,p),c.certs=null,c.revs=null,c.si=[];var g=f.shift();"a0"==t.substr(g,2)&&(c.certs=i(t,g),g=f.shift()),"a1"==t.substr(g,2)&&(c.revs=i(t,g),g=f.shift());var v=g;if("31"!=t.substr(v,2))throw"Can't find signerInfos";for(var y=n(t,v),m=0;m<y.length;m++){var b=y[m],S=h.parseSignerInfoForAddingUnsigned(t,b,m);c.si[m]=S}var w=null;c.obj=new u,(w=new a).hTLV=c.version,c.obj.dCMSVersion=w,(w=new a).hTLV=c.algs,c.obj.dDigestAlgs=w,(w=new a).hTLV=c.encapcontent,c.obj.dEncapContentInfo=w,(w=new a).hTLV=c.certs,c.obj.dCerts=w,c.obj.signerInfoList=[];for(m=0;m<c.si.length;m++)c.obj.signerInfoList.push(c.si[m].obj);return c},Qe.asn1.cades.CAdESUtil.parseSignerInfoForAddingUnsigned=function(t,e,n){var i=nn,r=i.getChildIdx,s=i.getTLV,o=i.getV,a=Qe.asn1,u=a.ASN1Object,h=a.cms,c=h.AttributeList,f=h.SignerInfo,l={},d=r(t,e);if(6!=d.length)throw"not supported items for SignerInfo (!=6)";var p=d.shift();l.version=s(t,p);var g=d.shift();l.si=s(t,g);var v=d.shift();l.digalg=s(t,v);var y=d.shift();l.sattrs=s(t,y);var m=d.shift();l.sigalg=s(t,m);var b=d.shift();l.sig=s(t,b),l.sigval=o(t,b);var S=null;return l.obj=new f,(S=new u).hTLV=l.version,l.obj.dCMSVersion=S,(S=new u).hTLV=l.si,l.obj.dSignerIdentifier=S,(S=new u).hTLV=l.digalg,l.obj.dDigestAlgorithm=S,(S=new u).hTLV=l.sattrs,l.obj.dSignedAttrs=S,(S=new u).hTLV=l.sigalg,l.obj.dSigAlg=S,(S=new u).hTLV=l.sig,l.obj.dSig=S,l.obj.dUnsignedAttrs=new c,l},void 0!==Qe.asn1.csr&&Qe.asn1.csr||(Qe.asn1.csr={}),Qe.asn1.csr.CertificationRequest=function(t){var e=Qe,n=e.asn1,i=n.DERBitString,r=n.DERSequence,s=n.csr,o=n.x509;s.CertificationRequest.superclass.constructor.call(this),this.sign=function(t,n){null==this.prvKey&&(this.prvKey=n),this.asn1SignatureAlg=new o.AlgorithmIdentifier({name:t}),sig=new e.crypto.Signature({alg:t}),sig.init(this.prvKey),sig.updateHex(this.asn1CSRInfo.getEncodedHex()),this.hexSig=sig.sign(),this.asn1Sig=new i({hex:"00"+this.hexSig});var s=new r({array:[this.asn1CSRInfo,this.asn1SignatureAlg,this.asn1Sig]});this.hTLV=s.getEncodedHex(),this.isModified=!1},this.getPEMString=function(){return gn(this.getEncodedHex(),"CERTIFICATE REQUEST")},this.getEncodedHex=function(){if(0==this.isModified&&null!=this.hTLV)return this.hTLV;throw"not signed yet"},void 0!==t&&void 0!==t.csrinfo&&(this.asn1CSRInfo=t.csrinfo)},ee.lang.extend(Qe.asn1.csr.CertificationRequest,Qe.asn1.ASN1Object),Qe.asn1.csr.CertificationRequestInfo=function(t){var e=Qe.asn1,n=e.DERInteger,i=e.DERSequence,r=e.DERSet,s=e.DERNull,o=e.DERTaggedObject,a=e.DERObjectIdentifier,u=e.csr,h=e.x509,c=h.X500Name,f=h.Extension,l=Fn;u.CertificationRequestInfo.superclass.constructor.call(this),this._initialize=function(){this.asn1Array=new Array,this.asn1Version=new n({int:0}),this.asn1Subject=null,this.asn1SubjPKey=null,this.extensionsArray=new Array},this.setSubjectByParam=function(t){this.asn1Subject=new c(t)},this.setSubjectPublicKeyByGetKey=function(t){var e=l.getKey(t);this.asn1SubjPKey=new h.SubjectPublicKeyInfo(e)},this.appendExtensionByName=function(t,e){f.appendByNameToArray(t,e,this.extensionsArray)},this.getEncodedHex=function(){if(this.asn1Array=new Array,this.asn1Array.push(this.asn1Version),this.asn1Array.push(this.asn1Subject),this.asn1Array.push(this.asn1SubjPKey),this.extensionsArray.length>0){var t=new i({array:this.extensionsArray}),e=new r({array:[t]}),n=new i({array:[new a({oid:"1.2.840.113549.1.9.14"}),e]}),u=new o({explicit:!0,tag:"a0",obj:n});this.asn1Array.push(u)}else{u=new o({explicit:!1,tag:"a0",obj:new s});this.asn1Array.push(u)}var h=new i({array:this.asn1Array});return this.hTLV=h.getEncodedHex(),this.isModified=!1,this.hTLV},this._initialize()},ee.lang.extend(Qe.asn1.csr.CertificationRequestInfo,Qe.asn1.ASN1Object),Qe.asn1.csr.CSRUtil=new function(){},Qe.asn1.csr.CSRUtil.newCSRPEM=function(t){var e=Fn,n=Qe.asn1.csr;if(void 0===t.subject)throw"parameter subject undefined";if(void 0===t.sbjpubkey)throw"parameter sbjpubkey undefined";if(void 0===t.sigalg)throw"parameter sigalg undefined";if(void 0===t.sbjprvkey)throw"parameter sbjpubkey undefined";var i=new n.CertificationRequestInfo;if(i.setSubjectByParam(t.subject),i.setSubjectPublicKeyByGetKey(t.sbjpubkey),void 0!==t.ext&&void 0!==t.ext.length)for(var r=0;r<t.ext.length;r++)for(key in t.ext[r])i.appendExtensionByName(key,t.ext[r][key]);var s=new n.CertificationRequest({csrinfo:i}),o=e.getKey(t.sbjprvkey);return s.sign(t.sigalg,o),s.getPEMString()},Qe.asn1.csr.CSRUtil.getInfo=function(t){var e=nn.getTLVbyList,n={subject:{},pubkey:{}};if(-1==t.indexOf("-----BEGIN CERTIFICATE REQUEST"))throw"argument is not PEM file";var i=vn(t,"CERTIFICATE REQUEST");return n.subject.hex=e(i,0,[0,1]),n.subject.name=In.hex2dn(n.subject.hex),n.pubkey.hex=e(i,0,[0,2]),n.pubkey.obj=Fn.getKey(n.pubkey.hex,null,"pkcs8pub"),n},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.asn1&&Qe.asn1||(Qe.asn1={}),void 0!==Qe.asn1.ocsp&&Qe.asn1.ocsp||(Qe.asn1.ocsp={}),Qe.asn1.ocsp.DEFAULT_HASH="sha1",Qe.asn1.ocsp.CertID=function(t){var e=Qe,n=e.asn1,i=n.DEROctetString,r=n.DERInteger,s=n.DERSequence,o=n.x509.AlgorithmIdentifier,a=n.ocsp,u=a.DEFAULT_HASH,h=e.crypto.Util.hashHex,c=In,f=nn;if(a.CertID.superclass.constructor.call(this),this.dHashAlg=null,this.dIssuerNameHash=null,this.dIssuerKeyHash=null,this.dSerialNumber=null,this.setByValue=function(t,e,n,s){void 0===s&&(s=u),this.dHashAlg=new o({name:s}),this.dIssuerNameHash=new i({hex:t}),this.dIssuerKeyHash=new i({hex:e}),this.dSerialNumber=new r({hex:n})},this.setByCert=function(t,e,n){void 0===n&&(n=u);var i=new c;i.readCertPEM(e);var r=new c;r.readCertPEM(t);var s=r.getPublicKeyHex(),o=f.getTLVbyList(s,0,[1,0],"30"),a=i.getSerialNumberHex(),l=h(r.getSubjectHex(),n),d=h(o,n);this.setByValue(l,d,a,n),this.hoge=i.getSerialNumberHex()},this.getEncodedHex=function(){if(null===this.dHashAlg&&null===this.dIssuerNameHash&&null===this.dIssuerKeyHash&&null===this.dSerialNumber)throw"not yet set values";var t=[this.dHashAlg,this.dIssuerNameHash,this.dIssuerKeyHash,this.dSerialNumber],e=new s({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var l=t;if(void 0!==l.issuerCert&&void 0!==l.subjectCert){var d=u;void 0===l.alg&&(d=void 0),this.setByCert(l.issuerCert,l.subjectCert,d)}else{if(void 0===l.namehash||void 0===l.keyhash||void 0===l.serial)throw"invalid constructor arguments";d=u;void 0===l.alg&&(d=void 0),this.setByValue(l.namehash,l.keyhash,l.serial,d)}}},ee.lang.extend(Qe.asn1.ocsp.CertID,Qe.asn1.ASN1Object),Qe.asn1.ocsp.Request=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.ocsp;if(i.Request.superclass.constructor.call(this),this.dReqCert=null,this.dExt=null,this.getEncodedHex=function(){var t=[];if(null===this.dReqCert)throw"reqCert not set";t.push(this.dReqCert);var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t){var r=new i.CertID(t);this.dReqCert=r}},ee.lang.extend(Qe.asn1.ocsp.Request,Qe.asn1.ASN1Object),Qe.asn1.ocsp.TBSRequest=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.ocsp;i.TBSRequest.superclass.constructor.call(this),this.version=0,this.dRequestorName=null,this.dRequestList=[],this.dRequestExt=null,this.setRequestListByParam=function(t){for(var e=[],n=0;n<t.length;n++){var r=new i.Request(t[0]);e.push(r)}this.dRequestList=e},this.getEncodedHex=function(){var t=[];if(0!==this.version)throw"not supported version: "+this.version;if(null!==this.dRequestorName)throw"requestorName not supported";var e=new n({array:this.dRequestList});if(t.push(e),null!==this.dRequestExt)throw"requestExtensions not supported";var i=new n({array:t});return this.hTLV=i.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList&&this.setRequestListByParam(t.reqList)},ee.lang.extend(Qe.asn1.ocsp.TBSRequest,Qe.asn1.ASN1Object),Qe.asn1.ocsp.OCSPRequest=function(t){var e=Qe.asn1,n=e.DERSequence,i=e.ocsp;if(i.OCSPRequest.superclass.constructor.call(this),this.dTbsRequest=null,this.dOptionalSignature=null,this.getEncodedHex=function(){var t=[];if(null===this.dTbsRequest)throw"tbsRequest not set";if(t.push(this.dTbsRequest),null!==this.dOptionalSignature)throw"optionalSignature not supported";var e=new n({array:t});return this.hTLV=e.getEncodedHex(),this.hTLV},void 0!==t&&void 0!==t.reqList){var r=new i.TBSRequest(t);this.dTbsRequest=r}},ee.lang.extend(Qe.asn1.ocsp.OCSPRequest,Qe.asn1.ASN1Object),Qe.asn1.ocsp.OCSPUtil={},Qe.asn1.ocsp.OCSPUtil.getRequestHex=function(t,e,n){var i=Qe.asn1.ocsp;void 0===n&&(n=i.DEFAULT_HASH);var r={alg:n,issuerCert:t,subjectCert:e};return new i.OCSPRequest({reqList:[r]}).getEncodedHex()},Qe.asn1.ocsp.OCSPUtil.getOCSPResponseInfo=function(t){var e=nn,n=e.getVbyList,i=e.getIdxbyList,r=(n=e.getVbyList,e.getV),s={};try{var o=n(t,0,[0],"0a");s.responseStatus=parseInt(o,16)}catch(t){}if(0!==s.responseStatus)return s;try{var a=i(t,0,[1,0,1,0,0,2,0,1]);"80"===t.substr(a,2)?s.certStatus="good":"a1"===t.substr(a,2)?(s.certStatus="revoked",s.revocationTime=fn(n(t,a,[0]))):"82"===t.substr(a,2)&&(s.certStatus="unknown")}catch(t){}try{var u=i(t,0,[1,0,1,0,0,2,0,2]);s.thisUpdate=fn(r(t,u))}catch(t){}try{var h=i(t,0,[1,0,1,0,0,2,0,3]);"a0"===t.substr(h,2)&&(s.nextUpdate=fn(n(t,h,[0])))}catch(t){}return s},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.lang&&Qe.lang||(Qe.lang={}),Qe.lang.String=function(){},tn=function(t){return on(new vt(t,"utf8").toString("base64"))},en=function(t){return new vt(an(t),"base64").toString("utf8")},Qe.lang.String.isInteger=function(t){return!!t.match(/^[0-9]+$/)||!!t.match(/^-[0-9]+$/)},Qe.lang.String.isHex=function(t){return!(t.length%2!=0||!t.match(/^[0-9a-f]+$/)&&!t.match(/^[0-9A-F]+$/))},Qe.lang.String.isBase64=function(t){return!(!(t=t.replace(/\s+/g,"")).match(/^[0-9A-Za-z+\/]+={0,3}$/)||t.length%4!=0)},Qe.lang.String.isBase64URL=function(t){return!t.match(/[+\/=]/)&&(t=an(t),Qe.lang.String.isBase64(t))},Qe.lang.String.isIntegerArray=function(t){return!!(t=t.replace(/\s+/g,"")).match(/^\[[0-9,]+\]$/)},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.Util=new function(){this.DIGESTINFOHEAD={sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",ripemd160:"3021300906052b2403020105000414"},this.DEFAULTPROVIDER={md5:"cryptojs",sha1:"cryptojs",sha224:"cryptojs",sha256:"cryptojs",sha384:"cryptojs",sha512:"cryptojs",ripemd160:"cryptojs",hmacmd5:"cryptojs",hmacsha1:"cryptojs",hmacsha224:"cryptojs",hmacsha256:"cryptojs",hmacsha384:"cryptojs",hmacsha512:"cryptojs",hmacripemd160:"cryptojs",MD5withRSA:"cryptojs/jsrsa",SHA1withRSA:"cryptojs/jsrsa",SHA224withRSA:"cryptojs/jsrsa",SHA256withRSA:"cryptojs/jsrsa",SHA384withRSA:"cryptojs/jsrsa",SHA512withRSA:"cryptojs/jsrsa",RIPEMD160withRSA:"cryptojs/jsrsa",MD5withECDSA:"cryptojs/jsrsa",SHA1withECDSA:"cryptojs/jsrsa",SHA224withECDSA:"cryptojs/jsrsa",SHA256withECDSA:"cryptojs/jsrsa",SHA384withECDSA:"cryptojs/jsrsa",SHA512withECDSA:"cryptojs/jsrsa",RIPEMD160withECDSA:"cryptojs/jsrsa",SHA1withDSA:"cryptojs/jsrsa",SHA224withDSA:"cryptojs/jsrsa",SHA256withDSA:"cryptojs/jsrsa",MD5withRSAandMGF1:"cryptojs/jsrsa",SHA1withRSAandMGF1:"cryptojs/jsrsa",SHA224withRSAandMGF1:"cryptojs/jsrsa",SHA256withRSAandMGF1:"cryptojs/jsrsa",SHA384withRSAandMGF1:"cryptojs/jsrsa",SHA512withRSAandMGF1:"cryptojs/jsrsa",RIPEMD160withRSAandMGF1:"cryptojs/jsrsa"},this.CRYPTOJSMESSAGEDIGESTNAME={md5:oe.algo.MD5,sha1:oe.algo.SHA1,sha224:oe.algo.SHA224,sha256:oe.algo.SHA256,sha384:oe.algo.SHA384,sha512:oe.algo.SHA512,ripemd160:oe.algo.RIPEMD160},this.getDigestInfoHex=function(t,e){if(void 0===this.DIGESTINFOHEAD[e])throw"alg not supported in Util.DIGESTINFOHEAD: "+e;return this.DIGESTINFOHEAD[e]+t},this.getPaddedDigestInfoHex=function(t,e,n){var i=this.getDigestInfoHex(t,e),r=n/4;if(i.length+22>r)throw"key is too short for SigAlg: keylen="+n+","+e;for(var s="0001",o="00"+i,a="",u=r-s.length-o.length,h=0;h<u;h+=2)a+="ff";return s+a+o},this.hashString=function(t,e){return new Qe.crypto.MessageDigest({alg:e}).digestString(t)},this.hashHex=function(t,e){return new Qe.crypto.MessageDigest({alg:e}).digestHex(t)},this.sha1=function(t){return new Qe.crypto.MessageDigest({alg:"sha1",prov:"cryptojs"}).digestString(t)},this.sha256=function(t){return new Qe.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestString(t)},this.sha256Hex=function(t){return new Qe.crypto.MessageDigest({alg:"sha256",prov:"cryptojs"}).digestHex(t)},this.sha512=function(t){return new Qe.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestString(t)},this.sha512Hex=function(t){return new Qe.crypto.MessageDigest({alg:"sha512",prov:"cryptojs"}).digestHex(t)}},Qe.crypto.Util.md5=function(t){return new Qe.crypto.MessageDigest({alg:"md5",prov:"cryptojs"}).digestString(t)},Qe.crypto.Util.ripemd160=function(t){return new Qe.crypto.MessageDigest({alg:"ripemd160",prov:"cryptojs"}).digestString(t)},Qe.crypto.Util.SECURERANDOMGEN=new qe,Qe.crypto.Util.getRandomHexOfNbytes=function(t){var e=new Array(t);return Qe.crypto.Util.SECURERANDOMGEN.nextBytes(e),rn(e)},Qe.crypto.Util.getRandomBigIntegerOfNbytes=function(t){return new fe(Qe.crypto.Util.getRandomHexOfNbytes(t),16)},Qe.crypto.Util.getRandomHexOfNbits=function(t){var e=t%8,n=new Array((t-e)/8+1);return Qe.crypto.Util.SECURERANDOMGEN.nextBytes(n),n[0]=(255<<e&255^255)&n[0],rn(n)},Qe.crypto.Util.getRandomBigIntegerOfNbits=function(t){return new fe(Qe.crypto.Util.getRandomHexOfNbits(t),16)},Qe.crypto.Util.getRandomBigIntegerZeroToMax=function(t){for(var e=t.bitLength();;){var n=Qe.crypto.Util.getRandomBigIntegerOfNbits(e);if(-1!=t.compareTo(n))return n}},Qe.crypto.Util.getRandomBigIntegerMinToMax=function(t,e){var n=t.compareTo(e);if(1==n)throw"biMin is greater than biMax";if(0==n)return t;var i=e.subtract(t);return Qe.crypto.Util.getRandomBigIntegerZeroToMax(i).add(t)},Qe.crypto.MessageDigest=function(t){this.setAlgAndProvider=function(t,e){if(null!==(t=Qe.crypto.MessageDigest.getCanonicalAlgName(t))&&void 0===e&&(e=Qe.crypto.Util.DEFAULTPROVIDER[t]),-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(t)&&"cryptojs"==e){try{this.md=Qe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[t].create()}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=oe.enc.Hex.parse(t);this.md.update(e)},this.digest=function(){return this.md.finalize().toString(oe.enc.Hex)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}if(-1!=":sha256:".indexOf(t)&&"sjcl"==e){try{this.md=new sjcl.hash.sha256}catch(e){throw"setAlgAndProvider hash alg set fail alg="+t+"/"+e}this.updateString=function(t){this.md.update(t)},this.updateHex=function(t){var e=sjcl.codec.hex.toBits(t);this.md.update(e)},this.digest=function(){var t=this.md.finalize();return sjcl.codec.hex.fromBits(t)},this.digestString=function(t){return this.updateString(t),this.digest()},this.digestHex=function(t){return this.updateHex(t),this.digest()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digest=function(){throw"digest() not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algName+"/"+this.provName},this.digestHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algName+"/"+this.provName},void 0!==t&&void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName))},Qe.crypto.MessageDigest.getCanonicalAlgName=function(t){return"string"==typeof t&&(t=(t=t.toLowerCase()).replace(/-/,"")),t},Qe.crypto.MessageDigest.getHashLength=function(t){var e=Qe.crypto.MessageDigest,n=e.getCanonicalAlgName(t);if(void 0===e.HASHLENGTH[n])throw"not supported algorithm: "+t;return e.HASHLENGTH[n]},Qe.crypto.MessageDigest.HASHLENGTH={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,ripemd160:20},Qe.crypto.Mac=function(t){this.setAlgAndProvider=function(t,e){if(null==(t=t.toLowerCase())&&(t="hmacsha1"),"hmac"!=(t=t.toLowerCase()).substr(0,4))throw"setAlgAndProvider unsupported HMAC alg: "+t;void 0===e&&(e=Qe.crypto.Util.DEFAULTPROVIDER[t]),this.algProv=t+"/"+e;var n=t.substr(4);if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(n)&&"cryptojs"==e){try{var i=Qe.crypto.Util.CRYPTOJSMESSAGEDIGESTNAME[n];this.mac=oe.algo.HMAC.create(i,this.pass)}catch(t){throw"setAlgAndProvider hash alg set fail hashAlg="+n+"/"+t}this.updateString=function(t){this.mac.update(t)},this.updateHex=function(t){var e=oe.enc.Hex.parse(t);this.mac.update(e)},this.doFinal=function(){return this.mac.finalize().toString(oe.enc.Hex)},this.doFinalString=function(t){return this.updateString(t),this.doFinal()},this.doFinalHex=function(t){return this.updateHex(t),this.doFinal()}}},this.updateString=function(t){throw"updateString(str) not supported for this alg/prov: "+this.algProv},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg/prov: "+this.algProv},this.doFinal=function(){throw"digest() not supported for this alg/prov: "+this.algProv},this.doFinalString=function(t){throw"digestString(str) not supported for this alg/prov: "+this.algProv},this.doFinalHex=function(t){throw"digestHex(hex) not supported for this alg/prov: "+this.algProv},this.setPassword=function(t){if("string"==typeof t){var e=t;return t.length%2!=1&&t.match(/^[0-9A-Fa-f]+$/)||(e=dn(t)),void(this.pass=oe.enc.Hex.parse(e))}if("object"!=typeof t)throw"KJUR.crypto.Mac unsupported password type: "+t;e=null;if(void 0!==t.hex){if(t.hex.length%2!=0||!t.hex.match(/^[0-9A-Fa-f]+$/))throw"Mac: wrong hex password: "+t.hex;e=t.hex}if(void 0!==t.utf8&&(e=cn(t.utf8)),void 0!==t.rstr&&(e=dn(t.rstr)),void 0!==t.b64&&(e=ce(t.b64)),void 0!==t.b64u&&(e=hn(t.b64u)),null==e)throw"KJUR.crypto.Mac unsupported password type: "+t;this.pass=oe.enc.Hex.parse(e)},void 0!==t&&(void 0!==t.pass&&this.setPassword(t.pass),void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov&&(this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]),this.setAlgAndProvider(this.algName,this.provName)))},Qe.crypto.Signature=function(t){var e=null;if(this._setAlgNames=function(){var t=this.algName.match(/^(.+)with(.+)$/);t&&(this.mdAlgName=t[1].toLowerCase(),this.pubkeyAlgName=t[2].toLowerCase())},this._zeroPaddingOfSignature=function(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t},this.setAlgAndProvider=function(t,e){if(this._setAlgNames(),"cryptojs/jsrsa"!=e)throw"provider not supported: "+e;if(-1!=":md5:sha1:sha224:sha256:sha384:sha512:ripemd160:".indexOf(this.mdAlgName)){try{this.md=new Qe.crypto.MessageDigest({alg:this.mdAlgName})}catch(t){throw"setAlgAndProvider hash alg set fail alg="+this.mdAlgName+"/"+t}this.init=function(t,e){var n=null;try{n=void 0===e?Fn.getKey(t):Fn.getKey(t,e)}catch(t){throw"init failed:"+t}if(!0===n.isPrivate)this.prvKey=n,this.state="SIGN";else{if(!0!==n.isPublic)throw"init failed.:"+n;this.pubKey=n,this.state="VERIFY"}},this.updateString=function(t){this.md.updateString(t)},this.updateHex=function(t){this.md.updateHex(t)},this.sign=function(){if(this.sHashHex=this.md.digest(),void 0!==this.ecprvhex&&void 0!==this.eccurvename){var t=new Qe.crypto.ECDSA({curve:this.eccurvename});this.hSign=t.signHex(this.sHashHex,this.ecprvhex)}else if(this.prvKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHashPSS(this.sHashHex,this.mdAlgName,this.pssSaltLen);else if(this.prvKey instanceof Ge&&"rsa"===this.pubkeyAlgName)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex,this.mdAlgName);else if(this.prvKey instanceof Qe.crypto.ECDSA)this.hSign=this.prvKey.signWithMessageHash(this.sHashHex);else{if(!(this.prvKey instanceof Qe.crypto.DSA))throw"Signature: unsupported private key alg: "+this.pubkeyAlgName;this.hSign=this.prvKey.signWithMessageHash(this.sHashHex)}return this.hSign},this.signString=function(t){return this.updateString(t),this.sign()},this.signHex=function(t){return this.updateHex(t),this.sign()},this.verify=function(t){if(this.sHashHex=this.md.digest(),void 0!==this.ecpubhex&&void 0!==this.eccurvename)return new Qe.crypto.ECDSA({curve:this.eccurvename}).verifyHex(this.sHashHex,t,this.ecpubhex);if(this.pubKey instanceof Ge&&"rsaandmgf1"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHashPSS(this.sHashHex,t,this.mdAlgName,this.pssSaltLen);if(this.pubKey instanceof Ge&&"rsa"===this.pubkeyAlgName)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==Qe.crypto.ECDSA&&this.pubKey instanceof Qe.crypto.ECDSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);if(void 0!==Qe.crypto.DSA&&this.pubKey instanceof Qe.crypto.DSA)return this.pubKey.verifyWithMessageHash(this.sHashHex,t);throw"Signature: unsupported public key alg: "+this.pubkeyAlgName}}},this.init=function(t,e){throw"init(key, pass) not supported for this alg:prov="+this.algProvName},this.updateString=function(t){throw"updateString(str) not supported for this alg:prov="+this.algProvName},this.updateHex=function(t){throw"updateHex(hex) not supported for this alg:prov="+this.algProvName},this.sign=function(){throw"sign() not supported for this alg:prov="+this.algProvName},this.signString=function(t){throw"digestString(str) not supported for this alg:prov="+this.algProvName},this.signHex=function(t){throw"digestHex(hex) not supported for this alg:prov="+this.algProvName},this.verify=function(t){throw"verify(hSigVal) not supported for this alg:prov="+this.algProvName},this.initParams=t,void 0!==t&&(void 0!==t.alg&&(this.algName=t.alg,void 0===t.prov?this.provName=Qe.crypto.Util.DEFAULTPROVIDER[this.algName]:this.provName=t.prov,this.algProvName=this.algName+":"+this.provName,this.setAlgAndProvider(this.algName,this.provName),this._setAlgNames()),void 0!==t.psssaltlen&&(this.pssSaltLen=t.psssaltlen),void 0!==t.prvkeypem)){if(void 0!==t.prvkeypas)throw"both prvkeypem and prvkeypas parameters not supported";try{e=Fn.getKey(t.prvkeypem);this.init(e)}catch(t){throw"fatal error to load pem private key: "+t}}},Qe.crypto.Cipher=function(t){},Qe.crypto.Cipher.encrypt=function(t,e,n){if(e instanceof Ge&&e.isPublic){var i=Qe.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.encrypt(t);if("RSAOAEP"===i)return e.encryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.encryptOAEP(t,"sha"+r[1]);throw"Cipher.encrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.encrypt: unsupported key or algorithm"},Qe.crypto.Cipher.decrypt=function(t,e,n){if(e instanceof Ge&&e.isPrivate){var i=Qe.crypto.Cipher.getAlgByKeyAndName(e,n);if("RSA"===i)return e.decrypt(t);if("RSAOAEP"===i)return e.decryptOAEP(t,"sha1");var r=i.match(/^RSAOAEP(\d+)$/);if(null!==r)return e.decryptOAEP(t,"sha"+r[1]);throw"Cipher.decrypt: unsupported algorithm for RSAKey: "+n}throw"Cipher.decrypt: unsupported key or algorithm"},Qe.crypto.Cipher.getAlgByKeyAndName=function(t,e){if(t instanceof Ge){if(-1!=":RSA:RSAOAEP:RSAOAEP224:RSAOAEP256:RSAOAEP384:RSAOAEP512:".indexOf(e))return e;if(null==e)return"RSA";throw"getAlgByKeyAndName: not supported algorithm name for RSAKey: "+e}throw"getAlgByKeyAndName: not supported algorithm name: "+e},Qe.crypto.OID=new function(){this.oidhex2name={"2a864886f70d010101":"rsaEncryption","2a8648ce3d0201":"ecPublicKey","2a8648ce380401":"dsa","2a8648ce3d030107":"secp256r1","2b8104001f":"secp192k1","2b81040021":"secp224r1","2b8104000a":"secp256k1","2b81040023":"secp521r1","2b81040022":"secp384r1","2a8648ce380403":"SHA1withDSA","608648016503040301":"SHA224withDSA","608648016503040302":"SHA256withDSA"}},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.ECDSA=function(t){var e=new qe;this.type="EC",this.isPrivate=!1,this.isPublic=!1,this.getBigRandom=function(t){return new fe(t.bitLength(),e).mod(t.subtract(fe.ONE)).add(fe.ONE)},this.setNamedCurve=function(t){this.ecparams=Qe.crypto.ECParameterDB.getByName(t),this.prvKeyHex=null,this.pubKeyHex=null,this.curveName=t},this.setPrivateKeyHex=function(t){this.isPrivate=!0,this.prvKeyHex=t},this.setPublicKeyHex=function(t){this.isPublic=!0,this.pubKeyHex=t},this.getPublicKeyXYHex=function(){var t=this.pubKeyHex;if("04"!==t.substr(0,2))throw"this method supports uncompressed format(04) only";var e=this.ecparams.keylen/4;if(t.length!==2+2*e)throw"malformed public key hex length";var n={};return n.x=t.substr(2,e),n.y=t.substr(2+e),n},this.getShortNISTPCurveName=function(){var t=this.curveName;return"secp256r1"===t||"NIST P-256"===t||"P-256"===t||"prime256v1"===t?"P-256":"secp384r1"===t||"NIST P-384"===t||"P-384"===t?"P-384":null},this.generateKeyPairHex=function(){var t=this.ecparams.n,e=this.getBigRandom(t),n=this.ecparams.G.multiply(e),i=n.getX().toBigInteger(),r=n.getY().toBigInteger(),s=this.ecparams.keylen/4,o=("0000000000"+e.toString(16)).slice(-s),a="04"+("0000000000"+i.toString(16)).slice(-s)+("0000000000"+r.toString(16)).slice(-s);return this.setPrivateKeyHex(o),this.setPublicKeyHex(a),{ecprvhex:o,ecpubhex:a}},this.signWithMessageHash=function(t){return this.signHex(t,this.prvKeyHex)},this.signHex=function(t,e){var n=new fe(e,16),i=this.ecparams.n,r=new fe(t,16);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(fe.ZERO)<=0);var a=s.modInverse(i).multiply(r.add(n.multiply(o))).mod(i);return Qe.crypto.ECDSA.biRSSigToASN1Sig(o,a)},this.sign=function(t,e){var n=e,i=this.ecparams.n,r=fe.fromByteArrayUnsigned(t);do{var s=this.getBigRandom(i),o=this.ecparams.G.multiply(s).getX().toBigInteger().mod(i)}while(o.compareTo(fe.ZERO)<=0);var a=s.modInverse(i).multiply(r.add(n.multiply(o))).mod(i);return this.serializeSig(o,a)},this.verifyWithMessageHash=function(t,e){return this.verifyHex(t,e,this.pubKeyHex)},this.verifyHex=function(t,e,n){var i,r,s,o=Qe.crypto.ECDSA.parseSigHex(e);i=o.r,r=o.s,s=Ye.decodeFromHex(this.ecparams.curve,n);var a=new fe(t,16);return this.verifyRaw(a,i,r,s)},this.verify=function(t,e,n){var i,r,s;if(Bitcoin.Util.isArray(e)){var o=this.parseSig(e);i=o.r,r=o.s}else{if("object"!=typeof e||!e.r||!e.s)throw"Invalid value for signature";i=e.r,r=e.s}if(n instanceof Ye)s=n;else{if(!Bitcoin.Util.isArray(n))throw"Invalid format for pubkey value, must be byte array or ECPointFp";s=Ye.decodeFrom(this.ecparams.curve,n)}var a=fe.fromByteArrayUnsigned(t);return this.verifyRaw(a,i,r,s)},this.verifyRaw=function(t,e,n,i){var r=this.ecparams.n,s=this.ecparams.G;if(e.compareTo(fe.ONE)<0||e.compareTo(r)>=0)return!1;if(n.compareTo(fe.ONE)<0||n.compareTo(r)>=0)return!1;var o=n.modInverse(r),a=t.multiply(o).mod(r),u=e.multiply(o).mod(r);return s.multiply(a).add(i.multiply(u)).getX().toBigInteger().mod(r).equals(e)},this.serializeSig=function(t,e){var n=t.toByteArraySigned(),i=e.toByteArraySigned(),r=[];return r.push(2),r.push(n.length),(r=r.concat(n)).push(2),r.push(i.length),(r=r.concat(i)).unshift(r.length),r.unshift(48),r},this.parseSig=function(t){var e;if(48!=t[0])throw new Error("Signature not a valid DERSequence");if(2!=t[e=2])throw new Error("First element in signature must be a DERInteger");var n=t.slice(e+2,e+2+t[e+1]);if(2!=t[e+=2+t[e+1]])throw new Error("Second element in signature must be a DERInteger");var i=t.slice(e+2,e+2+t[e+1]);return e+=2+t[e+1],{r:fe.fromByteArrayUnsigned(n),s:fe.fromByteArrayUnsigned(i)}},this.parseSigCompact=function(t){if(65!==t.length)throw"Signature has the wrong length";var e=t[0]-27;if(e<0||e>7)throw"Invalid signature type";var n=this.ecparams.n;return{r:fe.fromByteArrayUnsigned(t.slice(1,33)).mod(n),s:fe.fromByteArrayUnsigned(t.slice(33,65)).mod(n),i:e}},this.readPKCS5PrvKeyHex=function(t){var e,n,i,r=nn,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[2,0],"06"),n=o(t,0,[1],"04");try{i=o(t,0,[3,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#1/5 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PrvKeyHex=function(t){var e,n,i,r=nn,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{o(t,0,[1,0],"06"),e=o(t,0,[1,1],"06"),n=o(t,0,[2,0,1],"04");try{i=o(t,0,[2,0,2,0],"03").substr(2)}catch(t){}}catch(t){throw"malformed PKCS#8 plain ECC private key"}if(this.curveName=s(e),void 0===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i),this.setPrivateKeyHex(n),this.isPublic=!1},this.readPKCS8PubKeyHex=function(t){var e,n,i=nn,r=Qe.crypto.ECDSA.getName,s=i.getVbyList;if(!1===i.isASN1HEX(t))throw"not ASN.1 hex string";try{s(t,0,[0,0],"06"),e=s(t,0,[0,1],"06"),n=s(t,0,[1],"03").substr(2)}catch(t){throw"malformed PKCS#8 ECC public key"}if(this.curveName=r(e),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(n)},this.readCertPubKeyHex=function(t,e){5!==e&&(e=6);var n,i,r=nn,s=Qe.crypto.ECDSA.getName,o=r.getVbyList;if(!1===r.isASN1HEX(t))throw"not ASN.1 hex string";try{n=o(t,0,[0,e,0,1],"06"),i=o(t,0,[0,e,1],"03").substr(2)}catch(t){throw"malformed X.509 certificate ECC public key"}if(this.curveName=s(n),null===this.curveName)throw"unsupported curve name";this.setNamedCurve(this.curveName),this.setPublicKeyHex(i)},void 0!==t&&void 0!==t.curve&&(this.curveName=t.curve),void 0===this.curveName&&(this.curveName="secp256r1"),this.setNamedCurve(this.curveName),void 0!==t&&(void 0!==t.prv&&this.setPrivateKeyHex(t.prv),void 0!==t.pub&&this.setPublicKeyHex(t.pub))},Qe.crypto.ECDSA.parseSigHex=function(t){var e=Qe.crypto.ECDSA.parseSigHexInHexRS(t);return{r:new fe(e.r,16),s:new fe(e.s,16)}},Qe.crypto.ECDSA.parseSigHexInHexRS=function(t){var e=nn,n=e.getChildIdx,i=e.getV;if("30"!=t.substr(0,2))throw"signature is not a ASN.1 sequence";var r=n(t,0);if(2!=r.length)throw"number of signature ASN.1 sequence elements seem wrong";var s=r[0],o=r[1];if("02"!=t.substr(s,2))throw"1st item of sequene of signature is not ASN.1 integer";if("02"!=t.substr(o,2))throw"2nd item of sequene of signature is not ASN.1 integer";return{r:i(t,s),s:i(t,o)}},Qe.crypto.ECDSA.asn1SigToConcatSig=function(t){var e=Qe.crypto.ECDSA.parseSigHexInHexRS(t),n=e.r,i=e.s;if("00"==n.substr(0,2)&&n.length%32==2&&(n=n.substr(2)),"00"==i.substr(0,2)&&i.length%32==2&&(i=i.substr(2)),n.length%32==30&&(n="00"+n),i.length%32==30&&(i="00"+i),n.length%32!=0)throw"unknown ECDSA sig r length error";if(i.length%32!=0)throw"unknown ECDSA sig s length error";return n+i},Qe.crypto.ECDSA.concatSigToASN1Sig=function(t){if(t.length/2*8%128!=0)throw"unknown ECDSA concatinated r-s sig  length error";var e=t.substr(0,t.length/2),n=t.substr(t.length/2);return Qe.crypto.ECDSA.hexRSSigToASN1Sig(e,n)},Qe.crypto.ECDSA.hexRSSigToASN1Sig=function(t,e){var n=new fe(t,16),i=new fe(e,16);return Qe.crypto.ECDSA.biRSSigToASN1Sig(n,i)},Qe.crypto.ECDSA.biRSSigToASN1Sig=function(t,e){var n=Qe.asn1,i=new n.DERInteger({bigint:t}),r=new n.DERInteger({bigint:e});return new n.DERSequence({array:[i,r]}).getEncodedHex()},Qe.crypto.ECDSA.getName=function(t){return"2a8648ce3d030107"===t?"secp256r1":"2b8104000a"===t?"secp256k1":"2b81040022"===t?"secp384r1":-1!=="|secp256r1|NIST P-256|P-256|prime256v1|".indexOf(t)?"secp256r1":-1!=="|secp256k1|".indexOf(t)?"secp256k1":-1!=="|secp384r1|NIST P-384|P-384|".indexOf(t)?"secp384r1":null},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.ECParameterDB=new function(){var t={},e={};function n(t){return new fe(t,16)}this.getByName=function(n){var i=n;if(void 0!==e[i]&&(i=e[n]),void 0!==t[i])return t[i];throw"unregistered EC curve name: "+i},this.regist=function(i,r,s,o,a,u,h,c,f,l,d,p){t[i]={};var g=n(s),v=n(o),y=n(a),m=n(u),b=n(h),S=new Xe(g,v,y),w=S.decodePointHex("04"+c+f);t[i].name=i,t[i].keylen=r,t[i].curve=S,t[i].G=w,t[i].n=m,t[i].h=b,t[i].oid=d,t[i].info=p;for(var x=0;x<l.length;x++)e[l[x]]=i}},Qe.crypto.ECParameterDB.regist("secp128r1",128,"FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC","E87579C11079F43DD824993C2CEE5ED3","FFFFFFFE0000000075A30D1B9038A115","1","161FF7528B899B2D0C28607CA52C5B86","CF5AC8395BAFEB13C02DA292DDED7A83",[],"","secp128r1 : SECG curve over a 128 bit prime field"),Qe.crypto.ECParameterDB.regist("secp160k1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73","0","7","0100000000000000000001B8FA16DFAB9ACA16B6B3","1","3B4C382CE37AA192A4019E763036F4F5DD4D7EBB","938CF935318FDCED6BC28286531733C3F03C4FEE",[],"","secp160k1 : SECG curve over a 160 bit prime field"),Qe.crypto.ECParameterDB.regist("secp160r1",160,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC","1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45","0100000000000000000001F4C8F927AED3CA752257","1","4A96B5688EF573284664698968C38BB913CBFC82","23A628553168947D59DCC912042351377AC5FB32",[],"","secp160r1 : SECG curve over a 160 bit prime field"),Qe.crypto.ECParameterDB.regist("secp192k1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37","0","3","FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D","1","DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D","9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D",[]),Qe.crypto.ECParameterDB.regist("secp192r1",192,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC","64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1","FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831","1","188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF1012","07192B95FFC8DA78631011ED6B24CDD573F977A11E794811",[]),Qe.crypto.ECParameterDB.regist("secp224r1",224,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE","B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4","FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D","1","B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21","BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34",[]),Qe.crypto.ECParameterDB.regist("secp256k1",256,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F","0","7","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141","1","79BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798","483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8",[]),Qe.crypto.ECParameterDB.regist("secp256r1",256,"FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF","FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC","5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B","FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551","1","6B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C296","4FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5",["NIST P-256","P-256","prime256v1"]),Qe.crypto.ECParameterDB.regist("secp384r1",384,"FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFF0000000000000000FFFFFFFC","B3312FA7E23EE7E4988E056BE3F82D19181D9C6EFE8141120314088F5013875AC656398D8A2ED19D2A85C8EDD3EC2AEF","FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC7634D81F4372DDF581A0DB248B0A77AECEC196ACCC52973","1","AA87CA22BE8B05378EB1C71EF320AD746E1D3B628BA79B9859F741E082542A385502F25DBF55296C3A545E3872760AB7","3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f",["NIST P-384","P-384"]),Qe.crypto.ECParameterDB.regist("secp521r1",521,"1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFC","051953EB9618E1C9A1F929A21A0B68540EEA2DA725B99B315F3B8B489918EF109E156193951EC7E937B1652C0BD3BB1BF073573DF883D2C34F1EF451FD46B503F00","1FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFA51868783BF2F966B7FCC0148F709A5D03BB5C9B8899C47AEBB6FB71E91386409","1","C6858E06B70404E9CD9E3ECB662395B4429C648139053FB521F828AF606B4D3DBAA14B5E77EFE75928FE1DC127A2FFA8DE3348B3C1856A429BF97E7E31C2E5BD66","011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650",["NIST P-521","P-521"]),void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.crypto&&Qe.crypto||(Qe.crypto={}),Qe.crypto.DSA=function(){this.p=null,this.q=null,this.g=null,this.y=null,this.x=null,this.type="DSA",this.isPrivate=!1,this.isPublic=!1,this.setPrivate=function(t,e,n,i,r){this.isPrivate=!0,this.p=t,this.q=e,this.g=n,this.y=i,this.x=r},this.setPrivateHex=function(t,e,n,i,r){var s,o,a,u,h;s=new fe(t,16),o=new fe(e,16),a=new fe(n,16),u="string"==typeof i&&i.length>1?new fe(i,16):null,h=new fe(r,16),this.setPrivate(s,o,a,u,h)},this.setPublic=function(t,e,n,i){this.isPublic=!0,this.p=t,this.q=e,this.g=n,this.y=i,this.x=null},this.setPublicHex=function(t,e,n,i){var r,s,o,a;r=new fe(t,16),s=new fe(e,16),o=new fe(n,16),a=new fe(i,16),this.setPublic(r,s,o,a)},this.signWithMessageHash=function(t){var e=this.p,n=this.q,i=this.g,r=(this.y,this.x),s=Qe.crypto.Util.getRandomBigIntegerMinToMax(fe.ONE.add(fe.ONE),n.subtract(fe.ONE)),o=new fe(t.substr(0,n.bitLength()/4),16),a=i.modPow(s,e).mod(n),u=s.modInverse(n).multiply(o.add(r.multiply(a))).mod(n);return Qe.asn1.ASN1Util.jsonToASN1HEX({seq:[{int:{bigint:a}},{int:{bigint:u}}]})},this.verifyWithMessageHash=function(t,e){var n=this.p,i=this.q,r=this.g,s=this.y,o=this.parseASN1Signature(e),a=o[0],u=o[1],h=new fe(t.substr(0,i.bitLength()/4),16);if(fe.ZERO.compareTo(a)>0||a.compareTo(i)>0)throw"invalid DSA signature";if(fe.ZERO.compareTo(u)>=0||u.compareTo(i)>0)throw"invalid DSA signature";var c=u.modInverse(i),f=h.multiply(c).mod(i),l=a.multiply(c).mod(i);return 0==r.modPow(f,n).multiply(s.modPow(l,n)).mod(n).mod(i).compareTo(a)},this.parseASN1Signature=function(t){try{return[new fe(nn.getVbyList(t,0,[0],"02"),16),new fe(nn.getVbyList(t,0,[1],"02"),16)]}catch(t){throw"malformed ASN.1 DSA signature"}},this.readPKCS5PrvKeyHex=function(t){var e,n,i,r,s,o=nn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{e=a(t,0,[1],"02"),n=a(t,0,[2],"02"),i=a(t,0,[3],"02"),r=a(t,0,[4],"02"),s=a(t,0,[5],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#1/5 plain DSA private key"}this.setPrivateHex(e,n,i,r,s)},this.readPKCS8PrvKeyHex=function(t){var e,n,i,r,s=nn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[1,1,0],"02"),n=o(t,0,[1,1,1],"02"),i=o(t,0,[1,1,2],"02"),r=o(t,0,[2,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 plain DSA private key"}this.setPrivateHex(e,n,i,null,r)},this.readPKCS8PubKeyHex=function(t){var e,n,i,r,s=nn,o=s.getVbyList;if(!1===s.isASN1HEX(t))throw"not ASN.1 hex string";try{e=o(t,0,[0,1,0],"02"),n=o(t,0,[0,1,1],"02"),i=o(t,0,[0,1,2],"02"),r=o(t,0,[1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed PKCS#8 DSA public key"}this.setPublicHex(e,n,i,r)},this.readCertPubKeyHex=function(t,e){var n,i,r,s;5!==e&&(e=6);var o=nn,a=o.getVbyList;if(!1===o.isASN1HEX(t))throw"not ASN.1 hex string";try{n=a(t,0,[0,e,0,1,0],"02"),i=a(t,0,[0,e,0,1,1],"02"),r=a(t,0,[0,e,0,1,2],"02"),s=a(t,0,[0,e,1,0],"02")}catch(t){throw console.log("EXCEPTION:"+t),"malformed X.509 certificate DSA public key"}this.setPublicHex(n,i,r,s)}};var Fn=function(){var t=function(t,n,i){return e(oe.AES,t,n,i)},e=function(t,e,n,i){var r=oe.enc.Hex.parse(e),s=oe.enc.Hex.parse(n),o=oe.enc.Hex.parse(i),a={};a.key=s,a.iv=o,a.ciphertext=r;var u=t.decrypt(a,s,{iv:o});return oe.enc.Hex.stringify(u)},n=function(t,e,n){return i(oe.AES,t,e,n)},i=function(t,e,n,i){var r=oe.enc.Hex.parse(e),s=oe.enc.Hex.parse(n),o=oe.enc.Hex.parse(i),a=t.encrypt(r,s,{iv:o}),u=oe.enc.Hex.parse(a.toString());return oe.enc.Base64.stringify(u)},r={"AES-256-CBC":{proc:t,eproc:n,keylen:32,ivlen:16},"AES-192-CBC":{proc:t,eproc:n,keylen:24,ivlen:16},"AES-128-CBC":{proc:t,eproc:n,keylen:16,ivlen:16},"DES-EDE3-CBC":{proc:function(t,n,i){return e(oe.TripleDES,t,n,i)},eproc:function(t,e,n){return i(oe.TripleDES,t,e,n)},keylen:24,ivlen:8},"DES-CBC":{proc:function(t,n,i){return e(oe.DES,t,n,i)},eproc:function(t,e,n){return i(oe.DES,t,e,n)},keylen:8,ivlen:8}},s=function(t){var e={},n=t.match(new RegExp("DEK-Info: ([^,]+),([0-9A-Fa-f]+)","m"));n&&(e.cipher=n[1],e.ivsalt=n[2]);var i=t.match(new RegExp("-----BEGIN ([A-Z]+) PRIVATE KEY-----"));i&&(e.type=i[1]);var r=-1,s=0;-1!=t.indexOf("\r\n\r\n")&&(r=t.indexOf("\r\n\r\n"),s=2),-1!=t.indexOf("\n\n")&&(r=t.indexOf("\n\n"),s=1);var o=t.indexOf("-----END");if(-1!=r&&-1!=o){var a=t.substring(r+2*s,o-s);a=a.replace(/\s+/g,""),e.data=a}return e},o=function(t,e,n){for(var i=n.substring(0,16),s=oe.enc.Hex.parse(i),o=oe.enc.Utf8.parse(e),a=r[t].keylen+r[t].ivlen,u="",h=null;;){var c=oe.algo.MD5.create();if(null!=h&&c.update(h),c.update(o),c.update(s),h=c.finalize(),(u+=oe.enc.Hex.stringify(h)).length>=2*a)break}var f={};return f.keyhex=u.substr(0,2*r[t].keylen),f.ivhex=u.substr(2*r[t].keylen,2*r[t].ivlen),f},a=function(t,e,n,i){var s=oe.enc.Base64.parse(t),o=oe.enc.Hex.stringify(s);return(0,r[e].proc)(o,n,i)};return{version:"1.0.0",parsePKCS5PEM:function(t){return s(t)},getKeyAndUnusedIvByPasscodeAndIvsalt:function(t,e,n){return o(t,e,n)},decryptKeyB64:function(t,e,n,i){return a(t,e,n,i)},getDecryptedKeyHex:function(t,e){var n=s(t),i=n.cipher,r=n.ivsalt,u=n.data,h=o(i,e,r).keyhex;return a(u,i,h,r)},getEncryptedPKCS5PEMFromPrvKeyHex:function(t,e,n,i,s){var a="";if(void 0!==i&&null!=i||(i="AES-256-CBC"),void 0===r[i])throw"KEYUTIL unsupported algorithm: "+i;void 0!==s&&null!=s||(s=function(t){var e=oe.lib.WordArray.random(t);return oe.enc.Hex.stringify(e)}(r[i].ivlen).toUpperCase());var u=function(t,e,n,i){return(0,r[e].eproc)(t,n,i)}(e,i,o(i,n,s).keyhex,s);a="-----BEGIN "+t+" PRIVATE KEY-----\r\n";return a+="Proc-Type: 4,ENCRYPTED\r\n",a+="DEK-Info: "+i+","+s+"\r\n",a+="\r\n",a+=u.replace(/(.{64})/g,"$1\r\n"),a+="\r\n-----END "+t+" PRIVATE KEY-----\r\n"},parseHexOfEncryptedPKCS8:function(t){var e=nn,n=e.getChildIdx,i=e.getV,r={},s=n(t,0);if(2!=s.length)throw"malformed format: SEQUENCE(0).items != 2: "+s.length;r.ciphertext=i(t,s[1]);var o=n(t,s[0]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0).items != 2: "+o.length;if("2a864886f70d01050d"!=i(t,o[0]))throw"this only supports pkcs5PBES2";var a=n(t,o[1]);if(2!=o.length)throw"malformed format: SEQUENCE(0.0.1).items != 2: "+a.length;var u=n(t,a[1]);if(2!=u.length)throw"malformed format: SEQUENCE(0.0.1.1).items != 2: "+u.length;if("2a864886f70d0307"!=i(t,u[0]))throw"this only supports TripleDES";r.encryptionSchemeAlg="TripleDES",r.encryptionSchemeIV=i(t,u[1]);var h=n(t,a[0]);if(2!=h.length)throw"malformed format: SEQUENCE(0.0.1.0).items != 2: "+h.length;if("2a864886f70d01050c"!=i(t,h[0]))throw"this only supports pkcs5PBKDF2";var c=n(t,h[1]);if(c.length<2)throw"malformed format: SEQUENCE(0.0.1.0.1).items < 2: "+c.length;r.pbkdf2Salt=i(t,c[0]);var f=i(t,c[1]);try{r.pbkdf2Iter=parseInt(f,16)}catch(t){throw"malformed format pbkdf2Iter: "+f}return r},getPBKDF2KeyHexFromParam:function(t,e){var n=oe.enc.Hex.parse(t.pbkdf2Salt),i=t.pbkdf2Iter,r=oe.PBKDF2(e,n,{keySize:6,iterations:i});return oe.enc.Hex.stringify(r)},_getPlainPKCS8HexFromEncryptedPKCS8PEM:function(t,e){var n=vn(t,"ENCRYPTED PRIVATE KEY"),i=this.parseHexOfEncryptedPKCS8(n),r=Fn.getPBKDF2KeyHexFromParam(i,e),s={};s.ciphertext=oe.enc.Hex.parse(i.ciphertext);var o=oe.enc.Hex.parse(r),a=oe.enc.Hex.parse(i.encryptionSchemeIV),u=oe.TripleDES.decrypt(s,o,{iv:a});return oe.enc.Hex.stringify(u)},getKeyFromEncryptedPKCS8PEM:function(t,e){var n=this._getPlainPKCS8HexFromEncryptedPKCS8PEM(t,e);return this.getKeyFromPlainPrivatePKCS8Hex(n)},parsePlainPrivatePKCS8Hex:function(t){var e=nn,n=e.getChildIdx,i=e.getV,r={algparam:null};if("30"!=t.substr(0,2))throw"malformed plain PKCS8 private key(code:001)";var s=n(t,0);if(3!=s.length)throw"malformed plain PKCS8 private key(code:002)";if("30"!=t.substr(s[1],2))throw"malformed PKCS8 private key(code:003)";var o=n(t,s[1]);if(2!=o.length)throw"malformed PKCS8 private key(code:004)";if("06"!=t.substr(o[0],2))throw"malformed PKCS8 private key(code:005)";if(r.algoid=i(t,o[0]),"06"==t.substr(o[1],2)&&(r.algparam=i(t,o[1])),"04"!=t.substr(s[2],2))throw"malformed PKCS8 private key(code:006)";return r.keyidx=e.getVidx(t,s[2]),r},getKeyFromPlainPrivatePKCS8PEM:function(t){var e=vn(t,"PRIVATE KEY");return this.getKeyFromPlainPrivatePKCS8Hex(e)},getKeyFromPlainPrivatePKCS8Hex:function(t){var e,n=this.parsePlainPrivatePKCS8Hex(t);if("2a864886f70d010101"==n.algoid)e=new Ge;else if("2a8648ce380401"==n.algoid)e=new Qe.crypto.DSA;else{if("2a8648ce3d0201"!=n.algoid)throw"unsupported private key algorithm";e=new Qe.crypto.ECDSA}return e.readPKCS8PrvKeyHex(t),e},_getKeyFromPublicPKCS8Hex:function(t){var e,n=nn.getVbyList(t,0,[0,0],"06");if("2a864886f70d010101"===n)e=new Ge;else if("2a8648ce380401"===n)e=new Qe.crypto.DSA;else{if("2a8648ce3d0201"!==n)throw"unsupported PKCS#8 public key hex";e=new Qe.crypto.ECDSA}return e.readPKCS8PubKeyHex(t),e},parsePublicRawRSAKeyHex:function(t){var e=nn,n=e.getChildIdx,i=e.getV,r={};if("30"!=t.substr(0,2))throw"malformed RSA key(code:001)";var s=n(t,0);if(2!=s.length)throw"malformed RSA key(code:002)";if("02"!=t.substr(s[0],2))throw"malformed RSA key(code:003)";if(r.n=i(t,s[0]),"02"!=t.substr(s[1],2))throw"malformed RSA key(code:004)";return r.e=i(t,s[1]),r},parsePublicPKCS8Hex:function(t){var e=nn,n=e.getChildIdx,i=e.getV,r={algparam:null},s=n(t,0);if(2!=s.length)throw"outer DERSequence shall have 2 elements: "+s.length;var o=s[0];if("30"!=t.substr(o,2))throw"malformed PKCS8 public key(code:001)";var a=n(t,o);if(2!=a.length)throw"malformed PKCS8 public key(code:002)";if("06"!=t.substr(a[0],2))throw"malformed PKCS8 public key(code:003)";if(r.algoid=i(t,a[0]),"06"==t.substr(a[1],2)?r.algparam=i(t,a[1]):"30"==t.substr(a[1],2)&&(r.algparam={},r.algparam.p=e.getVbyList(t,a[1],[0],"02"),r.algparam.q=e.getVbyList(t,a[1],[1],"02"),r.algparam.g=e.getVbyList(t,a[1],[2],"02")),"03"!=t.substr(s[1],2))throw"malformed PKCS8 public key(code:004)";return r.key=i(t,s[1]).substr(2),r}}}();Fn.getKey=function(t,e,n){var i=(v=nn).getChildIdx,r=(v.getV,v.getVbyList),s=Qe.crypto,o=s.ECDSA,a=s.DSA,u=Ge,h=vn,c=Fn;if(void 0!==u&&t instanceof u)return t;if(void 0!==o&&t instanceof o)return t;if(void 0!==a&&t instanceof a)return t;if(void 0!==t.curve&&void 0!==t.xy&&void 0===t.d)return new o({pub:t.xy,curve:t.curve});if(void 0!==t.curve&&void 0!==t.d)return new o({prv:t.d,curve:t.curve});if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new u).setPublic(t.n,t.e),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.co&&void 0===t.qi)return(C=new u).setPrivateEx(t.n,t.e,t.d,t.p,t.q,t.dp,t.dq,t.co),C;if(void 0===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0===t.p)return(C=new u).setPrivate(t.n,t.e,t.d),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0===t.x)return(C=new a).setPublic(t.p,t.q,t.g,t.y),C;if(void 0!==t.p&&void 0!==t.q&&void 0!==t.g&&void 0!==t.y&&void 0!==t.x)return(C=new a).setPrivate(t.p,t.q,t.g,t.y,t.x),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0===t.d)return(C=new u).setPublic(hn(t.n),hn(t.e)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d&&void 0!==t.p&&void 0!==t.q&&void 0!==t.dp&&void 0!==t.dq&&void 0!==t.qi)return(C=new u).setPrivateEx(hn(t.n),hn(t.e),hn(t.d),hn(t.p),hn(t.q),hn(t.dp),hn(t.dq),hn(t.qi)),C;if("RSA"===t.kty&&void 0!==t.n&&void 0!==t.e&&void 0!==t.d)return(C=new u).setPrivate(hn(t.n),hn(t.e),hn(t.d)),C;if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0===t.d){var f=(D=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+hn(t.x)).slice(-f)+("0000000000"+hn(t.y)).slice(-f);return D.setPublicKeyHex(l),D}if("EC"===t.kty&&void 0!==t.crv&&void 0!==t.x&&void 0!==t.y&&void 0!==t.d){f=(D=new o({curve:t.crv})).ecparams.keylen/4,l="04"+("0000000000"+hn(t.x)).slice(-f)+("0000000000"+hn(t.y)).slice(-f);var d=("0000000000"+hn(t.d)).slice(-f);return D.setPublicKeyHex(l),D.setPrivateKeyHex(d),D}if("pkcs5prv"===n){var p,g=t,v=nn;if(9===(p=i(g,0)).length)(C=new u).readPKCS5PrvKeyHex(g);else if(6===p.length)(C=new a).readPKCS5PrvKeyHex(g);else{if(!(p.length>2&&"04"===g.substr(p[1],2)))throw"unsupported PKCS#1/5 hexadecimal key";(C=new o).readPKCS5PrvKeyHex(g)}return C}if("pkcs8prv"===n)return C=c.getKeyFromPlainPrivatePKCS8Hex(t);if("pkcs8pub"===n)return c._getKeyFromPublicPKCS8Hex(t);if("x509pub"===n)return In.getPublicKeyFromCertHex(t);if(-1!=t.indexOf("-END CERTIFICATE-",0)||-1!=t.indexOf("-END X509 CERTIFICATE-",0)||-1!=t.indexOf("-END TRUSTED CERTIFICATE-",0))return In.getPublicKeyFromCertPEM(t);if(-1!=t.indexOf("-END PUBLIC KEY-")){var y=vn(t,"PUBLIC KEY");return c._getKeyFromPublicPKCS8Hex(y)}if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var m=h(t,"RSA PRIVATE KEY");return c.getKey(m,null,"pkcs5prv")}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1==t.indexOf("4,ENCRYPTED")){var b=r(P=h(t,"DSA PRIVATE KEY"),0,[1],"02"),S=r(P,0,[2],"02"),w=r(P,0,[3],"02"),x=r(P,0,[4],"02"),F=r(P,0,[5],"02");return(C=new a).setPrivate(new fe(b,16),new fe(S,16),new fe(w,16),new fe(x,16),new fe(F,16)),C}if(-1!=t.indexOf("-END PRIVATE KEY-"))return c.getKeyFromPlainPrivatePKCS8PEM(t);if(-1!=t.indexOf("-END RSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var E=c.getDecryptedKeyHex(t,e),A=new Ge;return A.readPKCS5PrvKeyHex(E),A}if(-1!=t.indexOf("-END EC PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var D,C=r(P=c.getDecryptedKeyHex(t,e),0,[1],"04"),I=r(P,0,[2,0],"06"),T=r(P,0,[3,0],"03").substr(2);if(void 0===Qe.crypto.OID.oidhex2name[I])throw"undefined OID(hex) in KJUR.crypto.OID: "+I;return(D=new o({curve:Qe.crypto.OID.oidhex2name[I]})).setPublicKeyHex(T),D.setPrivateKeyHex(C),D.isPublic=!1,D}if(-1!=t.indexOf("-END DSA PRIVATE KEY-")&&-1!=t.indexOf("4,ENCRYPTED")){var P;b=r(P=c.getDecryptedKeyHex(t,e),0,[1],"02"),S=r(P,0,[2],"02"),w=r(P,0,[3],"02"),x=r(P,0,[4],"02"),F=r(P,0,[5],"02");return(C=new a).setPrivate(new fe(b,16),new fe(S,16),new fe(w,16),new fe(x,16),new fe(F,16)),C}if(-1!=t.indexOf("-END ENCRYPTED PRIVATE KEY-"))return c.getKeyFromEncryptedPKCS8PEM(t,e);throw"not supported argument"},Fn.generateKeypair=function(t,e){if("RSA"==t){var n=e;(o=new Ge).generate(n,"10001"),o.isPrivate=!0,o.isPublic=!0;var i=new Ge,r=o.n.toString(16),s=o.e.toString(16);return i.setPublic(r,s),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}if("EC"==t){var o,a,u=e,h=new Qe.crypto.ECDSA({curve:u}).generateKeyPairHex();return(o=new Qe.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),o.setPrivateKeyHex(h.ecprvhex),o.isPrivate=!0,o.isPublic=!1,(i=new Qe.crypto.ECDSA({curve:u})).setPublicKeyHex(h.ecpubhex),i.isPrivate=!1,i.isPublic=!0,(a={}).prvKeyObj=o,a.pubKeyObj=i,a}throw"unknown algorithm: "+t},Fn.getPEM=function(t,e,n,i,r,s){var o=Qe,a=o.asn1,u=a.DERObjectIdentifier,h=a.DERInteger,c=a.ASN1Util.newObject,f=a.x509.SubjectPublicKeyInfo,l=o.crypto,d=l.DSA,p=l.ECDSA,g=Ge;function v(t){return c({seq:[{int:0},{int:{bigint:t.n}},{int:t.e},{int:{bigint:t.d}},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.dmp1}},{int:{bigint:t.dmq1}},{int:{bigint:t.coeff}}]})}function y(t){return c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a0",!0,{oid:{name:t.curveName}}]},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]})}function m(t){return c({seq:[{int:0},{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}},{int:{bigint:t.y}},{int:{bigint:t.x}}]})}if((void 0!==g&&t instanceof g||void 0!==d&&t instanceof d||void 0!==p&&t instanceof p)&&1==t.isPublic&&(void 0===e||"PKCS8PUB"==e))return gn(x=new f(t).getEncodedHex(),"PUBLIC KEY");if("PKCS1PRV"==e&&void 0!==g&&t instanceof g&&(void 0===n||null==n)&&1==t.isPrivate)return gn(x=v(t).getEncodedHex(),"RSA PRIVATE KEY");if("PKCS1PRV"==e&&void 0!==p&&t instanceof p&&(void 0===n||null==n)&&1==t.isPrivate){var b=new u({name:t.curveName}).getEncodedHex(),S=y(t).getEncodedHex(),w="";return w+=gn(b,"EC PARAMETERS"),w+=gn(S,"EC PRIVATE KEY")}if("PKCS1PRV"==e&&void 0!==d&&t instanceof d&&(void 0===n||null==n)&&1==t.isPrivate)return gn(x=m(t).getEncodedHex(),"DSA PRIVATE KEY");if("PKCS5PRV"==e&&void 0!==g&&t instanceof g&&void 0!==n&&null!=n&&1==t.isPrivate){var x=v(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("RSA",x,n,i,s)}if("PKCS5PRV"==e&&void 0!==p&&t instanceof p&&void 0!==n&&null!=n&&1==t.isPrivate){x=y(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("EC",x,n,i,s)}if("PKCS5PRV"==e&&void 0!==d&&t instanceof d&&void 0!==n&&null!=n&&1==t.isPrivate){x=m(t).getEncodedHex();return void 0===i&&(i="DES-EDE3-CBC"),this.getEncryptedPKCS5PEMFromPrvKeyHex("DSA",x,n,i,s)}var F=function(t,e){var n=E(t,e);return new c({seq:[{seq:[{oid:{name:"pkcs5PBES2"}},{seq:[{seq:[{oid:{name:"pkcs5PBKDF2"}},{seq:[{octstr:{hex:n.pbkdf2Salt}},{int:n.pbkdf2Iter}]}]},{seq:[{oid:{name:"des-EDE3-CBC"}},{octstr:{hex:n.encryptionSchemeIV}}]}]}]},{octstr:{hex:n.ciphertext}}]}).getEncodedHex()},E=function(t,e){var n=oe.lib.WordArray.random(8),i=oe.lib.WordArray.random(8),r=oe.PBKDF2(e,n,{keySize:6,iterations:100}),s=oe.enc.Hex.parse(t),o=oe.TripleDES.encrypt(s,r,{iv:i})+"",a={};return a.ciphertext=o,a.pbkdf2Salt=oe.enc.Hex.stringify(n),a.pbkdf2Iter=100,a.encryptionSchemeAlg="DES-EDE3-CBC",a.encryptionSchemeIV=oe.enc.Hex.stringify(i),a};if("PKCS8PRV"==e&&null!=g&&t instanceof g&&1==t.isPrivate){var A=v(t).getEncodedHex();x=c({seq:[{int:0},{seq:[{oid:{name:"rsaEncryption"}},{null:!0}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?gn(x,"PRIVATE KEY"):gn(S=F(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==p&&t instanceof p&&1==t.isPrivate){A=new c({seq:[{int:1},{octstr:{hex:t.prvKeyHex}},{tag:["a1",!0,{bitstr:{hex:"00"+t.pubKeyHex}}]}]}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"ecPublicKey"}},{oid:{name:t.curveName}}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?gn(x,"PRIVATE KEY"):gn(S=F(x,n),"ENCRYPTED PRIVATE KEY")}if("PKCS8PRV"==e&&void 0!==d&&t instanceof d&&1==t.isPrivate){A=new h({bigint:t.x}).getEncodedHex(),x=c({seq:[{int:0},{seq:[{oid:{name:"dsa"}},{seq:[{int:{bigint:t.p}},{int:{bigint:t.q}},{int:{bigint:t.g}}]}]},{octstr:{hex:A}}]}).getEncodedHex();return void 0===n||null==n?gn(x,"PRIVATE KEY"):gn(S=F(x,n),"ENCRYPTED PRIVATE KEY")}throw"unsupported object nor format"},Fn.getKeyFromCSRPEM=function(t){var e=vn(t,"CERTIFICATE REQUEST");return Fn.getKeyFromCSRHex(e)},Fn.getKeyFromCSRHex=function(t){var e=Fn.parseCSRHex(t);return Fn.getKey(e.p8pubkeyhex,null,"pkcs8pub")},Fn.parseCSRHex=function(t){var e=nn,n=e.getChildIdx,i=e.getTLV,r={},s=t;if("30"!=s.substr(0,2))throw"malformed CSR(code:001)";var o=n(s,0);if(o.length<1)throw"malformed CSR(code:002)";if("30"!=s.substr(o[0],2))throw"malformed CSR(code:003)";var a=n(s,o[0]);if(a.length<3)throw"malformed CSR(code:004)";return r.p8pubkeyhex=i(s,a[2]),r},Fn.getJWKFromKey=function(t){var e={};if(t instanceof Ge&&t.isPrivate)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e.d=un(t.d.toString(16)),e.p=un(t.p.toString(16)),e.q=un(t.q.toString(16)),e.dp=un(t.dmp1.toString(16)),e.dq=un(t.dmq1.toString(16)),e.qi=un(t.coeff.toString(16)),e;if(t instanceof Ge&&t.isPublic)return e.kty="RSA",e.n=un(t.n.toString(16)),e.e=un(t.e.toString(16)),e;if(t instanceof Qe.crypto.ECDSA&&t.isPrivate){if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;var n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=un(n.x),e.y=un(n.y),e.d=un(t.prvKeyHex),e}if(t instanceof Qe.crypto.ECDSA&&t.isPublic){var i;if("P-256"!==(i=t.getShortNISTPCurveName())&&"P-384"!==i)throw"unsupported curve name for JWT: "+i;n=t.getPublicKeyXYHex();return e.kty="EC",e.crv=i,e.x=un(n.x),e.y=un(n.y),e}throw"not supported key object"},Ge.getPosArrayOfChildrenFromHex=function(t){return nn.getChildIdx(t,0)},Ge.getHexValueArrayOfChildrenFromHex=function(t){var e,n=nn.getV,i=n(t,(e=Ge.getPosArrayOfChildrenFromHex(t))[0]),r=n(t,e[1]),s=n(t,e[2]),o=n(t,e[3]),a=n(t,e[4]),u=n(t,e[5]),h=n(t,e[6]),c=n(t,e[7]),f=n(t,e[8]);return(e=new Array).push(i,r,s,o,a,u,h,c,f),e},Ge.prototype.readPrivateKeyFromPEMString=function(t){var e=vn(t),n=Ge.getHexValueArrayOfChildrenFromHex(e);this.setPrivateEx(n[1],n[2],n[3],n[4],n[5],n[6],n[7],n[8])},Ge.prototype.readPKCS5PrvKeyHex=function(t){var e=Ge.getHexValueArrayOfChildrenFromHex(t);this.setPrivateEx(e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])},Ge.prototype.readPKCS8PrvKeyHex=function(t){var e,n,i,r,s,o,a,u,h=nn,c=h.getVbyList;if(!1===h.isASN1HEX(t))throw"not ASN.1 hex string";try{e=c(t,0,[2,0,1],"02"),n=c(t,0,[2,0,2],"02"),i=c(t,0,[2,0,3],"02"),r=c(t,0,[2,0,4],"02"),s=c(t,0,[2,0,5],"02"),o=c(t,0,[2,0,6],"02"),a=c(t,0,[2,0,7],"02"),u=c(t,0,[2,0,8],"02")}catch(t){throw"malformed PKCS#8 plain RSA private key"}this.setPrivateEx(e,n,i,r,s,o,a,u)},Ge.prototype.readPKCS5PubKeyHex=function(t){var e=nn,n=e.getV;if(!1===e.isASN1HEX(t))throw"keyHex is not ASN.1 hex string";var i=e.getChildIdx(t,0);if(2!==i.length||"02"!==t.substr(i[0],2)||"02"!==t.substr(i[1],2))throw"wrong hex for PKCS#5 public key";var r=n(t,i[0]),s=n(t,i[1]);this.setPublic(r,s)},Ge.prototype.readPKCS8PubKeyHex=function(t){var e=nn;if(!1===e.isASN1HEX(t))throw"not ASN.1 hex string";if("06092a864886f70d010101"!==e.getTLVbyList(t,0,[0,0]))throw"not PKCS8 RSA public key";var n=e.getTLVbyList(t,0,[1,0]);this.readPKCS5PubKeyHex(n)},Ge.prototype.readCertPubKeyHex=function(t,e){var n,i;(n=new In).readCertHex(t),i=n.getPublicKeyHex(),this.readPKCS8PubKeyHex(i)};var En=new RegExp("");function An(t,e){for(var n="",i=e/4-t.length,r=0;r<i;r++)n+="0";return n+t}function Dn(t,e,n){for(var i="",r=0;i.length<e;)i+=ln(n(dn(t+String.fromCharCode.apply(String,[(4278190080&r)>>24,(16711680&r)>>16,(65280&r)>>8,255&r])))),r+=1;return i}function Cn(t){for(var e in Qe.crypto.Util.DIGESTINFOHEAD){var n=Qe.crypto.Util.DIGESTINFOHEAD[e],i=n.length;if(t.substring(0,i)==n)return[e,t.substring(i)]}return[]}function In(){var t=nn,e=t.getChildIdx,n=t.getV,i=t.getTLV,r=t.getVbyList,s=t.getTLVbyList,o=t.getIdxbyList,a=t.getVidx,u=t.oidname,h=In,c=vn;this.hex=null,this.version=0,this.foffset=0,this.aExtInfo=null,this.getVersion=function(){return null===this.hex||0!==this.version?this.version:"a003020102"!==s(this.hex,0,[0,0])?(this.version=1,this.foffset=-1,1):(this.version=3,3)},this.getSerialNumberHex=function(){return r(this.hex,0,[0,1+this.foffset],"02")},this.getSignatureAlgorithmField=function(){return u(r(this.hex,0,[0,2+this.foffset,0],"06"))},this.getIssuerHex=function(){return s(this.hex,0,[0,3+this.foffset],"30")},this.getIssuerString=function(){return h.hex2dn(this.getIssuerHex())},this.getSubjectHex=function(){return s(this.hex,0,[0,5+this.foffset],"30")},this.getSubjectString=function(){return h.hex2dn(this.getSubjectHex())},this.getNotBefore=function(){var t=r(this.hex,0,[0,4+this.foffset,0]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getNotAfter=function(){var t=r(this.hex,0,[0,4+this.foffset,1]);return t=t.replace(/(..)/g,"%$1"),t=decodeURIComponent(t)},this.getPublicKeyHex=function(){return t.getTLVbyList(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyIdx=function(){return o(this.hex,0,[0,6+this.foffset],"30")},this.getPublicKeyContentIdx=function(){var t=this.getPublicKeyIdx();return o(this.hex,t,[1,0],"30")},this.getPublicKey=function(){return Fn.getKey(this.getPublicKeyHex(),null,"pkcs8pub")},this.getSignatureAlgorithmName=function(){return u(r(this.hex,0,[1,0],"06"))},this.getSignatureValueHex=function(){return r(this.hex,0,[2],"03",!0)},this.verifySignature=function(t){var e=this.getSignatureAlgorithmName(),n=this.getSignatureValueHex(),i=s(this.hex,0,[0],"30"),r=new Qe.crypto.Signature({alg:e});return r.init(t),r.updateHex(i),r.verify(n)},this.parseExt=function(){if(3!==this.version)return-1;var n=o(this.hex,0,[0,7,0],"30"),i=e(this.hex,n);this.aExtInfo=new Array;for(var s=0;s<i.length;s++){var u={critical:!1},h=0;3===e(this.hex,i[s]).length&&(u.critical=!0,h=1),u.oid=t.hextooidstr(r(this.hex,i[s],[0],"06"));var c=o(this.hex,i[s],[1+h]);u.vidx=a(this.hex,c),this.aExtInfo.push(u)}},this.getExtInfo=function(t){var e=this.aExtInfo,n=t;if(t.match(/^[0-9.]+$/)||(n=Qe.asn1.x509.OID.name2oid(t)),""!==n)for(var i=0;i<e.length;i++)if(e[i].oid===n)return e[i]},this.getExtBasicConstraints=function(){var t=this.getExtInfo("basicConstraints");if(void 0===t)return t;var e=n(this.hex,t.vidx);if(""===e)return{};if("0101ff"===e)return{cA:!0};if("0101ff02"===e.substr(0,8)){var i=n(e,6);return{cA:!0,pathLen:parseInt(i,16)}}throw"basicConstraints parse error"},this.getExtKeyUsageBin=function(){var t=this.getExtInfo("keyUsage");if(void 0===t)return"";var e=n(this.hex,t.vidx);if(e.length%2!=0||e.length<=2)throw"malformed key usage value";var i=parseInt(e.substr(0,2)),r=parseInt(e.substr(2),16).toString(2);return r.substr(0,r.length-i)},this.getExtKeyUsageString=function(){for(var t=this.getExtKeyUsageBin(),e=new Array,n=0;n<t.length;n++)"1"==t.substr(n,1)&&e.push(In.KEYUSAGE_NAME[n]);return e.join(",")},this.getExtSubjectKeyIdentifier=function(){var t=this.getExtInfo("subjectKeyIdentifier");return void 0===t?t:n(this.hex,t.vidx)},this.getExtAuthorityKeyIdentifier=function(){var t=this.getExtInfo("authorityKeyIdentifier");if(void 0===t)return t;for(var r={},s=i(this.hex,t.vidx),o=e(s,0),a=0;a<o.length;a++)"80"===s.substr(o[a],2)&&(r.kid=n(s,o[a]));return r},this.getExtExtKeyUsageName=function(){var t=this.getExtInfo("extKeyUsage");if(void 0===t)return t;var r=new Array,s=i(this.hex,t.vidx);if(""===s)return r;for(var o=e(s,0),a=0;a<o.length;a++)r.push(u(n(s,o[a])));return r},this.getExtSubjectAltName=function(){for(var t=this.getExtSubjectAltName2(),e=new Array,n=0;n<t.length;n++)"DNS"===t[n][0]&&e.push(t[n][1]);return e},this.getExtSubjectAltName2=function(){var t,r,s,o=this.getExtInfo("subjectAltName");if(void 0===o)return o;for(var a=new Array,u=i(this.hex,o.vidx),h=e(u,0),c=0;c<h.length;c++)s=u.substr(h[c],2),t=n(u,h[c]),"81"===s&&(r=fn(t),a.push(["MAIL",r])),"82"===s&&(r=fn(t),a.push(["DNS",r])),"84"===s&&(r=In.hex2dn(t,0),a.push(["DN",r])),"86"===s&&(r=fn(t),a.push(["URI",r])),"87"===s&&(r=Sn(t),a.push(["IP",r]));return a},this.getExtCRLDistributionPointsURI=function(){var t=this.getExtInfo("cRLDistributionPoints");if(void 0===t)return t;for(var n=new Array,i=e(this.hex,t.vidx),s=0;s<i.length;s++)try{var o=fn(r(this.hex,i[s],[0,0,0],"86"));n.push(o)}catch(t){}return n},this.getExtAIAInfo=function(){var t=this.getExtInfo("authorityInfoAccess");if(void 0===t)return t;for(var n={ocsp:[],caissuer:[]},i=e(this.hex,t.vidx),s=0;s<i.length;s++){var o=r(this.hex,i[s],[0],"06"),a=r(this.hex,i[s],[1],"86");"2b06010505073001"===o&&n.ocsp.push(fn(a)),"2b06010505073002"===o&&n.caissuer.push(fn(a))}return n},this.getExtCertificatePolicies=function(){var t=this.getExtInfo("certificatePolicies");if(void 0===t)return t;for(var s=i(this.hex,t.vidx),o=[],a=e(s,0),h=0;h<a.length;h++){var c={},f=e(s,a[h]);if(c.id=u(n(s,f[0])),2===f.length)for(var l=e(s,f[1]),d=0;d<l.length;d++){var p=r(s,l[d],[0],"06");"2b06010505070201"===p?c.cps=fn(r(s,l[d],[1])):"2b06010505070202"===p&&(c.unotice=fn(r(s,l[d],[1,0])))}o.push(c)}return o},this.readCertPEM=function(t){this.readCertHex(c(t))},this.readCertHex=function(t){this.hex=t,this.getVersion();try{o(this.hex,0,[0,7],"a3"),this.parseExt()}catch(t){}},this.getInfo=function(){var t,e,n;if(t="Basic Fields\n",t+="  serial number: "+this.getSerialNumberHex()+"\n",t+="  signature algorithm: "+this.getSignatureAlgorithmField()+"\n",t+="  issuer: "+this.getIssuerString()+"\n",t+="  notBefore: "+this.getNotBefore()+"\n",t+="  notAfter: "+this.getNotAfter()+"\n",t+="  subject: "+this.getSubjectString()+"\n",t+="  subject public key info: \n",t+="    key algorithm: "+(e=this.getPublicKey()).type+"\n","RSA"===e.type&&(t+="    n="+xn(e.n.toString(16)).substr(0,16)+"...\n",t+="    e="+xn(e.e.toString(16))+"\n"),null!=(n=this.aExtInfo)){t+="X509v3 Extensions:\n";for(var i=0;i<n.length;i++){var r=n[i],s=Qe.asn1.x509.OID.oid2name(r.oid);""===s&&(s=r.oid);var o="";if(!0===r.critical&&(o="CRITICAL"),t+="  "+s+" "+o+":\n","basicConstraints"===s){var a=this.getExtBasicConstraints();void 0===a.cA?t+="    {}\n":(t+="    cA=true",void 0!==a.pathLen&&(t+=", pathLen="+a.pathLen),t+="\n")}else if("keyUsage"===s)t+="    "+this.getExtKeyUsageString()+"\n";else if("subjectKeyIdentifier"===s)t+="    "+this.getExtSubjectKeyIdentifier()+"\n";else if("authorityKeyIdentifier"===s){var u=this.getExtAuthorityKeyIdentifier();void 0!==u.kid&&(t+="    kid="+u.kid+"\n")}else{if("extKeyUsage"===s)t+="    "+this.getExtExtKeyUsageName().join(", ")+"\n";else if("subjectAltName"===s)t+="    "+this.getExtSubjectAltName2()+"\n";else if("cRLDistributionPoints"===s)t+="    "+this.getExtCRLDistributionPointsURI()+"\n";else if("authorityInfoAccess"===s){var h=this.getExtAIAInfo();void 0!==h.ocsp&&(t+="    ocsp: "+h.ocsp.join(",")+"\n"),void 0!==h.caissuer&&(t+="    caissuer: "+h.caissuer.join(",")+"\n")}else if("certificatePolicies"===s)for(var c=this.getExtCertificatePolicies(),f=0;f<c.length;f++)void 0!==c[f].id&&(t+="    policy oid: "+c[f].id+"\n"),void 0!==c[f].cps&&(t+="    cps: "+c[f].cps+"\n")}}}return t+="signature algorithm: "+this.getSignatureAlgorithmName()+"\n",t+="signature: "+this.getSignatureValueHex().substr(0,16)+"...\n"}}En.compile("[^0-9a-f]","gi"),Ge.prototype.sign=function(t,e){var n,i=(n=t,Qe.crypto.Util.hashString(n,e));return this.signWithMessageHash(i,e)},Ge.prototype.signWithMessageHash=function(t,e){var n=$e(Qe.crypto.Util.getPaddedDigestInfoHex(t,e,this.n.bitLength()),16);return An(this.doPrivate(n).toString(16),this.n.bitLength())},Ge.prototype.signPSS=function(t,e,n){var i,r=(i=dn(t),Qe.crypto.Util.hashHex(i,e));return void 0===n&&(n=-1),this.signWithMessageHashPSS(r,e,n)},Ge.prototype.signWithMessageHashPSS=function(t,e,n){var i,r=ln(t),s=r.length,o=this.n.bitLength()-1,a=Math.ceil(o/8),u=function(t){return Qe.crypto.Util.hashHex(t,e)};if(-1===n||void 0===n)n=s;else if(-2===n)n=a-s-2;else if(n<-2)throw"invalid salt length";if(a<s+n+2)throw"data too long";var h="";n>0&&(h=new Array(n),(new qe).nextBytes(h),h=String.fromCharCode.apply(String,h));var c=ln(u(dn("\0\0\0\0\0\0\0\0"+r+h))),f=[];for(i=0;i<a-n-s-2;i+=1)f[i]=0;var l=String.fromCharCode.apply(String,f)+""+h,d=Dn(c,l.length,u),p=[];for(i=0;i<l.length;i+=1)p[i]=l.charCodeAt(i)^d.charCodeAt(i);var g=65280>>8*a-o&255;for(p[0]&=~g,i=0;i<s;i++)p.push(c.charCodeAt(i));return p.push(188),An(this.doPrivate(new fe(p)).toString(16),this.n.bitLength())},Ge.prototype.verify=function(t,e){var n=$e(e=(e=e.replace(En,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var i=Cn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;var r,s=i[0];return i[1]==(r=t,Qe.crypto.Util.hashString(r,s))},Ge.prototype.verifyWithMessageHash=function(t,e){var n=$e(e=(e=e.replace(En,"")).replace(/[ \n]+/g,""),16);if(n.bitLength()>this.n.bitLength())return 0;var i=Cn(this.doPublic(n).toString(16).replace(/^1f+00/,""));if(0==i.length)return!1;i[0];return i[1]==t},Ge.prototype.verifyPSS=function(t,e,n,i){var r,s=(r=dn(t),Qe.crypto.Util.hashHex(r,n));return void 0===i&&(i=-1),this.verifyWithMessageHashPSS(s,e,n,i)},Ge.prototype.verifyWithMessageHashPSS=function(t,e,n,i){var r=new fe(e,16);if(r.bitLength()>this.n.bitLength())return!1;var s,o=function(t){return Qe.crypto.Util.hashHex(t,n)},a=ln(t),u=a.length,h=this.n.bitLength()-1,c=Math.ceil(h/8);if(-1===i||void 0===i)i=u;else if(-2===i)i=c-u-2;else if(i<-2)throw"invalid salt length";if(c<u+i+2)throw"data too long";var f=this.doPublic(r).toByteArray();for(s=0;s<f.length;s+=1)f[s]&=255;for(;f.length<c;)f.unshift(0);if(188!==f[c-1])throw"encoded message does not end in 0xbc";var l=(f=String.fromCharCode.apply(String,f)).substr(0,c-u-1),d=f.substr(l.length,u),p=65280>>8*c-h&255;if(0!=(l.charCodeAt(0)&p))throw"bits beyond keysize not zero";var g=Dn(d,l.length,o),v=[];for(s=0;s<l.length;s+=1)v[s]=l.charCodeAt(s)^g.charCodeAt(s);v[0]&=~p;var y=c-u-i-2;for(s=0;s<y;s+=1)if(0!==v[s])throw"leftmost octets not zero";if(1!==v[y])throw"0x01 marker not found";return d===ln(o(dn("\0\0\0\0\0\0\0\0"+a+String.fromCharCode.apply(String,v.slice(-i)))))},Ge.SALT_LEN_HLEN=-1,Ge.SALT_LEN_MAX=-2,Ge.SALT_LEN_RECOVER=-2,In.hex2dn=function(t,e){if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed DN";for(var n=new Array,i=nn.getChildIdx(t,e),r=0;r<i.length;r++)n.push(In.hex2rdn(t,i[r]));return"/"+(n=n.map(function(t){return t.replace("/","\\/")})).join("/")},In.hex2rdn=function(t,e){if(void 0===e&&(e=0),"31"!==t.substr(e,2))throw"malformed RDN";for(var n=new Array,i=nn.getChildIdx(t,e),r=0;r<i.length;r++)n.push(In.hex2attrTypeValue(t,i[r]));return(n=n.map(function(t){return t.replace("+","\\+")})).join("+")},In.hex2attrTypeValue=function(t,e){var n=nn,i=n.getV;if(void 0===e&&(e=0),"30"!==t.substr(e,2))throw"malformed attribute type and value";var r=n.getChildIdx(t,e);2!==r.length||t.substr(r[0],2);var s=i(t,r[0]),o=Qe.asn1.ASN1Util.oidHexToInt(s);return Qe.asn1.x509.OID.oid2atype(o)+"="+ln(i(t,r[1]))},In.getPublicKeyFromCertHex=function(t){var e=new In;return e.readCertHex(t),e.getPublicKey()},In.getPublicKeyFromCertPEM=function(t){var e=new In;return e.readCertPEM(t),e.getPublicKey()},In.getPublicKeyInfoPropOfCertPEM=function(t){var e,n,i=nn.getVbyList,r={};return r.algparam=null,(e=new In).readCertPEM(t),n=e.getPublicKeyHex(),r.keyhex=i(n,0,[1],"03").substr(2),r.algoid=i(n,0,[0,0],"06"),"2a8648ce3d0201"===r.algoid&&(r.algparam=i(n,0,[0,1],"06")),r},In.KEYUSAGE_NAME=["digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly"],void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.jws&&Qe.jws||(Qe.jws={}),Qe.jws.JWS=function(){var t=Qe.jws.JWS.isSafeJSONString;this.parseJWS=function(e,n){if(void 0===this.parsedJWS||!n&&void 0===this.parsedJWS.sigvalH){var i=e.match(/^([^.]+)\.([^.]+)\.([^.]+)$/);if(null==i)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";var r=i[1],s=i[2],o=i[3],a=r+"."+s;if(this.parsedJWS={},this.parsedJWS.headB64U=r,this.parsedJWS.payloadB64U=s,this.parsedJWS.sigvalB64U=o,this.parsedJWS.si=a,!n){var u=hn(o),h=$e(u,16);this.parsedJWS.sigvalH=u,this.parsedJWS.sigvalBI=h}var c=en(r),f=en(s);if(this.parsedJWS.headS=c,this.parsedJWS.payloadS=f,!t(c,this.parsedJWS,"headP"))throw"malformed JSON string for JWS Head: "+c}}},Qe.jws.JWS.sign=function(t,e,n,i,r){var s,o,a,u=Qe,h=u.jws.JWS,c=h.readSafeJSONString,f=h.isSafeJSONString,l=u.crypto,d=(l.ECDSA,l.Mac),p=l.Signature,g=JSON;if("string"!=typeof e&&"object"!=typeof e)throw"spHeader must be JSON string or object: "+e;if("object"==typeof e&&(o=e,s=g.stringify(o)),"string"==typeof e){if(!f(s=e))throw"JWS Head is not safe JSON string: "+s;o=c(s)}if(a=n,"object"==typeof n&&(a=g.stringify(n)),""!=t&&null!=t||void 0===o.alg||(t=o.alg),""!=t&&null!=t&&void 0===o.alg&&(o.alg=t,s=g.stringify(o)),t!==o.alg)throw"alg and sHeader.alg doesn't match: "+t+"!="+o.alg;var v=null;if(void 0===h.jwsalg2sigalg[t])throw"unsupported alg name: "+t;v=h.jwsalg2sigalg[t];var y=tn(s)+"."+tn(a),m="";if("Hmac"==v.substr(0,4)){if(void 0===i)throw"mac key shall be specified for HS* alg";var b=new d({alg:v,prov:"cryptojs",pass:i});b.updateString(y),m=b.doFinal()}else if(-1!=v.indexOf("withECDSA")){(w=new p({alg:v})).init(i,r),w.updateString(y);var S=w.sign();m=Qe.crypto.ECDSA.asn1SigToConcatSig(S)}else{var w;if("none"!=v)(w=new p({alg:v})).init(i,r),w.updateString(y),m=w.sign()}return y+"."+un(m)},Qe.jws.JWS.verify=function(t,e,n){var i,r=Qe,s=r.jws.JWS,o=s.readSafeJSONString,a=r.crypto,u=a.ECDSA,h=a.Mac,c=a.Signature;i=Ge;var f=t.split(".");if(3!==f.length)return!1;var l=f[0]+"."+f[1],d=hn(f[2]),p=o(en(f[0])),g=null,v=null;if(void 0===p.alg)throw"algorithm not specified in header";if((v=(g=p.alg).substr(0,2),null!=n&&"[object Array]"===Object.prototype.toString.call(n)&&n.length>0)&&-1==(":"+n.join(":")+":").indexOf(":"+g+":"))throw"algorithm '"+g+"' not accepted in the list";if("none"!=g&&null===e)throw"key shall be specified to verify.";if("string"==typeof e&&-1!=e.indexOf("-----BEGIN ")&&(e=Fn.getKey(e)),!("RS"!=v&&"PS"!=v||e instanceof i))throw"key shall be a RSAKey obj for RS* and PS* algs";if("ES"==v&&!(e instanceof u))throw"key shall be a ECDSA obj for ES* algs";var y=null;if(void 0===s.jwsalg2sigalg[p.alg])throw"unsupported alg name: "+g;if("none"==(y=s.jwsalg2sigalg[g]))throw"not supported";if("Hmac"==y.substr(0,4)){if(void 0===e)throw"hexadecimal key shall be specified for HMAC";var m=new h({alg:y,pass:e});return m.updateString(l),d==m.doFinal()}if(-1!=y.indexOf("withECDSA")){var b,S=null;try{S=u.concatSigToASN1Sig(d)}catch(t){return!1}return(b=new c({alg:y})).init(e),b.updateString(l),b.verify(S)}return(b=new c({alg:y})).init(e),b.updateString(l),b.verify(d)},Qe.jws.JWS.parse=function(t){var e,n,i,r=t.split("."),s={};if(2!=r.length&&3!=r.length)throw"malformed sJWS: wrong number of '.' splitted elements";return e=r[0],n=r[1],3==r.length&&(i=r[2]),s.headerObj=Qe.jws.JWS.readSafeJSONString(en(e)),s.payloadObj=Qe.jws.JWS.readSafeJSONString(en(n)),s.headerPP=JSON.stringify(s.headerObj,null,"  "),null==s.payloadObj?s.payloadPP=en(n):s.payloadPP=JSON.stringify(s.payloadObj,null,"  "),void 0!==i&&(s.sigHex=hn(i)),s},Qe.jws.JWS.verifyJWT=function(t,e,n){var i=Qe.jws,r=i.JWS,s=r.readSafeJSONString,o=r.inArray,a=r.includedArray,u=t.split("."),h=u[0],c=u[1],f=(hn(u[2]),s(en(h))),l=s(en(c));if(void 0===f.alg)return!1;if(void 0===n.alg)throw"acceptField.alg shall be specified";if(!o(f.alg,n.alg))return!1;if(void 0!==l.iss&&"object"==typeof n.iss&&!o(l.iss,n.iss))return!1;if(void 0!==l.sub&&"object"==typeof n.sub&&!o(l.sub,n.sub))return!1;if(void 0!==l.aud&&"object"==typeof n.aud)if("string"==typeof l.aud){if(!o(l.aud,n.aud))return!1}else if("object"==typeof l.aud&&!a(l.aud,n.aud))return!1;var d=i.IntDate.getNow();return void 0!==n.verifyAt&&"number"==typeof n.verifyAt&&(d=n.verifyAt),void 0!==n.gracePeriod&&"number"==typeof n.gracePeriod||(n.gracePeriod=0),!(void 0!==l.exp&&"number"==typeof l.exp&&l.exp+n.gracePeriod<d)&&(!(void 0!==l.nbf&&"number"==typeof l.nbf&&d<l.nbf-n.gracePeriod)&&(!(void 0!==l.iat&&"number"==typeof l.iat&&d<l.iat-n.gracePeriod)&&((void 0===l.jti||void 0===n.jti||l.jti===n.jti)&&!!r.verify(t,e,n.alg))))},Qe.jws.JWS.includedArray=function(t,e){var n=Qe.jws.JWS.inArray;if(null===t)return!1;if("object"!=typeof t)return!1;if("number"!=typeof t.length)return!1;for(var i=0;i<t.length;i++)if(!n(t[i],e))return!1;return!0},Qe.jws.JWS.inArray=function(t,e){if(null===e)return!1;if("object"!=typeof e)return!1;if("number"!=typeof e.length)return!1;for(var n=0;n<e.length;n++)if(e[n]==t)return!0;return!1},Qe.jws.JWS.jwsalg2sigalg={HS256:"HmacSHA256",HS384:"HmacSHA384",HS512:"HmacSHA512",RS256:"SHA256withRSA",RS384:"SHA384withRSA",RS512:"SHA512withRSA",ES256:"SHA256withECDSA",ES384:"SHA384withECDSA",PS256:"SHA256withRSAandMGF1",PS384:"SHA384withRSAandMGF1",PS512:"SHA512withRSAandMGF1",none:"none"},Qe.jws.JWS.isSafeJSONString=function(t,e,n){var i=null;try{return"object"!=typeof(i=Ze(t))?0:i.constructor===Array?0:(e&&(e[n]=i),1)}catch(t){return 0}},Qe.jws.JWS.readSafeJSONString=function(t){var e=null;try{return"object"!=typeof(e=Ze(t))?null:e.constructor===Array?null:e}catch(t){return null}},Qe.jws.JWS.getEncodedSignatureValueFromJWS=function(t){var e=t.match(/^[^.]+\.[^.]+\.([^.]+)$/);if(null==e)throw"JWS signature is not a form of 'Head.Payload.SigValue'.";return e[1]},Qe.jws.JWS.getJWKthumbprint=function(t){if("RSA"!==t.kty&&"EC"!==t.kty&&"oct"!==t.kty)throw"unsupported algorithm for JWK Thumprint";var e="{";if("RSA"===t.kty){if("string"!=typeof t.n||"string"!=typeof t.e)throw"wrong n and e value for RSA key";e+='"e":"'+t.e+'",',e+='"kty":"'+t.kty+'",',e+='"n":"'+t.n+'"}'}else if("EC"===t.kty){if("string"!=typeof t.crv||"string"!=typeof t.x||"string"!=typeof t.y)throw"wrong crv, x and y value for EC key";e+='"crv":"'+t.crv+'",',e+='"kty":"'+t.kty+'",',e+='"x":"'+t.x+'",',e+='"y":"'+t.y+'"}'}else if("oct"===t.kty){if("string"!=typeof t.k)throw"wrong k value for oct(symmetric) key";e+='"kty":"'+t.kty+'",',e+='"k":"'+t.k+'"}'}var n=dn(e);return un(Qe.crypto.Util.hashHex(n,"sha256"))},Qe.jws.IntDate={},Qe.jws.IntDate.get=function(t){var e=Qe.jws.IntDate,n=e.getNow,i=e.getZulu;if("now"==t)return n();if("now + 1hour"==t)return n()+3600;if("now + 1day"==t)return n()+86400;if("now + 1month"==t)return n()+2592e3;if("now + 1year"==t)return n()+31536e3;if(t.match(/Z$/))return i(t);if(t.match(/^[0-9]+$/))return parseInt(t);throw"unsupported format: "+t},Qe.jws.IntDate.getZulu=function(t){return yn(t)},Qe.jws.IntDate.getNow=function(){return~~(new Date/1e3)},Qe.jws.IntDate.intDate2UTCString=function(t){return new Date(1e3*t).toUTCString()},Qe.jws.IntDate.intDate2Zulu=function(t){var e=new Date(1e3*t);return("0000"+e.getUTCFullYear()).slice(-4)+("00"+(e.getUTCMonth()+1)).slice(-2)+("00"+e.getUTCDate()).slice(-2)+("00"+e.getUTCHours()).slice(-2)+("00"+e.getUTCMinutes()).slice(-2)+("00"+e.getUTCSeconds()).slice(-2)+"Z"},void 0!==Qe&&Qe||(Qe={}),void 0!==Qe.jws&&Qe.jws||(Qe.jws={}),Qe.jws.JWSJS=function(){var t=Qe.jws.JWS,e=t.readSafeJSONString;this.aHeader=[],this.sPayload="",this.aSignature=[],this.init=function(){this.aHeader=[],this.sPayload=void 0,this.aSignature=[]},this.initWithJWS=function(t){this.init();var e=t.split(".");if(3!=e.length)throw"malformed input JWS";this.aHeader.push(e[0]),this.sPayload=e[1],this.aSignature.push(e[2])},this.addSignature=function(t,e,n,i){if(void 0===this.sPayload||null===this.sPayload)throw"there's no JSON-JS signature to add.";var r=this.aHeader.length;if(this.aHeader.length!=this.aSignature.length)throw"aHeader.length != aSignature.length";try{var s=Qe.jws.JWS.sign(t,e,this.sPayload,n,i).split(".");s[0],s[2];this.aHeader.push(s[0]),this.aSignature.push(s[2])}catch(t){throw this.aHeader.length>r&&this.aHeader.pop(),this.aSignature.length>r&&this.aSignature.pop(),"addSignature failed: "+t}},this.verifyAll=function(t){if(this.aHeader.length!==t.length||this.aSignature.length!==t.length)return!1;for(var e=0;e<t.length;e++){var n=t[e];if(2!==n.length)return!1;if(!1===this.verifyNth(e,n[0],n[1]))return!1}return!0},this.verifyNth=function(e,n,i){if(this.aHeader.length<=e||this.aSignature.length<=e)return!1;var r=this.aHeader[e],s=this.aSignature[e],o=r+"."+this.sPayload+"."+s,a=!1;try{a=t.verify(o,n,i)}catch(t){return!1}return a},this.readJWSJS=function(t){if("string"==typeof t){var n=e(t);if(null==n)throw"argument is not safe JSON object string";this.aHeader=n.headers,this.sPayload=n.payload,this.aSignature=n.signatures}else try{if(!(t.headers.length>0))throw"malformed header";if(this.aHeader=t.headers,"string"!=typeof t.payload)throw"malformed signatures";if(this.sPayload=t.payload,!(t.signatures.length>0))throw"malformed signatures";this.aSignatures=t.signatures}catch(t){throw"malformed JWS-JS JSON object: "+t}},this.getJSON=function(){return{headers:this.aHeader,payload:this.sPayload,signatures:this.aSignature}},this.isEmpty=function(){return 0==this.aHeader.length?1:0}};Qe.crypto.ECDSA,Qe.crypto.DSA,Qe.crypto.Signature;var Tn=Qe.crypto.MessageDigest,Pn=(Qe.crypto.Mac,Qe.crypto.Cipher,Fn),jn=vn,Hn=(Qe.crypto,Qe.asn1),_n=Qe.jws,Rn=(Qe.lang,{apiRoot:"http://127.0.0.1:4944/api",request:function(t){t.headers=void 0!==t.headers?t.json:{"Content-Type":"application/json"},t.method="POST";var e=void 0!==t.uri?t.uri:this.apiRoot;return t.apiMethod&&(t.uri+="/"+t.apiMethod),t.apiIdType&&(t.uri+="/"+encodeURIComponent(t.apiIdType)),t.apiId&&(t.uri+="/"+encodeURIComponent(t.apiId)),t.apiAction&&(t.uri+="/"+t.apiAction),et(e,t)},getJwt:function(t,e){var n=Math.floor(Date.now()/1e3)+60;return e=tt({exp:n},e),_n.sign({header:{typ:"JWT",alg:"ES256"},payload:e,privateKey:t})}}),kn=r.JSON||(r.JSON={stringify:JSON.stringify}),Bn=function(t){return kn.stringify.apply(kn,arguments)},Nn=e(n(function(t){t.exports={default:Bn,__esModule:!0}})),On=e(n(function(t,e){e.__esModule=!0,e.default=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}})),Vn=b,Ln={},Mn=c?Object.defineProperties:function(t,e){u(t);for(var n,i=G(e),r=i.length,s=0;r>s;)y.f(t,n=i[s++],e[n]);return t},Kn=i.document,Un=Kn&&Kn.documentElement,qn=K("IE_PROTO"),$n=function(){},zn=function(){var t,e=d("iframe"),n=z.length;for(e.style.display="none",Un.appendChild(e),e.src="javascript:",(t=e.contentWindow.document).open(),t.write("<script>document.F=Object<\/script>"),t.close(),zn=t.F;n--;)delete zn.prototype[z[n]];return zn()},Gn=Object.create||function(t,e){var n;return null!==t?($n.prototype=u(t),n=new $n,$n.prototype=null,n[qn]=t):n=zn(),void 0===e?n:Mn(n,e)},Jn=n(function(t){var e=N("wks"),n=i.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:L)("Symbol."+t))}).store=e}),Wn=y.f,Yn=Jn("toStringTag"),Xn=function(t,e,n){t&&!w(t=n?t:t.prototype,Yn)&&Wn(t,Yn,{configurable:!0,value:e})},Zn={};b(Zn,Jn("iterator"),function(){return this});var Qn,ti=function(t,e,n){t.prototype=Gn(Zn,{next:m(1,n)}),Xn(t,e+" Iterator")},ei=K("IE_PROTO"),ni=Object.prototype,ii=Object.getPrototypeOf||function(t){return t=Y(t),w(t,ei)?t[ei]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?ni:null},ri=Jn("iterator"),si=!([].keys&&"next"in[].keys()),oi=function(){return this},ai=function(t,e,n,i,r,s,o){ti(n,e,i);var a,u,h,c=function(t){if(!si&&t in p)return p[t];switch(t){case"keys":case"values":return function(){return new n(this,t)}}return function(){return new n(this,t)}},f=e+" Iterator",l="values"==r,d=!1,p=t.prototype,g=p[ri]||p["@@iterator"]||r&&p[r],v=g||c(r),y=r?l?c("entries"):v:void 0,m="Array"==e&&p.entries||g;if(m&&(h=ii(m.call(new t)))!==Object.prototype&&h.next&&Xn(h,f,!0),l&&g&&"values"!==g.name&&(d=!0,v=function(){return g.call(this)}),o&&(si||d||!p[ri])&&b(p,ri,v),Ln[e]=v,Ln[f]=oi,r)if(a={values:l?v:c("values"),keys:s?v:c("keys"),entries:y},o)for(u in a)u in p||Vn(p,u,a[u]);else E(E.P+E.F*(si||d),e,a);return a},ui=(Qn=!0,function(t,e){var n,i,r=String(I(t)),s=H(e),o=r.length;return s<0||s>=o?Qn?"":void 0:(n=r.charCodeAt(s))<55296||n>56319||s+1===o||(i=r.charCodeAt(s+1))<56320||i>57343?Qn?r.charAt(s):n:Qn?r.slice(s,s+2):i-56320+(n-55296<<10)+65536});ai(String,"String",function(t){this._t=String(t),this._i=0},function(){var t,e=this._t,n=this._i;return n>=e.length?{value:void 0,done:!0}:(t=ui(e,n),this._i+=t.length,{value:t,done:!1})});var hi=function(t,e){return{value:e,done:!!t}};ai(Array,"Array",function(t,e){this._t=T(t),this._i=0,this._k=e},function(){var t=this._t,e=this._k,n=this._i++;return!t||n>=t.length?(this._t=void 0,hi(1)):hi(0,"keys"==e?n:"values"==e?t[n]:[n,t[n]])},"values");Ln.Arguments=Ln.Array;for(var ci=Jn("toStringTag"),fi="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),li=0;li<fi.length;li++){var di=fi[li],pi=i[di],gi=pi&&pi.prototype;gi&&!gi[ci]&&b(gi,ci,di),Ln[di]=Ln.Array}var vi={f:Jn},yi=vi.f("iterator"),mi=n(function(t){t.exports={default:yi,__esModule:!0}});e(mi);var bi=n(function(t){var e=L("meta"),n=y.f,i=0,r=Object.isExtensible||function(){return!0},s=!h(function(){return r(Object.preventExtensions({}))}),o=function(t){n(t,e,{value:{i:"O"+ ++i,w:{}}})},u=t.exports={KEY:e,NEED:!1,fastKey:function(t,n){if(!a(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!w(t,e)){if(!r(t))return"F";if(!n)return"E";o(t)}return t[e].i},getWeak:function(t,n){if(!w(t,e)){if(!r(t))return!0;if(!n)return!1;o(t)}return t[e].w},onFreeze:function(t){return s&&u.NEED&&r(t)&&!w(t,e)&&o(t),t}}}),Si=(bi.KEY,bi.NEED,bi.fastKey,bi.getWeak,bi.onFreeze,y.f),wi=function(t){var e=r.Symbol||(r.Symbol={});"_"==t.charAt(0)||t in e||Si(e,t,{value:vi.f(t)})},xi=Array.isArray||function(t){return"Array"==D(t)},Fi=z.concat("length","prototype"),Ei={f:Object.getOwnPropertyNames||function(t){return $(t,Fi)}},Ai=Ei.f,Di={}.toString,Ci="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Ii={f:function(t){return Ci&&"[object Window]"==Di.call(t)?function(t){try{return Ai(t)}catch(t){return Ci.slice()}}(t):Ai(T(t))}},Ti=Object.getOwnPropertyDescriptor,Pi={f:c?Ti:function(t,e){if(t=T(t),e=g(e,!0),p)try{return Ti(t,e)}catch(t){}if(w(t,e))return m(!W.f.call(t,e),t[e])}},ji=bi.KEY,Hi=Pi.f,_i=y.f,Ri=Ii.f,ki=i.Symbol,Bi=i.JSON,Ni=Bi&&Bi.stringify,Oi=Jn("_hidden"),Vi=Jn("toPrimitive"),Li={}.propertyIsEnumerable,Mi=N("symbol-registry"),Ki=N("symbols"),Ui=N("op-symbols"),qi=Object.prototype,$i="function"==typeof ki,zi=i.QObject,Gi=!zi||!zi.prototype||!zi.prototype.findChild,Ji=c&&h(function(){return 7!=Gn(_i({},"a",{get:function(){return _i(this,"a",{value:7}).a}})).a})?function(t,e,n){var i=Hi(qi,e);i&&delete qi[e],_i(t,e,n),i&&t!==qi&&_i(qi,e,i)}:_i,Wi=function(t){var e=Ki[t]=Gn(ki.prototype);return e._k=t,e},Yi=$i&&"symbol"==typeof ki.iterator?function(t){return"symbol"==typeof t}:function(t){return t instanceof ki},Xi=function(t,e,n){return t===qi&&Xi(Ui,e,n),u(t),e=g(e,!0),u(n),w(Ki,e)?(n.enumerable?(w(t,Oi)&&t[Oi][e]&&(t[Oi][e]=!1),n=Gn(n,{enumerable:m(0,!1)})):(w(t,Oi)||_i(t,Oi,m(1,{})),t[Oi][e]=!0),Ji(t,e,n)):_i(t,e,n)},Zi=function(t,e){u(t);for(var n,i=function(t){var e=G(t),n=J.f;if(n)for(var i,r=n(t),s=W.f,o=0;r.length>o;)s.call(t,i=r[o++])&&e.push(i);return e}(e=T(e)),r=0,s=i.length;s>r;)Xi(t,n=i[r++],e[n]);return t},Qi=function(t){var e=Li.call(this,t=g(t,!0));return!(this===qi&&w(Ki,t)&&!w(Ui,t))&&(!(e||!w(this,t)||!w(Ki,t)||w(this,Oi)&&this[Oi][t])||e)},tr=function(t,e){if(t=T(t),e=g(e,!0),t!==qi||!w(Ki,e)||w(Ui,e)){var n=Hi(t,e);return!n||!w(Ki,e)||w(t,Oi)&&t[Oi][e]||(n.enumerable=!0),n}},er=function(t){for(var e,n=Ri(T(t)),i=[],r=0;n.length>r;)w(Ki,e=n[r++])||e==Oi||e==ji||i.push(e);return i},nr=function(t){for(var e,n=t===qi,i=Ri(n?Ui:T(t)),r=[],s=0;i.length>s;)!w(Ki,e=i[s++])||n&&!w(qi,e)||r.push(Ki[e]);return r};$i||(Vn((ki=function(){if(this instanceof ki)throw TypeError("Symbol is not a constructor!");var t=L(arguments.length>0?arguments[0]:void 0),e=function(n){this===qi&&e.call(Ui,n),w(this,Oi)&&w(this[Oi],t)&&(this[Oi][t]=!1),Ji(this,t,m(1,n))};return c&&Gi&&Ji(qi,t,{configurable:!0,set:e}),Wi(t)}).prototype,"toString",function(){return this._k}),Pi.f=tr,y.f=Xi,Ei.f=Ii.f=er,W.f=Qi,J.f=nr,vi.f=function(t){return Wi(Jn(t))}),E(E.G+E.W+E.F*!$i,{Symbol:ki});for(var ir="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),rr=0;ir.length>rr;)Jn(ir[rr++]);for(var sr=G(Jn.store),or=0;sr.length>or;)wi(sr[or++]);E(E.S+E.F*!$i,"Symbol",{for:function(t){return w(Mi,t+="")?Mi[t]:Mi[t]=ki(t)},keyFor:function(t){if(!Yi(t))throw TypeError(t+" is not a symbol!");for(var e in Mi)if(Mi[e]===t)return e},useSetter:function(){Gi=!0},useSimple:function(){Gi=!1}}),E(E.S+E.F*!$i,"Object",{create:function(t,e){return void 0===e?Gn(t):Zi(Gn(t),e)},defineProperty:Xi,defineProperties:Zi,getOwnPropertyDescriptor:tr,getOwnPropertyNames:er,getOwnPropertySymbols:nr}),Bi&&E(E.S+E.F*(!$i||h(function(){var t=ki();return"[null]"!=Ni([t])||"{}"!=Ni({a:t})||"{}"!=Ni(Object(t))})),"JSON",{stringify:function(t){for(var e,n,i=[t],r=1;arguments.length>r;)i.push(arguments[r++]);if(n=e=i[1],(a(e)||void 0!==t)&&!Yi(t))return xi(e)||(e=function(t,e){if("function"==typeof n&&(e=n.call(this,t,e)),!Yi(e))return e}),i[1]=e,Ni.apply(Bi,i)}}),ki.prototype[Vi]||b(ki.prototype,Vi,ki.prototype.valueOf),Xn(ki,"Symbol"),Xn(Math,"Math",!0),Xn(i.JSON,"JSON",!0),wi("asyncIterator"),wi("observable");var ar=r.Symbol,ur=n(function(t){t.exports={default:ar,__esModule:!0}});e(ur);var hr=n(function(t,e){e.__esModule=!0;var n=s(mi),i=s(ur),r="function"==typeof i.default&&"symbol"==typeof n.default?function(t){return typeof t}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":typeof t};function s(t){return t&&t.__esModule?t:{default:t}}e.default="function"==typeof i.default&&"symbol"===r(n.default)?function(t){return void 0===t?"undefined":r(t)}:function(t){return t&&"function"==typeof i.default&&t.constructor===i.default&&t!==i.default.prototype?"symbol":void 0===t?"undefined":r(t)}});e(hr);var cr=e(n(function(t,e){e.__esModule=!0;var n,i=(n=hr)&&n.__esModule?n:{default:n};e.default=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":(0,i.default)(e))&&"function"!=typeof e?t:e}})),fr=function(t,e){if(u(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")},lr={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,n){try{(n=o(Function.call,Pi.f(Object.prototype,"__proto__").set,2))(t,[]),e=!(t instanceof Array)}catch(t){e=!0}return function(t,i){return fr(t,i),e?t.__proto__=i:n(t,i),t}}({},!1):void 0),check:fr};E(E.S,"Object",{setPrototypeOf:lr.set});var dr=r.Object.setPrototypeOf,pr=n(function(t){t.exports={default:dr,__esModule:!0}});e(pr),E(E.S,"Object",{create:Gn});var gr=r.Object,vr=function(t,e){return gr.create(t,e)},yr=n(function(t){t.exports={default:vr,__esModule:!0}});e(yr);var mr,br,Sr,wr=e(n(function(t,e){e.__esModule=!0;var n=s(pr),i=s(yr),r=s(hr);function s(t){return t&&t.__esModule?t:{default:t}}e.default=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":(0,r.default)(e)));t.prototype=(0,i.default)(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(n.default?(0,n.default)(t,e):t.__proto__=e)}})),xr=Jn("toStringTag"),Fr="Arguments"==D(function(){return arguments}()),Er=function(t){var e,n,i;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(n=function(t,e){try{return t[e]}catch(t){}}(e=Object(t),xr))?n:Fr?D(e):"Object"==(i=D(e))&&"function"==typeof e.callee?"Arguments":i},Ar=function(t,e,n,i){try{return i?e(u(n)[0],n[1]):e(n)}catch(e){var r=t.return;throw void 0!==r&&u(r.call(t)),e}},Dr=Jn("iterator"),Cr=Array.prototype,Ir=Jn("iterator"),Tr=r.getIteratorMethod=function(t){if(null!=t)return t[Ir]||t["@@iterator"]||Ln[Er(t)]},Pr=n(function(t){var e={},n={},i=t.exports=function(t,i,r,s,a){var h,c,f,l,d,p=a?function(){return t}:Tr(t),g=o(r,s,i?2:1),v=0;if("function"!=typeof p)throw TypeError(t+" is not iterable!");if(void 0===(d=p)||Ln.Array!==d&&Cr[Dr]!==d){for(f=p.call(t);!(c=f.next()).done;)if((l=Ar(f,g,c.value,i))===e||l===n)return l}else for(h=R(t.length);h>v;v++)if((l=i?g(u(c=t[v])[0],c[1]):g(t[v]))===e||l===n)return l};i.BREAK=e,i.RETURN=n}),jr=Jn("species"),Hr=function(t,e){var n,i=u(t).constructor;return void 0===i||null==(n=u(i)[jr])?e:s(n)},_r=i.process,Rr=i.setImmediate,kr=i.clearImmediate,Br=i.MessageChannel,Nr=i.Dispatch,Or=0,Vr={},Lr=function(){var t=+this;if(Vr.hasOwnProperty(t)){var e=Vr[t];delete Vr[t],e()}},Mr=function(t){Lr.call(t.data)};Rr&&kr||(Rr=function(t){for(var e=[],n=1;arguments.length>n;)e.push(arguments[n++]);return Vr[++Or]=function(){!function(t,e,n){var i=void 0===n;switch(e.length){case 0:return i?t():t.call(n);case 1:return i?t(e[0]):t.call(n,e[0]);case 2:return i?t(e[0],e[1]):t.call(n,e[0],e[1]);case 3:return i?t(e[0],e[1],e[2]):t.call(n,e[0],e[1],e[2]);case 4:return i?t(e[0],e[1],e[2],e[3]):t.call(n,e[0],e[1],e[2],e[3])}t.apply(n,e)}("function"==typeof t?t:Function(t),e)},mr(Or),Or},kr=function(t){delete Vr[t]},"process"==D(_r)?mr=function(t){_r.nextTick(o(Lr,t,1))}:Nr&&Nr.now?mr=function(t){Nr.now(o(Lr,t,1))}:Br?(Sr=(br=new Br).port2,br.port1.onmessage=Mr,mr=o(Sr.postMessage,Sr,1)):i.addEventListener&&"function"==typeof postMessage&&!i.importScripts?(mr=function(t){i.postMessage(t+"","*")},i.addEventListener("message",Mr,!1)):mr="onreadystatechange"in d("script")?function(t){Un.appendChild(d("script")).onreadystatechange=function(){Un.removeChild(this),Lr.call(t)}}:function(t){setTimeout(o(Lr,t,1),0)});var Kr={set:Rr,clear:kr},Ur=Kr.set,qr=i.MutationObserver||i.WebKitMutationObserver,$r=i.process,zr=i.Promise,Gr="process"==D($r);function Jr(t){var e,n;this.promise=new t(function(t,i){if(void 0!==e||void 0!==n)throw TypeError("Bad Promise constructor");e=t,n=i}),this.resolve=s(e),this.reject=s(n)}var Wr={f:function(t){return new Jr(t)}},Yr=function(t){try{return{e:!1,v:t()}}catch(t){return{e:!0,v:t}}},Xr=i.navigator,Zr=Xr&&Xr.userAgent||"",Qr=function(t,e){if(u(t),a(e)&&e.constructor===t)return e;var n=Wr.f(t);return(0,n.resolve)(e),n.promise},ts=Jn("species"),es=Jn("iterator"),ns=!1;try{[7][es]().return=function(){ns=!0}}catch(t){}var is,rs,ss,os,as,us,hs=Kr.set,cs=function(){var t,e,n,r=function(){var i,r;for(Gr&&(i=$r.domain)&&i.exit();t;){r=t.fn,t=t.next;try{r()}catch(i){throw t?n():e=void 0,i}}e=void 0,i&&i.enter()};if(Gr)n=function(){$r.nextTick(r)};else if(!qr||i.navigator&&i.navigator.standalone)if(zr&&zr.resolve){var s=zr.resolve(void 0);n=function(){s.then(r)}}else n=function(){Ur.call(i,r)};else{var o=!0,a=document.createTextNode("");new qr(r).observe(a,{characterData:!0}),n=function(){a.data=o=!o}}return function(i){var r={fn:i,next:void 0};e&&(e.next=r),t||(t=r,n()),e=r}}(),fs=i.TypeError,ls=i.process,ds=ls&&ls.versions,ps=ds&&ds.v8||"",gs=i.Promise,vs="process"==Er(ls),ys=function(){},ms=rs=Wr.f,bs=!!function(){try{var t=gs.resolve(1),e=(t.constructor={})[Jn("species")]=function(t){t(ys,ys)};return(vs||"function"==typeof PromiseRejectionEvent)&&t.then(ys)instanceof e&&0!==ps.indexOf("6.6")&&-1===Zr.indexOf("Chrome/66")}catch(t){}}(),Ss=function(t){var e;return!(!a(t)||"function"!=typeof(e=t.then))&&e},ws=function(t,e){if(!t._n){t._n=!0;var n=t._c;cs(function(){for(var i=t._v,r=1==t._s,s=0,o=function(e){var n,s,o,a=r?e.ok:e.fail,u=e.resolve,h=e.reject,c=e.domain;try{a?(r||(2==t._h&&Es(t),t._h=1),!0===a?n=i:(c&&c.enter(),n=a(i),c&&(c.exit(),o=!0)),n===e.promise?h(fs("Promise-chain cycle")):(s=Ss(n))?s.call(n,u,h):u(n)):h(i)}catch(t){c&&!o&&c.exit(),h(t)}};n.length>s;)o(n[s++]);t._c=[],t._n=!1,e&&!t._h&&xs(t)})}},xs=function(t){hs.call(i,function(){var e,n,r,s=t._v,o=Fs(t);if(o&&(e=Yr(function(){vs?ls.emit("unhandledRejection",s,t):(n=i.onunhandledrejection)?n({promise:t,reason:s}):(r=i.console)&&r.error&&r.error("Unhandled promise rejection",s)}),t._h=vs||Fs(t)?2:1),t._a=void 0,o&&e.e)throw e.v})},Fs=function(t){return 1!==t._h&&0===(t._a||t._c).length},Es=function(t){hs.call(i,function(){var e;vs?ls.emit("rejectionHandled",t):(e=i.onrejectionhandled)&&e({promise:t,reason:t._v})})},As=function(t){var e=this;e._d||(e._d=!0,(e=e._w||e)._v=t,e._s=2,e._a||(e._a=e._c.slice()),ws(e,!0))},Ds=function(t){var e,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===t)throw fs("Promise can't be resolved itself");(e=Ss(t))?cs(function(){var i={_w:n,_d:!1};try{e.call(t,o(Ds,i,1),o(As,i,1))}catch(t){As.call(i,t)}}):(n._v=t,n._s=1,ws(n,!1))}catch(t){As.call({_w:n,_d:!1},t)}}};bs||(gs=function(t){!function(t,e,n,i){if(!(t instanceof e)||void 0!==i&&i in t)throw TypeError(n+": incorrect invocation!")}(this,gs,"Promise","_h"),s(t),is.call(this);try{t(o(Ds,this,1),o(As,this,1))}catch(t){As.call(this,t)}},(is=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(t,e,n){for(var i in e)n&&t[i]?t[i]=e[i]:b(t,i,e[i]);return t}(gs.prototype,{then:function(t,e){var n=ms(Hr(this,gs));return n.ok="function"!=typeof t||t,n.fail="function"==typeof e&&e,n.domain=vs?ls.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&ws(this,!1),n.promise},catch:function(t){return this.then(void 0,t)}}),ss=function(){var t=new is;this.promise=t,this.resolve=o(Ds,t,1),this.reject=o(As,t,1)},Wr.f=ms=function(t){return t===gs||t===os?new ss(t):rs(t)}),E(E.G+E.W+E.F*!bs,{Promise:gs}),Xn(gs,"Promise"),us="function"==typeof r[as="Promise"]?r[as]:i[as],c&&us&&!us[ts]&&y.f(us,ts,{configurable:!0,get:function(){return this}}),os=r.Promise,E(E.S+E.F*!bs,"Promise",{reject:function(t){var e=ms(this);return(0,e.reject)(t),e.promise}}),E(E.S+!0*E.F,"Promise",{resolve:function(t){return Qr(this===os?gs:this,t)}}),E(E.S+E.F*!(bs&&function(t,e){if(!e&&!ns)return!1;var n=!1;try{var i=[7],r=i[es]();r.next=function(){return{done:n=!0}},i[es]=function(){return r},t(i)}catch(t){}return n}(function(t){gs.all(t).catch(ys)})),"Promise",{all:function(t){var e=this,n=ms(e),i=n.resolve,r=n.reject,s=Yr(function(){var n=[],s=0,o=1;Pr(t,!1,function(t){var a=s++,u=!1;n.push(void 0),o++,e.resolve(t).then(function(t){u||(u=!0,n[a]=t,--o||i(n))},r)}),--o||i(n)});return s.e&&r(s.v),n.promise},race:function(t){var e=this,n=ms(e),i=n.reject,r=Yr(function(){Pr(t,!1,function(t){e.resolve(t).then(n.resolve,i)})});return r.e&&i(r.v),n.promise}}),E(E.P+E.R,"Promise",{finally:function(t){var e=Hr(this,r.Promise||i.Promise),n="function"==typeof t;return this.then(n?function(n){return Qr(e,t()).then(function(){return n})}:t,n?function(n){return Qr(e,t()).then(function(){throw n})}:t)}}),E(E.S,"Promise",{try:function(t){var e=Wr.f(this),n=Yr(t);return(n.e?e.reject:e.resolve)(n.v),e.promise}});var Cs=r.Promise,Is=e(n(function(t){t.exports={default:Cs,__esModule:!0}})),Ts=!1;try{Ts="[object process]"===Object.prototype.toString.call(nt.process)}catch(t){}var Ps={getHash:function(t){return new vt(new Tn({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},timeoutPromise:function(t,e){return Is.race([t,new Is(function(t){setTimeout(function(){t()},e)})])},isNode:Ts};!function(t,e){var n=(r.Object||{})[t]||Object[t],i={};i[t]=e(n),E(E.S+E.F*h(function(){n(1)}),"Object",i)}("keys",function(){return function(t){return G(Y(t))}});var js,Hs=r.Object.keys,_s=e(n(function(t){t.exports={default:Hs,__esModule:!0}})),Rs={email:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i,bitcoin:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,bitcoin_address:/^[13][a-km-zA-HJ-NP-Z0-9]{26,33}$/,ip:/^(([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)\.){3}([1-9]?\d|1\d\d|2[0-5][0-5]|2[0-4]\d)$/,ipv6:/^(?:[A-F0-9]{1,4}:){7}[A-F0-9]{1,4}$/,gpg_fingerprint:null,gpg_keyid:null,google_oauth2:null,tel:/^\d{7,}$/,phone:/^\d{7,}$/,keyID:null,url:/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)?/gi,account:/^([\w-]+(?:\.[\w-]+)*)@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$/i},ks=function(){function t(e){if(On(this,t),e.hasOwnProperty("val"))if(this.val=e.val,e.hasOwnProperty("name"))this.name=e.name;else{var n=t.guessTypeOf(this.val);if(!n)throw new Error("Type of attribute was omitted and could not be guessed");this.name=n}else{if(!Array.isArray(e))throw new Error("Invalid attribute data",e);if(2!==e.length)throw new Error("Invalid Attribute");this.name=e[0],this.val=e[1]}}return t.getUniqueIdValidators=function(){return Rs},t.isUniqueType=function(t){return _s(Rs).indexOf(t)>-1},t.guessTypeOf=function(t){for(var e in Rs)if(t.match(Rs[e]))return e},t.equals=function(e,n){return new t(e).equals(new t(n))},t.prototype.toArray=function(){return[this.name,this.val]},t.prototype.equals=function(t){return this.name===t.name&&this.val===t.val},t}(),Bs="Invalid Identifi message:",Ns=function(t){function e(){return On(this,e),cr(this,t.apply(this,arguments))}return wr(e,t),e}(Error),Os=function(){function t(e){On(this,t),this.signedData=e,this._validate()}return t.prototype.getSignerKeyID=function(){return Ps.getHash(this.jwsHeader.key||this.jwsHeader.kid)},t.prototype._validate=function(){if(!this.signedData)throw new Ns(Bs+" Missing signedData");if("object"!=typeof this.signedData)throw new Ns(Bs+" signedData must be an object");var t=this.signedData;if(!t.type)throw new Ns(Bs+" Missing type definition");if(!t.author)throw new Ns(Bs+" Missing author");if(!t.author.length)throw new Ns(Bs+" Author empty");var e=void 0,n=void 0;for(this.jwsHeader&&(this.signerKeyHash=this.getSignerKeyID()),e=0;e<t.author.length;e++){if(2!==t.author[e].length)throw new Ns(Bs+" Invalid author: "+t.author[e].toString());if("keyID"===t.author[e][0]){if(n)throw new Ns(Bs+" Author may have only one keyID");if(n=t.author[e][1],this.signerKeyHash&&n!==this.signerKeyHash)throw new Ns(Bs+" If message has a keyID author, it must be signed by the same key")}}if(!t.recipient)throw new Ns(Bs+" Missing recipient");if(!t.recipient.length)throw new Ns(Bs+" Author empty");for(e=0;e<t.recipient.length;e++)if(2!==t.recipient[e].length)throw new Ns(Bs+" Invalid recipient: "+t.recipient[e].toString());if(!t.timestamp)throw new Ns(Bs+" Missing timestamp");if(!Date.parse(t.timestamp))throw new Ns(Bs+" Invalid timestamp");if("rating"===t.type){if(isNaN(t.rating))throw new Ns(Bs+" Invalid rating");if(isNaN(t.maxRating))throw new Ns(Bs+" Invalid maxRating");if(isNaN(t.minRating))throw new Ns(Bs+" Invalid minRating");if(t.rating>t.maxRating)throw new Ns(Bs+" Rating is above maxRating");if(t.rating<t.minRating)throw new Ns(Bs+" Rating is below minRating");if("string"!=typeof t.context||!t.context.length)throw new Ns(Bs+" Rating messages must have a context field")}if(("verify_identity"===t.type||"unverify_identity"===t.type)&&t.recipient.length<2)throw new Ns(Bs+" At least 2 recipient attributes are needed for a connection / disconnection");return!0},t.prototype.isPositive=function(){return"rating"===this.signedData.type&&this.signedData.rating>(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNegative=function(){return"rating"===this.signedData.type&&this.signedData.rating<(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.isNeutral=function(){return"rating"===this.signedData.type&&this.signedData.rating===(this.signedData.maxRating+this.signedData.minRating)/2},t.prototype.sign=function(e,n){return this.jwsHeader={alg:"ES256",key:e.pubKeyASN1},this.jws=_n.JWS.sign(this.jwsHeader.alg,Nn(this.jwsHeader),Nn(this.signedData),e),n||t._validateJws(this.jws),this.getHash(),this},t.create=function(e,n){!e.author&&n&&(e.author=[["keyID",n.keyID]]),e.timestamp=e.timestamp||(new Date).toISOString(),e.context=e.context||"identifi";var i=new t(e);return n&&i.sign(n),i},t.createVerification=function(e,n){return e.type="verification",t.create(e,n)},t.createRating=function(e,n){return e.type="rating",e.maxRating=e.maxRating||10,e.minRating=e.minRating||-10,t.create(e,n)},t.fromJws=function(e){t._validateJws(e);var n=_n.JWS.parse(e),i=new t(n.payloadObj);return i.hash=t.getHash(e),i.jwsHeader=n.headerObj,i.jws=e,i},t.prototype.getAuthor=function(t){for(var e=0;e<this.signedData.author.length;e++){var n=this.signedData.author[e];if(ks.isUniqueType(n[0]))return t.get(n[1],n[0])}},t.prototype.getRecipient=function(t){for(var e=0;e<this.signedData.recipient.length;e++){var n=this.signedData.recipient[e];if(ks.isUniqueType(n[0]))return t.get(n[1],n[0])}},t.prototype.getHash=function(){return this.jws&&!this.hash&&(this.hash=t.getHash(this.jws)),this.hash},t.getHash=function(t){return new vt(new Tn({alg:"sha256",prov:"cryptojs"}).digestString(t),"hex").toString("base64")},t.prototype.verify=function(){var e=this.jwsHeader.key||this.jwsHeader.kid,n=Hn.ASN1Util.getPEMStringFromHex(e,"PUBLIC KEY"),i=Pn.getKey(n);if(!_n.JWS.verify(this.jws,i,[this.jwsHeader.alg]))throw new Ns(Bs+" Invalid signature");if(this.hash){if(this.hash!==t.getHash(this.jws))throw new Ns(Bs+" Invalid message hash")}else this.getHash();return!0},t._validateJws=function(t){if("string"!=typeof t)throw new Ns(Bs+" Message JWS must be a string");if(t.length>1e4)throw new Ns(Bs+" Message JWS max length is 10000");return!0},t}(),Vs=n(function(t){!function(){function e(t,e){for(var n=2;n<arguments.length;n++)for(var i=0;i<arguments[n].length;i++)t[e++]=arguments[n].charAt(i)}function n(t){return String.fromCharCode(t>>24&255,t>>16&255,t>>8&255,255&t)}function i(t){return String.fromCharCode(255&t,t>>8&255)}t.exports=function(t,r,s){this.width=t,this.height=r,this.depth=s,this.pix_size=r*(t+1),this.data_size=2+this.pix_size+5*Math.floor((65534+this.pix_size)/65535)+4,this.ihdr_offs=0,this.ihdr_size=25,this.plte_offs=this.ihdr_offs+this.ihdr_size,this.plte_size=8+3*s+4,this.trns_offs=this.plte_offs+this.plte_size,this.trns_size=8+s+4,this.idat_offs=this.trns_offs+this.trns_size,this.idat_size=8+this.data_size+4,this.iend_offs=this.idat_offs+this.idat_size,this.iend_size=12,this.buffer_size=this.iend_offs+this.iend_size,this.buffer=new Array,this.palette=new Object,this.pindex=0;for(var o=new Array,a=0;a<this.buffer_size;a++)this.buffer[a]="\0";e(this.buffer,this.ihdr_offs,n(this.ihdr_size-12),"IHDR",n(t),n(r),"\b"),e(this.buffer,this.plte_offs,n(this.plte_size-12),"PLTE"),e(this.buffer,this.trns_offs,n(this.trns_size-12),"tRNS"),e(this.buffer,this.idat_offs,n(this.idat_size-12),"IDAT"),e(this.buffer,this.iend_offs,n(this.iend_size-12),"IEND");var u,h=30912;h+=31-h%31,e(this.buffer,this.idat_offs+8,(u=h,String.fromCharCode(u>>8&255,255&u)));for(a=0;(a<<16)-1<this.pix_size;a++){var c,f;a+65535<this.pix_size?(c=65535,f="\0"):(c=this.pix_size-(a<<16)-a,f=""),e(this.buffer,this.idat_offs+8+2+(a<<16)+(a<<2),f,i(c),i(~c))}for(a=0;a<256;a++){for(var l=a,d=0;d<8;d++)l=1&l?-306674912^l>>1&2147483647:l>>1&2147483647;o[a]=l}this.index=function(t,e){var n=e*(this.width+1)+t+1;return this.idat_offs+8+2+5*Math.floor(n/65535+1)+n},this.color=function(t,e,n,i){var r=(((i=i>=0?i:255)<<8|t)<<8|e)<<8|n;if(void 0===this.palette[r]){if(this.pindex==this.depth)return"\0";var s=this.plte_offs+8+3*this.pindex;this.buffer[s+0]=String.fromCharCode(t),this.buffer[s+1]=String.fromCharCode(e),this.buffer[s+2]=String.fromCharCode(n),this.buffer[this.trns_offs+8+this.pindex]=String.fromCharCode(i),this.palette[r]=String.fromCharCode(this.pindex++)}return this.palette[r]},this.getBase64=function(){var t,e,n,i,r,s,o,a=this.getDump(),u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=a.length,c=0,f="";do{i=(t=a.charCodeAt(c))>>2,r=(3&t)<<4|(e=a.charCodeAt(c+1))>>4,n=a.charCodeAt(c+2),s=h<c+2?64:(15&e)<<2|n>>6,o=h<c+3?64:63&n,f+=u.charAt(i)+u.charAt(r)+u.charAt(s)+u.charAt(o)}while((c+=3)<h);return f},this.getDump=function(){for(var t=1,i=0,r=5552,s=0;s<this.height;s++)for(var a=-1;a<this.width;a++)i+=t+=this.buffer[this.index(a,s)].charCodeAt(0),0==(r-=1)&&(t%=65521,i%=65521,r=5552);function u(t,i,r){for(var s=-1,a=4;a<r-4;a+=1)s=o[255&(s^t[i+a].charCodeAt(0))]^s>>8&16777215;e(t,i+r-4,n(-1^s))}return t%=65521,i%=65521,e(this.buffer,this.idat_offs+this.idat_size-8,n(i<<16|t)),u(this.buffer,this.ihdr_offs,this.ihdr_size),u(this.buffer,this.plte_offs,this.plte_size),u(this.buffer,this.trns_offs,this.trns_size),u(this.buffer,this.idat_offs,this.idat_size),u(this.buffer,this.iend_offs,this.iend_size),"ÂPNG\r\n\n"+this.buffer.join("")}}}()}),Ls=n(function(t){!function(){var e;e=Vs;var n=function(t,e){if("string"!=typeof t||t.length<15)throw"A hash of at least 15 characters is required.";this.defaults={background:[240,240,240,255],margin:.08,size:64,saturation:.7,brightness:.5,format:"png"},this.options="object"==typeof e?e:this.defaults,"number"==typeof arguments[1]&&(this.options.size=arguments[1]),arguments[2]&&(this.options.margin=arguments[2]),this.hash=t,this.background=this.options.background||this.defaults.background,this.size=this.options.size||this.defaults.size,this.format=this.options.format||this.defaults.format,this.margin=void 0!==this.options.margin?this.options.margin:this.defaults.margin;var n=parseInt(this.hash.substr(-7),16)/268435455,i=this.options.saturation||this.defaults.saturation,r=this.options.brightness||this.defaults.brightness;this.foreground=this.options.foreground||this.hsl2rgb(n,i,r)};n.prototype={background:null,foreground:null,hash:null,margin:null,size:null,format:null,image:function(){return this.isSvg()?new i(this.size,this.foreground,this.background):new e(this.size,this.size,256)},render:function(){var t,e,n=this.image(),i=this.size,r=Math.floor(i*this.margin),s=Math.floor((i-2*r)/5),o=Math.floor((i-5*s)/2),a=n.color.apply(n,this.background),u=n.color.apply(n,this.foreground);for(t=0;t<15;t++)e=parseInt(this.hash.charAt(t),16)%2?a:u,t<5?this.rectangle(2*s+o,t*s+o,s,s,e,n):t<10?(this.rectangle(1*s+o,(t-5)*s+o,s,s,e,n),this.rectangle(3*s+o,(t-5)*s+o,s,s,e,n)):t<15&&(this.rectangle(0*s+o,(t-10)*s+o,s,s,e,n),this.rectangle(4*s+o,(t-10)*s+o,s,s,e,n));return n},rectangle:function(t,e,n,i,r,s){var o,a;if(this.isSvg())s.rectangles.push({x:t,y:e,w:n,h:i,color:r});else for(o=t;o<t+n;o++)for(a=e;a<e+i;a++)s.buffer[s.index(o,a)]=r},hsl2rgb:function(t,e,n){return[255*(e=[n+=e*=n<.5?n:1-n,n-(t*=6)%1*e*2,n-=e*=2,n,n+t%1*e,n+e])[~~t%6],255*e[(16|t)%6],255*e[(8|t)%6]]},toString:function(t){return t?this.render().getDump():this.render().getBase64()},isSvg:function(){return this.format.match(/svg/i)}};var i=function(t,e,n){this.size=t,this.foreground=this.color.apply(this,e),this.background=this.color.apply(this,n),this.rectangles=[]};i.prototype={size:null,foreground:null,background:null,rectangles:null,color:function(t,e,n,i){var r=[t,e,n].map(Math.round);return r.push(i>=0&&i<=255?i/255:1),"rgba("+r.join(",")+")"},getDump:function(){var t,e,n,i=this.foreground,r=this.background,s=.005*this.size;for(e="<svg xmlns='http://www.w3.org/2000/svg' width='"+this.size+"' height='"+this.size+"' style='background-color:"+r+";'><g style='fill:"+i+"; stroke:"+i+"; stroke-width:"+s+";'>",t=0;t<this.rectangles.length;t++)(n=this.rectangles[t]).color!=r&&(e+="<rect  x='"+n.x+"' y='"+n.y+"' width='"+n.w+"' height='"+n.h+"'/>");return e+="</g></svg>"},getBase64:function(){if(btoa)return btoa(this.getDump());if(vt)return new vt(this.getDump(),"binary").toString("base64");throw"Cannot generate base64 output"}},t.exports=n}()}),Ms=function(){function t(e){On(this,t),this.gun=e}return t.create=function(e,n){if(n.receivedNegative|=n.receivedNegative||0,n.receivedPositive|=n.receivedPositive||0,n.receivedNeutral=n.receivedNeutral||0,n.sentNegative=n.sentNegative||0,n.sentPositive=n.sentPositive||0,n.sentNeutral=n.sentNeutral||0,n.trustDistance=n.hasOwnProperty("trustDistance")?n.trustDistance:99,n.attrs=n.attrs||{},Array.isArray(n.attrs)){for(var i={};n.attrs.length;){var r=n.attrs.pop();i[encodeURIComponent(r.name)+":"+encodeURIComponent(r.val)]=r}n.attrs=i}n.mostVerifiedAttributes=t.getMostVerifiedAttributes(n.attrs);var s=-1;return _s(n.mostVerifiedAttributes).forEach(function(t){var e=n.mostVerifiedAttributes[t];ks.isUniqueType(t)&&e.verificationScore>s&&(n.linkTo={name:t,val:e.attribute.val},s=e.verificationScore)}),n.linkTo||(n.linkTo=n.attrs[_s(n.attrs)[0]]),"keyID"!==n.linkTo.name&&n.mostVerifiedAttributes.keyID&&(n.linkTo=n.mostVerifiedAttributes.keyID.attribute),new t(e.set(n))},t.getMostVerifiedAttributes=function(t){var e={};return _s(t).forEach(function(n){var i=t[n],r=_s(e).indexOf(i.name)>-1;2*i.conf>3*i.ref&&(!r||i.conf-i.ref>e[i.name].verificationScore)&&(e[i.name]={attribute:i,verificationScore:i.conf-i.ref})}),e},t.prototype.verified=function(t){return this.mostVerifiedAttributes.hasOwnProperty(t)?this.mostVerifiedAttributes[t].attribute.val:void 0},t.prototype.profileCard=function(){var e=this,n=document.createElement("div");n.className="identifi-card";var i=this.identicon(60);i.style.order=1,i.style.flexShrink=0,i.style.marginRight="15px";var r=document.createElement("div");r.style.padding="5px",r.style.order=2,r.style.flexGrow=1;var s=document.createElement("span"),o=document.createElement("small");return n.appendChild(i),n.appendChild(r),r.appendChild(s),r.appendChild(o),this.gun.on(async function(n){if(n){var i=await new Is(function(t){e.gun.get("attrs").load(function(e){return t(e)})}),r=await e.gun.get("linkTo").then(),a="https://identi.fi/#/identities/"+r.name+"/"+r.val,u=t.getMostVerifiedAttributes(i);s.innerHTML='<a href="'+a+'">'+(u.name&&u.name.attribute.val||u.nickname&&u.nickname.attribute.val||r.name+":"+r.val)+"</a><br>",s.innerHTML+='<small>Received: <span class="identifi-pos">+'+(n.receivedPositive||0)+'</span> / <span class="identifi-neg">-'+(n.receivedNegative||0)+"</span></small><br>",o.innerHTML="",_s(i).forEach(function(t){var e=i[t];e.link&&(o.innerHTML+=e.name+': <a href="'+e.link+'">'+e.val+"</a> ")})}}),n},t.appendSearchWidget=function(t,e){var n=document.createElement("form"),i=document.createElement("input");i.type="text",i.placeholder="Search",i.id="identifiSearchInput",n.innerHTML+='<div id="identifiSearchResults"></div>';var r=document.createElement("div");t.appendChild(n),n.appendChild(i),n.appendChild(r),i.addEventListener("keyup",async function(){var t=await e.search(i.value);r.innerHTML="",t.sort(function(t,e){return t.trustDistance-e.trustDistance}),t.forEach(function(t){r.appendChild(t.profileCard())})})},t._ordinal=function(t){var e=["th","st","nd","rd"],n=t%100;return t+(e[(n-20)%10]||e[n]||e[0])},t._injectCss=function(){if(!document.getElementById("identifiStyle")){var t=document.createElement("style");t.id="identifiStyle",t.innerHTML="\n      .identifi-identicon * {\n        box-sizing: border-box;\n      }\n\n      .identifi-identicon {\n        vertical-align: middle;\n        margin: auto;\n        border-radius: 50%;\n        text-align: center;\n        display: inline-block;\n        position: relative;\n        margin: auto;\n        max-width: 100%;\n      }\n\n      .identifi-distance {\n        z-index: 2;\n        position: absolute;\n        left:0%;\n        top:2px;\n        width: 100%;\n        text-align: right;\n        color: #fff;\n        text-shadow: 0 0 1px #000;\n        font-size: 75%;\n        line-height: 75%;\n        font-weight: bold;\n      }\n\n      .identifi-pie {\n        border-radius: 50%;\n        position: absolute;\n        top: 0;\n        left: 0;\n        box-shadow: 0px 0px 0px 0px #82FF84;\n        padding-bottom: 100%;\n        max-width: 100%;\n        -webkit-transition: all 0.2s ease-in-out;\n        -moz-transition: all 0.2s ease-in-out;\n        transition: all 0.2s ease-in-out;\n      }\n\n      .identifi-card {\n        padding: 10px;\n        background-color: #f7f7f7;\n        color: #777;\n        border: 1px solid #ddd;\n        display: flex;\n        flex-direction: row;\n        overflow: hidden;\n      }\n\n      .identifi-card a {\n        -webkit-transition: color 150ms;\n        transition: color 150ms;\n        text-decoration: none;\n        color: #337ab7;\n      }\n\n      .identifi-card a:hover, .identifi-card a:active {\n        text-decoration: underline;\n        color: #23527c;\n      }\n\n      .identifi-pos {\n        color: #3c763d;\n      }\n\n      .identifi-neg {\n        color: #a94442;\n      }\n\n      .identifi-identicon img {\n        position: absolute;\n        top: 0;\n        left: 0;\n        max-width: 100%;\n        border-radius: 50%;\n        border-color: transparent;\n        border-style: solid;\n      }",document.body.appendChild(t)}},t.prototype.identicon=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];t._injectCss();var r=document.createElement("div");r.className="identifi-identicon",r.style.width=e+"px",r.style.height=e+"px";var s=document.createElement("div");s.className="identifi-pie",s.style.width=e+"px";var o=document.createElement("img");o.alt="",o.width=e,o.style.borderWidth=n+"px";var a=void 0;return i&&((a=document.createElement("span")).className="identifi-distance",a.style.fontSize=e>50?e/4+"px":"10px",r.appendChild(a)),r.appendChild(s),r.appendChild(o),this.gun.on(function(r){if(r){var u="rgba(0,0,0,0.2)",h="none",c="",f="0px 0px 0px 0px #82FF84";r.receivedPositive>20*r.receivedNegative?f="0px 0px "+n*r.receivedPositive/50+"px 0px #82FF84":r.receivedPositive<3*r.receivedNegative&&(f="0px 0px "+n*r.receivedNegative/10+"px 0px #BF0400"),r.receivedPositive+r.receivedNegative>0&&(r.receivedPositive>r.receivedNegative?(c="rotate("+(-r.receivedPositive/(r.receivedPositive+r.receivedNegative)*360-180)/2+"deg)",u="#A94442",h="linear-gradient("+r.receivedPositive/(r.receivedPositive+r.receivedNegative)*360+"deg, transparent 50%, #3C763D 50%), linear-gradient(0deg, #3C763D 50%, transparent 50%)"):(c="rotate("+((-r.receivedNegative/(r.receivedPositive+r.receivedNegative)*360-180)/2+180)+"deg)",u="#3C763D",h="linear-gradient("+r.receivedNegative/(r.receivedPositive+r.receivedNegative)*360+"deg, transparent 50%, #A94442 50%), linear-gradient(0deg, #A94442 50%, transparent 50%)")),s.style.backgroundColor=u,s.style.backgroundImage=h,s.style.boxShadow=f,s.style.transform=c,s.style.opacity=(r.receivedPositive+r.receivedNegative)/10*.5+.35;var l=new Tn({alg:"md5",prov:"cryptojs"}).digestString(Nn(r.linkTo)),d=new Ls(l,{width:e,format:"svg"});o.src="data:image/svg+xml;base64,"+d.toString(),i&&(a.textContent=r.trustDistance<1e3?t._ordinal(r.trustDistance):"â")}}),r},t}(),Ks=W.f,Us=(js=!1,function(t){for(var e,n=T(t),i=G(n),r=i.length,s=0,o=[];r>s;)Ks.call(n,e=i[s++])&&o.push(js?[e,n[e]]:n[e]);return o});E(E.S,"Object",{values:function(t){return Us(t)}});var qs=r.Object.values,$s=e(n(function(t){t.exports={default:qs,__esModule:!0}}));E(E.S,"Number",{isNaN:function(t){return t!=t}});var zs=r.Number.isNaN,Gs=e(n(function(t){t.exports={default:zs,__esModule:!0}})),Js=void 0,Ws=function(){function t(){On(this,t)}return t.getDefault=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:".";if(Js)return Js;if(Ps.isNode){var n=require("fs"),i=e+"/private.key";if(n.existsSync(i)){var r=n.readFileSync(i,"utf8");Js=t.fromJwk(r)}else Js=t.generate(),n.writeFileSync(i,t.toJwk(Js)),n.chmodSync(i,400)}else{var s=window.localStorage.getItem("identifi.myKey");s?Js=t.fromJwk(s):(Js=t.generate(),window.localStorage.setItem("identifi.myKey",t.toJwk(Js)))}return Js},t.toJwk=function(t){return Nn(Pn.getJWKFromKey(t))},t.fromJwk=function(e){var n=Pn.getKey(JSON.parse(e));return n.pubKeyASN1=t._getPubKeyASN1(n),n.keyID=Ps.getHash(n.pubKeyASN1),n},t.generate=function(){var e=Pn.generateKeypair("EC","secp256r1");return e.prvKeyObj.pubKeyASN1=t._getPubKeyASN1(e.pubKeyObj),e.prvKeyObj.keyID=Ps.getHash(e.prvKeyObj.pubKeyASN1),e.prvKeyObj},t._getPubKeyASN1=function(t){"P-256"===t.curveName&&(t.curveName="secp256r1");var e=Pn.getPEM(t);return jn(e)},t}(),Ys=n(function(e){!function(){function n(t){function e(t){return t.split("/").slice(-1).toString().replace(".js","")}return t.slice?n[e(t)]:function(i,r){t(i={exports:{}}),n[e(r)]=i.exports}}var i;"undefined"!=typeof window&&(i=window),void 0!==t&&(i=t);var r=(i=i||{}).console||{log:function(){}},s=e;n(function(t){var e={fn:{is:function(t){return!!t&&"function"==typeof t}}};e.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},e.num={is:function(t){return!i(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},e.text={is:function(t){return"string"==typeof t}},e.text.ify=function(t){return e.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},e.text.random=function(t,e){var n="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)n+=e.charAt(Math.floor(Math.random()*e.length)),t--;return n},e.text.match=function(t,n){var i=!1;if(t=t||"",n=e.text.is(n)?{"=":n}:n||{},e.obj.has(n,"~")&&(t=t.toLowerCase(),n["="]=(n["="]||n["~"]).toLowerCase()),e.obj.has(n,"="))return t===n["="];if(e.obj.has(n,"*")){if(t.slice(0,n["*"].length)!==n["*"])return!1;i=!0,t=t.slice(n["*"].length)}if(e.obj.has(n,"!")){if(t.slice(-n["!"].length)!==n["!"])return!1;i=!0}if(e.obj.has(n,"+")&&e.list.map(e.list.is(n["+"])?n["+"]:[n["+"]],function(e){return!(t.indexOf(e)>=0)||void(i=!0)}))return!1;if(e.obj.has(n,"-")&&e.list.map(e.list.is(n["-"])?n["-"]:[n["-"]],function(e){return!(t.indexOf(e)<0)||void(i=!0)}))return!1;if(e.obj.has(n,">")){if(!(t>n[">"]))return!1;i=!0}if(e.obj.has(n,"<")){if(!(t<n["<"]))return!1;i=!0}if(e.obj.has(n,"?")){if(!function(t,e){for(var n,i=-1,r=0;n=e[r++];)if(!~(i=t.indexOf(n,i+1)))return!1;return!0}(t,n["?"]))return!1;i=!0}return i},e.list={is:function(t){return t instanceof Array}},e.list.slit=Array.prototype.slice,e.list.sort=function(t){return function(e,n){return e&&n?(e=e[t],(n=n[t])>e?-1:e>n?1:0):0}},e.list.map=function(t,e,n){return a(t,e,n)},e.list.index=1,e.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=function(t,e,n){return(t||{})[e]=n,t},e.obj.has=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},e.obj.del=function(t,e){return t?(t[e]=null,delete t[e],t):void 0},e.obj.as=function(t,e,n,i){return t[e]=t[e]||(i===n?{}:n)},e.obj.ify=function(t){if(s(t))return t;try{t=JSON.parse(t)}catch(e){t={}}return t},function(){function t(t,e){o(this,e)&&n!==this[e]||(this[e]=t)}var n;e.obj.to=function(e,n){return a(e,t,n=n||{}),n}}(),e.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,e){var n=this.n;if(!n||!(e===n||s(n)&&o(n,e)))return!!e||void 0}e.obj.empty=function(e,n){return!e||!a(e,t,{n:n})}}(),function(){function t(e,n){return 2===arguments.length?(t.r=t.r||{},void(t.r[e]=n)):(t.r=t.r||[],void t.r.push(e))}var r=Object.keys;e.obj.map=function(a,u,h){var c,f,l,d,p,g=0,v=n(u);if(t.r=null,r&&s(a)&&(d=r(a),p=!0),i(a)||d)for(f=(d||a).length;f>g;g++){var y=g+e.list.index;if(v){if((l=p?u.call(h||this,a[d[g]],d[g],t):u.call(h||this,a[g],y,t))!==c)return l}else if(u===a[p?d[g]:g])return d?d[g]:y}else for(g in a)if(v){if(o(a,g)&&(l=h?u.call(h,a[g],g,t):u(a[g],g,t))!==c)return l}else if(u===a[g])return g;return v?t.r:e.list.index?0:-1}}(),e.time={},e.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var n=e.fn.is,i=e.list.is,r=e.obj,s=r.is,o=r.has,a=r.map;t.exports=e})(n,"./type"),n(function(t){t.exports=function t(e,n,i){if(!e)return{to:t};e=(this.tag||(this.tag={}))[e]||(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}});if(n instanceof Function){var r={off:t.off||(t.off=function(){return this.next===t._.next||(this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,void(this.the.last===this.the&&delete this.on.tag[this.the.tag]))}),to:t._,next:n,the:e,on:this,as:i};return(r.back=e.last||e).to=r,e.last=r}return(e=e.to)&&void 0!==n&&e.next(n),e}})(n,"./onto"),n(function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var e=JSON.stringify;t.exports=function(t,n,i,r,s){if(n>t)return{defer:!0};if(i>n)return{historical:!0};if(n>i)return{converge:!0,incoming:!0};if(n===i){if((r=e(r)||"")===(s=e(s)||""))return{state:!0};if(s>r)return{converge:!0,current:!0};if(r>s)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+r+" to "+s+" at "+n+" to "+i+"!"}}})(n,"./HAM"),n(function(t){var e=n("./type"),i={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(a(t)||s(t)||o(t))||(i.rel.is(t)||!1)))}};i.link=i.rel={_:"#"},function(){function t(t,e){var n=this;return n.id?n.id=!1:e==r&&a(t)?void(n.id=t):n.id=!1}i.rel.is=function(e){if(e&&e[r]&&!e._&&h(e)){var n={};if(f(e,t,n),n.id)return n.id}return!1}}(),i.rel.ify=function(t){return c({},r,t)},e.obj.has._=".";var r=i.link._,s=e.bi.is,o=e.num.is,a=e.text.is,u=e.obj,h=u.is,c=u.put,f=u.map;t.exports=i})(n,"./val"),n(function(t){var e=n("./type"),i=n("./val"),r={_:"_",soul:function(t,e){return t&&t._&&t._[e||c]}};r.soul.ify=function(t,e){return e="string"==typeof e?{soul:e}:e||{},(t=t||{})._=t._||{},t._[c]=e.soul||t._[c]||h(),t},r.soul._=i.link._,function(){function t(t,e){return e!==r._?!i.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s)):void 0}r.is=function(e,n,i){var s;return!(!o(e)||!(s=r.soul(e)))&&!u(e,t,{as:i,cb:n,s:s,n:e})}}(),function(){function t(t,e){var n,r=this.o;return r.map?void(void 0===(n=r.map.call(this.as,t,""+e,r.node))?a(r.node,e):r.node&&(r.node[e]=n)):void(i.is(t)&&(r.node[e]=t))}r.ify=function(e,n,i){return n?"string"==typeof n?n={soul:n}:n instanceof Function&&(n={map:n}):n={},n.map&&(n.node=n.map.call(i,e,void 0,n.node||{})),(n.node=r.soul.ify(n.node||{},n))&&u(e,t,{o:n,as:i}),n.node}}();var s=e.obj,o=s.is,a=s.del,u=s.map,h=e.text.random,c=r.soul._;t.exports=r})(n,"./node"),n(function(t){function e(){var t;return(t=s())>o?(a=0,o=t+e.drift):o=t+(a+=1)/u+e.drift}var i=n("./type"),r=n("./node"),s=i.time.is,o=-1/0,a=0,u=1e3,h="undefined"!=typeof performance&&(performance.timing&&performance);h&&h.timing&&h.timing.navigationStart||(h=!1),e._=">",e.drift=0,e.is=function(t,n,i){var r=n&&t&&t[b]&&t[b][e._]||i;if(r)return y(r=r[n])?r:-1/0},e.lex=function(){return e().toString(36).replace(".","")},e.ify=function(t,n,i,s,o){if(!t||!t[b]){if(!o)return;t=r.soul.ify(t,o)}var a=l(t[b],e._);return c!==n&&n!==b&&(y(i)&&(a[n]=i),c!==s&&(t[n]=s)),t},e.to=function(t,n,i){var s=t[n];return p(s)&&(s=v(s)),e.ify(i,n,e.is(t,n),s,r.soul(t))},function(){function t(t,n){b!==n&&e.ify(this.o,n,this.s)}e.map=function(n,i,r){var s,o=p(o=n||i)?o:null;return n=m(n=n||i)?n:null,o&&!n?(i=y(i)?i:e(),o[b]=o[b]||{},g(o,t,{o:o,s:i}),o):(r=r||p(i)?i:s,i=y(i)?i:e(),function(e,o,a,u){return n?(n.call(r||this||{},e,o,a,u),void(d(a,o)&&s===a[o]||t.call({o:a,s:i},e,o))):(t.call({o:a,s:i},e,o),e)})}}();var c,f=i.obj,l=f.as,d=f.has,p=f.is,g=f.map,v=f.copy,y=i.num.is,m=i.fn.is,b=r._;t.exports=e})(n,"./state"),n(function(t){var e=n("./type"),i=n("./val"),r=n("./node"),s={};!function(){function t(t,n){return!t||n!==r.soul(t)||!r.is(t,this.fn,this.as)||void(this.cb&&(e.n=t,e.as=this.as,this.cb.call(e.as,t,n,e)))}function e(t){t&&r.is(e.n,t,e.as)}s.is=function(e,n,i,r){return!(!e||!u(e)||f(e))&&!d(e,t,{cb:n,fn:i,as:r})}}(),function(){function t(t,e){var s;return(s=function(t,e){for(var n,i=t.seen,r=i.length;r--;)if(n=i[r],e.obj===n.obj)return n;i.push(e)}(t,e))?s:(e.env=t,e.soul=a,r.ify(e.obj,n,e)&&(e.rel=e.rel||i.rel.ify(r.soul(e.node)),e.obj!==t.shell&&(t.graph[i.rel.is(e.rel)]=e.node)),e)}function n(e,n,s){var a,u,l=this,d=l.env;if(r._===n&&c(e,i.rel._))return s._;if(a=f(e,n,s,l,d)){if(n||(l.node=l.node||s||{},c(e,r._)&&r.soul(e)&&(l.node._=p(e._)),l.node=r.soul.ify(l.node,i.rel.is(l.rel)),l.rel=l.rel||i.rel.ify(r.soul(l.node))),(u=d.map)&&(u.call(d.as||{},e,n,s,l),c(s,n))){if(e=s[n],o===e)return void h(s,n);if(!(a=f(e,n,s,l,d)))return}if(!n)return l.node;if(!0===a)return e;if((u=t(d,{obj:e,path:l.path.concat(n)})).node)return u.rel}}function a(t){var e=this,n=i.link.is(e.rel),s=e.env.graph;e.rel=e.rel||i.rel.ify(t),e.rel[i.rel._]=t,e.node&&e.node[r._]&&(e.node[r._][i.rel._]=t),c(s,n)&&(s[t]=s[n],h(s,n))}function f(t,n,r,s,o){var a;return!!i.is(t)||(u(t)?1:(a=o.invalid)?f(t=a.call(o.as||{},t,n,r),n,r,s,o):(o.err="Invalid value at '"+s.path.concat(n).join(".")+"'!",void(e.list.is(t)&&(o.err+=" Use `.set(item)` instead of an Array."))))}s.ify=function(e,n,r){var s={path:[],obj:e};return n?"string"==typeof n?n={soul:n}:n instanceof Function&&(n.map=n):n={},n.soul&&(s.rel=i.rel.ify(n.soul)),n.shell=(r||{}).shell,n.graph=n.graph||{},n.seen=n.seen||[],n.as=n.as||r,t(n,s),n.root=s.node,n.graph}}(),s.node=function(t){var e=r.soul(t);if(e)return l({},e,t)},function(){function t(t,e){var n,o;if(r._!==e)return(n=i.rel.is(t))?(o=this.opt.seen[n])?void(this.obj[e]=o):void(this.obj[e]=this.opt.seen[n]=s.to(this.graph,n,this.opt)):void(this.obj[e]=t);f(t,i.rel._)||(this.obj[e]=p(t))}s.to=function(e,n,i){if(e){var r={};return i=i||{seen:{}},d(e[n],t,{obj:r,graph:e,opt:i}),r}}}();var o,a=(e.fn.is,e.obj),u=a.is,h=a.del,c=a.has,f=a.empty,l=a.put,d=a.map,p=a.copy;t.exports=s})(n,"./graph"),n(function(t){n("./onto"),t.exports=function(t,e){if(this.on){if(!(t instanceof Function)){if(!t||!e)return;var n=t["#"]||t,i=(this.tag||empty)[n];if(!i)return;return i=this.on(n,e),clearTimeout(i.err),!0}n=e&&e["#"]||Math.random().toString(36).slice(2);if(!t)return n;var r=this.on(n,t,e);return r.err=r.err||setTimeout(function(){r.next({err:"Error: No ACK received yet.",lack:!0}),r.off()},(this.opt||{}).lack||9e3),n}}})(n,"./ask"),n(function(t){var e=n("./type"),i=e.time.is;t.exports=function(t){var n={s:{}};return t=t||{max:1e3,age:9e3},n.check=function(t){var e;return!!(e=n.s[t])&&(e.pass?e.pass=!1:n.track(t))},n.track=function(r,s){var o=n.s[r]||(n.s[r]={});return o.was=i(),s&&(o.pass=!0),n.to||(n.to=setTimeout(function(){var r=i();e.obj.map(n.s,function(i,s){t.age>r-i.was||e.obj.del(n.s,s)}),n.to=null},t.age+9)),o},n}})(n,"./dup"),n(function(t){function e(t){return t instanceof e?(this._={gun:this,$:this}).$:this instanceof e?e.create(this._={gun:this,$:this,opt:t}):new e(t)}e.is=function(t){return t instanceof e||t&&t._&&t===t._.$||!1},e.version=.9,e.chain=e.prototype,e.chain.toJSON=function(){};var i=n("./type");i.obj.to(i,e),e.HAM=n("./HAM"),e.val=n("./val"),e.node=n("./node"),e.state=n("./state"),e.graph=n("./graph"),e.on=n("./onto"),e.ask=n("./ask"),e.dup=n("./dup"),function(){function t(n){var i,r,s=this,a=s.as,u=a.at||a,h=u.$;return(r=n["#"])||(r=n["#"]=c(9)),(i=u.dup).check(r)?void(a.out===n.out&&(n.out=o,s.to.next(n))):(i.track(r),u.ask(n["@"],n)||(n.get&&e.on.get(n,h),n.put&&e.on.put(n,h)),s.to.next(n),void(a.out||(n.out=t,u.on("out",n))))}e.create=function(n){n.root=n.root||n,n.graph=n.graph||{},n.on=n.on||e.on,n.ask=n.ask||e.ask,n.dup=n.dup||e.dup();var i=n.$.opt(n.opt);return n.once||(n.on("in",t,n),n.on("out",t,{at:n,out:t}),e.on("create",n),n.on("create",n)),n.once=1,i}}(),function(){function t(t,n,i,r){var s=this,o=e.state.is(i,n);if(!o)return s.err="Error: No state on '"+n+"' in node '"+r+"'!";var a=s.graph[r]||b,u=e.state.is(a,n,!0),h=a[n],c=e.HAM(s.machine,o,u,t,h);return c.incoming?(s.put[r]=e.state.to(i,n,s.put[r]),(s.diff||(s.diff={}))[r]=e.state.to(i,n,s.diff[r]),void(s.souls[r]=!0)):void(c.defer&&(s.defer=o<(s.defer||1/0)?o:s.defer))}function n(t,e){var n=this,o=n.$._,a=(o.next||b)[e];if(!a){if(!(o.opt||b).super)return void(n.souls[e]=!1);a=n.$.get(e)._}var u=n.map[e]={put:t,get:e,$:a.$},h={ctx:n,msg:u};n.async=!!o.tag.node,n.ack&&(u["@"]=n.ack),g(t,i,h),n.async&&(n.and||o.on("node",function(t){this.to.next(t),t===n.map[t.get]&&(n.souls[t.get]=!1,g(t.put,r,t),g(n.souls,function(t){return t||void 0})||n.c||(n.c=1,this.off(),g(n.map,s,n)))}),n.and=!0,o.on("node",u))}function i(t,n){var i=this.ctx,r=i.graph,s=this.msg,o=s.get,a=s.put,u=s.$._;r[o]=e.state.to(a,n,r[o]),i.async||(u.put=e.state.to(a,n,u.put))}function r(t,n){var i=this.put,r=this.$._;r.put=e.state.to(i,n,r.put)}function s(t){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}e.on.put=function(i,r){var a=r._,u={$:r,graph:a.graph,put:{},map:{},souls:{},machine:e.state(),ack:i["@"],cat:a,stop:{}};return e.graph.is(i.put,null,t,u)||(u.err="Error: Invalid graph!"),u.err?a.on("in",{"@":i["#"],err:e.log(u.err)}):(g(u.put,n,u),u.async||g(u.map,s,u),o!==u.defer&&setTimeout(function(){e.on.put(i,r)},u.defer-u.machine),void(u.diff&&a.on("put",p(i,{put:u.diff}))))},e.on.get=function(t,n){var i=n._,r=t.get,s=r[y],o=i.graph[s],a=r[m],u=(i.next||(i.next={}))[s];if(r["*"]){var h={};e.obj.map(i.graph,function(t,n){e.text.match(n,r)&&(h[n]=e.obj.copy(t))}),e.obj.empty(h)||i.on("in",{"@":t["#"],how:"*",put:h,$:n})}if(!o)return i.on("get",t);if(a){if(!d(o,a))return i.on("get",t);o=e.state.to(o,a)}else o=e.obj.copy(o);o=e.graph.node(o),(u||b).ack,i.on("in",{"@":t["#"],how:"mem",put:o,$:n}),i.on("get",t)}}(),e.chain.opt=function(t){t=t||{};var n=this._,i=t.peers||t;return l(t)||(t={}),l(n.opt)||(n.opt=t),h(i)&&(i=[i]),a(i)&&(i=g(i,function(t,e,n){n(t,{url:t})}),l(n.opt.peers)||(n.opt.peers={}),n.opt.peers=p(i,n.opt.peers)),n.opt.peers=n.opt.peers||{},p(t,n.opt),e.on("opt",n),n.opt.uuid=n.opt.uuid||function(){return v()+c(12)},this};var o,a=e.list.is,u=e.text,h=u.is,c=u.random,f=e.obj,l=f.is,d=f.has,p=f.to,g=f.map,v=(f.copy,e.state.lex),y=e.val.rel._,m=".",b=(e.node._,e.val.link.is,{});r.debug=function(t,e){return r.debug.i&&t===r.debug.i&&r.debug.i++&&(r.log.apply(r,arguments)||e)},e.log=function(){return!e.log.off&&r.log.apply(r,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(t,n,i){return(i=e.log.once)[t]=i[t]||0,i[t]++||e.log(n)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.Gun=e).window=window);try{void 0!==s&&(s.exports=e)}catch(t){}t.exports=e})(n,"./root"),n(function(){var t=n("./root");t.chain.back=function(n,r){if(-1===(n=n||1)||1/0===n)return this._.root.$;if(1===n)return(this._.back||this._).$;var s=this._;if("string"==typeof n&&(n=n.split(".")),!(n instanceof Array)){if(n instanceof Function){for(var o,a={back:s};(a=a.back)&&e===(o=n(a,r)););return o}return t.num.is(n)?(s.back||s).$.back(n-1):this}var u=0,h=n.length;for(a=s;h>u;u++)a=(a||i)[n[u]];return e!==a?r?this:a:(a=s.back)?a.$.back(n,r):void 0};var e,i={}})(n,"./back"),n(function(){function t(t){var e,n,i,r=this.as,s=r.back,o=r.root;if(t.I||(t.I=r.$),t.$||(t.$=r.$),this.to.next(t),n=t.get){if(n["#"]||r.soul){if(n["#"]=n["#"]||r.soul,t["#"]||(t["#"]=y(9)),s=o.$.get(n["#"])._,n=n["."]){if(d(s.put,n)&&((i=(e=s.$.get(n)._).ack)||(e.ack=-1),s.on("in",{$:s.$,put:h.state.to(s.put,n),get:s.get}),i))return}else{if((i=s.ack)||(s.ack=-1),d(s,"put")&&s.on("in",s),i)return;t.$=s.$}return o.ask(u,t),o.on("in",t)}if(o.now&&(o.now[r.id]=o.now[r.id]||!0,r.pass={}),n["."])return r.get?(t={get:{".":r.get},$:r.$},s.ask||(s.ask={}),s.ask[r.get]=t.$._,s.on("out",t)):(t={get:{},$:r.$},s.on("out",t));if(r.ack=r.ack||-1,r.get)return t.$=r.$,n["."]=r.get,(s.ask||(s.ask={}))[r.get]=t.$._,s.on("out",t)}return s.on("out",t)}function e(t){var e,n,s=this,u=s.as,l=u.root,y=(t.$||f)._||f,m=t.put;if(u.get&&t.get!==u.get&&(t=g(t,{get:u.get})),u.has&&y!==u&&(t=g(t,{$:u.$}),y.ack&&(u.ack=y.ack)),c===m){if(n=y.put,s.to.next(t),u.soul)return;if(c===n&&c!==y.put)return;return r(u,t),u.has&&a(u,t),p(y.echo,u.id),void p(u.map,y.id)}return u.soul?(s.to.next(t),r(u,t),void(u.next&&v(m,o,{msg:t,cat:u}))):(e=h.val.link.is(m))?(l.stop,(n=(n=l.stop||{})[y.id]||(n[y.id]={})).is=n.is||y.put,n[u.id]=y.put||!0,s.to.next(t),i(u,t,y,e),void r(u,t)):h.val.is(m)?(u.has||u.soul?a(u,t):(y.has||y.soul)&&((y.echo||(y.echo={}))[u.id]=y.echo[y.id]||u,(u.map||(u.map={}))[y.id]=u.map[y.id]||{at:y}),s.to.next(t),void r(u,t)):(u.has&&y!==u&&d(y,"put")&&(u.put=y.put),(e=h.node.soul(m))&&y.has&&(y.put=u.root.$.get(e)._.put),n=(l.stop||{})[y.id],s.to.next(t),i(u,t,y,e),r(u,t),void(u.next&&v(m,o,{msg:t,cat:u})))}function i(t,e,n,r){if(r&&m!==t.get){var s=t.root.$.get(r)._;t.has?n=s:n.has&&i(n,e,n,r),n!==t&&(n.$||(n={}),(n.echo||(n.echo={}))[t.id]=n.echo[t.id]||t,t.has&&!(t.map||f)[n.id]&&a(t,e),(r!==(s=n.id?(t.map||(t.map={}))[n.id]=t.map[n.id]||{at:n}:{}).link||s.pass||t.pass)&&(t.pass&&(h.obj.map(t.map,function(t){t.pass=!0}),p(t,"pass")),s.pass&&p(s,"pass"),t.has&&(t.link=r),function(t,e){var n=t.root.$.get(e)._;(!t.ack||(n.on("out",{get:{"#":e}}),t.ask))&&(n=t.ask,h.obj.del(t,"ask"),v(n||t.next,function(t,n){t.on("out",{get:{"#":e,".":n}})}),h.obj.del(t,"ask"))}(t,s.link=r)))}}function r(t,e){t.echo&&v(t.echo,s,e)}function s(t){t&&t.on&&t.on("in",this)}function o(t,e){var n,i,r,s=this.cat.next||f,o=this.msg;(m!==e||s[e])&&(i=s[e])&&(i.has?(c!==i.put&&h.val.link.is(t)||(i.put=t),n=i.$):(r=o.$)&&(r=(n=o.$.get(e))._,c!==r.put&&h.val.link.is(t)||(r.put=t)),i.on("in",{put:t,get:e,$:n,via:o}))}function a(t,e){if(t.has||t.soul){var n=t.map;t.root,t.map=null,t.has&&(t.link=null),(t.pass||e["@"]||null!==n)&&(c===n&&h.val.link.is(t.put)||(v(n,function(e){(e=e.at)&&p(e.echo,t.id)}),n=t.put,v(t.next,function(e,i){return c===n&&c!==t.put||(e.put=c,e.ack&&(e.ack=-1),void e.on("in",{get:i,$:e.$,put:c}))})))}}function u(t){var e=this.as,n=e.get||f,i=e.$._,r=(t.put||f)[n["#"]];if(i.ack&&(i.ack=i.ack+1||1),t.put&&(!n["."]||d(r,i.get)))return m==n["."]?void i.on("in",{get:i.get,put:h.val.link.ify(n["#"]),$:i.$,"@":t["@"]}):(t.$=i.root.$,void h.on.put(t,i.root.$));i.put===c&&i.on("in",{get:i.get,put:i.put=c,$:i.$,"@":t["@"]})}var h=n("./root");h.chain.chain=function(n){var i,r=this,s=r._,o=new(n||r).constructor(r),a=o._;return a.root=i=s.root,a.id=++i.once,a.back=r._,a.on=h.on,a.on("in",e,a),a.on("out",t,a),o};var c,f={},l=h.obj,d=l.has,p=(l.put,l.del),g=l.to,v=l.map,y=h.text.random,m=(h.val.rel._,h.node._)})(n,"./chain"),n(function(){function t(t,e,n,i){var r,s=t._;return(r=s.soul)?(e(r,i,s),t):(r=s.link)?(e(r,i,s),t):(t.get(function(t,n){n.rid(t);var s=(s=t.$)&&s._||{};r=s.link||s.soul||u.is(t.put)||h(t.put),e(r,i,t,n)},{out:{get:{".":!0}}}),t)}function e(t){var e,n=this,i=n.as,r=i.at.root,a=(t.$||{})._||{},h=t.put||a.put;if((e=r.now)&&n!==e[i.now])return n.to.next(t);if(n.seen&&a.id&&n.seen[a.id])return n.to.next(t);if((e=h)&&e[u._]&&(e=u.is(e))&&(e=(t.$$=a.root.gun.get(e))._,s!==e.put&&(t=o(t,{put:h=e.put}))),(e=r.mum)&&a.id){if(e[a.id])return;s===h||u.is(h)||(e[a.id]=!0)}return i.use(t,n),n.stun?void(n.stun=null):void n.to.next(t)}function i(t){var e,n=this.on;return!t||n.soul||n.has?this.off():(t=(t=(t=t.$||t)._||t).id)?(n.map,!!(e=this.seen||(this.seen={}))[t]||void(e[t]=!0)):void 0}var r=n("./root");r.chain.get=function(n,s,o){var h;if("string"!=typeof n){if(n instanceof Function){if(!0===s)return t(this,n,0,o);var f,l=(h=this)._,d=l.root,p=d.now;(o=s||{}).at=l,o.use=n,o.out=o.out||{},o.out.get=o.out.get||{},(f=l.on("in",e,o)).rid=i,(d.now={$:1})[o.now=l.id]=f;var g=d.mum;return d.mum={},l.on("out",o.out),d.mum=g,d.now=p,h}return a(n)?this.get(""+n,s,o):(p=u.is(n))?this.get(p,s,o):((o=this.chain())._.err={err:r.log("Invalid get request!",n)},s&&s.call(o,o._.err),o)}var v=this._;return(h=(v.next||c)[n])||(h=function(t,e){var n=e._,i=n.next,r=e.chain()._;return i||(i=n.next={}),i[r.get=t]=r,e===n.root.$?r.soul=t:(n.soul||n.has)&&(r.has=t),r}(n,this)),h=h.$,(p=v.stun)&&(h._.stun=h._.stun||p),s&&s instanceof Function&&h.get(s,o),h};var s,o=(r.obj.has,r.obj.to),a=r.num.is,u=r.val.link,h=r.node.soul,c=(r.node._,{})})(n,"./get"),n(function(){function t(t){t.batch=i;var e=t.opt||{},n=t.env=c.state.map(o,e.state);return n.soul=t.soul,t.graph=c.graph.ify(t.data,n,t),n.err?((t.ack||y).call(t,t.out={err:c.log(n.err)}),void(t.res&&t.res())):void t.batch()}function e(t){t&&t()}function i(){var t=this;t.graph&&!g(t.stun,s)&&(t.res=t.res||function(t){t&&t()},t.res(function(){var e=t.$.back(-1)._,n=e.ask(function(n){e.root.on("ack",n),n.err&&c.log(n),n.lack||this.off(),t.ack&&t.ack(n,this)},t.opt),i=e.root.now;l.del(e.root,"now");var r=e.root.mum;e.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":n}),e.root.mum=r?l.to(r,e.root.mum):r,e.root.now=i},t),t.res&&t.res())}function s(t){return!!t||void 0}function o(t,e,n,i){var r=this,s=c.is(t);!e&&i.path.length&&(r.res||m)(function(){for(var e=i.path,n=r.ref,o=(r.opt,0),u=e.length;u>o;o++)n=n.get(e[o]);s&&(n=t);var h=n._.dub;return h||(h=c.node.soul(i.obj))?(n.back(-1).get(h),void i.soul(h)):((r.stun=r.stun||{})[e]=!0,void n.get(a,!0,{as:{at:i,as:r,p:e}}))},{as:r,at:i})}function a(t,e,n,i){var r=(e=e.as).at;e=e.as;var s=((n||{}).$||{})._||{};return t=s.dub=s.dub||t||c.node.soul(r.obj)||c.node.soul(n.put||s.put)||c.val.rel.is(n.put||s.put)||(e.via.back("opt.uuid")||c.text.random)(),i&&(i.stun=!0),t?void u(s,s.dub=t,r,e):void s.via.back("opt.uuid")(function(t,n){return t?c.log(t):void u(s,s.dub=s.dub||n,r,e)})}function u(t,e,n,i){t.$.back(-1).get(e),n.soul(e),i.stun[n.path]=!1,i.batch()}function h(t,e,n,i){if(e=e.as,n.$&&n.$._){if(n.err)return void r.log("Please report this as an issue! Put.any.err");var s,o=n.$._,a=o.put,u=e.opt||{};if(!(s=e.ref)||!s._.now){if(i&&(i.stun=!0),e.ref!==e.$){if(!(s=e.$._.get||o.get))return void r.log("Please report this as an issue! Put.no.get");e.data=p({},s,e.data),s=null}if(f===a){if(!o.get)return;t||(s=o.$.back(function(t){return t.link||t.soul?t.link||t.soul:void(e.data=p({},t.get,e.data))})),s=s||o.get,o=o.root.$.get(s)._,e.soul=s,a=e.data}return e.not||(e.soul=e.soul||t)||(e.path&&d(e.data)?e.soul=(u.uuid||e.via.back("opt.uuid")||c.text.random)():(b==o.get&&(e.soul=(o.put||v)["#"]||o.dub),e.soul=e.soul||o.soul||o.soul||(u.uuid||e.via.back("opt.uuid")||c.text.random)()),e.soul)?void e.ref.put(e.data,e.soul,e):void e.via.back("opt.uuid")(function(t,n){return t?c.log(t):void e.ref.put(e.data,e.soul=n,e)})}}}var c=n("./root");c.chain.put=function(n,i,r){var s,o=this,a=o._,u=a.root.$;return(r=r||{}).data=n,r.via=r.$=r.via||r.$||o,"string"==typeof i?r.soul=i:r.ack=r.ack||i,a.soul&&(r.soul=a.soul),r.soul||u===o?d(r.data)?(r.soul=r.soul||(r.not=c.node.soul(r.data)||(r.via.back("opt.uuid")||c.text.random)()),r.soul?(r.$=o=u.get(r.soul),r.ref=r.$,t(r),o):(r.via.back("opt.uuid")(function(t,e){return t?c.log(t):void(r.ref||r.$).put(r.data,r.soul=e,r)}),o)):((r.ack||y).call(r,r.out={err:c.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),o):c.is(n)?(n.get(function(t,e,n){return!t&&c.val.is(n.put)?c.log("The reference you are saving is a",typeof n.put,'"'+n.put+'", not a node (object)!'):void o.put(c.val.rel.ify(t),i,r)},!0),o):(r.ref=r.ref||u._===(s=a.back)?o:s.$,r.ref._.soul&&c.val.is(r.data)&&a.get?(r.data=p({},a.get,r.data),r.ref.put(r.data,r.soul,r),o):(r.ref.get(h,!0,{as:r}),r.out||(r.res=r.res||e,r.$._.stun=r.ref._.stun),o))};var f,l=c.obj,d=l.is,p=l.put,g=l.map,v={},y=function(){},m=function(t,e){t.call(e||v)},b=c.node._})(n,"./put"),n(function(t){var e=n("./root");n("./chain"),n("./back"),n("./put"),n("./get"),t.exports=e})(n,"./index"),n(function(){function t(t,e){var n,i=this,s=t.$,o=((s||{})._||{}).put||t.put;if(i.at,r!==o){if(n=t.$$){if(n=t.$$._,r===n.put)return;o=n.put}i.change&&(o=t.put),i.as?i.ok.call(i.as,t,e):i.ok.call(s,o,t.get,t,e)}}function e(t,n,i){var s,o,a=this.as,u=(a.at,t.$),h=u._,c=h.put||t.put;if(o=t.$$){if(s=o=t.$$._,r===o.put)return;c=o.put}return(o=n.wait)&&(o=o[h.id])&&clearTimeout(o),i||r!==c&&!h.soul&&!h.link&&(!s||0<s.ack)?(n.rid(t),void a.ok.call(u||a.$,c,t.get)):void(o=(n.wait={})[h.id]=setTimeout(function(){e.call({as:a},t,n,o||1)},a.wait||99))}var i=n("./index");i.chain.on=function(e,n,i,r){var s,o=this,a=o._;if("string"==typeof e)return n?(s=a.on(e,n,i||a,r),i&&i.$&&(i.subs||(i.subs=[])).push(s),o):a.on(e);var u=n;return(u=!0===u?{change:!0}:u||{}).at=a,u.ok=e,o.get(t,u),o},i.chain.val=function(t,e){return i.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,e)},i.chain.once=function(t,n){var s=this,o=s._,a=o.put;if(0<o.ack&&r!==a)return(t||u).call(s,a,o.get),s;if(!t){i.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var h=s.chain();return h._.nix=s.once(function(){h._.on("in",s._)}),h}return(n=n||{}).ok=t,n.at=o,n.out={"#":i.text.random(9)},s.get(e,{as:n}),n.async=!0,s},i.chain.off=function(){var t,e=this._,n=e.back;return n?((t=n.next)&&t[e.get]&&a(t,e.get),(t=n.ask)&&a(t,e.get),(t=n.put)&&a(t,e.get),(t=e.soul)&&a(n.root.graph,t),(t=e.map)&&o(t,function(t){t.link&&n.root.$.get(t.link).off()}),(t=e.next)&&o(t,function(t){t.$.off()}),e.on("off",{}),this):void 0};var r,s=i.obj,o=s.map,a=(s.has,s.del),u=(s.to,i.val.link,function(){})})(n,"./on"),n(function(){function t(t){return!t.put||i.val.is(t.put)?this.to.next(t):(this.as.nix&&this.off(),r(t.put,e,{at:this.as,msg:t}),void this.to.next(t))}function e(t,e){if(o!==e){var n=this.msg.$,i=this.at,r=n.get(e)._;(r.echo||(r.echo={}))[i.id]=r.echo[i.id]||i}}var i=n("./index");i.chain.map=function(e){var n,r=this,o=r._;return e?(i.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),n=r.chain(),r.map().on(function(t,r,o,a){var u=(e||s).call(this,t,r,o,a);if(void 0!==u)return t===u?n._.on("in",o):i.is(u)?n._.on("in",u._):void n._.on("in",{get:r,put:u})}),n):(n=o.each)?n:(o.each=n=r.chain(),n._.nix=r.back("nix"),r.on("in",t,n._),n)};var r=i.obj.map,s=function(){},o=i.node._})(n,"./map"),n(function(){var t=n("./index");t.chain.set=function(e,n,i){var r,s=this;if(n=n||function(){},(i=i||{}).item=i.item||e,r=t.node.soul(e))return s.set(s.back(-1).get(r),n,i);if(!t.is(e)){var o=s.back("opt.uuid")();return o&&t.obj.is(e)?s.set(s._.root.$.put(e,o),n,i):s.get(t.state.lex()+t.text.random(7)).put(e,n,i)}return e.get(function(e,r,o){return e?void s.put(t.obj.put({},e,t.val.link.ify(e)),n,i):n.call(s,{err:t.log('Only a node can be linked! Not "'+o.put+'"!')})},!0),e}})(n,"./set"),n(function(){if("undefined"!=typeof Gun){var t,e=function(){};"undefined"!=typeof window&&(t=window);var n=t.localStorage||{setItem:e,removeItem:e,getItem:e};Gun.on("create",function(t){function e(t){if(!t.err&&t.ok){var e=t["@"];setTimeout(function(){Gun.obj.map(a,function(t,n){Gun.obj.map(t,function(n,i){e===n&&delete t[i]}),u(t)&&delete a[n]}),l()},r.wait||1)}}var i=this.to,r=t.opt;if(t.once)return i.next(t);r.prefix=r.file||"gun/";var s,o,a=Gun.obj.ify(n.getItem("gap/"+r.prefix))||{},u=Gun.obj.empty;if(!u(a)){var h=Gun.obj.ify(n.getItem(r.prefix))||{},c={};Gun.obj.map(a,function(t,e){Gun.obj.map(t,function(t,n){c[e]=Gun.state.to(h[e],n,c[e])})}),setTimeout(function(){t.on("out",{put:c,"#":t.ask(e),I:t.$})},1)}t.on("out",function(t){t.lS||(t.I&&t.put&&!t["@"]&&!u(r.peers)&&(s=t["#"],Gun.graph.is(t.put,null,f),o||(o=setTimeout(l,r.wait||1))),this.to.next(t))}),t.on("ack",e),i.next(t);var f=function(t,e,n,i){(a[i]||(a[i]={}))[e]=s},l=function(){clearTimeout(o),o=!1;try{n.setItem("gap/"+r.prefix,JSON.stringify(a))}catch(t){Gun.log(err=t||"localStorage failure")}}}),Gun.on("create",function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";var i,r=(t.graph,{}),s=0,o=Gun.obj.ify(n.getItem(e.prefix))||{};t.on("localStorage",o),t.on("put",function(t){return this.to.next(t),Gun.graph.is(t.put,null,a),t["@"]||(r[t["#"]]=!0),(s+=1)>=(e.batch||1e3)?u():void(i||(i=setTimeout(u,e.wait||1)))}),t.on("get",function(n){function i(){if(u&&(r=u["#"])){var i=u["."];(s=o[r]||a)&&i&&(s=Gun.state.to(s,i)),(s||Gun.obj.empty(e.peers))&&t.on("in",{"@":n["#"],put:Gun.graph.node(s),how:"lS",lS:n.I})}}this.to.next(n);var r,s,a,u=n.get;Gun.debug?setTimeout(i,1):i()});var a=function(t,e,n,i){o[i]=Gun.state.to(n,e,o[i])},u=function(a){var h;s=0,clearTimeout(i),i=!1;var c=r;r={},a&&(o=a);try{n.setItem(e.prefix,JSON.stringify(o))}catch(n){Gun.log(h=n||"localStorage failure"),t.on("localStorage:error",{err:h,file:e.prefix,flush:o,retry:u})}(h||Gun.obj.empty(e.peers))&&Gun.obj.map(c,function(e,n){t.on("in",{"@":n,err:h,ok:0})})}}})}})(n,"./adapters/localStorage"),n(function(t){function e(t){var n=function(){},a=t.opt;return n.out=function(e){var i;return this.to&&this.to.next(e),(i=e["@"])&&(i=t.dup.s[i])&&(i=i.it)&&i.mesh?(n.say(e,i.mesh.via,1),void(i["##"]=e["##"])):void n.say(e)},t.on("create",function(e){e.opt.pid=e.opt.pid||i.text.random(9),this.to.next(e),t.on("out",n.out)}),n.hear=function(e,s){if(e){var o,a,u,h=t.dup,c=e[0];try{u=JSON.parse(e)}catch(t){r.log("DAM JSON parse error",t)}if("{"===c){if(!u)return;if(h.check(o=u["#"]))return;if(h.track(o,!0).it=u,(c=u["@"])&&u.put&&(c+=a=u["##"]||(u["##"]=n.hash(u)))!=o){if(h.check(c))return;(c=h.s)[a]=c[o]}return(u.mesh=function(){}).via=s,(c=u["><"])&&(u.mesh.to=i.obj.map(c.split(","),function(t,e,n){n(t,!0)})),u.dam?void((c=n.hear[u.dam])&&c(u,s,t)):void t.on("in",u)}if("["!==c);else{if(!u)return;for(var f,l=0;f=u[l++];)n.hear(f,s)}}},function(){function e(t,e){var n=e.wire;try{n.send?n.send(t):e.say&&e.say(t)}catch(n){(e.queue=e.queue||[]).push(t)}}n.say=function(r,s,u){var h,c,f;if(s){if((s.wire||a.wire&&a.wire(s))&&(c=r.mesh||o,s!==c.via&&((f=c.raw)||(f=n.raw(r)),!((h=r["@"])&&(h=t.dup.s[h])&&(h=h.it)&&h.get&&h["##"]&&h["##"]===r["##"]||(h=c.to)&&(h[s.url]||h[s.id])&&!u)))){if(s.batch)return void s.batch.push(f);s.batch=[],setTimeout(function(){var t=s.batch;t&&(s.batch=null,t.length&&e(JSON.stringify(t),s))},a.gap||a.wait||1),e(f,s)}}else i.obj.map(a.peers,function(t){n.say(r,t)})}}(),function(){function r(t,e){var n;return e instanceof Object?(i.obj.map(Object.keys(e).sort(),o,{to:n={},on:e}),n):e}function o(t){this.to[t]=this.on[t]}n.raw=function(e){if(!e)return"";var o,c,f,l=t.dup,d=e.mesh||{};if(f=d.raw)return f;if("string"==typeof e)return e;e["@"]&&(f=e.put)&&((c=e["##"])||(o=u(f,r)||"",c=n.hash(e,o),e["##"]=c),(f=l.s)[c=e["@"]+c]=f[e["#"]],e["#"]=c||e["#"],o&&((e=i.obj.to(e)).put=h));var p=0,g=[];i.obj.map(a.peers,function(t){return g.push(t.url||t.id),++p>9||void 0}),e["><"]=g.join();var v=u(e);return s!==o&&(f=v.indexOf(h,v.indexOf("put")),v=v.slice(0,f-1)+o+v.slice(f+h.length+1)),d&&(d.raw=v),v},n.hash=function(t,n){return e.hash(n||u(t.put,r)||"")||t["#"]||i.text.random(9)};var u=JSON.stringify,h=":])([:"}(),n.hi=function(e){var r=e.wire||{};e.id||e.url?(a.peers[e.url||e.id]=e,i.obj.del(a.peers,r.id)):(r=r.id=r.id||i.text.random(9),n.say({dam:"?"},a.peers[r]=e)),r.hied||t.on(r.hied="hi",e),r=e.queue,e.queue=[],i.obj.map(r,function(t){n.say(t,e)})},n.bye=function(e){i.obj.del(a.peers,e.id),t.on("bye",e)},n.hear["?"]=function(t,e){return t.pid?(e.id=e.id||t.pid,void n.hi(e)):n.say({dam:"?",pid:a.pid,"@":t["#"]},e)},n}var i=n("../type");e.hash=function(t){if("string"!=typeof t)return{err:1};var e=0;if(!t.length)return e;for(var n=0,i=t.length;i>n;++n)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e};var s,o={};Object.keys=Object.keys||function(t){return map(t,function(t,e,n){n(e)})};try{t.exports=e}catch(t){}})(n,"./adapters/mesh"),n(function(){var e=n("../index");e.Mesh=n("./mesh"),e.on("opt",function(n){function i(t){if(!t||!t.url)return n&&n(t);var e=t.url.replace("http","ws"),n=t.wire=new s.WebSocket(e);return n.onclose=function(){s.mesh.bye(t),r(t)},n.onerror=function(e){r(t),e&&e.code},n.onopen=function(){s.mesh.hi(t)},n.onmessage=function(e){e&&s.mesh.hear(e.data||e,t)},n}function r(t){clearTimeout(t.defer),t.defer=setTimeout(function(){i(t)},2e3)}this.to.next(n);var s=n.opt;if(!n.once&&!1!==s.WebSocket){var o;"undefined"!=typeof window&&(o=window),void 0!==t&&(o=t),o=o||{};var a=s.WebSocket||o.WebSocket||o.webkitWebSocket||o.mozWebSocket;a&&(s.WebSocket=a,s.mesh=s.mesh||e.Mesh(n),s.wire,s.wire=i)}})})(n,"./adapters/websocket")}()}),Xs=n(function(e){!function(){var n;"undefined"!=typeof window&&(n=window),void 0!==t&&(n=t);var i=(n=n||{}).console||{log:function(){}};function r(t){return t.slice?r[e(t)]:function(n,i){t(n={exports:{}}),r[e(i)]=n.exports};function e(t){return t.split("/").slice(-1).toString().replace(".js","")}}var s=e;r(function(t){var e={fn:{is:function(t){return!!t&&"function"==typeof t}}};e.bi={is:function(t){return t instanceof Boolean||"boolean"==typeof t}},e.num={is:function(t){return!i(t)&&(t-parseFloat(t)+1>=0||1/0===t||-1/0===t)}},e.text={is:function(t){return"string"==typeof t}},e.text.ify=function(t){return e.text.is(t)?t:"undefined"!=typeof JSON?JSON.stringify(t):t&&t.toString?t.toString():t},e.text.random=function(t,e){var n="";for(t=t||24,e=e||"0123456789ABCDEFGHIJKLMNOPQRSTUVWXZabcdefghijklmnopqrstuvwxyz";t>0;)n+=e.charAt(Math.floor(Math.random()*e.length)),t--;return n},e.text.match=function(t,n){var i=!1;if(t=t||"",n=e.text.is(n)?{"=":n}:n||{},e.obj.has(n,"~")&&(t=t.toLowerCase(),n["="]=(n["="]||n["~"]).toLowerCase()),e.obj.has(n,"="))return t===n["="];if(e.obj.has(n,"*")){if(t.slice(0,n["*"].length)!==n["*"])return!1;i=!0,t=t.slice(n["*"].length)}if(e.obj.has(n,"!")){if(t.slice(-n["!"].length)!==n["!"])return!1;i=!0}if(e.obj.has(n,"+")&&e.list.map(e.list.is(n["+"])?n["+"]:[n["+"]],function(e){if(!(t.indexOf(e)>=0))return!0;i=!0}))return!1;if(e.obj.has(n,"-")&&e.list.map(e.list.is(n["-"])?n["-"]:[n["-"]],function(e){if(!(t.indexOf(e)<0))return!0;i=!0}))return!1;if(e.obj.has(n,">")){if(!(t>n[">"]))return!1;i=!0}if(e.obj.has(n,"<")){if(!(t<n["<"]))return!1;i=!0}if(e.obj.has(n,"?")){if(!function(t,e){for(var n,i=-1,r=0;n=e[r++];)if(!~(i=t.indexOf(n,i+1)))return!1;return!0}(t,n["?"]))return!1;i=!0}return i},e.list={is:function(t){return t instanceof Array}},e.list.slit=Array.prototype.slice,e.list.sort=function(t){return function(e,n){return e&&n?(e=e[t])<(n=n[t])?-1:e>n?1:0:0}},e.list.map=function(t,e,n){return a(t,e,n)},e.list.index=1,e.obj={is:function(t){return!!t&&(t instanceof Object&&t.constructor===Object||"Object"===Object.prototype.toString.call(t).match(/^\[object (\w+)\]$/)[1])}},e.obj.put=function(t,e,n){return(t||{})[e]=n,t},e.obj.has=function(t,e){return t&&Object.prototype.hasOwnProperty.call(t,e)},e.obj.del=function(t,e){if(t)return t[e]=null,delete t[e],t},e.obj.as=function(t,e,n,i){return t[e]=t[e]||(i===n?{}:n)},e.obj.ify=function(t){if(s(t))return t;try{t=JSON.parse(t)}catch(e){t={}}return t},function(){var t;function n(e,n){o(this,n)&&t!==this[n]||(this[n]=e)}e.obj.to=function(t,e){return a(t,n,e=e||{}),e}}(),e.obj.copy=function(t){return t?JSON.parse(JSON.stringify(t)):t},function(){function t(t,e){var n=this.n;if(!n||!(e===n||s(n)&&o(n,e)))return!!e||void 0}e.obj.empty=function(e,n){return!e||!a(e,t,{n:n})}}(),function(){function t(e,n){if(2===arguments.length)return t.r=t.r||{},void(t.r[e]=n);t.r=t.r||[],t.r.push(e)}var r=Object.keys;e.obj.map=function(a,u,h){var c,f,l,d,p,g=0,v=n(u);if(t.r=null,r&&s(a)&&(d=r(a),p=!0),i(a)||d)for(f=(d||a).length;g<f;g++){var y=g+e.list.index;if(v){if((l=p?u.call(h||this,a[d[g]],d[g],t):u.call(h||this,a[g],y,t))!==c)return l}else if(u===a[p?d[g]:g])return d?d[g]:y}else for(g in a)if(v){if(o(a,g)&&(l=h?u.call(h,a[g],g,t):u(a[g],g,t))!==c)return l}else if(u===a[g])return g;return v?t.r:e.list.index?0:-1}}(),e.time={},e.time.is=function(t){return t?t instanceof Date:+(new Date).getTime()};var n=e.fn.is,i=e.list.is,r=e.obj,s=r.is,o=r.has,a=r.map;t.exports=e})(r,"./type"),r(function(t){t.exports=function t(e,n,i){if(!e)return{to:t};e=(this.tag||(this.tag={}))[e]||(this.tag[e]={tag:e,to:t._={next:function(t){var e;(e=this.to)&&e.next(t)}}});if(n instanceof Function){var r={off:t.off||(t.off=function(){if(this.next===t._.next)return!0;this===this.the.last&&(this.the.last=this.back),this.to.back=this.back,this.next=t._.next,this.back.to=this.to,this.the.last===this.the&&delete this.on.tag[this.the.tag]}),to:t._,next:n,the:e,on:this,as:i};return(r.back=e.last||e).to=r,e.last=r}return(e=e.to)&&void 0!==n&&e.next(n),e}})(r,"./onto"),r(function(t){if("undefined"==typeof JSON)throw new Error("JSON is not included in this browser. Please load it first: ajax.cdnjs.com/ajax/libs/json2/20110223/json2.js");var e=JSON.stringify;t.exports=function(t,n,i,r,s){if(t<n)return{defer:!0};if(n<i)return{historical:!0};if(i<n)return{converge:!0,incoming:!0};if(n===i){if((r=e(r)||"")===(s=e(s)||""))return{state:!0};if(r<s)return{converge:!0,current:!0};if(s<r)return{converge:!0,incoming:!0}}return{err:"Invalid CRDT Data: "+r+" to "+s+" at "+n+" to "+i+"!"}}})(r,"./HAM"),r(function(t){var e=r("./type"),n={is:function(t){return void 0!==t&&(null===t||t!==1/0&&(!!(a(t)||s(t)||o(t))||(n.rel.is(t)||!1)))}};n.link=n.rel={_:"#"},function(){function t(t,e){var n=this;return n.id?n.id=!1:e==i&&a(t)?void(n.id=t):n.id=!1}n.rel.is=function(e){if(e&&e[i]&&!e._&&h(e)){var n={};if(f(e,t,n),n.id)return n.id}return!1}}(),n.rel.ify=function(t){return c({},i,t)},e.obj.has._=".";var i=n.link._,s=e.bi.is,o=e.num.is,a=e.text.is,u=e.obj,h=u.is,c=u.put,f=u.map;t.exports=n})(r,"./val"),r(function(t){var e=r("./type"),n=r("./val"),i={_:"_",soul:function(t,e){return t&&t._&&t._[e||c]}};i.soul.ify=function(t,e){return e="string"==typeof e?{soul:e}:e||{},(t=t||{})._=t._||{},t._[c]=e.soul||t._[c]||h(),t},i.soul._=n.link._,function(){function t(t,e){if(e!==i._)return!n.is(t)||void(this.cb&&this.cb.call(this.as,t,e,this.n,this.s))}i.is=function(e,n,r){var s;return!!o(e)&&(!!(s=i.soul(e))&&!u(e,t,{as:r,cb:n,s:s,n:e}))}}(),function(){function t(t,e){var i,r=this.o;r.map?void 0===(i=r.map.call(this.as,t,""+e,r.node))?a(r.node,e):r.node&&(r.node[e]=i):n.is(t)&&(r.node[e]=t)}i.ify=function(e,n,r){return n?"string"==typeof n?n={soul:n}:n instanceof Function&&(n={map:n}):n={},n.map&&(n.node=n.map.call(r,e,void 0,n.node||{})),(n.node=i.soul.ify(n.node||{},n))&&u(e,t,{o:n,as:r}),n.node}}();var s=e.obj,o=s.is,a=s.del,u=s.map,h=e.text.random,c=i.soul._;t.exports=i})(r,"./node"),r(function(t){var e=r("./type"),n=r("./node");function i(){var t;return t=s(),o<t?(a=0,o=t+i.drift):o=t+(a+=1)/u+i.drift}var s=e.time.is,o=-1/0,a=0,u=1e3,h="undefined"!=typeof performance&&(performance.timing&&performance);h&&h.timing&&h.timing.navigationStart||(h=!1);i._=">",i.drift=0,i.is=function(t,e,n){var r=e&&t&&t[b]&&t[b][i._]||n;if(r)return y(r=r[e])?r:-1/0},i.lex=function(){return i().toString(36).replace(".","")},i.ify=function(t,e,r,s,o){if(!t||!t[b]){if(!o)return;t=n.soul.ify(t,o)}var a=l(t[b],i._);return c!==e&&e!==b&&(y(r)&&(a[e]=r),c!==s&&(t[e]=s)),t},i.to=function(t,e,r){var s=t[e];return p(s)&&(s=v(s)),i.ify(r,e,i.is(t,e),s,n.soul(t))},function(){function t(t,e){b!==e&&i.ify(this.o,e,this.s)}i.map=function(e,n,r){var s,o=p(o=e||n)?o:null;return e=m(e=e||n)?e:null,o&&!e?(n=y(n)?n:i(),o[b]=o[b]||{},g(o,t,{o:o,s:n}),o):(r=r||p(n)?n:s,n=y(n)?n:i(),function(i,o,a,u){if(!e)return t.call({o:a,s:n},i,o),i;e.call(r||this||{},i,o,a,u),d(a,o)&&s===a[o]||t.call({o:a,s:n},i,o)})}}();var c,f=e.obj,l=f.as,d=f.has,p=f.is,g=f.map,v=f.copy,y=e.num.is,m=e.fn.is,b=n._;t.exports=i})(r,"./state"),r(function(t){var e=r("./type"),n=r("./val"),i=r("./node"),s={};!function(){function t(t,n){if(!t||n!==i.soul(t)||!i.is(t,this.fn,this.as))return!0;this.cb&&(e.n=t,e.as=this.as,this.cb.call(e.as,t,n,e))}function e(t){t&&i.is(e.n,t,e.as)}s.is=function(e,n,i,r){return!(!e||!u(e)||f(e))&&!d(e,t,{cb:n,fn:i,as:r})}}(),function(){function t(t,e){var s;return(s=function(t,e){var n,i=t.seen,r=i.length;for(;r--;)if(n=i[r],e.obj===n.obj)return n;i.push(e)}(t,e))?s:(e.env=t,e.soul=a,i.ify(e.obj,r,e)&&(e.rel=e.rel||n.rel.ify(i.soul(e.node)),e.obj!==t.shell&&(t.graph[n.rel.is(e.rel)]=e.node)),e)}function r(e,r,s){var a,u,l=this,d=l.env;if(i._===r&&c(e,n.rel._))return s._;if(a=f(e,r,s,l,d)){if(r||(l.node=l.node||s||{},c(e,i._)&&i.soul(e)&&(l.node._=p(e._)),l.node=i.soul.ify(l.node,n.rel.is(l.rel)),l.rel=l.rel||n.rel.ify(i.soul(l.node))),(u=d.map)&&(u.call(d.as||{},e,r,s,l),c(s,r))){if(e=s[r],o===e)return void h(s,r);if(!(a=f(e,r,s,l,d)))return}if(!r)return l.node;if(!0===a)return e;if((u=t(d,{obj:e,path:l.path.concat(r)})).node)return u.rel}}function a(t){var e=this,r=n.link.is(e.rel),s=e.env.graph;e.rel=e.rel||n.rel.ify(t),e.rel[n.rel._]=t,e.node&&e.node[i._]&&(e.node[i._][n.rel._]=t),c(s,r)&&(s[t]=s[r],h(s,r))}function f(t,i,r,s,o){var a;return!!n.is(t)||(u(t)?1:(a=o.invalid)?f(t=a.call(o.as||{},t,i,r),i,r,s,o):(o.err="Invalid value at '"+s.path.concat(i).join(".")+"'!",void(e.list.is(t)&&(o.err+=" Use `.set(item)` instead of an Array."))))}s.ify=function(e,i,r){var s={path:[],obj:e};return i?"string"==typeof i?i={soul:i}:i instanceof Function&&(i.map=i):i={},i.soul&&(s.rel=n.rel.ify(i.soul)),i.shell=(r||{}).shell,i.graph=i.graph||{},i.seen=i.seen||[],i.as=i.as||r,t(i,s),i.root=s.node,i.graph}}(),s.node=function(t){var e=i.soul(t);if(e)return l({},e,t)},function(){function t(t,e){var r,o;if(i._!==e)(r=n.rel.is(t))?(o=this.opt.seen[r])?this.obj[e]=o:this.obj[e]=this.opt.seen[r]=s.to(this.graph,r,this.opt):this.obj[e]=t;else{if(f(t,n.rel._))return;this.obj[e]=p(t)}}s.to=function(e,n,i){if(e){var r={};return i=i||{seen:{}},d(e[n],t,{obj:r,graph:e,opt:i}),r}}}();e.fn.is;var o,a=e.obj,u=a.is,h=a.del,c=a.has,f=a.empty,l=a.put,d=a.map,p=a.copy;t.exports=s})(r,"./graph"),r(function(t){r("./onto"),t.exports=function(t,e){if(this.on){if(!(t instanceof Function)){if(!t||!e)return;var n=t["#"]||t,i=(this.tag||empty)[n];if(!i)return;return i=this.on(n,e),clearTimeout(i.err),!0}n=e&&e["#"]||Math.random().toString(36).slice(2);if(!t)return n;var r=this.on(n,t,e);return r.err=r.err||setTimeout(function(){r.next({err:"Error: No ACK received yet.",lack:!0}),r.off()},(this.opt||{}).lack||9e3),n}}})(r,"./ask"),r(function(t){var e=r("./type");var n=e.time.is;t.exports=function(t){var i={s:{}};return t=t||{max:1e3,age:9e3},i.check=function(t){var e;return!!(e=i.s[t])&&(e.pass?e.pass=!1:i.track(t))},i.track=function(r,s){var o=i.s[r]||(i.s[r]={});return o.was=n(),s&&(o.pass=!0),i.to||(i.to=setTimeout(function(){var r=n();e.obj.map(i.s,function(n,s){t.age>r-n.was||e.obj.del(i.s,s)}),i.to=null},t.age+9)),o},i}})(r,"./dup"),r(function(t){function e(t){return t instanceof e?(this._={gun:this,$:this}).$:this instanceof e?e.create(this._={gun:this,$:this,opt:t}):new e(t)}e.is=function(t){return t instanceof e||t&&t._&&t===t._.$||!1},e.version=.9,e.chain=e.prototype,e.chain.toJSON=function(){};var n=r("./type");n.obj.to(n,e),e.HAM=r("./HAM"),e.val=r("./val"),e.node=r("./node"),e.state=r("./state"),e.graph=r("./graph"),e.on=r("./onto"),e.ask=r("./ask"),e.dup=r("./dup"),function(){function t(n){var i,r,s=this.as,a=s.at||s,u=a.$;(r=n["#"])||(r=n["#"]=c(9)),(i=a.dup).check(r)?s.out===n.out&&(n.out=o,this.to.next(n)):(i.track(r),a.ask(n["@"],n)||(n.get&&e.on.get(n,u),n.put&&e.on.put(n,u)),this.to.next(n),s.out||(n.out=t,a.on("out",n)))}e.create=function(n){n.root=n.root||n,n.graph=n.graph||{},n.on=n.on||e.on,n.ask=n.ask||e.ask,n.dup=n.dup||e.dup();var i=n.$.opt(n.opt);return n.once||(n.on("in",t,n),n.on("out",t,{at:n,out:t}),e.on("create",n),n.on("create",n)),n.once=1,i}}(),function(){function t(t,n,i,r){var s=this,o=e.state.is(i,n);if(!o)return s.err="Error: No state on '"+n+"' in node '"+r+"'!";var a=s.graph[r]||b,u=e.state.is(a,n,!0),h=a[n],c=e.HAM(s.machine,o,u,t,h);c.incoming?(s.put[r]=e.state.to(i,n,s.put[r]),(s.diff||(s.diff={}))[r]=e.state.to(i,n,s.diff[r]),s.souls[r]=!0):c.defer&&(s.defer=o<(s.defer||1/0)?o:s.defer)}function n(t,e){var n=this,o=n.$._,a=(o.next||b)[e];if(!a){if(!(o.opt||b).super)return void(n.souls[e]=!1);a=n.$.get(e)._}var u=n.map[e]={put:t,get:e,$:a.$},h={ctx:n,msg:u};n.async=!!o.tag.node,n.ack&&(u["@"]=n.ack),g(t,i,h),n.async&&(n.and||o.on("node",function(t){this.to.next(t),t===n.map[t.get]&&(n.souls[t.get]=!1,g(t.put,r,t),g(n.souls,function(t){if(t)return t})||n.c||(n.c=1,this.off(),g(n.map,s,n)))}),n.and=!0,o.on("node",u))}function i(t,n){var i=this.ctx,r=i.graph,s=this.msg,o=s.get,a=s.put,u=s.$._;r[o]=e.state.to(a,n,r[o]),i.async||(u.put=e.state.to(a,n,u.put))}function r(t,n){var i=this.put,r=this.$._;r.put=e.state.to(i,n,r.put)}function s(t,e){t.$&&(this.cat.stop=this.stop,t.$._.on("in",t),this.cat.stop=null)}e.on.put=function(i,r){var a=r._,u={$:r,graph:a.graph,put:{},map:{},souls:{},machine:e.state(),ack:i["@"],cat:a,stop:{}};if(e.graph.is(i.put,null,t,u)||(u.err="Error: Invalid graph!"),u.err)return a.on("in",{"@":i["#"],err:e.log(u.err)});g(u.put,n,u),u.async||g(u.map,s,u),o!==u.defer&&setTimeout(function(){e.on.put(i,r)},u.defer-u.machine),u.diff&&a.on("put",p(i,{put:u.diff}))},e.on.get=function(t,n){var i=n._,r=t.get,s=r[y],o=i.graph[s],a=r[m],u=(i.next||(i.next={}))[s];if(r["*"]){var h={};e.obj.map(i.graph,function(t,n){e.text.match(n,r)&&(h[n]=e.obj.copy(t))}),e.obj.empty(h)||i.on("in",{"@":t["#"],how:"*",put:h,$:n})}if(!o)return i.on("get",t);if(a){if(!d(o,a))return i.on("get",t);o=e.state.to(o,a)}else o=e.obj.copy(o);o=e.graph.node(o),(u||b).ack,i.on("in",{"@":t["#"],how:"mem",put:o,$:n}),i.on("get",t)}}(),e.chain.opt=function(t){t=t||{};var n=this._,i=t.peers||t;return l(t)||(t={}),l(n.opt)||(n.opt=t),h(i)&&(i=[i]),a(i)&&(i=g(i,function(t,e,n){n(t,{url:t})}),l(n.opt.peers)||(n.opt.peers={}),n.opt.peers=p(i,n.opt.peers)),n.opt.peers=n.opt.peers||{},p(t,n.opt),e.on("opt",n),n.opt.uuid=n.opt.uuid||function(){return v()+c(12)},this};var o,a=e.list.is,u=e.text,h=u.is,c=u.random,f=e.obj,l=f.is,d=f.has,p=f.to,g=f.map,v=(f.copy,e.state.lex),y=e.val.rel._,m=".",b=(e.node._,e.val.link.is,{});i.debug=function(t,e){return i.debug.i&&t===i.debug.i&&i.debug.i++&&(i.log.apply(i,arguments)||e)},e.log=function(){return!e.log.off&&i.log.apply(i,arguments),[].slice.call(arguments).join(" ")},e.log.once=function(t,n,i){return(i=e.log.once)[t]=i[t]||0,i[t]++||e.log(n)},e.log.once("welcome","Hello wonderful person! :) Thanks for using GUN, feel free to ask for help on https://gitter.im/amark/gun and ask StackOverflow questions tagged with 'gun'!"),"undefined"!=typeof window&&((window.Gun=e).window=window);try{void 0!==s&&(s.exports=e)}catch(t){}t.exports=e})(r,"./root"),r(function(t){var e=r("./root");e.chain.back=function(t,r){if(-1===(t=t||1)||1/0===t)return this._.root.$;if(1===t)return(this._.back||this._).$;var s=this._;if("string"==typeof t&&(t=t.split(".")),t instanceof Array){for(var o=0,a=t.length,u=s;o<a;o++)u=(u||i)[t[o]];return n!==u?r?this:u:(u=s.back)?u.$.back(t,r):void 0}if(t instanceof Function){var h;for(u={back:s};(u=u.back)&&n===(h=t(u,r)););return h}return e.num.is(t)?(s.back||s).$.back(t-1):this};var n,i={}})(r,"./back"),r(function(t){var e=r("./root");function n(t){var n,i,r,s=this.as,o=s.back,a=s.root;if(t.I||(t.I=s.$),t.$||(t.$=s.$),this.to.next(t),i=t.get){if(i["#"]||s.soul){if(i["#"]=i["#"]||s.soul,t["#"]||(t["#"]=m(9)),o=a.$.get(i["#"])._,i=i["."]){if(p(o.put,i)&&((r=(n=o.$.get(i)._).ack)||(n.ack=-1),o.on("in",{$:o.$,put:e.state.to(o.put,i),get:o.get}),r))return}else{if((r=o.ack)||(o.ack=-1),p(o,"put")&&o.on("in",o),r)return;t.$=o.$}return a.ask(c,t),a.on("in",t)}if(a.now&&(a.now[s.id]=a.now[s.id]||!0,s.pass={}),i["."])return s.get?(t={get:{".":s.get},$:s.$},o.ask||(o.ask={}),o.ask[s.get]=t.$._,o.on("out",t)):(t={get:{},$:s.$},o.on("out",t));if(s.ack=s.ack||-1,s.get)return t.$=s.$,i["."]=s.get,(o.ask||(o.ask={}))[s.get]=t.$._,o.on("out",t)}return o.on("out",t)}function i(t){var n,i,r=this,a=r.as,c=a.root,d=(t.$||l)._||l,m=t.put;if(a.get&&t.get!==a.get&&(t=v(t,{get:a.get})),a.has&&d!==a&&(t=v(t,{$:a.$}),d.ack&&(a.ack=d.ack)),f===m){if(i=d.put,r.to.next(t),a.soul)return;if(f===i&&f!==d.put)return;return o(a,t,r),a.has&&h(a,t),g(d.echo,a.id),void g(a.map,d.id)}if(a.soul)return r.to.next(t),o(a,t,r),void(a.next&&y(m,u,{msg:t,cat:a}));if(!(n=e.val.link.is(m)))return e.val.is(m)?(a.has||a.soul?h(a,t):(d.has||d.soul)&&((d.echo||(d.echo={}))[a.id]=d.echo[d.id]||a,(a.map||(a.map={}))[d.id]=a.map[d.id]||{at:d}),r.to.next(t),void o(a,t,r)):(a.has&&d!==a&&p(d,"put")&&(a.put=d.put),(n=e.node.soul(m))&&d.has&&(d.put=a.root.$.get(n)._.put),i=(c.stop||{})[d.id],r.to.next(t),s(a,t,d,n),o(a,t,r),void(a.next&&y(m,u,{msg:t,cat:a})));c.stop;(i=(i=c.stop||{})[d.id]||(i[d.id]={})).is=i.is||d.put,i[a.id]=d.put||!0,r.to.next(t),s(a,t,d,n),o(a,t,r)}function s(t,n,i,r){if(r&&b!==t.get){var o=t.root.$.get(r)._;t.has?i=o:i.has&&s(i,n,i,r),i!==t&&(i.$||(i={}),(i.echo||(i.echo={}))[t.id]=i.echo[t.id]||t,t.has&&!(t.map||l)[i.id]&&h(t,n),(r!==(o=i.id?(t.map||(t.map={}))[i.id]=t.map[i.id]||{at:i}:{}).link||o.pass||t.pass)&&(t.pass&&(e.obj.map(t.map,function(t){t.pass=!0}),g(t,"pass")),o.pass&&g(o,"pass"),t.has&&(t.link=r),function(t,n){var i=t.root.$.get(n)._;if(t.ack&&(i.on("out",{get:{"#":n}}),!t.ask))return;i=t.ask,e.obj.del(t,"ask"),y(i||t.next,function(t,e){t.on("out",{get:{"#":n,".":e}})}),e.obj.del(t,"ask")}(t,o.link=r)))}}function o(t,e,n){t.echo&&y(t.echo,a,e)}function a(t){t&&t.on&&t.on("in",this)}function u(t,n){var i,r,s,o=this.cat.next||l,a=this.msg;(b!==n||o[n])&&(r=o[n])&&(r.has?(f!==r.put&&e.val.link.is(t)||(r.put=t),i=r.$):(s=a.$)&&(s=(i=a.$.get(n))._,f!==s.put&&e.val.link.is(t)||(s.put=t)),r.on("in",{put:t,get:n,$:i,via:a}))}function h(t,n){if(t.has||t.soul){var i=t.map;t.root;t.map=null,t.has&&(t.link=null),(t.pass||n["@"]||null!==i)&&(f===i&&e.val.link.is(t.put)||(y(i,function(e){(e=e.at)&&g(e.echo,t.id)}),i=t.put,y(t.next,function(e,n){if(f===i&&f!==t.put)return!0;e.put=f,e.ack&&(e.ack=-1),e.on("in",{get:n,$:e.$,put:f})})))}}function c(t,n){var i=this.as,r=i.get||l,s=i.$._,o=(t.put||l)[r["#"]];if(s.ack&&(s.ack=s.ack+1||1),!t.put||r["."]&&!p(o,s.get)){if(s.put!==f)return;s.on("in",{get:s.get,put:s.put=f,$:s.$,"@":t["@"]})}else b!=r["."]?(t.$=s.root.$,e.on.put(t,s.root.$)):s.on("in",{get:s.get,put:e.val.link.ify(r["#"]),$:s.$,"@":t["@"]})}e.chain.chain=function(t){var r,s=this._,o=new(t||this).constructor(this),a=o._;return a.root=r=s.root,a.id=++r.once,a.back=this._,a.on=e.on,a.on("in",i,a),a.on("out",n,a),o};var f,l={},d=e.obj,p=d.has,g=(d.put,d.del),v=d.to,y=d.map,m=e.text.random,b=(e.val.rel._,e.node._)})(r,"./chain"),r(function(t){var e=r("./root");function n(t){var e,n=this,i=n.as,r=i.at.root,a=(t.$||{})._||{},h=t.put||a.put;if((e=r.now)&&n!==e[i.now])return n.to.next(t);if(n.seen&&a.id&&n.seen[a.id])return n.to.next(t);if((e=h)&&e[u._]&&(e=u.is(e))&&(e=(t.$$=a.root.gun.get(e))._,s!==e.put&&(t=o(t,{put:h=e.put}))),(e=r.mum)&&a.id){if(e[a.id])return;s===h||u.is(h)||(e[a.id]=!0)}i.use(t,n),n.stun?n.stun=null:n.to.next(t)}function i(t){var e=this.on;if(!t||e.soul||e.has)return this.off();if(t=(t=(t=t.$||t)._||t).id){var n;e.map;if((n=this.seen||(this.seen={}))[t])return!0;n[t]=!0}}e.chain.get=function(t,r,s){var o;if("string"!=typeof t){if(t instanceof Function){if(!0===r)return function(t,e,n,i){var r,s=t._;if(r=s.soul)return e(r,i,s),t;if(r=s.link)return e(r,i,s),t;return t.get(function(t,n){n.rid(t);var s=(s=t.$)&&s._||{};r=s.link||s.soul||u.is(t.put)||h(t.put),e(r,i,t,n)},{out:{get:{".":!0}}}),t}(this,t,0,s);var f,l=(o=this)._,d=l.root,p=d.now;(s=r||{}).at=l,s.use=t,s.out=s.out||{},s.out.get=s.out.get||{},(f=l.on("in",n,s)).rid=i,(d.now={$:1})[s.now=l.id]=f;var g=d.mum;return d.mum={},l.on("out",s.out),d.mum=g,d.now=p,o}return a(t)?this.get(""+t,r,s):(p=u.is(t))?this.get(p,r,s):((s=this.chain())._.err={err:e.log("Invalid get request!",t)},r&&r.call(s,s._.err),s)}var v=this._;return(o=(v.next||c)[t])||(o=function(t,e){var n=e._,i=n.next,r=e.chain()._;i||(i=n.next={});i[r.get=t]=r,e===n.root.$?r.soul=t:(n.soul||n.has)&&(r.has=t);return r}(t,this)),o=o.$,(p=v.stun)&&(o._.stun=o._.stun||p),r&&r instanceof Function&&o.get(r,s),o};e.obj.has;var s,o=e.obj.to,a=e.num.is,u=e.val.link,h=e.node.soul,c=(e.node._,{})})(r,"./get"),r(function(t){var e=r("./root");function n(t){t&&t()}function s(){var t=this;t.graph&&!g(t.stun,o)&&(t.res=t.res||function(t){t&&t()},t.res(function(){var n=t.$.back(-1)._,i=n.ask(function(i){n.root.on("ack",i),i.err&&e.log(i),i.lack||this.off(),t.ack&&t.ack(i,this)},t.opt),r=n.root.now;l.del(n.root,"now");var s=n.root.mum;n.root.mum={},t.ref._.on("out",{$:t.ref,put:t.out=t.env.graph,opt:t.opt,"#":i}),n.root.mum=s?l.to(s,n.root.mum):s,n.root.now=r},t),t.res&&t.res())}function o(t,e){if(t)return!0}function a(t,n,i,r){var s=this,o=e.is(t);!n&&r.path.length&&(s.res||m)(function(){for(var n=r.path,i=s.ref,a=(s.opt,0),h=n.length;a<h;a++)i=i.get(n[a]);o&&(i=t);var c=i._.dub;if(c||(c=e.node.soul(r.obj)))return i.back(-1).get(c),void r.soul(c);(s.stun=s.stun||{})[n]=!0,i.get(u,!0,{as:{at:r,as:s,p:n}})},{as:s,at:r})}function u(t,n,i,r){var s=(n=n.as).at;n=n.as;var o=((i||{}).$||{})._||{};t=o.dub=o.dub||t||e.node.soul(s.obj)||e.node.soul(i.put||o.put)||e.val.rel.is(i.put||o.put)||(n.via.back("opt.uuid")||e.text.random)(),r&&(r.stun=!0),t?h(o,o.dub=t,s,n):o.via.back("opt.uuid")(function(t,i){if(t)return e.log(t);h(o,o.dub=o.dub||i,s,n)})}function h(t,e,n,i){t.$.back(-1).get(e),n.soul(e),i.stun[n.path]=!1,i.batch()}function c(t,n,r,s){if(n=n.as,r.$&&r.$._)if(r.err)i.log("Please report this as an issue! Put.any.err");else{var o,a=r.$._,u=a.put,h=n.opt||{};if(!(o=n.ref)||!o._.now){if(s&&(s.stun=!0),n.ref!==n.$){if(!(o=n.$._.get||a.get))return void i.log("Please report this as an issue! Put.no.get");n.data=p({},o,n.data),o=null}if(f===u){if(!a.get)return;t||(o=a.$.back(function(t){if(t.link||t.soul)return t.link||t.soul;n.data=p({},t.get,n.data)})),o=o||a.get,a=a.root.$.get(o)._,n.soul=o,u=n.data}n.not||(n.soul=n.soul||t)||(n.path&&d(n.data)?n.soul=(h.uuid||n.via.back("opt.uuid")||e.text.random)():(b==a.get&&(n.soul=(a.put||v)["#"]||a.dub),n.soul=n.soul||a.soul||a.soul||(h.uuid||n.via.back("opt.uuid")||e.text.random)()),n.soul)?n.ref.put(n.data,n.soul,n):n.via.back("opt.uuid")(function(t,i){if(t)return e.log(t);n.ref.put(n.data,n.soul=i,n)})}}}e.chain.put=function(t,i,r){var o,u=this,h=u._,f=h.root.$;return(r=r||{}).data=t,r.via=r.$=r.via||r.$||u,"string"==typeof i?r.soul=i:r.ack=r.ack||i,h.soul&&(r.soul=h.soul),r.soul||f===u?d(r.data)?(r.soul=r.soul||(r.not=e.node.soul(r.data)||(r.via.back("opt.uuid")||e.text.random)()),r.soul?(r.$=u=f.get(r.soul),r.ref=r.$,function(t){t.batch=s;var n=t.opt||{},i=t.env=e.state.map(a,n.state);if(i.soul=t.soul,t.graph=e.graph.ify(t.data,i,t),i.err)return(t.ack||y).call(t,t.out={err:e.log(i.err)}),void(t.res&&t.res());t.batch()}(r),u):(r.via.back("opt.uuid")(function(t,n){if(t)return e.log(t);(r.ref||r.$).put(r.data,r.soul=n,r)}),u)):((r.ack||y).call(r,r.out={err:e.log("Data saved to the root level of the graph must be a node (an object), not a",typeof r.data,'of "'+r.data+'"!')}),r.res&&r.res(),u):e.is(t)?(t.get(function(t,n,s){if(!t&&e.val.is(s.put))return e.log("The reference you are saving is a",typeof s.put,'"'+s.put+'", not a node (object)!');u.put(e.val.rel.ify(t),i,r)},!0),u):(r.ref=r.ref||f._===(o=h.back)?u:o.$,r.ref._.soul&&e.val.is(r.data)&&h.get?(r.data=p({},h.get,r.data),r.ref.put(r.data,r.soul,r),u):(r.ref.get(c,!0,{as:r}),r.out||(r.res=r.res||n,r.$._.stun=r.ref._.stun),u))};var f,l=e.obj,d=l.is,p=l.put,g=l.map,v={},y=function(){},m=function(t,e){t.call(e||v)},b=e.node._})(r,"./put"),r(function(t){var e=r("./root");r("./chain"),r("./back"),r("./put"),r("./get"),t.exports=e})(r,"./index"),r(function(t){var e=r("./index");function n(t,e){var n,i=t.$,r=((i||{})._||{}).put||t.put;this.at;if(s!==r){if(n=t.$$){if(n=t.$$._,s===n.put)return;r=n.put}this.change&&(r=t.put),this.as?this.ok.call(this.as,t,e):this.ok.call(i,r,t.get,t,e)}}function i(t,e,n){var r,o,a=this.as,u=(a.at,t.$),h=u._,c=h.put||t.put;if(o=t.$$){if(r=o=t.$$._,s===o.put)return;c=o.put}(o=e.wait)&&(o=o[h.id])&&clearTimeout(o),n||s!==c&&!h.soul&&!h.link&&(!r||0<r.ack)?(e.rid(t),a.ok.call(u||a.$,c,t.get)):o=(e.wait={})[h.id]=setTimeout(function(){i.call({as:a},t,e,o||1)},a.wait||99)}e.chain.on=function(t,e,i,r){var s,o=this._;if("string"==typeof t)return e?(s=o.on(t,e,i||o,r),i&&i.$&&(i.subs||(i.subs=[])).push(s),this):o.on(t);var a=e;return(a=!0===a?{change:!0}:a||{}).at=o,a.ok=t,this.get(n,a),this},e.chain.val=function(t,n){return e.log.once("onceval","Future Breaking API Change: .val -> .once, apologies unexpected."),this.once(t,n)},e.chain.once=function(t,n){var r=this,o=r._,a=o.put;if(0<o.ack&&s!==a)return(t||h).call(r,a,o.get),r;if(!t){e.log.once("valonce","Chainable val is experimental, its behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it.");var u=r.chain();return u._.nix=r.once(function(){u._.on("in",r._)}),u}return(n=n||{}).ok=t,n.at=o,n.out={"#":e.text.random(9)},r.get(i,{as:n}),n.async=!0,r},e.chain.off=function(){var t,e=this._,n=e.back;if(n)return(t=n.next)&&t[e.get]&&u(t,e.get),(t=n.ask)&&u(t,e.get),(t=n.put)&&u(t,e.get),(t=e.soul)&&u(n.root.graph,t),(t=e.map)&&a(t,function(t){t.link&&n.root.$.get(t.link).off()}),(t=e.next)&&a(t,function(t){t.$.off()}),e.on("off",{}),this};var s,o=e.obj,a=o.map,u=(o.has,o.del),h=(o.to,e.val.link,function(){})})(r,"./on"),r(function(t){var e=r("./index");function n(t){if(!t.put||e.val.is(t.put))return this.to.next(t);this.as.nix&&this.off(),s(t.put,i,{at:this.as,msg:t}),this.to.next(t)}function i(t,e){if(a!==e){var n=this.msg.$,i=this.at,r=n.get(e)._;(r.echo||(r.echo={}))[i.id]=r.echo[i.id]||i}}e.chain.map=function(t,i,r){var s,a=this._;return t?(e.log.once("mapfn","Map functions are experimental, their behavior and API may change moving forward. Please play with it and report bugs and ideas on how to improve it."),s=this.chain(),this.map().on(function(n,i,r,a){var u=(t||o).call(this,n,i,r,a);if(void 0!==u)return n===u?s._.on("in",r):e.is(u)?s._.on("in",u._):void s._.on("in",{get:i,put:u})}),s):(s=a.each)?s:(a.each=s=this.chain(),s._.nix=this.back("nix"),this.on("in",n,s._),s)};var s=e.obj.map,o=function(){},a=e.node._})(r,"./map"),r(function(t){var e=r("./index");e.chain.set=function(t,n,i){var r,s=this;if(n=n||function(){},(i=i||{}).item=i.item||t,r=e.node.soul(t))return s.set(s.back(-1).get(r),n,i);if(!e.is(t)){var o=s.back("opt.uuid")();return o&&e.obj.is(t)?s.set(s._.root.$.put(t,o),n,i):s.get(e.state.lex()+e.text.random(7)).put(t,n,i)}return t.get(function(t,r,o){if(!t)return n.call(s,{err:e.log('Only a node can be linked! Not "'+o.put+'"!')});s.put(e.obj.put({},t,e.val.link.ify(t)),n,i)},!0),t}})(r,"./set"),r(function(t){if("undefined"!=typeof Gun){var e,n=function(){};"undefined"!=typeof window&&(e=window);var i=e.localStorage||{setItem:n,removeItem:n,getItem:n};Gun.on("create",function(t){var e=this.to,n=t.opt;if(t.once)return e.next(t);n.prefix=n.file||"gun/";var r,s,o=Gun.obj.ify(i.getItem("gap/"+n.prefix))||{},a=Gun.obj.empty;if(!a(o)){var u=Gun.obj.ify(i.getItem(n.prefix))||{},h={};Gun.obj.map(o,function(t,e){Gun.obj.map(t,function(t,n){h[e]=Gun.state.to(u[e],n,h[e])})}),setTimeout(function(){t.on("out",{put:h,"#":t.ask(c),I:t.$})},1)}function c(t){if(!t.err&&t.ok){var e=t["@"];setTimeout(function(){Gun.obj.map(o,function(t,n){Gun.obj.map(t,function(n,i){e===n&&delete t[i]}),a(t)&&delete o[n]}),l()},n.wait||1)}}t.on("out",function(t){t.lS||(t.I&&t.put&&!t["@"]&&!a(n.peers)&&(r=t["#"],Gun.graph.is(t.put,null,f),s||(s=setTimeout(l,n.wait||1))),this.to.next(t))}),t.on("ack",c),e.next(t);var f=function(t,e,n,i){(o[i]||(o[i]={}))[e]=r},l=function(){clearTimeout(s),s=!1;try{i.setItem("gap/"+n.prefix,JSON.stringify(o))}catch(t){Gun.log(err=t||"localStorage failure")}}}),Gun.on("create",function(t){this.to.next(t);var e=t.opt;if(!t.once&&!1!==e.localStorage){e.prefix=e.file||"gun/";t.graph;var n,r={},s=0,o=Gun.obj.ify(i.getItem(e.prefix))||{};t.on("localStorage",o),t.on("put",function(t){if(this.to.next(t),Gun.graph.is(t.put,null,a),t["@"]||(r[t["#"]]=!0),(s+=1)>=(e.batch||1e3))return u();n||(n=setTimeout(u,e.wait||1))}),t.on("get",function(n){this.to.next(n);var i,r,s,a=n.get;function u(){if(a&&(i=a["#"])){var u=a["."];(r=o[i]||s)&&u&&(r=Gun.state.to(r,u)),(r||Gun.obj.empty(e.peers))&&t.on("in",{"@":n["#"],put:Gun.graph.node(r),how:"lS",lS:n.I})}}Gun.debug?setTimeout(u,1):u()});var a=function(t,e,n,i){o[i]=Gun.state.to(n,e,o[i])},u=function(a){var h;s=0,clearTimeout(n),n=!1;var c=r;r={},a&&(o=a);try{i.setItem(e.prefix,JSON.stringify(o))}catch(n){Gun.log(h=n||"localStorage failure"),t.on("localStorage:error",{err:h,file:e.prefix,flush:o,retry:u})}(h||Gun.obj.empty(e.peers))&&Gun.obj.map(c,function(e,n){t.on("in",{"@":n,err:h,ok:0})})}}})}})(r,"./adapters/localStorage"),r(function(t){var e=r("../type");function n(t){var r=function(){},a=t.opt;return r.out=function(e){var n;if(this.to&&this.to.next(e),(n=e["@"])&&(n=t.dup.s[n])&&(n=n.it)&&n.mesh)return r.say(e,n.mesh.via,1),void(n["##"]=e["##"]);r.say(e)},t.on("create",function(n){n.opt.pid=n.opt.pid||e.text.random(9),this.to.next(n),t.on("out",r.out)}),r.hear=function(n,s){if(n){var o,a,u,h=t.dup,c=n[0];try{u=JSON.parse(n)}catch(t){i.log("DAM JSON parse error",t)}if("{"===c){if(!u)return;if(h.check(o=u["#"]))return;if(h.track(o,!0).it=u,(c=u["@"])&&u.put&&(c+=a=u["##"]||(u["##"]=r.hash(u)))!=o){if(h.check(c))return;(c=h.s)[a]=c[o]}return(u.mesh=function(){}).via=s,(c=u["><"])&&(u.mesh.to=e.obj.map(c.split(","),function(t,e,n){n(t,!0)})),u.dam?void((c=r.hear[u.dam])&&c(u,s,t)):void t.on("in",u)}if("["!==c);else{if(!u)return;for(var f,l=0;f=u[l++];)r.hear(f,s)}}},function(){function n(t,e){var n=e.wire;try{n.send?n.send(t):e.say&&e.say(t)}catch(n){(e.queue=e.queue||[]).push(t)}}r.say=function(i,s,u){var h,c,f;s?(s.wire||a.wire&&a.wire(s))&&(c=i.mesh||o,s!==c.via&&((f=c.raw)||(f=r.raw(i)),(h=i["@"])&&(h=t.dup.s[h])&&(h=h.it)&&h.get&&h["##"]&&h["##"]===i["##"]||(h=c.to)&&(h[s.url]||h[s.id])&&!u||(s.batch?s.batch.push(f):(s.batch=[],setTimeout(function(){var t=s.batch;t&&(s.batch=null,t.length&&n(JSON.stringify(t),s))},a.gap||a.wait||1),n(f,s))))):e.obj.map(a.peers,function(t){r.say(i,t)})}}(),function(){function i(t,n){var i;return n instanceof Object?(e.obj.map(Object.keys(n).sort(),o,{to:i={},on:n}),i):n}function o(t){this.to[t]=this.on[t]}r.raw=function(n){if(!n)return"";var o,c,f,l=t.dup,d=n.mesh||{};if(f=d.raw)return f;if("string"==typeof n)return n;n["@"]&&(f=n.put)&&((c=n["##"])||(o=u(f,i)||"",c=r.hash(n,o),n["##"]=c),(f=l.s)[c=n["@"]+c]=f[n["#"]],n["#"]=c||n["#"],o&&((n=e.obj.to(n)).put=h));var p=0,g=[];e.obj.map(a.peers,function(t){if(g.push(t.url||t.id),++p>9)return!0}),n["><"]=g.join();var v=u(n);return s!==o&&(f=v.indexOf(h,v.indexOf("put")),v=v.slice(0,f-1)+o+v.slice(f+h.length+1)),d&&(d.raw=v),v},r.hash=function(t,r){return n.hash(r||u(t.put,i)||"")||t["#"]||e.text.random(9)};var u=JSON.stringify,h=":])([:"}(),r.hi=function(n){var i=n.wire||{};n.id||n.url?(a.peers[n.url||n.id]=n,e.obj.del(a.peers,i.id)):(i=i.id=i.id||e.text.random(9),r.say({dam:"?"},a.peers[i]=n)),i.hied||t.on(i.hied="hi",n),i=n.queue,n.queue=[],e.obj.map(i,function(t){r.say(t,n)})},r.bye=function(n){e.obj.del(a.peers,n.id),t.on("bye",n)},r.hear["?"]=function(t,e){if(!t.pid)return r.say({dam:"?",pid:a.pid,"@":t["#"]},e);e.id=e.id||t.pid,r.hi(e)},r}n.hash=function(t){if("string"!=typeof t)return{err:1};var e=0;if(!t.length)return e;for(var n=0,i=t.length;n<i;++n)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e};var s,o={};Object.keys=Object.keys||function(t){return map(t,function(t,e,n){n(e)})};try{t.exports=n}catch(t){}})(r,"./adapters/mesh"),r(function(e){var n=r("../index");n.Mesh=r("./mesh"),n.on("opt",function(e){this.to.next(e);var i=e.opt;if(!e.once&&!1!==i.WebSocket){var r;"undefined"!=typeof window&&(r=window),void 0!==t&&(r=t),r=r||{};var s=i.WebSocket||r.WebSocket||r.webkitWebSocket||r.mozWebSocket;if(s){i.WebSocket=s;i.mesh=i.mesh||n.Mesh(e),i.wire;i.wire=o}}function o(t){if(!t||!t.url)return n&&n(t);var e=t.url.replace("http","ws"),n=t.wire=new i.WebSocket(e);return n.onclose=function(){i.mesh.bye(t),a(t)},n.onerror=function(e){a(t),e&&e.code},n.onopen=function(){i.mesh.hi(t)},n.onmessage=function(e){e&&i.mesh.hear(e.data||e,t)},n}function a(t){clearTimeout(t.defer),t.defer=setTimeout(function(){o(t)},2e3)}})})(r,"./adapters/websocket")}()}),Zs="undefined"!=typeof window?window.Gun:Xs;Zs.chain.promise=function(t){var e=this;t=t||function(t){return t};return new Promise(function(t,n){e.once(function(e,n){t({put:e,get:n,gun:this})})}).then(t)},Zs.chain.then=function(t){return this.promise(function(e){return t?t(e.put):e.put})};var Qs="undefined"!=typeof window?window.Gun:Xs;Qs.chain.open=function(t,e,n){return(e=e||{}).doc=e.doc||{},e.ids=e.ids||{},e.any=e.any||t,e.ev=e.ev||{off:function(){Qs.obj.map(e.ev.s,function(t){t&&t.off()}),e.ev.s={}},s:{}},this.on(function(t,i,r,s){if(delete((t=Qs.obj.copy(t))||{})._,clearTimeout(e.to),e.to=setTimeout(function(){e.any&&(e.any.call(e.at.$,e.doc,e.key,e,e.ev),e.off&&(e.ev.off(),e.any=null))},e.wait||1),e.at=e.at||r,e.key=e.key||i,e.ev.s[this._.id]=s,Qs.val.is(t))n?n[i]=t:e.doc=t;else{var o,a=this;Qs.obj.map(t,function(t,i){(o=Qs.val.link.is(t))?e.ids[o]?(n||e.doc)[i]=e.ids[o]:a.get(i).open(e.any,e,e.ids[o]=(n||e.doc)[i]={}):(n||e.doc)[i]=t})}})};var to="undefined"!=typeof window?window.Gun:Xs;async function eo(t,e,n,i){return new Is(function(r){var s=[];function o(){s.sort(function(t,e){return t.key<e.key?-1:t.key>e.key?1:0}),r(s)}t.map(function(t,r){(!i||r>i)&&0===r.indexOf(e)&&(t&&s.push({value:t,key:r}),s.length>=n&&o())}),setTimeout(function(){o()},1e3)})}to.chain.open,to.chain.load=function(t,e,n){return(e=e||{}).off=!0,this.open(t,e,n)};var no=function(){function t(e){On(this,t),this.gun=e||new Ys}return t.create=async function(e,n){var i=new t(e);n||(n={name:"keyID",val:Ws.getDefault().keyID,conf:1,ref:0}),i.gun.get("viewpoint").put(new ks(n));var r=Ms.create(i.gun.get("identities"),{attrs:[n],trustDistance:0});return await i._addIdentityToIndexes(r.gun),i},t.getMsgIndexKey=function(t){var e=parseInt(t.distance);return(e=("00"+(e=Gs(e)?99:e)).substring(e.toString().length))+":"+Math.floor(Date.parse(t.timestamp||t.signedData.timestamp)/1e3)+":"+(t.ipfs_hash||t.hash).substr(0,9)},t.getIdentityIndexKeys=async function(t,e){var n=[],i=await t.get("trustDistance").then();return await t.get("attrs").map().once(function(t){if(t){var r=void 0!==i?i:parseInt(t.dist);r=("00"+(r=Gs(r)?99:r)).substring(r.toString().length);var s=t.val||t[1],o=t.name||t[0],a=encodeURIComponent(s),u=encodeURIComponent(s.toLowerCase()),h=encodeURIComponent(o),c=r+":"+a+":"+h,f=r+":"+u+":"+h;if(ks.isUniqueType(o)||(c=c+":"+e.substr(0,9),f=f+":"+e.substr(0,9)),n.push(c),c!==f&&n.push(f),s.indexOf(" ")>-1)for(var l=s.toLowerCase().split(" "),d=0;d<l.length;d+=1){var p=r+":"+encodeURIComponent(l[d])+":"+h;ks.isUniqueType(o)||(p=p+":"+e.substr(0,9)),n.push(p)}if(c.match(/^http(s)?:\/\/.+\/[a-zA-Z0-9_]+$/)){var g=c.split("/");n.push(g[g.length-1])}}}).then(),n},t.prototype.getViewpoint=async function(){var t=this,e=await new Is(function(e){return t.gun.get("identitiesByTrustDistance").map(function(t,n){return 0===n.indexOf("00")?e(n):0})});return new Ms(this.gun.get("identitiesByTrustDistance").get(e))},t.prototype.get=async function(t,e){if(void 0===t)throw"Value is undefined";void 0===e&&(e=ks.guessTypeOf(t));var n=encodeURIComponent(t)+":"+encodeURIComponent(e);if(await this.gun.get("identitiesBySearchKey").get(n).then())return new Ms(this.gun.get("identitiesBySearchKey").get(n))},t.prototype._getMsgs=async function(t,e,n){var i=await eo(t,"",e,n),r=[];return i.forEach(function(t){var e=Os.fromJws(t.value);r.push(e)}),r},t.prototype._addIdentityToIndexes=async function(e){for(var n=Ys.node.soul(e)||"todo",i=await t.getIdentityIndexKeys(e,n.substr(0,6)),r=0;r<i.length;r++){var s=i[r];console.log("adding key "+s),await this.gun.get("identitiesByTrustDistance").get(s).put(e).then(),await this.gun.get("identitiesBySearchKey").get(s.substr(s.indexOf(":")+1)).put(e).then()}},t.prototype.getSentMsgs=async function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._getMsgs(t.gun.get("sent"),e,n)},t.prototype.getReceivedMsgs=async function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return this._getMsgs(t.gun.get("received"),e,n)},t.prototype._getAttributeTrustDistance=async function(t){if(ks.isUniqueType(t.name)){var e=await this.get(t.val,t.name);return e&&e.gun.get("trustDistance").then()}},t.prototype.getMsgTrustDistance=async function(t){var e=1/0;if(await this.get(t.getSignerKeyID(),"keyID")){for(var n=await this.gun.get("viewpoint").then(),i=0;i<t.signedData.author.length;i++){var r=new ks(t.signedData.author[i]);if(ks.equals(r,n))return 0;var s=await this._getAttributeTrustDistance(r);s<e&&(e=s)}return e<1/0?e:void 0}},t.prototype._updateMsgRecipientIdentity=async function(e,n,i){var r=await t.getIdentityIndexKeys(i,"todo".substr(0,6)),s=await new Is(function(t){i.get("attrs").load(function(e){return t(e)})});if("verification"===e.signedData.type&&(e.signedData.recipient.forEach(function(t){var e=!1;_s(s).forEach(function(n){ks.equals(t,s[n])&&(s[n].conf=(s[n].conf||0)+1,e=!0)}),e||(s[encodeURIComponent(t[0])+":"+encodeURIComponent(t[1])]={name:t[0],val:t[1],conf:1,ref:0})}),await i.get("mostVerifiedAttributes").put(Ms.getMostVerifiedAttributes(s)),await i.get("attrs").put(s)),"rating"===e.signedData.type){var o=await i.then();e.isPositive()?(e.distance+1<o.trustDistance&&i.get("trustDistance").put(e.distance+1),await i.get("receivedPositive").put(o.receivedPositive+1)):e.isNegative()?await i.get("receivedNegative").put(o.receivedNegative+1):await i.get("receivedNeutral").put(o.receivedNeutral+1)}await i.get("received").get(n).put(e.jws).then();for(var a=await t.getIdentityIndexKeys(i,"todo".substr(0,6)),u=0;u<r.length;u++){var h=r[u];-1===a.indexOf(h)&&(await this.gun.get("identitiesByTrustDistance").get(h).put(null),await this.gun.get("identitiesBySearchKey").get(h.substr(h.indexOf(":")+1)).put(null))}},t.prototype._updateMsgAuthorIdentity=async function(t,e,n){if("rating"===t.signedData.type){var i=await n.then();t.isPositive()?await n.get("sentPositive").put(i.sentPositive+1):t.isNegative()?await n.get("sentNegative").put(i.sentNegative+1):await n.get("sentNeutral").put(i.sentNeutral+1)}return n.get("sent").get(e).put(t.jws).then()},t.prototype._updateIdentityProfilesByMsg=async function(e,n,i){var r=t.getMsgIndexKey(e);r=r.substr(r.indexOf(":")+1);for(var s=$s(tt({},n,i)),o=0;o<s.length;o++)i.hasOwnProperty(s[o].gun._.link)&&await this._updateMsgRecipientIdentity(e,r,s[o].gun),n.hasOwnProperty(s[o].gun._.link)&&await this._updateMsgAuthorIdentity(e,r,s[o].gun),await this._addIdentityToIndexes(s[o].gun)},t.prototype._updateIdentityIndexesByMsg=async function(t){for(var e={},n={},i=0;i<t.signedData.author.length;i++){var r=t.signedData.author[i],s=await this.get(r[1],r[0]);s&&(n[s.gun._.link]=s)}if(_s(n).length){for(var o=0;o<t.signedData.recipient.length;o++){var a=t.signedData.recipient[o],u=await this.get(a[1],a[0]);u&&(e[u.gun._.link]=u)}if(!_s(e).length){var h=[];t.signedData.recipient.forEach(function(t){h.push({name:t[0],val:t[1],conf:1,ref:0})});var c=Ms.create(this.gun.get("identities"),{attrs:h});e[c.gun._.link]=c}return this._updateIdentityProfilesByMsg(t,n,e)}},t.prototype.addMessages=async function(t){var e={};if(!Array.isArray(t))throw"msgs param must be an array";console.log("sorting "+t.length+" messages onto a search tree...");for(var n=0;n<t.length;n++)for(var i=0;i<t[n].signedData.author.length;i++){var r=t[n].signedData.author[i];if(ks.isUniqueType(r[0]))e[encodeURIComponent(r[1])+":"+encodeURIComponent(r[0])+":"+t[n].getHash()]=t[n]}console.log("...done");var s=_s(e).sort();if(s.length){var o=void 0,a=void 0,u=this.gun.get("identitiesBySearchKey");do{var h=await eo(u,""),c=0,f=s[c],l=h.shift();for(o=s.length;f&&l;)if(0===f.indexOf(l.key)){try{var d=Os.fromJws(e[f].jws);await Ps.timeoutPromise(this.addMessage(d),1e4)}catch(t){var p=Os.fromJws(e[f].jws);console.log("adding failed:",t,Nn(p,null,2))}s.splice(c,1),f=c<s.length?s[c]:void 0}else f<l.key?f=c<s.length?s[++c]:void 0:l=h.shift();a=s.length}while(a!==o);return!0}},t.prototype.addMessage=async function(e){if(e.distance=await this.getMsgTrustDistance(e),void 0===e.distance)return!1;var n=t.getMsgIndexKey(e);return await this.gun.get("messagesByDistance").get(n).put(e.jws).then(),n=n.substr(n.indexOf(":")+1),await this.gun.get("messagesByTimestamp").get(n).put(e.jws).then(),await this._updateIdentityIndexesByMsg(e),!0},t.prototype.search=async function(t){var e=this,n={};return new Is(function(i){e.gun.get("identitiesByTrustDistance").map(function(i,r){-1!==r.indexOf(encodeURIComponent(t))&&(n.hasOwnProperty(Ys.node.soul(i))||(n[Ys.node.soul(i)]=new Ms(e.gun.get("identitiesByTrustDistance").get(r))))}),setTimeout(function(){i($s(n))},200)})},t}();return{VERSION:"0.0.63",APIClient:Rn,Message:Os,Identity:Ms,Attribute:ks,Index:no,Key:Ws,util:Ps}});
